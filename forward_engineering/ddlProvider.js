"use strict";var Wt=Object.defineProperty;var t=(s,e)=>Wt(s,"name",{value:e,configurable:!0});var j=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var Je=j((ln,Me)=>{"use strict";Me.exports={number:"numeric",string:"nvarchar2",date:"date",timestamp:"timestamp",binary:"raw",boolean:"numeric",document:"bfile",array:"json",objectId:"char",default:"nvarchar2"}});var Qe=j((mn,ze)=>{"use strict";ze.exports={character:{type:"char"},"character varying":{type:"varchar"},"char varying":{type:"varchar"},"national char":{type:"nchar"},"national character":{type:"nchar"},"national char varying":{type:"nvarchar2"},"national character varying":{type:"nvarchar2"},"nchar varying":{type:"nvarchar2"},tinyint:{type:"number",precision:5},"small int":{type:"number",precision:5},shortinteger:{type:"number",precision:5},shortint:{type:"number",precision:5},smallint:{type:"number",precision:5},int:{type:"number",precision:10},integer:{type:"number",precision:10},shortdecimal:{type:"number",precision:5,scale:0},decimal:{type:"number",precision:5,scale:0},longinteger:{type:"number",precision:20},bigint:{type:"number",precision:20},int8:{type:"number",precision:20},bit:{type:"number",precision:1},real:{type:"float",length:23},"double precision":{type:"number"},"small money":{type:"float",precision:16,scale:2},money:{type:"float",precision:16,scale:2},"long varchar":{type:"long"},text:{type:"long"},ntext:{type:"long"},uniqueidentifier:{type:"char",length:36},uuid:{type:"char",length:36},datetime:{type:"date"},"small datetime":{type:"date"},image:{type:"long raw"},binary:{type:"raw"},varbinary:{type:"raw"},string:{type:"nvarchar2"}}});var Ze=j((un,Xe)=>{"use strict";Xe.exports={createSchema:"CREATE USER${ifNotExists} ${schemaName} NO AUTHENTICATION",comment:"\nCOMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${tableType} TABLE${ifNotExists} ${name}${tableProps}\n${options}",createTableProps:"${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}",columnDefinition:"${name}${type}${default}${encrypt}${constraints}",createKeyConstraint:"${constraintName}${keyType}${columns}${options}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete}",checkConstraint:"${name}CHECK (${expression})",createForeignKey:"ALTER TABLE ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",createIndex:"CREATE${indexType} INDEX${ifNotExists}${name} ON ${tableName}${keys}${options};\n",dropIndex:"DROP INDEX ${name};",alterIndexRename:"ALTER INDEX ${oldName} RENAME TO ${newName};",alterIndexRebuild:"ALTER INDEX ${name} REBUILD ${options};",createView:"CREATE${orReplace}${force}${viewType}${materialized} VIEW${ifNotExists} ${name} ${sharing}${viewProperties}\n	AS ${selectStatement}",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createObjectType:`CREATE OR REPLACE TYPE \${name} AS OBJECT 
(
	\${properties}
);
`,objectTypeColumnDefinition:"${name} ${type}",createCollectionType:"CREATE OR REPLACE TYPE ${name} IS ${collectionType}${size} OF (${datatype})${notPersistable};\n",ifNotExists:`DECLARE
BEGIN
	EXECUTE IMMEDIATE '\${statement}';
	EXCEPTION WHEN OTHERS THEN
		IF SQLCODE = -\${errorCode} THEN NULL; ELSE RAISE; END IF;
END;
/
`,createSynonym:"CREATE${orReplace}${editionable}${public} SYNONYM ${name}\n	FOR ${objectName};\n",renameColumn:"ALTER TABLE ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",createSequence:"CREATE SEQUENCE${ifNotExists} ${name}${sharing}${options}",dropSequence:"DROP SEQUENCE${ifExists} ${name};\n",renameSequence:"RENAME ${name} TO ${newName};\n",alterSequence:"ALTER SEQUENCE${ifExists} ${name}${options};\n",dualityView:{createJsonRelationalDualityViewHeading:"CREATE${orReplaceStatement}${forceStatement}${editionableStatement} JSON RELATIONAL DUALITY VIEW ${viewName} AS",sql:{tableTagsStatement:"WITH${checkStatement}${etagStatement}${insertStatement}${updateStatement}${deleteStatement}",columnTagsStatement:"WITH${checkStatement}${etagStatement}${updateStatement}",fromTableStatement:"FROM ${tableName}${tableAlias}${tableTagsStatement}${whereClauseStatement}"}},alterSession:"ALTER SESSION SET CURRENT_SCHEMA=${schemaName};\n"}});var Ce=j((dn,et)=>{"use strict";var Mt=Object.freeze({SQL:"SQL",GRAPHQL:"GRAPHQL"});et.exports={DualityViewSyntaxType:Mt}});var nt=j((pn,tt)=>{"use strict";var Jt=Object.freeze({JOIN_SUBQUERY_TYPE:"joinSubquery",COLLECTION_REFERENCE:"collectionReference"});tt.exports={DualityViewPropertiesType:Jt}});var ce=j((gn,rt)=>{"use strict";var yn=require("lodash");rt.exports=s=>{let e=t(n=>s.get(n,"[0].code")||s.get(n,"[0].name",""),"getDbName"),a=t(n=>n&&(n.code||n.collectionName)||"","getEntityName"),l=t(n=>n&&(n.code||n.name)||"","getViewName"),p=t(n=>n&&(n.code||n.name)||"","getBucketName"),d=t(n=>({...s.get(n,"[0]",{}),name:e(n)}),"getDbData"),o=t(n=>s.get(n,"[0].viewOn"),"getViewOn"),T=t(n=>u=>u.primaryTableId===n&&u.primaryTableId!==u.foreignTableId,"isRecursiveRelationship"),y=t(n=>Object.keys(n).reduce((u,f)=>{let R=n[f].filter(K=>{let B=n[K.primaryTableId];return Array.isArray(B)?!B.some(T(f)):!0});return s.isEmpty(R)?u:{...u,[f]:R}},{}),"rejectRecursiveRelationships"),C=t(n=>Object.keys(n).reduce((u,f)=>{let R=n[f].filter(K=>{let B=n[K.primaryTableId];return Array.isArray(B)?B.some(T(f)):!1});return u.concat(R)},[]),"filterRecursiveRelationships"),h=t((n,u="	")=>n.split(`
`).map(f=>u+f).join(`
`),"tab"),O=t((n,u)=>Object.keys(n).map(s.toLower).includes(s.toLower(u)),"hasType"),U=t(n=>Object.entries(n).filter(([u,f])=>!s.isNil(f)).reduce((u,[f,R])=>({...u,[f]:R}),{}),"clean"),G=t(n=>n.every(u=>s.get(u,"isActivated",!0)),"checkAllKeysActivated"),Z=t(n=>n.length?n.every(u=>!s.get(u,"isActivated",!0)):!1,"checkAllKeysDeactivated"),g=t((n,u)=>{let f=n.filter(K=>s.get(K,"isActivated",!0)).map(u),R=n.filter(K=>!s.get(K,"isActivated",!0)).map(u);return{activatedItems:f,deactivatedItems:R}},"divideIntoActivatedAndDeactivated"),E=t((n,{isActivated:u,isPartOfLine:f,inlineComment:R="--"})=>u!==!1?n:f?"/* "+n+" */":n.includes(`
`)?`/*
`+n+` */
`:R+" "+n,"commentIfDeactivated"),S=t((n,u="'",f="'")=>{let R=n[0];return n[n.length-1]===u&&R===f?n:`${u}${n}${f}`},"wrap"),L=t(n=>`"${n}"`,"wrapInQuotes"),N=t(n=>u=>n==="nonquotedIdentifier"?u:L(u),"prepareNameForScriptFormat"),P=t(n=>`'${n}'`,"wrapComment"),q=t(n=>(u,f)=>f?`${N(n)(f)}.${N(n)(u)}`:N(n)(u),"getNamePrefixedWithSchemaNameForScriptFormat"),v=t((n,u)=>u.some(f=>(n==null?void 0:n.oldField[f])!==(n==null?void 0:n.newField[f])),"checkFieldPropertiesChanged"),J=t(({name:n})=>L(n),"columnMapToString");return{getDbName:e,getBucketName:p,getDbData:d,getEntityName:a,getViewName:l,getViewOn:o,rejectRecursiveRelationships:y,filterRecursiveRelationships:C,tab:h,hasType:O,clean:U,checkAllKeysActivated:G,checkAllKeysDeactivated:Z,divideIntoActivatedAndDeactivated:g,commentIfDeactivated:E,wrap:S,wrapComment:P,wrapInQuotes:L,getNamePrefixedWithSchemaNameForScriptFormat:q,checkFieldPropertiesChanged:v,getColumnsList:t((n,u,f,R=J)=>{var H;let K=g(n,R),B=(H=K==null?void 0:K.deactivatedItems)!=null&&H.length?E(K.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!u&&f?" ("+K.activatedItems.join(", ")+B+")":" ("+n.map(R).join(", ")+")"},"getColumnsList"),escapeSingleQuote:t(n=>n.replaceAll("'","''"),"escapeSingleQuote"),getGroupItemsByCompMode:t(({newItems:n=[],oldItems:u=[]})=>{let f=n.filter(B=>!u.some(H=>H.id===B.id)),R=[],K=[];return u.forEach(B=>{let H=n.find(m=>m.id===B.id);H?s.isEqual(H,B)||K.push(H):R.push(B)}),{added:f,removed:R,modified:K}},"getGroupItemsByCompMode"),prepareNameForScriptFormat:N}}});var at=j((Nn,it)=>{"use strict";var{DualityViewPropertiesType:st}=nt(),ie=class ie{constructor(e,a,l,p,d){if(this.constructor===ie)throw new Error("Abstract classes can't be instantiated.");this._ddlTemplates=e,this._assignTemplates=a,this._lodash=l,this._prepareName=p,this._getNamePrefixedWithSchemaName=d}static padInFront(e){return` ${e}`}static padInFrontAndUppercaseIfExists(e){return e?ie.padInFront(e).toUpperCase():""}static isDualityView(e={}){return e.viewOn&&e.duality}static isJoinSubquery(e={}){return(e==null?void 0:e.type)===st.JOIN_SUBQUERY_TYPE}static isFlexColumn(e={}){return e.flexColumn}static isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e={}){let{ref:a,refIdPath:l,refType:p}=e;return a&&(l||[]).length===2&&p===st.COLLECTION_REFERENCE}static isRegularDualityViewFieldInArraySubquery(e={}){let{ref:a,refId:l}=e;return a&&l}static isRegularDualityViewField(e={}){return ie.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)||ie.isRegularDualityViewFieldInArraySubquery(e)}static getPathToReferencedColumn(e,a){let l=[];return ie.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)?l=e.refIdPath:ie.isRegularDualityViewFieldInArraySubquery(e)&&(l=[...a.joinedCollectionRefIdPath||[],e.ref]),l}static getRegularFieldNameFromCollection(e,a){if(e.length<2)throw new Error("Cannot extract referenced column name");let l=e[0],p=e[1],d=a[l],o=(d==null?void 0:d.properties)||{};for(let T of Object.keys(o))if(o[T].GUID===p)return T;return""}static getKeyValueFrontPadding(e){return"	".repeat(e)}_getForceStatement(e){return ie.padInFrontAndUppercaseIfExists(e.force)}_getOrReplaceStatement(e){return e.orReplace?" OR REPLACE":""}_getEditionableStatement(e){return ie.padInFrontAndUppercaseIfExists(e.editionable)}static getRegularFieldName(e,a){return a.code||e||a.referencedColumnName}getCreateJsonRelationalDualityViewHeadingDdl(e){var U,G;let{jsonSchema:a,view:l}=e,{getViewName:p}=ce()(this._lodash),d=((G=(U=this._ddlTemplates)==null?void 0:U.dualityView)==null?void 0:G.createJsonRelationalDualityViewHeading)||"",o=this._getOrReplaceStatement(l),T=this._getForceStatement(a),y=this._getEditionableStatement(a),C=p(l),h=this._getNamePrefixedWithSchemaName(C,l.schemaName),O={orReplaceStatement:o,forceStatement:T,editionableStatement:y,viewName:h};return this._assignTemplates(d,O)}getDualityViewBodyDdl(e){throw new Error("Not implemented")}convertDualityViewToDdl(e){let a=this.getCreateJsonRelationalDualityViewHeadingDdl(e),l=this.getDualityViewBodyDdl(e);return a+`
`+l+`
`}};t(ie,"AbstractDualityViewFeDdlCreator");var Oe=ie;it.exports={AbstractDualityViewFeDdlCreator:Oe}});var ct=j((fn,ot)=>{"use strict";var{AbstractDualityViewFeDdlCreator:F}=at(),Pe=class Pe extends F{_getFromRootTableAliasStatement(e){if(e.rootTableAlias){let a=this._prepareName(e.rootTableAlias);return F.padInFront(a)}return""}_getFromChildTableAliasStatement(e){if(e.childTableAlias){let a=this._prepareName(e.childTableAlias);return F.padInFront(a)}return""}_getCheckStatement(e){return F.padInFrontAndUppercaseIfExists(e.check)}_getEtagStatement(e){let a=e.etag?"etag":"";return F.padInFrontAndUppercaseIfExists(a)}_getDeleteStatement(e){return F.padInFrontAndUppercaseIfExists(e.delete)}_getInsertStatement(e){return F.padInFrontAndUppercaseIfExists(e.insert)}_getUpdateStatement(e){return F.padInFrontAndUppercaseIfExists(e.update)}_getTableTagsStatement(e){let a=e.tableTagsClause||{},l=this._getCheckStatement(a),p="";l&&(p=this._getEtagStatement(a));let d=this._getInsertStatement(a),o=this._getUpdateStatement(a),T=this._getDeleteStatement(a),y={checkStatement:l,etagStatement:p,insertStatement:d,updateStatement:o,deleteStatement:T};if(Object.values(y).some(h=>h==null?void 0:h.length)){let h=this._ddlTemplates.dualityView.sql.tableTagsStatement,O=this._assignTemplates(h,y);return F.padInFront(O)}return""}_getColumnTagsStatement(e){let a=e.columnTagsClause||{},l=this._getCheckStatement(a),p="";l&&(p=this._getEtagStatement(a));let d=this._getUpdateStatement(a),o={checkStatement:l,etagStatement:p,updateStatement:d};if(Object.values(o).some(y=>y==null?void 0:y.length)){let y=this._ddlTemplates.dualityView.sql.columnTagsStatement,C=this._assignTemplates(y,o);return F.padInFront(C)}return""}_getFromRootTableStatement(e){var y;let a=this._getNamePrefixedWithSchemaName(e.tableName,e.schemaName),l=this._getFromRootTableAliasStatement(e),p=this._getTableTagsStatement(e),d=(y=e.whereClause)==null?void 0:y.trim(),o=d?`
WHERE ${d} WITH CHECK OPTION`:"",T=this._ddlTemplates.dualityView.sql.fromTableStatement;return this._assignTemplates(T,{tableName:a,tableAlias:l,tableTagsStatement:p,whereClauseStatement:o})}_getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:a,bodyPadding:l}){let p=this._lodash.first(e.joinedCollectionRefIdPath);if(!p)throw new Error("Specify child table for all join subqueries");let d=a[p],{getEntityName:o}=ce()(this._lodash),T=o(d),y=d.bucketName,C=this._getNamePrefixedWithSchemaName(T,y),h=this._getFromChildTableAliasStatement(e),O=this._getTableTagsStatement(e),U=this._ddlTemplates.dualityView.sql.fromTableStatement,Z=[this._assignTemplates(U,{tableName:C,tableAlias:h,tableTagsStatement:O})];return e.whereClause&&Z.push(`WHERE ${e.whereClause}`),Z.map(g=>`${l}${g}`).join(`
`)}_getNameOfReferencedColumnForDdl(e,a,l){let{getEntityName:p}=ce()(this._lodash);if(F.isDualityView(e)){let d=e.rootTableAlias||e.tableName;return this._getNamePrefixedWithSchemaName(a,d)}if(F.isJoinSubquery(e)){if(e.childTableAlias){let o=e.childTableAlias;return this._getNamePrefixedWithSchemaName(a,o)}let d=this._lodash.first(e.joinedCollectionRefIdPath);if(d){let o=l[d],T=p(o);return this._getNamePrefixedWithSchemaName(a,T)}}return""}_getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}){let{wrap:o}=ce()(this._lodash),T=F.getKeyValueFrontPadding(p),y=F.getRegularFieldName(e,a),C=o(y,"'","'"),h=F.getPathToReferencedColumn(a,l),O=F.getRegularFieldNameFromCollection(h,d),U=this._getNameOfReferencedColumnForDdl(l,O,d),G=this._getColumnTagsStatement(a);return`${T}${C}: ${U}${G}`}_getJoinSubqueryValueStatement({propertyJsonSchema:e,paddingFactor:a,relatedSchemas:l}){let p=a+1,d=a+2,o=this._getObjectGenStatement({paddingFactor:d,relatedSchemas:l,jsonSchema:e}),T=F.getKeyValueFrontPadding(p),C=[`${T}SELECT${o}`],h=this._getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:l,bodyPadding:T});return C.push(h),C.join(`
`)}_shouldUnnestJoinSubquery(e){let a=this._lodash.toUpper(e.sqlJsonFunction),l=this._lodash.toLower(e.subtype);return a==="JSON_OBJECT"||l==="object"?!!e.unnestSubquery:!1}_getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:l,relatedSchemas:p}){let{wrap:d}=ce()(this._lodash),o=this._getJoinSubqueryValueStatement({relatedSchemas:p,paddingFactor:l,propertyJsonSchema:a}),T=F.getKeyValueFrontPadding(l),y=this._getObjectGenStatementJsonKeywordConfig(a),C=y.surroundingBrackets[0],h=y.surroundingBrackets[1];if(this._shouldUnnestJoinSubquery(a))return`${T}UNNEST ${C}
${o}
${T}${h}`;let U=this._getJoinSubqueryName(e,a),G=d(U,"'","'");return`${T}${G} : ${C}
${o}
${T}${h}`}_getJoinSubqueryName(e,a){return a.name||e}_buildKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}){return F.isFlexColumn(a)?this._getFlexColumnStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:p}):F.isRegularDualityViewField(a)?this._getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}):F.isJoinSubquery(a)?this._getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:p,relatedSchemas:d}):""}_getKeyValueStatement({jsonSchema:e,relatedSchemas:a,paddingFactor:l}){var y;let p=[],d=e.properties||((y=e.items)==null?void 0:y.properties)||{},o=this._lodash.toPairs(d);for(let[C,h]of o){let O=this._buildKeyValueStatement({propertyName:C,propertyJsonSchema:h,parent:e,paddingFactor:l,relatedSchemas:a});p.push(O)}return`
${p.join(`,
`)}
`}_getObjectGenStatementJsonKeywordConfig(e){if(!F.isJoinSubquery(e))return{jsonKeyword:"JSON",surroundingBrackets:["",""],jsonKeywordBrackets:["{","}"]};let a=this._lodash.toUpper(e.sqlJsonFunction);return a==="JSON_OBJECT"?{jsonKeyword:a,surroundingBrackets:["(",")"],jsonKeywordBrackets:["(",")"]}:a==="JSON_ARRAYAGG"?{jsonKeyword:a,surroundingBrackets:["(",")"],jsonKeywordBrackets:["( JSON {","})"]}:this._lodash.toLower(e.subtype)==="array"?{jsonKeyword:"JSON",surroundingBrackets:["[","]"],jsonKeywordBrackets:["{","}"]}:{jsonKeyword:"JSON",surroundingBrackets:["(",")"],jsonKeywordBrackets:["{","}"]}}_getObjectGenStatement({relatedSchemas:e,paddingFactor:a,jsonSchema:l}){let p=this._getKeyValueStatement({relatedSchemas:e,paddingFactor:a,jsonSchema:l}),d=F.getKeyValueFrontPadding(a-1),o=this._getObjectGenStatementJsonKeywordConfig(l),T=o.jsonKeywordBrackets[0],y=o.jsonKeywordBrackets[1],C=`${o.jsonKeyword} ${T}\${keyValueStatement}${d}${y}`,h=this._assignTemplates(C,{keyValueStatement:p});return F.padInFront(h)}getDualityViewBodyDdl(e){let{view:a,jsonSchema:l,relatedSchemas:p}=e,T=[`SELECT${this._getObjectGenStatement({jsonSchema:l,paddingFactor:1,relatedSchemas:p})}`],y=this._getFromRootTableStatement(a);return T.push(y+";"),T.join(`
`)}_getFlexColumnStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:l}){let{wrap:p}=ce()(this._lodash),d=F.getKeyValueFrontPadding(l),o=F.getRegularFieldName(e,a),T=p(o,'"','"');return`${d}${T} AS FLEX COLUMN`}};t(Pe,"SqlDualityViewDdlCreator");var Re=Pe;ot.exports={SqlDualityViewDdlCreator:Re}});var mt=j(($n,lt)=>{"use strict";var{DualityViewSyntaxType:zt}=Ce(),{SqlDualityViewDdlCreator:Qt}=ct(),xe=class xe{static getCreatorInstance(e,{ddlTemplates:a,assignTemplates:l,lodash:p,prepareName:d,getNamePrefixedWithSchemaName:o}){switch(e==null?void 0:e.toUpperCase()){case zt.SQL:return new Qt(a,l,p,d,o);default:throw new Error(`Unknown syntax config: ${e}`)}}};t(xe,"DualityViewDdlCreatorFactory");var Ke=xe;lt.exports={DualityViewDdlCreatorFactory:Ke}});var Ve=j((hn,ut)=>{"use strict";var Xt=Object.freeze({IF_NOT_EXISTS_SINCE:23,JSON_TYPE_SINCE:21});ut.exports={DbVersion:Xt}});var pt=j((In,dt)=>{"use strict";var Fe=class Fe{type;keyId};t(Fe,"AlterIndexKeyDto");var qe=Fe,we=class we{id;indxName;isActivated;ifNotExist;indxType;indxKey;column_expression;tablespace;index_properties;index_attributes;index_compression;logging_clause;indxComments};t(we,"AlterIndexDto");var Le=we;dt.exports={AlterIndexDto:Le,AlterIndexKeyDto:qe}});var ve=j((Cn,yt)=>{"use strict";var ke=class ke{cache;cacheValue;cycle;ifNotExist;increment;maxValue;minValue;sequenceName;start;sharing;order;keep;scale;scaleExtend;shard;shardExtend;type};t(ke,"Sequence");var Ue=ke,_e=class _e{sharing;ddlScript;sequenceName;minValue;maxValue;increment;cycle;order;cacheValue;scale;extend;shard;type;keep};t(_e,"SequenceDto");var Be=_e;yt.exports={Sequence:Ue,SequenceDto:Be}});var Nt=j((Rn,Tt)=>{"use strict";var gt=t((s="")=>new RegExp("\\$\\{(.*?)\\}",s),"template"),Zt=t(s=>s.match(gt("gi"))||[],"getAllTemplates"),en=t(s=>(s.match(gt("i"))||[])[1],"parseTemplate");Tt.exports=({_:s})=>({assignTemplates:t((a,l)=>Zt(a).reduce((p,d)=>{let o=en(d);return p.replace(d,()=>l[o]||l[o]===0?l[o]:"")},a),"assignTemplates")})});var ft=j((xn,Et)=>{"use strict";var Kn=require("lodash");Et.exports=(s,e)=>{let a=t((g,E)=>Object.entries(g.properties).map(E),"mapProperties"),l=t(g=>g.compositeUniqueKey?!1:!!g.unique,"isUniqueKey"),p=t(g=>{var E;return l(g)&&!((E=g.uniqueKeyOptions)!=null&&E.constraintName)},"isInlineUnique"),d=t(g=>g.compositeUniqueKey||g.compositePrimaryKey?!1:!!g.primaryKey,"isPrimaryKey"),o=t(g=>{var E;return d(g)&&!((E=g.primaryKeyOptions)!=null&&E.constraintName)},"isInlinePrimaryKey"),T=t((g,E,S)=>e({keyType:"UNIQUE",columns:[{name:E,isActivated:S}],...g}),"hydrateUniqueOptions"),y=t((g,E,S)=>e({keyType:"PRIMARY KEY",columns:[{name:E,isActivated:S}],...g}),"hydratePrimaryKeyOptions"),C=t((g,E)=>Object.keys(E).find(S=>E[S].GUID===g),"findName"),h=t((g,E)=>s.get(Object.values(E).find(S=>S.GUID===g),"isActivated",!0),"checkIfActivated"),O=t((g,E)=>s.map(g,S=>({name:C(S.keyId,E.properties),isActivated:h(S.keyId,E.properties)})),"getKeys"),U=t(g=>Array.isArray(g.primaryKey)?g.primaryKey.filter(E=>!s.isEmpty(E.compositePrimaryKey)).map(E=>({...y(E,null,null),columns:O(E.compositePrimaryKey,g)})):[],"getCompositePrimaryKeys"),G=t(g=>Array.isArray(g.uniqueKey)?g.uniqueKey.filter(E=>!s.isEmpty(E.compositeUniqueKey)).map(E=>({...T(E,null,null),columns:O(E.compositeUniqueKey,g)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:t(g=>{if(!g.properties)return[];let E=a(g,([L,N])=>{if(!(!l(N)||p(N)))return T(N.uniqueKeyOptions,L,N.isActivated)}).filter(Boolean);return[...a(g,([L,N])=>{if(!(!d(N)||o(N)))return y(N.primaryKeyOptions,L,N.isActivated)}).filter(Boolean),...U(g),...E,...G(g)]},"getTableKeyConstraints"),isInlineUnique:p,isInlinePrimaryKey:o,getKeys:O}}});var De=j((Ln,St)=>{"use strict";var qn=require("lodash");St.exports=({prepareName:s,_:e})=>({getOptionsString:t(({constraintName:l,deferClause:p,rely:d,validate:o,indexClause:T,exceptionClause:y})=>{let C=l?` CONSTRAINT ${s(e.trim(l))}`:"",h=[p,d,T,o,y].filter(Boolean).join(" ");return{constraintString:C,statement:h&&` ${h}`}},"getOptionsString")})});var bt=j((Un,$t)=>{"use strict";var wn=require("lodash"),{DbVersion:tn}=Ve(),nn=t(s=>Number.parseInt(s,10)<tn.JSON_TYPE_SINCE,"shouldUseClobForJsonColumns");$t.exports=({_:s,wrap:e,assignTemplates:a,templates:l,commentIfDeactivated:p,wrapComment:d,prepareName:o})=>{let{getOptionsString:T}=De()({_:s,prepareName:o}),y=t((m,I)=>s.chain(I).filter("comment").map(x=>{let k=a(l.comment,{object:"COLUMN",objectName:`${m}.${o(x.name)}`,comment:d(x.comment)});return p(k,x)}).join(`
`).value(),"getColumnComments"),C=t(({nullable:m,unique:I,primaryKey:x,primaryKeyOptions:k,uniqueKeyOptions:M})=>{let{constraintString:z,statement:re}=T(h({primaryKey:x,unique:I,primaryKeyOptions:k,uniqueKeyOptions:M}));return`${m?"":" NOT NULL"}${z}${x?" PRIMARY KEY":""}${I?" UNIQUE":""}${re}`},"getColumnConstraints"),h=t(({primaryKey:m,unique:I,primaryKeyOptions:x,uniqueKeyOptions:k})=>m?x||{}:I?k||{}:{},"getOptions"),O=t((m,I)=>m==="JSON"&&nn(I)?"CLOB":m,"replaceTypeByVersion"),U=t(({default:m,identity:I})=>{if(!s.isEmpty(I)&&I.generated){let x=t(({generated:M,generatedOnNull:z})=>M==="BY DEFAULT"?` ${M} ${z?" ON NULL":""}`:" ALWAYS","getGenerated"),k=t(({identityStart:M,identityIncrement:z,numberToCache:re})=>{let ae=M?` START WITH ${M}`:"",le=z?` INCREMENT BY ${z}`:"",ye=re?` CACHE ${re}`:" NOCACHE";return`${ae}${le}${ye}`},"getOptions");return` GENERATED${x(I)} AS IDENTITY (${s.trim(k(I))})`}else if(m)return` DEFAULT ${m}`;return""},"getColumnDefault"),G=t(({encryption:m})=>{if(s.isPlainObject(m)&&!s.isEmpty(s.omit(m,"id"))){let{ENCRYPTION_ALGORITHM:I,INTEGRITY_ALGORITHM:x,noSalt:k}=m,M=I?` USING '${I}'`:"",z=x?` '${x}'`:"";return` ENCRYPT${M}${z}${k?" NO SALT":""}`}return""},"getColumnEncrypt"),Z=t((m,I,x)=>` ${m}(${I} ${s.toUpper(x)})`,"addByteLength"),g=t((m,I)=>` ${m}(${I})`,"addLength"),E=t((m,I,x)=>s.isNumber(x)?` ${m}(${I||"*"},${x})`:s.isNumber(I)?` ${m}(${I})`:` ${m}`,"addScalePrecision"),S=t((m,I)=>s.isNumber(I)?` ${m}(${I})`:` ${m}`,"addPrecision"),L=t((m,I,x)=>` TIMESTAMP${s.isNumber(m)?`(${m})`:""}${I?` WITH${x?" LOCAL":""} TIME ZONE`:""}`,"timestamp"),N=t(m=>` INTERVAL YEAR${s.isNumber(m)?`(${m})`:""} TO MONTH`,"intervalYear"),P=t((m,I)=>{let x=s.isNumber(m)?`(${m})`:"",k=s.isNumber(I)?`(${I})`:"";return` INTERVAL DAY${x} TO SECOND${k}`},"intervalDay"),q=t((m,I,x)=>{let k={"vector<int8>":"int8","vector<float32>":"float32","vector<float64>":"float64"}[x],M=I||"*",z=s.toUpper(k||"*");return` ${m}(${M}, ${z})`},"decorateVector"),v=t((m,I)=>["object","array"].includes(I)?" "+m+"("+s.toUpper(I)+")":" "+m,"decorateJson"),J=t(m=>["CHAR","VARCHAR2"].includes(m),"canHaveByte"),ee=t(m=>["CHAR","VARCHAR2","NCHAR","NVARCHAR2","RAW","UROWID"].includes(m),"canHaveLength"),i=t(m=>["NUMBER","FLOAT"].includes(m),"canHavePrecision"),$=t(m=>m==="NUMBER","canHaveScale"),n=t(m=>m==="INTERVAL YEAR","isIntervalYear"),u=t(m=>m==="INTERVAL DAY","isIntervalDay"),f=t(m=>m==="TIMESTAMP","isTimezone"),R=t((m,I,x)=>m==="VECTOR"&&(I||x),"canDecorateVector"),K=t(m=>m==="JSON","isJson");return{getColumnComments:y,getColumnConstraints:C,replaceTypeByVersion:O,getColumnDefault:U,getColumnEncrypt:G,decorateType:t((m,I)=>{let{lengthSemantics:x,length:k,precision:M,scale:z,fractSecPrecision:re,withTimeZone:ae,localTimeZone:le,yearPrecision:ye,dayPrecision:he,isUDTRef:Ie,schemaName:Ee,dimension:Ne,subtype:ge}=I;return x&&J(m)&&ee(m)&&s.isNumber(k)?Z(m,k,x):ee(m)&&s.isNumber(k)?g(m,k):i(m)&&$(m)?E(m,M,z):i(m)&&s.isNumber(M)?S(m,M):f(m)?L(re,ae,le):n(m)?N(ye):u(m)?P(he,re):Ie&&Ee?` "${Ee}"."${m}"`:R(m,Ne,ge)?q(m,Ne,ge):K(m)?v(m,ge):` ${m}`},"decorateType"),canHaveIdentity:t(m=>["number"].includes(m),"canHaveIdentity")}}});var It=j((_n,ht)=>{"use strict";var kn=require("lodash");ht.exports=({_:s,getColumnsList:e,checkAllKeysDeactivated:a,commentIfDeactivated:l,prepareName:p,assignTemplates:d})=>{let{getOptionsString:o}=De()({_:s,prepareName:p}),T=t(({duplicated:i,external:$,immutable:n,sharded:u,temporary:f,temporaryType:R,blockchain_table_clauses:K})=>{let B=!s.isEmpty(K);switch(!0){case f:return` ${s.toUpper(R)} TEMPORARY`;case u:return" SHARDED";case i:return" DUPLICATED";case n:return" IMMUTABLE";case B:return`${K.immutable?" IMMUTABLE":""} BLOCKCHAIN`;default:return""}},"getTableType"),y=t(i=>{let $=t(u=>u?`${u}
`:"","wrap"),n=[{key:"blockchain_table_clauses",getValue:C(i==null?void 0:i.tableProperties)},{key:"storage",getValue:h(i==null?void 0:i.tableProperties)},{key:"external_table_clause",getValue:O},{key:"partitioning",getValue:U},{key:"selectStatement",getValue:N("AS")},{key:"tableProperties",getValue:u=>u}].map(u=>i[u.key]?$(u.getValue(i[u.key],i)):"").filter(Boolean).join("");return s.trim(n)?` ${s.trim(n)}`:""},"getTableOptions"),C=t(i=>({blockchain_table_retention_clause:$,blockchain_row_retention_clause:n,blockchain_hash_and_data_format_clause:u})=>s.includes(i,$)||s.includes(i,n)||s.includes(i,u)?"":s.trim(` ${$||""} ${n||""} ${u||""}`),"getBlockChainClause"),h=t(i=>({organization:$,tablespace:n,logging:u})=>s.includes(i,"TABLESPACE")?"":$==="external"?"ORGANIZATION EXTERNAL":`ORGANIZATION ${s.toUpper($)||"HEAP"}${n?` TABLESPACE ${p(n)}`:""} ${u?"LOGGING":"NOLOGGING"}`,"getStorage"),O=t(i=>{if(!(i!=null&&i.access_driver_type))return"";let{access_driver_type:$,default_directory:n,access_parameter_type:u,opaque_format_spec:f,clob_subquery:R,reject_limit:K,location:B}=i,H=`(${s.map(B,({location_directory:x,location_specifier:k})=>`${x?`${x}:`:""}'${k}'`).join(", ")})`,m=u==="NONE"?"":`ACCESS PARAMETERS ${R?`USING CLOB ${R}`:f}`,I=`${n&&!s.isEmpty(n)?` DEFAULT DIRECTORY ${n}`:""}`+m+`${B&&!s.isEmpty(B)?` LOCATION ${H}`:""}`;return` (TYPE ${s.toUpper($)} ${I}) REJECT LIMIT ${K||"UNLIMITED"} `},"getExternalTableClause"),U=t((i,{isActivated:$})=>{if(i!=null&&i.partitionBy){let n=G(i,$),u=Z(i,$);return`PARTITION BY ${s.toUpper(s.startsWith(i.partitionBy,"composite")?s.last(i.partitionBy.split(" ")):i.partitionBy)} ${n}${u}`}return""},"getPartitioning"),G=t((i,$)=>{let n=a(i.partitionKey);return s.isEmpty(i.partitionKey)?"":e(i.partitionKey,n,$,({name:u})=>p(u))},"getPartitionKeys"),Z=t((i,$)=>{switch(i.partitionBy){case"range":return`${i.interval?`
INTERVAL (${i.interval})`:""}`+S(i.store_in_tablespaces)+g(i.range_partitions,"range_partition_clause");case"list":return`${i.automatic?" AUTOMATIC":""}`+S(i.store_in_tablespaces)+g(i.list_partitions,"list_partition_clause");case"hash":return L(i);case"reference":return`${i.constraint?` (${i.constraint})`:""}`+g(i.reference_partition_descs,"reference_partition_desc");case"system":return i.system_partitioning_quantity?` PARTITIONS ${i.system_partitioning_quantity}`:g(i.system_partition_descs,"system_partition_desc");case"composite range":{let n=E(i,$);return`${i.interval?` INTERVAL (${i.interval})`:""}`+S(i.store_in_tablespaces)+n+g(i.range_subpartition_descs,"range_subpartition_desc")}case"composite list":{let n=E(i,$);return S(i.store_in_tablespaces,"AUTOMATIC")+n+g(i.list_subpartition_descs,"list_subpartition_description")}case"composite hash":{let n=E(i,$),u=L(i);return`${n}${u}`}default:return""}},"getPartitionClause"),g=t((i,$)=>i&&s.isArray(i)&&!s.isEmpty(i)?`
(
	${($?s.map(i,n=>n[$]):i).join(`,
	`)}
)
`:"","partitionsToString"),E=t(({subpartitionType:i,subpartitionDescription:$,compositePartitionKey:n},u)=>{if(i){let f=a(n),R=$?`
${$}`:"";return` SUBPARTITION BY ${s.toUpper(i)} ${e(n,f,u,({name:K})=>p(K))} ${R}`}return""},"getSubpartition"),S=t((i,$,n="store_in_tablespace")=>s.isEmpty(i)?"":`${$?` ${$}`:""} STORE IN (${s.map(i,u=>u[n]).join(", ")})`,"getTablespaceList"),L=t(({hash_partition_quantity:i,store_in_tablespaces:$,overflow_store_in_tablespaces:n,individual_hash_partitions:u})=>i?` PARTITIONS ${i}`+S($)+S(n,"OVERFLOW","overflow_store_in_tablespace"):g(u,"individual_hash_partition"),"getHashPartition"),N=t(i=>$=>{if($)return`${i} ${$}`},"getBasicValue");return{getTableOptions:y,getTableType:T,generateConstraintsString:t((i,$)=>{var R,K;let n=l(((i==null?void 0:i.deactivatedItems)||[]).join(`,
	`),{isActivated:!$,isPartOfLine:!0}),u=(R=i==null?void 0:i.activatedItems)!=null&&R.length?`,
	`+i.activatedItems.join(`,
	`):"",f=(K=i==null?void 0:i.deactivatedItems)!=null&&K.length?`
	`+n:"";return u+f},"generateConstraintsString"),foreignKeysToString:t(i=>{if(Array.isArray(i)){let $=i.filter(f=>s.get(f,"isActivated",!0)).map(f=>p(s.trim(f.name))),n=i.filter(f=>!s.get(f,"isActivated",!0)).map(f=>p(s.trim(f.name))),u=n.length?l(n,{isActivated:!1,isPartOfLine:!0}):"";return $.join(", ")+u}return i},"foreignKeysToString"),foreignActiveKeysToString:t(i=>i.map($=>s.trim($.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:t((i,$)=>n=>{let u=a(n.columns),f=e(n.columns,u,$,({name:K})=>p(K)),R=o(n).statement;return{statement:d(i.createKeyConstraint,{constraintName:n.constraintName?`CONSTRAINT ${p(n.constraintName)} `:"",keyType:n.keyType,columns:f,options:R}),isActivated:!u}},"createKeyConstraint"),customPropertiesForForeignKey:t(i=>({foreignOnDelete:s.get(i,"relationshipOnDelete","")}),"customPropertiesForForeignKey")}}});var Ct=j((jn,At)=>{"use strict";var Dn=require("lodash");At.exports=({_:s,assignTemplates:e,templates:a,getNamePrefixedWithSchemaName:l})=>{let p=["OBJECT_UDT","VARRAY","TABLE","COLLECTION_UDT"],d=t((y,C)=>{let h=l(y.name,y.schemaName);switch(y.type){case"OBJECT_UDT":return e(a.createObjectType,{name:h,properties:s.map(y.properties,O=>C(O,a.objectTypeColumnDefinition)).join(`,
	`)});case"VARRAY":case"TABLE":{let O=y.type==="VARRAY"?"(64)":"";return e(a.createCollectionType,{name:h,collectionType:y.type,size:s.isNumber(y.size)?`(${y.size})`:O,datatype:`${y.ofType}${y.nullable?"":" NOT NULL"}`,notPersistable:`${y.notPersistable?" NOT PERSISTABLE":""}`})}default:return""}},"getPlainUdt");return{getUserDefinedType:t((y,C)=>d(y,C),"getUserDefinedType"),isNotPlainType:t(y=>{let C=s.toUpper(y.mode||y.type);return p.includes(C)},"isNotPlainType")}}});var Rt=j((Gn,Ot)=>{"use strict";Ot.exports=({_:s,prepareName:e})=>{let a=t(({editioning:d,editionable:o})=>`${o?" EDITIONABLE":""}${d?" EDITIONING":""}`,"getViewType"),l=t(d=>d?d.alias?`${e(d.name)} as ${e(d.alias)}`:e(d.name):"","getKeyWithAlias");return{getViewType:a,getViewData:t(d=>Array.isArray(d)?d.reduce((o,T)=>{if(!T.tableName)return o.columns.push(l(T)),o;let y=`${e(T.dbName)}.${e(T.tableName)}`;return o.tables.includes(y)||o.tables.push(y),o.columns.push({statement:`${y}.${l(T)}`,isActivated:T.isActivated}),o},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData")}}});var Kt=j((Mn,Pt)=>{"use strict";var Wn=require("lodash");Pt.exports=({_:s,prepareName:e})=>({getIndexType:t(o=>o?` ${s.toUpper(o)}`:"","getIndexType"),getIndexKeys:t(({indxKey:o,column_expression:T})=>{let{escapeSingleQuote:y}=ce()();return T?`
(
	${y(T)}
)
	`:s.isArray(o)&&!s.isEmpty(o)?`
(
	${s.map(o,({name:h,type:O})=>`${e(h)} ${s.toUpper(O)}`).join(`,
	`)}
)
	`:""},"getIndexKeys"),getIndexOptions:t(({indxDescription:o,comments:T,tablespace:y,index_properties:C,index_attributes:h,index_compression:O,logging_clause:U,indxKey:G,column_expression:Z})=>{let g=U?` ${s.toUpper(U)}`:"",E=y?` TABLESPACE ${y}`:"",S=O?` ${O}`:"",L=`${g}${E}${S}`;return C?L=` ${C}`:h&&(L=` ${h}`),s.isEmpty(G)&&s.isEmpty(Z)?L:s.trim(L)},"getIndexOptions"),getIndexName:t(o=>o?` ${e(o)}`:"","getIndexName")})});var Vt=j((zn,xt)=>{"use strict";xt.exports=({prepareName:s,templates:e,assignTemplates:a,getNamePrefixedWithSchemaName:l})=>{let p=t(o=>{let T=l(o.synonymName,o.schemaName);return a(e.createSynonym,{name:o.synonymPublic?s(o.synonymName):T,orReplace:o.synonymOrReplace?" OR REPLACE":"",editionable:o.synonymEditionable?" "+o.synonymEditionable:"",public:o.synonymPublic?" PUBLIC":"",objectName:o.synonymEntityName})},"generateSynonymCreateStatement");return{generateSynonymStatements:t((o,T,y)=>o!=null&&o.length?`
`+o.map(C=>p({...C,synonymEntityName:T,schemaName:y})).join(`
`):"","generateSynonymStatements")}}});var Lt=j((er,qt)=>{"use strict";var Xn=require("lodash"),{Sequence:Zn}=ve();qt.exports=({_:s,templates:e,assignTemplates:a,getNamePrefixedWithSchemaName:l,wrapIfNotExists:p})=>{let d=t(({schemaName:N,sequences:P,usingTryCatchWrapper:q})=>s.map(P,v=>o({schemaName:N,sequence:v,usingTryCatchWrapper:q})).join(`

`),"getSequencesScript"),o=t(({schemaName:N,sequence:P,usingTryCatchWrapper:q})=>{let v=L({schemaName:N,sequence:P}),J=l(P.sequenceName,v),ee=q?"":Z({sequence:P}),i=C({sequence:P,schemaName:N}),$=E({sequence:P}),n=a(e.createSequence,{name:J,ifNotExists:ee,sharing:$,options:i});return q?p(n,P.ifNotExist):n+";"},"createSequenceScript"),T=t(({schemaName:N,sequence:P,oldSequence:q,usingTryCatchWrapper:v})=>{let J=q.sequenceName||P.sequenceName,ee=L({schemaName:N,sequence:P}),i=l(J),$=l(J,ee),n=S({sequence:P,oldSequence:q}),u=C({schemaName:N,sequence:n}),f=n.sequenceName?l(n.sequenceName):"",R=g({usingTryCatchWrapper:v});if(n.hasOwnProperty("sharing")){let H=y({schemaName:N,sequence:q,usingTryCatchWrapper:v}),m=o({schemaName:N,sequence:P,usingTryCatchWrapper:v});return H+`
`+m+`
`}return[{key:"options",value:u,name:$,template:e.alterSequence},{key:"newName",value:f,name:i,template:e.renameSequence}].filter(H=>H.value).map(H=>a(H.template,{[H.key]:H.value,name:H.name,ifExists:R})).join(`
`)},"alterSequenceScript"),y=t(({schemaName:N,sequence:P,usingTryCatchWrapper:q})=>{let v=L({schemaName:N,sequence:P}),J=l(P.sequenceName,v),ee=g({usingTryCatchWrapper:q});return a(e.dropSequence,{name:J,ifExists:ee})},"dropSequenceScript"),C=t(({schemaName:N,sequence:P})=>{let v=[{getOption:h,key:"increment",clause:"INCREMENT BY"},{getOption:h,key:"start",clause:"START WITH"},{getOption:h,key:"restart",clause:"RESTART WITH"},{getOption:h,key:"minValue",clause:"MINVALUE"},{getOption:h,key:"maxValue",clause:"MAXVALUE"},{getOption:O,key:"cache",extendedKey:"cacheValue"},{getOption:O,key:"cycle",extendedKey:""},{getOption:O,key:"order",extendedKey:""},{getOption:O,key:"keep",extendedKey:""},{getOption:O,key:"scale",extendedKey:"scaleExtend"},{getOption:O,key:"shard",extendedKey:"shardExtend"},{getOption:O,key:"type",extendedKey:""}].map(J=>{let ee=J.getOption({sequence:P,schemaName:N,config:J});return U({option:ee})}).filter(Boolean).join("");return v&&G({options:v})},"getSequenceOptions"),h=t(({sequence:N,config:P})=>{let q=Number(N[P.key]);return isNaN(q)?"":`${P.clause} ${q}`},"getNumberOption"),O=t(({sequence:N,config:P})=>{let q=s.toUpper(N[P.key]);return q?q.startsWith("NO")||!N[P.extendedKey]?q:q+" "+O({sequence:N,config:{key:P.extendedKey}}):""},"getLiteralOption"),U=t(({option:N})=>N?`	${N}
`:"","wrapOption"),G=t(({options:N})=>`
`+N.replace(/\n$/,""),"wrapOptionsBlock"),Z=t(({sequence:N})=>N.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),g=t(({usingTryCatchWrapper:N})=>N?"":" IF EXISTS","getIfExists"),E=t(({sequence:N})=>N.sharing?" SHARING="+s.toUpper(N.sharing):"","getSharing"),S=t(({sequence:N,oldSequence:P})=>{let q=s.omitBy(N,(v,J)=>s.isEqual(v,P[J]));return N.minValue>P.minValue?{...q,restart:N.start}:q},"getModifiedSequence"),L=t(({schemaName:N,sequence:P})=>P.type==="session"?"":N,"getSequenceSchemaName");return{getSequencesScript:d,createSequenceScript:o,alterSequenceScript:T,dropSequenceScript:y}}});var Ut=j((sr,wt)=>{"use strict";var V=require("lodash"),rn=Je(),Ft=Qe(),w=Ze(),{DualityViewDdlCreatorFactory:sn}=mt(),{DualityViewSyntaxType:an}=Ce(),{DbVersion:on}=Ve(),{AlterIndexDto:nr}=pt(),{Sequence:rr}=ve(),pe=t(s=>Number.parseInt(s,10)<on.IF_NOT_EXISTS_SINCE,"shouldUseTryCatchIfNotExistsWrapper");wt.exports=(s,e,a)=>{var Ne,ge;let l=t(r=>V.isArray(r)?r:[r],"toArray"),{tab:p,commentIfDeactivated:d,checkAllKeysDeactivated:o,divideIntoActivatedAndDeactivated:T,hasType:y,wrap:C,clean:h,getNamePrefixedWithSchemaNameForScriptFormat:O,wrapComment:U,getColumnsList:G,prepareNameForScriptFormat:Z}=ce()(V),g=Z((Ne=e==null?void 0:e.targetScriptOptions)==null?void 0:Ne.keyword),E=O((ge=e==null?void 0:e.targetScriptOptions)==null?void 0:ge.keyword),{assignTemplates:S}=Nt()({_:V}),L=ft()(V,h),{getColumnComments:N,getColumnConstraints:P,replaceTypeByVersion:q,getColumnDefault:v,getColumnEncrypt:J,decorateType:ee,canHaveIdentity:i}=bt()({_:V,wrap:C,assignTemplates:S,templates:w,commentIfDeactivated:d,wrapComment:U,prepareName:g}),{getTableType:$,getTableOptions:n,generateConstraintsString:u,foreignKeysToString:f,foreignActiveKeysToString:R,createKeyConstraint:K,customPropertiesForForeignKey:B}=It()({_:V,checkAllKeysDeactivated:o,getColumnsList:G,commentIfDeactivated:d,prepareName:g,assignTemplates:S}),{getUserDefinedType:H,isNotPlainType:m}=Ct()({_:V,commentIfDeactivated:d,assignTemplates:S,templates:w,getNamePrefixedWithSchemaName:E}),{getViewType:I,getViewData:x}=Rt()({_:V,prepareName:g}),{getIndexType:k,getIndexKeys:M,getIndexOptions:z,getIndexName:re}=Kt()({_:V,prepareName:g}),ae=t((r,c,b=955)=>{if(c){let A=p(p(r)),D=V.trim(A).replace(/;$/,"");return S(w.ifNotExists,{statement:D,errorCode:b})}return r+";"},"wrapIfNotExists"),{generateSynonymStatements:le}=Vt()({prepareName:g,templates:w,assignTemplates:S,getNamePrefixedWithSchemaName:E}),{getSequencesScript:ye,createSequenceScript:he,dropSequenceScript:Ie,alterSequenceScript:Ee}=Lt()({_:V,templates:w,assignTemplates:S,getNamePrefixedWithSchemaName:E,wrapIfNotExists:ae});return{getDefaultType(r){return rn[r]},getTypesDescriptors(){return Ft},hasType(r){return y(Ft,r)},hydrateSchema(r,c){let b=V.get(c,"modelData.0.dbVersion");return{schemaName:r.name,ifNotExist:r.ifNotExist,dbVersion:b,synonyms:c.synonyms,sequences:c.sequences}},createSchema({schemaName:r,ifNotExist:c,dbVersion:b,sequences:A}){let _=`

`,D=";",W=g(r),Y=pe(b),Q=S(w.createSchema,{schemaName:W,ifNotExists:!Y&&c?" IF NOT EXISTS":""}),te=ye({schemaName:r,sequences:A,usingTryCatchWrapper:Y}),se=te?_+te:"",X=S(w.alterSession,{schemaName:W});return Y?ae(Q,c,1920)+se:Q+D+_+X+se},hydrateColumn({columnDefinition:r,jsonSchema:c,schemaData:b,definitionJsonSchema:A={}}){var Y;let _=b.dbVersion,D=!!c.$ref,W=D?r.type:V.toUpper(c.mode||c.type);return{name:r.name,type:W,ofType:c.ofType,notPersistable:c.notPersistable,size:c.size,primaryKey:L.isInlinePrimaryKey(c),primaryKeyOptions:c.primaryKeyOptions,unique:L.isInlineUnique(c),uniqueKeyOptions:c.uniqueKeyOptions,nullable:r.nullable,default:r.default,comment:c.refDescription||c.description||A.description,isActivated:r.isActivated,scale:r.scale,precision:r.precision,length:r.length,schemaName:b.schemaName,checkConstraints:c.checkConstraints,dbVersion:_,fractSecPrecision:c.fractSecPrecision,withTimeZone:c.withTimeZone,localTimeZone:c.localTimeZone,yearPrecision:c.yearPrecision,dayPrecision:c.dayPrecision,lengthSemantics:c.lengthSemantics,encryption:c.encryption,synonyms:((Y=b==null?void 0:b.synonyms)==null?void 0:Y.filter(Q=>Q.synonymEntityId===c.GUID))||[],isUDTRef:D,dimension:c.dimension,subtype:c.subtype,...i(c.mode)&&{identity:c.identity}}},hydrateJsonSchemaColumn(r,c){return!r.$ref||V.isEmpty(c)||m(c)?r:(r=V.omit(r,"$ref"),{...c,...r})},convertColumnDefinition(r,c=w.columnDefinition){let b=q(r.type,r.dbVersion);return d(S(c,{name:g(r.name),type:ee(b,r),default:v(r),encrypt:J(r),constraints:P(r)}),{isActivated:r.isActivated})},hydrateCheckConstraint(r){return{name:r.chkConstrName,expression:r.constrExpression,comments:r.constrComments,description:r.constrDescription}},createCheckConstraint({name:r,expression:c,comments:b,description:A}){return S(w.checkConstraint,{name:r?`CONSTRAINT ${g(r)} `:"",expression:V.trim(c).replace(/^\(([\s\S]*)\)$/,"$1")})},createForeignKeyConstraint({name:r,foreignKey:c,primaryTable:b,primaryKey:A,primaryTableActivated:_,foreignTableActivated:D,foreignSchemaName:W,primarySchemaName:Y,customProperties:Q},te,se){let X=o(A),ne=o(c),oe=!X&&!ne&&_&&D,me=l(c),ue=l(A),{foreignOnDelete:de}=B(Q),Te=S(w.createForeignKeyConstraint,{primaryTable:E(b,Y||se.schemaName),name:r?`CONSTRAINT ${g(r)}`:"",foreignKey:oe?f(me):R(me),primaryKey:oe?f(ue):R(ue),onDelete:de?` ON DELETE ${de}`:""});return{statement:V.trim(Te),isActivated:oe}},createForeignKey({name:r,foreignTable:c,foreignKey:b,primaryTable:A,primaryKey:_,primaryTableActivated:D,foreignTableActivated:W,foreignSchemaName:Y,primarySchemaName:Q,customProperties:te},se,X){let ne=o(_),oe=o(b),me=!ne&&!oe&&D&&W,ue=l(b),de=l(_),{foreignOnDelete:Te}=B(te),fe=S(w.createForeignKey,{primaryTable:E(A,Q||X.schemaName),foreignTable:E(c,Y||X.schemaName),name:r?g(r):"",foreignKey:me?f(ue):R(ue),primaryKey:me?f(de):R(de),onDelete:Te?` ON DELETE ${Te}`:""});return{statement:V.trim(fe)+`
`,isActivated:me}},dropForeignKey(r,c){let b={tableName:r,fkConstraintName:c};return S(w.dropForeignKey,b)},hydrateTable({tableData:r,entityData:c,jsonSchema:b}){var W,Y;let A=c[0],_=V.first(A.partitioning)||{},D=L.getKeys(_.compositePartitionKey,b);return{...r,keyConstraints:L.getTableKeyConstraints(b),selectStatement:V.trim(A.selectStatement),partitioning:V.assign({},_,{compositePartitionKey:D}),...V.pick(A,"blockchain_table_clauses","duplicated","external","external_table_clause","immutable","sharded","storage","temporary","temporaryType","description","ifNotExist","tableProperties"),synonyms:((Y=(W=r==null?void 0:r.schemaData)==null?void 0:W.synonyms)==null?void 0:Y.filter(Q=>Q.synonymEntityId===b.GUID))||[]}},createTable({blockchain_table_clauses:r,checkConstraints:c,columnDefinitions:b,columns:A,duplicated:_,external:D,external_table_clause:W,foreignKeyConstraints:Y,keyConstraints:Q,immutable:te,name:se,partitioning:X,schemaData:ne,selectStatement:oe,sharded:me,storage:ue,temporary:de,temporaryType:Te,description:fe,ifNotExist:je,tableProperties:Bt,synonyms:kt},Se){let $e=E(se,ne.schemaName),He=fe?S(w.comment,{object:"TABLE",objectName:$e,comment:U(fe)}):"",_t=T(Q.map(K(w,Se)),Ae=>Ae.statement),vt=u(_t,Se),Dt=T(Y,Ae=>Ae.statement),jt=u(Dt,Se),Ge=N($e,b),Ye=S(w.createTableProps,{columnDefinitions:V.join(A,`,
	`),foreignKeyConstraints:jt,keyConstraints:vt,checkConstraints:V.isEmpty(c)?"":`,
	`+V.join(c,`,
	`)}),Ht=le(kt,$e,ne.schemaName),Gt=He||Ge?`
`+He+Ge:"",Yt=ne.dbVersion||"",We=pe(Yt),be=S(w.createTable,{name:$e,ifNotExists:!We&&je?" IF NOT EXISTS":"",tableProps:Ye?`
(
	${Ye}
)`:"",tableType:$({duplicated:_,external:D,immutable:te,sharded:me,temporary:de,temporaryType:Te,blockchain_table_clauses:r}),options:n({blockchain_table_clauses:r,external_table_clause:W,storage:ue,partitioning:X,selectStatement:oe,tableProperties:Bt})});return We?be=ae(be,je):be+=";",d(be+`${Gt}
`+Ht,{isActivated:Se})},hydrateIndex(r,c,b){return{...r,schemaName:b.schemaName}},createIndex(r,c,b,A=!0){let _=re(c.indxName),D=k(c.indxType),W=M(c),Y=z(c),Q=e.dbVersion||"",te=pe(Q),se=c.ifNotExist&&!te,X=S(w.createIndex,{indexType:D,ifNotExists:se?" IF NOT EXISTS":"",name:_,keys:W,options:Y,tableName:E(r,c.schemaName)});return c.ifNotExist&&te&&(X=ae(X,!0)),te?d(X,{isActivated:c.isActivated}):d(X,{isActivated:c.isActivated})},dropIndex({name:r}){return S(w.dropIndex,{name:r})},alterIndexRename({oldName:r,newName:c}){return S(w.alterIndexRename,{oldName:r,newName:c})},alterIndexRebuild({name:r,indexData:c}){let b=z(c);return S(w.alterIndexRebuild,{name:r,options:b})},hydrateViewColumn(r){return{name:r.name,tableName:r.entityName,alias:r.alias,isActivated:r.isActivated,dbName:r.dbName}},hydrateView({viewData:r,entityData:c,jsonSchema:b}){var _,D;let A=c[0];return{name:r.name,keys:r.keys,orReplace:A.or_replace,editionable:A.editionable,editioning:A.editioning,force:A.force,selectStatement:A.selectStatement,tableName:r.tableName,schemaName:r.schemaData.schemaName,description:A.description,ifNotExist:A.ifNotExist,materialized:A.materialized,sharing:A.sharing,duality:A.duality,rootTableAlias:A.rootTableAlias,tableTagsClause:A.tableTagsClause,viewProperties:A.materialized?A.mviewProperties:A.viewProperties,synonyms:((D=(_=r.schemaData)==null?void 0:_.synonyms)==null?void 0:D.filter(W=>W.synonymEntityId===b.GUID))||[],modelInfo:{dbVersion:V.get(r,"schemaData.dbVersion")},whereClause:A.whereClause}},hydrateViewIndex(r,c,b){var A;return{...r,schemaName:c.schemaName,materialized:(A=V.first(b))==null?void 0:A.materialized}},createViewIndex(r,c,b,A){let _=re(c.indxName),D=k(c.indxType),W=M(c),Y=z(c,A);if(c.materialized)return d(S(w.createIndex,{indexType:D,name:_,keys:W,options:Y,tableName:E(r,c.schemaName)}),{isActivated:c.isActivated})},createView(r,c,b){let A=E(r.name,r.schemaName),{columns:_,tables:D}=x(r.keys),W=_.map(oe=>oe.statement).join(`,
		`),Y=r.description?`
`+S(w.comment,{object:"TABLE",objectName:A,comment:U(r.description)})+`
`:`
`,Q=V.trim(r.selectStatement)?V.trim(p(r.selectStatement)):S(w.viewSelectStatement,{tableName:D.join(", "),keys:W}),te=le(r.synonyms,A,r.schemaName),se=V.get(r,"modelInfo.dbVersion",""),X=pe(se),ne=S(w.createView,{name:A,ifNotExists:!X&&r.ifNotExist?" IF NOT EXISTS":"",orReplace:r.orReplace&&!r.materialized?" OR REPLACE":"",force:r.force&&!r.materialized?" FORCE":"",materialized:r.materialized?" MATERIALIZED":"",viewType:r.materialized?"":I(r),viewProperties:r.viewProperties?` 
`+p(r.viewProperties):"",sharing:r.sharing&&!r.materialized?` SHARING=${r.sharing}`:"",selectStatement:Q});return X?ne=ae(ne,r.ifNotExist):ne+=";",d(ne+Y+te,{isActivated:b})},createDualityView({jsonSchema:r,view:c,relatedSchemas:b}){return sn.getCreatorInstance(an.SQL,{ddlTemplates:w,assignTemplates:S,lodash:V,prepareName:g,getNamePrefixedWithSchemaName:E}).convertDualityViewToDdl({view:c,jsonSchema:r,relatedSchemas:b})},createUdt(r){let c=le(r.synonyms,E(r.name,r.schemaName),r.schemaName);return d(H(r,this.convertColumnDefinition)+c,{isActivated:r.isActivated})},commentIfDeactivated(r,c,b){return r},renameColumn(r,c,b){return S(w.renameColumn,{tableName:r,oldColumnName:c,newColumnName:b})},createSchemaSequence({schemaName:r,sequence:c}){let b=pe(e==null?void 0:e.dbVersion);return he({schemaName:r,sequence:c,usingTryCatchWrapper:b})},dropSchemaSequence({schemaName:r,sequence:c}){let b=pe(e==null?void 0:e.dbVersion);return Ie({schemaName:r,sequence:c,usingTryCatchWrapper:b})},alterSchemaSequence({schemaName:r,sequence:c,oldSequence:b}){let A=pe(e==null?void 0:e.dbVersion);return Ee({schemaName:r,sequence:c,oldSequence:b,usingTryCatchWrapper:A})}}}});module.exports=Ut();
