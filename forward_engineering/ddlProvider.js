"use strict";var Wt=Object.defineProperty;var t=(s,e)=>Wt(s,"name",{value:e,configurable:!0});var H=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var Je=H((ln,Me)=>{"use strict";Me.exports={number:"numeric",string:"nvarchar2",date:"date",timestamp:"timestamp",binary:"raw",boolean:"numeric",document:"bfile",array:"json",objectId:"char",default:"nvarchar2"}});var Qe=H((mn,ze)=>{"use strict";ze.exports={character:{type:"char"},"character varying":{type:"varchar"},"char varying":{type:"varchar"},"national char":{type:"nchar"},"national character":{type:"nchar"},"national char varying":{type:"nvarchar2"},"national character varying":{type:"nvarchar2"},"nchar varying":{type:"nvarchar2"},tinyint:{type:"number",precision:5},"small int":{type:"number",precision:5},shortinteger:{type:"number",precision:5},shortint:{type:"number",precision:5},smallint:{type:"number",precision:5},int:{type:"number",precision:10},integer:{type:"number",precision:10},shortdecimal:{type:"number",precision:5,scale:0},decimal:{type:"number",precision:5,scale:0},longinteger:{type:"number",precision:20},bigint:{type:"number",precision:20},int8:{type:"number",precision:20},bit:{type:"number",precision:1},real:{type:"float",length:23},"double precision":{type:"number"},"small money":{type:"float",precision:16,scale:2},money:{type:"float",precision:16,scale:2},"long varchar":{type:"long"},text:{type:"long"},ntext:{type:"long"},uniqueidentifier:{type:"char",length:36},uuid:{type:"char",length:36},datetime:{type:"date"},"small datetime":{type:"date"},image:{type:"long raw"},binary:{type:"raw"},varbinary:{type:"raw"},string:{type:"nvarchar2"}}});var Ze=H((un,Xe)=>{"use strict";Xe.exports={createSchema:"CREATE USER${ifNotExists} ${schemaName} NO AUTHENTICATION",comment:"\nCOMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${tableType} TABLE${ifNotExists} ${name}${tableProps}\n${options}",createTableProps:"${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}",columnDefinition:"${name}${type}${default}${encrypt}${constraints}",createKeyConstraint:"${constraintName}${keyType}${columns}${options}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete}",checkConstraint:"${name}CHECK (${expression})",createForeignKey:"ALTER TABLE ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",createIndex:"CREATE${indexType} INDEX${ifNotExists}${name} ON ${tableName}${keys}${options};\n",dropIndex:"DROP INDEX ${name};",alterIndexRename:"ALTER INDEX ${oldName} RENAME TO ${newName};",alterIndexRebuild:"ALTER INDEX ${name} REBUILD ${options};",createView:"CREATE${orReplace}${force}${viewType}${materialized} VIEW${ifNotExists} ${name} ${sharing}${viewProperties}\n	AS ${selectStatement}",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createObjectType:`CREATE OR REPLACE TYPE \${name} AS OBJECT 
(
	\${properties}
);
`,objectTypeColumnDefinition:"${name} ${type}",createCollectionType:"CREATE OR REPLACE TYPE ${name} IS ${collectionType}${size} OF (${datatype})${notPersistable};\n",ifNotExists:`DECLARE
BEGIN
	EXECUTE IMMEDIATE '\${statement}';
	EXCEPTION WHEN OTHERS THEN
		IF SQLCODE = -\${errorCode} THEN NULL; ELSE RAISE; END IF;
END;
/
`,createSynonym:"CREATE${orReplace}${editionable}${public} SYNONYM ${name}\n	FOR ${objectName};\n",renameColumn:"ALTER TABLE ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",createSequence:"CREATE SEQUENCE${ifNotExists} ${name}${sharing}${options}",dropSequence:"DROP SEQUENCE${ifExists} ${name};\n",renameSequence:"RENAME ${name} TO ${newName};\n",alterSequence:"ALTER SEQUENCE${ifExists} ${name}${options};\n",dualityView:{createJsonRelationalDualityViewHeading:"CREATE${orReplaceStatement}${forceStatement}${editionableStatement} JSON RELATIONAL DUALITY VIEW ${viewName} AS",sql:{tableTagsStatement:"WITH${checkStatement}${etagStatement}${insertStatement}${updateStatement}${deleteStatement}",columnTagsStatement:"WITH${checkStatement}${etagStatement}${updateStatement}",fromTableStatement:"FROM ${tableName}${tableAlias}${tableTagsStatement}${whereClauseStatement}"}},alterSession:"ALTER SESSION SET CURRENT_SCHEMA=${schemaName};\n"}});var Ce=H((dn,et)=>{"use strict";var Mt=Object.freeze({SQL:"SQL",GRAPHQL:"GRAPHQL"});et.exports={DualityViewSyntaxType:Mt}});var nt=H((pn,tt)=>{"use strict";var Jt=Object.freeze({JOIN_SUBQUERY_TYPE:"joinSubquery",COLLECTION_REFERENCE:"collectionReference"});tt.exports={DualityViewPropertiesType:Jt}});var ce=H((gn,rt)=>{"use strict";var yn=require("lodash");rt.exports=s=>{let e=t(n=>s.get(n,"[0].code")||s.get(n,"[0].name",""),"getDbName"),a=t(n=>n&&(n.code||n.collectionName)||"","getEntityName"),l=t(n=>n&&(n.code||n.name)||"","getViewName"),p=t(n=>n&&(n.code||n.name)||"","getBucketName"),d=t(n=>({...s.get(n,"[0]",{}),name:e(n)}),"getDbData"),o=t(n=>s.get(n,"[0].viewOn"),"getViewOn"),T=t(n=>u=>u.primaryTableId===n&&u.primaryTableId!==u.foreignTableId,"isRecursiveRelationship"),y=t(n=>Object.keys(n).reduce((u,E)=>{let R=n[E].filter(x=>{let k=n[x.primaryTableId];return Array.isArray(k)?!k.some(T(E)):!0});return s.isEmpty(R)?u:{...u,[E]:R}},{}),"rejectRecursiveRelationships"),A=t(n=>Object.keys(n).reduce((u,E)=>{let R=n[E].filter(x=>{let k=n[x.primaryTableId];return Array.isArray(k)?k.some(T(E)):!1});return u.concat(R)},[]),"filterRecursiveRelationships"),h=t((n,u="	")=>n.split(`
`).map(E=>u+E).join(`
`),"tab"),O=t((n,u)=>Object.keys(n).map(s.toLower).includes(s.toLower(u)),"hasType"),U=t(n=>Object.entries(n).filter(([u,E])=>!s.isNil(E)).reduce((u,[E,R])=>({...u,[E]:R}),{}),"clean"),G=t(n=>n.every(u=>s.get(u,"isActivated",!0)),"checkAllKeysActivated"),X=t(n=>n.length?n.every(u=>!s.get(u,"isActivated",!0)):!1,"checkAllKeysDeactivated"),g=t((n,u)=>{let E=n.filter(x=>s.get(x,"isActivated",!0)).map(u),R=n.filter(x=>!s.get(x,"isActivated",!0)).map(u);return{activatedItems:E,deactivatedItems:R}},"divideIntoActivatedAndDeactivated"),f=t((n,{isActivated:u,isPartOfLine:E,inlineComment:R="--"})=>u!==!1?n:E?"/* "+n+" */":n.includes(`
`)?`/*
`+n+` */
`:R+" "+n,"commentIfDeactivated"),S=t((n,u="'",E="'")=>{let R=n[0];return n[n.length-1]===u&&R===E?n:`${u}${n}${E}`},"wrap"),L=t(n=>`"${n}"`,"wrapInQuotes"),N=t(n=>u=>n==="nonquotedIdentifier"?u:L(u),"prepareNameForScriptFormat"),P=t(n=>`'${n.replace(/'/g,"''")}'`,"wrapComment"),q=t(n=>(u,E)=>E?`${N(n)(E)}.${N(n)(u)}`:N(n)(u),"getNamePrefixedWithSchemaNameForScriptFormat"),v=t((n,u)=>u.some(E=>(n==null?void 0:n.oldField[E])!==(n==null?void 0:n.newField[E])),"checkFieldPropertiesChanged"),M=t(({name:n})=>L(n),"columnMapToString");return{getDbName:e,getBucketName:p,getDbData:d,getEntityName:a,getViewName:l,getViewOn:o,rejectRecursiveRelationships:y,filterRecursiveRelationships:A,tab:h,hasType:O,clean:U,checkAllKeysActivated:G,checkAllKeysDeactivated:X,divideIntoActivatedAndDeactivated:g,commentIfDeactivated:f,wrap:S,wrapComment:P,wrapInQuotes:L,getNamePrefixedWithSchemaNameForScriptFormat:q,checkFieldPropertiesChanged:v,getColumnsList:t((n,u,E,R=M)=>{var j;let x=g(n,R),k=(j=x==null?void 0:x.deactivatedItems)!=null&&j.length?f(x.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!u&&E?" ("+x.activatedItems.join(", ")+k+")":" ("+n.map(R).join(", ")+")"},"getColumnsList"),escapeSingleQuote:t(n=>n.replaceAll("'","''"),"escapeSingleQuote"),getGroupItemsByCompMode:t(({newItems:n=[],oldItems:u=[]})=>{let E=n.filter(k=>!u.some(j=>j.id===k.id)),R=[],x=[];return u.forEach(k=>{let j=n.find(m=>m.id===k.id);j?s.isEqual(j,k)||x.push(j):R.push(k)}),{added:E,removed:R,modified:x}},"getGroupItemsByCompMode"),prepareNameForScriptFormat:N}}});var at=H((Nn,it)=>{"use strict";var{DualityViewPropertiesType:st}=nt(),ae=class ae{constructor(e,a,l,p,d){if(this.constructor===ae)throw new Error("Abstract classes can't be instantiated.");this._ddlTemplates=e,this._assignTemplates=a,this._lodash=l,this._prepareName=p,this._getNamePrefixedWithSchemaName=d}static padInFront(e){return` ${e}`}static padInFrontAndUppercaseIfExists(e){return e?ae.padInFront(e).toUpperCase():""}static isDualityView(e={}){return e.viewOn&&e.duality}static isJoinSubquery(e={}){return(e==null?void 0:e.type)===st.JOIN_SUBQUERY_TYPE}static isFlexColumn(e={}){return e.flexColumn}static isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e={}){let{ref:a,refIdPath:l,refType:p}=e;return a&&(l||[]).length===2&&p===st.COLLECTION_REFERENCE}static isRegularDualityViewFieldInArraySubquery(e={}){let{ref:a,refId:l}=e;return a&&l}static isRegularDualityViewField(e={}){return ae.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)||ae.isRegularDualityViewFieldInArraySubquery(e)}static getPathToReferencedColumn(e,a){let l=[];return ae.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)?l=e.refIdPath:ae.isRegularDualityViewFieldInArraySubquery(e)&&(l=[...a.joinedCollectionRefIdPath||[],e.ref]),l}static getRegularFieldNameFromCollection(e,a){if(e.length<2)throw new Error("Cannot extract referenced column name");let l=e[0],p=e[1],d=a[l],o=(d==null?void 0:d.properties)||{};for(let T of Object.keys(o))if(o[T].GUID===p)return T;return""}static getKeyValueFrontPadding(e){return"	".repeat(e)}_getForceStatement(e){return ae.padInFrontAndUppercaseIfExists(e.force)}_getOrReplaceStatement(e){return e.orReplace?" OR REPLACE":""}_getEditionableStatement(e){return ae.padInFrontAndUppercaseIfExists(e.editionable)}static getRegularFieldName(e,a){return a.code||e||a.referencedColumnName}getCreateJsonRelationalDualityViewHeadingDdl(e){var U,G;let{jsonSchema:a,view:l}=e,{getViewName:p}=ce()(this._lodash),d=((G=(U=this._ddlTemplates)==null?void 0:U.dualityView)==null?void 0:G.createJsonRelationalDualityViewHeading)||"",o=this._getOrReplaceStatement(l),T=this._getForceStatement(a),y=this._getEditionableStatement(a),A=p(l),h=this._getNamePrefixedWithSchemaName(A,l.schemaName),O={orReplaceStatement:o,forceStatement:T,editionableStatement:y,viewName:h};return this._assignTemplates(d,O)}getDualityViewBodyDdl(e){throw new Error("Not implemented")}convertDualityViewToDdl(e){let a=this.getCreateJsonRelationalDualityViewHeadingDdl(e),l=this.getDualityViewBodyDdl(e);return a+`
`+l+`
`}};t(ae,"AbstractDualityViewFeDdlCreator");var Oe=ae;it.exports={AbstractDualityViewFeDdlCreator:Oe}});var ct=H((En,ot)=>{"use strict";var{AbstractDualityViewFeDdlCreator:F}=at(),Pe=class Pe extends F{_getFromRootTableAliasStatement(e){if(e.rootTableAlias){let a=this._prepareName(e.rootTableAlias);return F.padInFront(a)}return""}_getFromChildTableAliasStatement(e){if(e.childTableAlias){let a=this._prepareName(e.childTableAlias);return F.padInFront(a)}return""}_getCheckStatement(e){return F.padInFrontAndUppercaseIfExists(e.check)}_getEtagStatement(e){let a=e.etag?"etag":"";return F.padInFrontAndUppercaseIfExists(a)}_getDeleteStatement(e){return F.padInFrontAndUppercaseIfExists(e.delete)}_getInsertStatement(e){return F.padInFrontAndUppercaseIfExists(e.insert)}_getUpdateStatement(e){return F.padInFrontAndUppercaseIfExists(e.update)}_getTableTagsStatement(e){let a=e.tableTagsClause||{},l=this._getCheckStatement(a),p="";l&&(p=this._getEtagStatement(a));let d=this._getInsertStatement(a),o=this._getUpdateStatement(a),T=this._getDeleteStatement(a),y={checkStatement:l,etagStatement:p,insertStatement:d,updateStatement:o,deleteStatement:T};if(Object.values(y).some(h=>h==null?void 0:h.length)){let h=this._ddlTemplates.dualityView.sql.tableTagsStatement,O=this._assignTemplates(h,y);return F.padInFront(O)}return""}_getColumnTagsStatement(e){let a=e.columnTagsClause||{},l=this._getCheckStatement(a),p="";l&&(p=this._getEtagStatement(a));let d=this._getUpdateStatement(a),o={checkStatement:l,etagStatement:p,updateStatement:d};if(Object.values(o).some(y=>y==null?void 0:y.length)){let y=this._ddlTemplates.dualityView.sql.columnTagsStatement,A=this._assignTemplates(y,o);return F.padInFront(A)}return""}_getFromRootTableStatement(e){var y;let a=this._getNamePrefixedWithSchemaName(e.tableName,e.schemaName),l=this._getFromRootTableAliasStatement(e),p=this._getTableTagsStatement(e),d=(y=e.whereClause)==null?void 0:y.trim(),o=d?`
WHERE ${d} WITH CHECK OPTION`:"",T=this._ddlTemplates.dualityView.sql.fromTableStatement;return this._assignTemplates(T,{tableName:a,tableAlias:l,tableTagsStatement:p,whereClauseStatement:o})}_getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:a,bodyPadding:l}){let p=this._lodash.first(e.joinedCollectionRefIdPath);if(!p)throw new Error("Specify child table for all join subqueries");let d=a[p],{getEntityName:o}=ce()(this._lodash),T=o(d),y=d.bucketName,A=this._getNamePrefixedWithSchemaName(T,y),h=this._getFromChildTableAliasStatement(e),O=this._getTableTagsStatement(e),U=this._ddlTemplates.dualityView.sql.fromTableStatement,X=[this._assignTemplates(U,{tableName:A,tableAlias:h,tableTagsStatement:O})];return e.whereClause&&X.push(`WHERE ${e.whereClause}`),X.map(g=>`${l}${g}`).join(`
`)}_getNameOfReferencedColumnForDdl(e,a,l){let{getEntityName:p}=ce()(this._lodash);if(F.isDualityView(e)){let d=e.rootTableAlias||e.tableName;return this._getNamePrefixedWithSchemaName(a,d)}if(F.isJoinSubquery(e)){if(e.childTableAlias){let o=e.childTableAlias;return this._getNamePrefixedWithSchemaName(a,o)}let d=this._lodash.first(e.joinedCollectionRefIdPath);if(d){let o=l[d],T=p(o);return this._getNamePrefixedWithSchemaName(a,T)}}return""}_getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}){let{wrap:o}=ce()(this._lodash),T=F.getKeyValueFrontPadding(p),y=F.getRegularFieldName(e,a),A=o(y,"'","'"),h=F.getPathToReferencedColumn(a,l),O=F.getRegularFieldNameFromCollection(h,d),U=this._getNameOfReferencedColumnForDdl(l,O,d),G=this._getColumnTagsStatement(a);return`${T}${A}: ${U}${G}`}_getJoinSubqueryValueStatement({propertyJsonSchema:e,paddingFactor:a,relatedSchemas:l}){let p=a+1,d=a+2,o=this._getObjectGenStatement({paddingFactor:d,relatedSchemas:l,jsonSchema:e}),T=F.getKeyValueFrontPadding(p),A=[`${T}SELECT${o}`],h=this._getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:l,bodyPadding:T});return A.push(h),A.join(`
`)}_shouldUnnestJoinSubquery(e){let a=this._lodash.toUpper(e.sqlJsonFunction),l=this._lodash.toLower(e.subtype);return a==="JSON_OBJECT"||l==="object"?!!e.unnestSubquery:!1}_getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:l,relatedSchemas:p}){let{wrap:d}=ce()(this._lodash),o=this._getJoinSubqueryValueStatement({relatedSchemas:p,paddingFactor:l,propertyJsonSchema:a}),T=F.getKeyValueFrontPadding(l),y=this._getObjectGenStatementJsonKeywordConfig(a),A=y.surroundingBrackets[0],h=y.surroundingBrackets[1];if(this._shouldUnnestJoinSubquery(a))return`${T}UNNEST ${A}
${o}
${T}${h}`;let U=this._getJoinSubqueryName(e,a),G=d(U,"'","'");return`${T}${G} : ${A}
${o}
${T}${h}`}_getJoinSubqueryName(e,a){return a.name||e}_buildKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}){return F.isFlexColumn(a)?this._getFlexColumnStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:p}):F.isRegularDualityViewField(a)?this._getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:a,parent:l,paddingFactor:p,relatedSchemas:d}):F.isJoinSubquery(a)?this._getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:p,relatedSchemas:d}):""}_getKeyValueStatement({jsonSchema:e,relatedSchemas:a,paddingFactor:l}){var y;let p=[],d=e.properties||((y=e.items)==null?void 0:y.properties)||{},o=this._lodash.toPairs(d);for(let[A,h]of o){let O=this._buildKeyValueStatement({propertyName:A,propertyJsonSchema:h,parent:e,paddingFactor:l,relatedSchemas:a});p.push(O)}return`
${p.join(`,
`)}
`}_getObjectGenStatementJsonKeywordConfig(e){if(!F.isJoinSubquery(e))return{jsonKeyword:"JSON",surroundingBrackets:["",""],jsonKeywordBrackets:["{","}"]};let a=this._lodash.toUpper(e.sqlJsonFunction);return a==="JSON_OBJECT"?{jsonKeyword:a,surroundingBrackets:["(",")"],jsonKeywordBrackets:["(",")"]}:a==="JSON_ARRAYAGG"?{jsonKeyword:a,surroundingBrackets:["(",")"],jsonKeywordBrackets:["( JSON {","})"]}:this._lodash.toLower(e.subtype)==="array"?{jsonKeyword:"JSON",surroundingBrackets:["[","]"],jsonKeywordBrackets:["{","}"]}:{jsonKeyword:"JSON",surroundingBrackets:["(",")"],jsonKeywordBrackets:["{","}"]}}_getObjectGenStatement({relatedSchemas:e,paddingFactor:a,jsonSchema:l}){let p=this._getKeyValueStatement({relatedSchemas:e,paddingFactor:a,jsonSchema:l}),d=F.getKeyValueFrontPadding(a-1),o=this._getObjectGenStatementJsonKeywordConfig(l),T=o.jsonKeywordBrackets[0],y=o.jsonKeywordBrackets[1],A=`${o.jsonKeyword} ${T}\${keyValueStatement}${d}${y}`,h=this._assignTemplates(A,{keyValueStatement:p});return F.padInFront(h)}getDualityViewBodyDdl(e){let{view:a,jsonSchema:l,relatedSchemas:p}=e,T=[`SELECT${this._getObjectGenStatement({jsonSchema:l,paddingFactor:1,relatedSchemas:p})}`],y=this._getFromRootTableStatement(a);return T.push(y+";"),T.join(`
`)}_getFlexColumnStatement({propertyName:e,propertyJsonSchema:a,paddingFactor:l}){let{wrap:p}=ce()(this._lodash),d=F.getKeyValueFrontPadding(l),o=F.getRegularFieldName(e,a),T=p(o,'"','"');return`${d}${T} AS FLEX COLUMN`}};t(Pe,"SqlDualityViewDdlCreator");var Re=Pe;ot.exports={SqlDualityViewDdlCreator:Re}});var mt=H(($n,lt)=>{"use strict";var{DualityViewSyntaxType:zt}=Ce(),{SqlDualityViewDdlCreator:Qt}=ct(),xe=class xe{static getCreatorInstance(e,{ddlTemplates:a,assignTemplates:l,lodash:p,prepareName:d,getNamePrefixedWithSchemaName:o}){switch(e==null?void 0:e.toUpperCase()){case zt.SQL:return new Qt(a,l,p,d,o);default:throw new Error(`Unknown syntax config: ${e}`)}}};t(xe,"DualityViewDdlCreatorFactory");var Ke=xe;lt.exports={DualityViewDdlCreatorFactory:Ke}});var Ve=H((hn,ut)=>{"use strict";var Xt=Object.freeze({IF_NOT_EXISTS_SINCE:23,JSON_TYPE_SINCE:21});ut.exports={DbVersion:Xt}});var pt=H((In,dt)=>{"use strict";var Fe=class Fe{type;keyId};t(Fe,"AlterIndexKeyDto");var qe=Fe,we=class we{id;indxName;isActivated;ifNotExist;indxType;indxKey;column_expression;tablespace;index_properties;index_attributes;index_compression;logging_clause;indxComments};t(we,"AlterIndexDto");var Le=we;dt.exports={AlterIndexDto:Le,AlterIndexKeyDto:qe}});var ve=H((Cn,yt)=>{"use strict";var ke=class ke{cache;cacheValue;cycle;ifNotExist;increment;maxValue;minValue;sequenceName;start;sharing;order;keep;scale;scaleExtend;shard;shardExtend;type};t(ke,"Sequence");var Ue=ke,_e=class _e{sharing;ddlScript;sequenceName;minValue;maxValue;increment;cycle;order;cacheValue;scale;extend;shard;type;keep};t(_e,"SequenceDto");var Be=_e;yt.exports={Sequence:Ue,SequenceDto:Be}});var Nt=H((Rn,Tt)=>{"use strict";var gt=t((s="")=>new RegExp("\\$\\{(.*?)\\}",s),"template"),Zt=t(s=>s.match(gt("gi"))||[],"getAllTemplates"),en=t(s=>(s.match(gt("i"))||[])[1],"parseTemplate");Tt.exports=({_:s})=>({assignTemplates:t((a,l)=>Zt(a).reduce((p,d)=>{let o=en(d);return p.replace(d,()=>l[o]||l[o]===0?l[o]:"")},a),"assignTemplates")})});var Et=H((xn,ft)=>{"use strict";var Kn=require("lodash");ft.exports=(s,e)=>{let a=t((g,f)=>Object.entries(g.properties).map(f),"mapProperties"),l=t(g=>g.compositeUniqueKey?!1:!!g.unique,"isUniqueKey"),p=t(g=>{var f;return l(g)&&!((f=g.uniqueKeyOptions)!=null&&f.constraintName)},"isInlineUnique"),d=t(g=>g.compositeUniqueKey||g.compositePrimaryKey?!1:!!g.primaryKey,"isPrimaryKey"),o=t(g=>{var f;return d(g)&&!((f=g.primaryKeyOptions)!=null&&f.constraintName)},"isInlinePrimaryKey"),T=t((g,f,S)=>e({keyType:"UNIQUE",columns:[{name:f,isActivated:S}],...g}),"hydrateUniqueOptions"),y=t((g,f,S)=>e({keyType:"PRIMARY KEY",columns:[{name:f,isActivated:S}],...g}),"hydratePrimaryKeyOptions"),A=t((g,f)=>Object.keys(f).find(S=>f[S].GUID===g),"findName"),h=t((g,f)=>s.get(Object.values(f).find(S=>S.GUID===g),"isActivated",!0),"checkIfActivated"),O=t((g,f)=>s.map(g,S=>({name:A(S.keyId,f.properties),isActivated:h(S.keyId,f.properties)})),"getKeys"),U=t(g=>Array.isArray(g.primaryKey)?g.primaryKey.filter(f=>!s.isEmpty(f.compositePrimaryKey)).map(f=>({...y(f,null,null),columns:O(f.compositePrimaryKey,g)})):[],"getCompositePrimaryKeys"),G=t(g=>Array.isArray(g.uniqueKey)?g.uniqueKey.filter(f=>!s.isEmpty(f.compositeUniqueKey)).map(f=>({...T(f,null,null),columns:O(f.compositeUniqueKey,g)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:t(g=>{if(!g.properties)return[];let f=a(g,([L,N])=>{if(!(!l(N)||p(N)))return T(N.uniqueKeyOptions,L,N.isActivated)}).filter(Boolean);return[...a(g,([L,N])=>{if(!(!d(N)||o(N)))return y(N.primaryKeyOptions,L,N.isActivated)}).filter(Boolean),...U(g),...f,...G(g)]},"getTableKeyConstraints"),isInlineUnique:p,isInlinePrimaryKey:o,getKeys:O}}});var De=H((Ln,St)=>{"use strict";var qn=require("lodash");St.exports=({prepareName:s,_:e})=>({getOptionsString:t(({constraintName:l,deferClause:p,rely:d,validate:o,indexClause:T,exceptionClause:y})=>{let A=l?` CONSTRAINT ${s(e.trim(l))}`:"",h=[p,d,T,o,y].filter(Boolean).join(" ");return{constraintString:A,statement:h&&` ${h}`}},"getOptionsString")})});var bt=H((Un,$t)=>{"use strict";var wn=require("lodash"),{DbVersion:tn}=Ve(),nn=t(s=>Number.parseInt(s,10)<tn.JSON_TYPE_SINCE,"shouldUseClobForJsonColumns");$t.exports=({_:s,wrap:e,assignTemplates:a,templates:l,commentIfDeactivated:p,wrapComment:d,prepareName:o})=>{let{getOptionsString:T}=De()({_:s,prepareName:o}),y=t((m,C)=>s.chain(C).filter("comment").map(K=>{let B=a(l.comment,{object:"COLUMN",objectName:`${m}.${o(K.name)}`,comment:d(K.comment)});return p(B,K)}).join(`
`).value(),"getColumnComments"),A=t(({nullable:m,unique:C,primaryKey:K,primaryKeyOptions:B,uniqueKeyOptions:Z})=>{let{constraintString:J,statement:te}=T(h({primaryKey:K,unique:C,primaryKeyOptions:B,uniqueKeyOptions:Z}));return`${m?"":" NOT NULL"}${J}${K?" PRIMARY KEY":""}${C?" UNIQUE":""}${te}`},"getColumnConstraints"),h=t(({primaryKey:m,unique:C,primaryKeyOptions:K,uniqueKeyOptions:B})=>m?K||{}:C?B||{}:{},"getOptions"),O=t((m,C)=>m==="JSON"&&nn(C)?"CLOB":m,"replaceTypeByVersion"),U=t(({default:m,defaultOnNull:C,identity:K})=>{if(!s.isEmpty(K)&&K.generated){let B=t(({generated:J,generatedOnNull:te})=>J==="BY DEFAULT"?` ${J} ${te?" ON NULL":""}`:" ALWAYS","getGenerated"),Z=t(({identityStart:J,identityIncrement:te,numberToCache:se})=>{let le=J?` START WITH ${J}`:"",ye=te?` INCREMENT BY ${te}`:"",Ne=se?` CACHE ${se}`:" NOCACHE";return`${le}${ye}${Ne}`},"getOptions");return` GENERATED${B(K)} AS IDENTITY (${s.trim(Z(K))})`}else if(m||m===0)return` DEFAULT${C?" ON NULL":""} ${m}`;return""},"getColumnDefault"),G=t(({encryption:m})=>{if(s.isPlainObject(m)&&!s.isEmpty(s.omit(m,"id"))){let{ENCRYPTION_ALGORITHM:C,INTEGRITY_ALGORITHM:K,noSalt:B}=m,Z=C?` USING '${C}'`:"",J=K?` '${K}'`:"";return` ENCRYPT${Z}${J}${B?" NO SALT":""}`}return""},"getColumnEncrypt"),X=t((m,C,K)=>` ${m}(${C} ${s.toUpper(K)})`,"addByteLength"),g=t((m,C)=>` ${m}(${C})`,"addLength"),f=t((m,C,K)=>s.isNumber(K)?` ${m}(${C||"*"},${K})`:s.isNumber(C)?` ${m}(${C})`:` ${m}`,"addScalePrecision"),S=t((m,C)=>s.isNumber(C)?` ${m}(${C})`:` ${m}`,"addPrecision"),L=t((m,C,K)=>` TIMESTAMP${s.isNumber(m)?`(${m})`:""}${C?` WITH${K?" LOCAL":""} TIME ZONE`:""}`,"timestamp"),N=t(m=>` INTERVAL YEAR${s.isNumber(m)?`(${m})`:""} TO MONTH`,"intervalYear"),P=t((m,C)=>{let K=s.isNumber(m)?`(${m})`:"",B=s.isNumber(C)?`(${C})`:"";return` INTERVAL DAY${K} TO SECOND${B}`},"intervalDay"),q=t((m,C,K)=>{let B={"vector<int8>":"int8","vector<float32>":"float32","vector<float64>":"float64"}[K],Z=C||"*",J=s.toUpper(B||"*");return` ${m}(${Z}, ${J})`},"decorateVector"),v=t((m,C)=>["object","array"].includes(C)?" "+m+"("+s.toUpper(C)+")":" "+m,"decorateJson"),M=t(m=>["CHAR","VARCHAR2"].includes(m),"canHaveByte"),ee=t(m=>["CHAR","VARCHAR2","NCHAR","NVARCHAR2","RAW","UROWID"].includes(m),"canHaveLength"),i=t(m=>["NUMBER","FLOAT"].includes(m),"canHavePrecision"),$=t(m=>m==="NUMBER","canHaveScale"),n=t(m=>m==="INTERVAL YEAR","isIntervalYear"),u=t(m=>m==="INTERVAL DAY","isIntervalDay"),E=t(m=>m==="TIMESTAMP","isTimezone"),R=t((m,C,K)=>m==="VECTOR"&&(C||K),"canDecorateVector"),x=t(m=>m==="JSON","isJson");return{getColumnComments:y,getColumnConstraints:A,replaceTypeByVersion:O,getColumnDefault:U,getColumnEncrypt:G,decorateType:t((m,C)=>{let{lengthSemantics:K,length:B,precision:Z,scale:J,fractSecPrecision:te,withTimeZone:se,localTimeZone:le,yearPrecision:ye,dayPrecision:Ne,isUDTRef:Ie,schemaName:Ee,dimension:fe,subtype:ge}=C;return K&&M(m)&&ee(m)&&s.isNumber(B)?X(m,B,K):ee(m)&&s.isNumber(B)?g(m,B):i(m)&&$(m)?f(m,Z,J):i(m)&&s.isNumber(Z)?S(m,Z):E(m)?L(te,se,le):n(m)?N(ye):u(m)?P(Ne,te):Ie&&Ee?` "${Ee}"."${m}"`:R(m,fe,ge)?q(m,fe,ge):x(m)?v(m,ge):` ${m}`},"decorateType"),canHaveIdentity:t(m=>["number"].includes(m),"canHaveIdentity")}}});var It=H((_n,ht)=>{"use strict";var kn=require("lodash");ht.exports=({_:s,getColumnsList:e,checkAllKeysDeactivated:a,commentIfDeactivated:l,prepareName:p,assignTemplates:d})=>{let{getOptionsString:o}=De()({_:s,prepareName:p}),T=t(({duplicated:i,external:$,immutable:n,sharded:u,temporary:E,temporaryType:R,blockchain_table_clauses:x})=>{let k=!s.isEmpty(x);switch(!0){case E:return` ${s.toUpper(R)} TEMPORARY`;case u:return" SHARDED";case i:return" DUPLICATED";case n:return" IMMUTABLE";case k:return`${x.immutable?" IMMUTABLE":""} BLOCKCHAIN`;default:return""}},"getTableType"),y=t(i=>{let $=t(u=>u?`${u}
`:"","wrap"),n=[{key:"blockchain_table_clauses",getValue:A(i==null?void 0:i.tableProperties)},{key:"storage",getValue:h(i==null?void 0:i.tableProperties)},{key:"external_table_clause",getValue:O},{key:"partitioning",getValue:U},{key:"selectStatement",getValue:N("AS")},{key:"tableProperties",getValue:u=>u}].map(u=>i[u.key]?$(u.getValue(i[u.key],i)):"").filter(Boolean).join("");return s.trim(n)?` ${s.trim(n)}`:""},"getTableOptions"),A=t(i=>({blockchain_table_retention_clause:$,blockchain_row_retention_clause:n,blockchain_hash_and_data_format_clause:u})=>s.includes(i,$)||s.includes(i,n)||s.includes(i,u)?"":s.trim(` ${$||""} ${n||""} ${u||""}`),"getBlockChainClause"),h=t(i=>({organization:$,tablespace:n,logging:u})=>s.includes(i,"TABLESPACE")?"":$==="external"?"ORGANIZATION EXTERNAL":`ORGANIZATION ${s.toUpper($)||"HEAP"}${n?` TABLESPACE ${p(n)}`:""} ${u?"LOGGING":"NOLOGGING"}`,"getStorage"),O=t(i=>{if(!(i!=null&&i.access_driver_type))return"";let{access_driver_type:$,default_directory:n,access_parameter_type:u,opaque_format_spec:E,clob_subquery:R,reject_limit:x,location:k}=i,j=`(${s.map(k,({location_directory:K,location_specifier:B})=>`${K?`${K}:`:""}'${B}'`).join(", ")})`,m=u==="NONE"?"":`ACCESS PARAMETERS ${R?`USING CLOB ${R}`:E}`,C=`${n&&!s.isEmpty(n)?` DEFAULT DIRECTORY ${n}`:""}`+m+`${k&&!s.isEmpty(k)?` LOCATION ${j}`:""}`;return` (TYPE ${s.toUpper($)} ${C}) REJECT LIMIT ${x||"UNLIMITED"} `},"getExternalTableClause"),U=t((i,{isActivated:$})=>{if(i!=null&&i.partitionBy){let n=G(i,$),u=X(i,$);return`PARTITION BY ${s.toUpper(s.startsWith(i.partitionBy,"composite")?s.last(i.partitionBy.split(" ")):i.partitionBy)} ${n}${u}`}return""},"getPartitioning"),G=t((i,$)=>{let n=a(i.partitionKey);return s.isEmpty(i.partitionKey)?"":e(i.partitionKey,n,$,({name:u})=>p(u))},"getPartitionKeys"),X=t((i,$)=>{switch(i.partitionBy){case"range":return`${i.interval?`
INTERVAL (${i.interval})`:""}`+S(i.store_in_tablespaces)+g(i.range_partitions,"range_partition_clause");case"list":return`${i.automatic?" AUTOMATIC":""}`+S(i.store_in_tablespaces)+g(i.list_partitions,"list_partition_clause");case"hash":return L(i);case"reference":return`${i.constraint?` (${i.constraint})`:""}`+g(i.reference_partition_descs,"reference_partition_desc");case"system":return i.system_partitioning_quantity?` PARTITIONS ${i.system_partitioning_quantity}`:g(i.system_partition_descs,"system_partition_desc");case"composite range":{let n=f(i,$);return`${i.interval?` INTERVAL (${i.interval})`:""}`+S(i.store_in_tablespaces)+n+g(i.range_subpartition_descs,"range_subpartition_desc")}case"composite list":{let n=f(i,$);return S(i.store_in_tablespaces,"AUTOMATIC")+n+g(i.list_subpartition_descs,"list_subpartition_description")}case"composite hash":{let n=f(i,$),u=L(i);return`${n}${u}`}default:return""}},"getPartitionClause"),g=t((i,$)=>i&&s.isArray(i)&&!s.isEmpty(i)?`
(
	${($?s.map(i,n=>n[$]):i).join(`,
	`)}
)
`:"","partitionsToString"),f=t(({subpartitionType:i,subpartitionDescription:$,compositePartitionKey:n},u)=>{if(i){let E=a(n),R=$?`
${$}`:"";return` SUBPARTITION BY ${s.toUpper(i)} ${e(n,E,u,({name:x})=>p(x))} ${R}`}return""},"getSubpartition"),S=t((i,$,n="store_in_tablespace")=>s.isEmpty(i)?"":`${$?` ${$}`:""} STORE IN (${s.map(i,u=>u[n]).join(", ")})`,"getTablespaceList"),L=t(({hash_partition_quantity:i,store_in_tablespaces:$,overflow_store_in_tablespaces:n,individual_hash_partitions:u})=>i?` PARTITIONS ${i}`+S($)+S(n,"OVERFLOW","overflow_store_in_tablespace"):g(u,"individual_hash_partition"),"getHashPartition"),N=t(i=>$=>{if($)return`${i} ${$}`},"getBasicValue");return{getTableOptions:y,getTableType:T,generateConstraintsString:t((i,$)=>{var R,x;let n=l(((i==null?void 0:i.deactivatedItems)||[]).join(`,
	`),{isActivated:!$,isPartOfLine:!0}),u=(R=i==null?void 0:i.activatedItems)!=null&&R.length?`,
	`+i.activatedItems.join(`,
	`):"",E=(x=i==null?void 0:i.deactivatedItems)!=null&&x.length?`
	`+n:"";return u+E},"generateConstraintsString"),foreignKeysToString:t(i=>{if(Array.isArray(i)){let $=i.filter(E=>s.get(E,"isActivated",!0)).map(E=>p(s.trim(E.name))),n=i.filter(E=>!s.get(E,"isActivated",!0)).map(E=>p(s.trim(E.name))),u=n.length?l(n,{isActivated:!1,isPartOfLine:!0}):"";return $.join(", ")+u}return i},"foreignKeysToString"),foreignActiveKeysToString:t(i=>i.map($=>s.trim($.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:t((i,$)=>n=>{let u=a(n.columns),E=e(n.columns,u,$,({name:x})=>p(x)),R=o(n).statement;return{statement:d(i.createKeyConstraint,{constraintName:n.constraintName?`CONSTRAINT ${p(n.constraintName)} `:"",keyType:n.keyType,columns:E,options:R}),isActivated:!u}},"createKeyConstraint"),customPropertiesForForeignKey:t(i=>({foreignOnDelete:s.get(i,"relationshipOnDelete","")}),"customPropertiesForForeignKey")}}});var Ct=H((Hn,At)=>{"use strict";var Dn=require("lodash");At.exports=({_:s,assignTemplates:e,templates:a,getNamePrefixedWithSchemaName:l})=>{let p=["OBJECT_UDT","VARRAY","TABLE","COLLECTION_UDT"],d=t((y,A)=>{let h=l(y.name,y.schemaName);switch(y.type){case"OBJECT_UDT":return e(a.createObjectType,{name:h,properties:s.map(y.properties,O=>A(O,a.objectTypeColumnDefinition)).join(`,
	`)});case"VARRAY":case"TABLE":{let O=y.type==="VARRAY"?"(64)":"";return e(a.createCollectionType,{name:h,collectionType:y.type,size:s.isNumber(y.size)?`(${y.size})`:O,datatype:`${y.ofType}${y.nullable?"":" NOT NULL"}`,notPersistable:`${y.notPersistable?" NOT PERSISTABLE":""}`})}default:return""}},"getPlainUdt");return{getUserDefinedType:t((y,A)=>d(y,A),"getUserDefinedType"),isNotPlainType:t(y=>{let A=s.toUpper(y.mode||y.type);return p.includes(A)},"isNotPlainType")}}});var Rt=H((Gn,Ot)=>{"use strict";Ot.exports=({_:s,prepareName:e})=>{let a=t(({editioning:d,editionable:o})=>`${o?" EDITIONABLE":""}${d?" EDITIONING":""}`,"getViewType"),l=t(d=>d?d.alias?`${e(d.name)} as ${e(d.alias)}`:e(d.name):"","getKeyWithAlias");return{getViewType:a,getViewData:t(d=>Array.isArray(d)?d.reduce((o,T)=>{if(!T.tableName)return o.columns.push(l(T)),o;let y=`${e(T.dbName)}.${e(T.tableName)}`;return o.tables.includes(y)||o.tables.push(y),o.columns.push({statement:`${y}.${l(T)}`,isActivated:T.isActivated}),o},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData")}}});var Kt=H((Mn,Pt)=>{"use strict";var Wn=require("lodash");Pt.exports=({_:s,prepareName:e})=>({getIndexType:t(o=>o?` ${s.toUpper(o)}`:"","getIndexType"),getIndexKeys:t(({indxKey:o,column_expression:T})=>{let{escapeSingleQuote:y}=ce()();return T?`
(
	${y(T)}
)
	`:s.isArray(o)&&!s.isEmpty(o)?`
(
	${s.map(o,({name:h,type:O})=>`${e(h)} ${s.toUpper(O)}`).join(`,
	`)}
)
	`:""},"getIndexKeys"),getIndexOptions:t(({indxDescription:o,comments:T,tablespace:y,index_properties:A,index_attributes:h,index_compression:O,logging_clause:U,indxKey:G,column_expression:X})=>{let g=U?` ${s.toUpper(U)}`:"",f=y?` TABLESPACE ${y}`:"",S=O?` ${O}`:"",L=`${g}${f}${S}`;return A?L=` ${A}`:h&&(L=` ${h}`),s.isEmpty(G)&&s.isEmpty(X)?L:s.trim(L)},"getIndexOptions"),getIndexName:t(o=>o?` ${e(o)}`:"","getIndexName")})});var Vt=H((zn,xt)=>{"use strict";xt.exports=({prepareName:s,templates:e,assignTemplates:a,getNamePrefixedWithSchemaName:l})=>{let p=t(o=>{let T=l(o.synonymName,o.schemaName);return a(e.createSynonym,{name:o.synonymPublic?s(o.synonymName):T,orReplace:o.synonymOrReplace?" OR REPLACE":"",editionable:o.synonymEditionable?" "+o.synonymEditionable:"",public:o.synonymPublic?" PUBLIC":"",objectName:o.synonymEntityName})},"generateSynonymCreateStatement");return{generateSynonymStatements:t((o,T,y)=>o!=null&&o.length?`
`+o.map(A=>p({...A,synonymEntityName:T,schemaName:y})).join(`
`):"","generateSynonymStatements")}}});var Lt=H((er,qt)=>{"use strict";var Xn=require("lodash"),{Sequence:Zn}=ve();qt.exports=({_:s,templates:e,assignTemplates:a,getNamePrefixedWithSchemaName:l,wrapIfNotExists:p})=>{let d=t(({schemaName:N,sequences:P,usingTryCatchWrapper:q})=>s.map(P,v=>o({schemaName:N,sequence:v,usingTryCatchWrapper:q})).join(`

`),"getSequencesScript"),o=t(({schemaName:N,sequence:P,usingTryCatchWrapper:q})=>{let v=L({schemaName:N,sequence:P}),M=l(P.sequenceName,v),ee=q?"":X({sequence:P}),i=A({sequence:P,schemaName:N}),$=f({sequence:P}),n=a(e.createSequence,{name:M,ifNotExists:ee,sharing:$,options:i});return q?p(n,P.ifNotExist):n+";"},"createSequenceScript"),T=t(({schemaName:N,sequence:P,oldSequence:q,usingTryCatchWrapper:v})=>{let M=q.sequenceName||P.sequenceName,ee=L({schemaName:N,sequence:P}),i=l(M),$=l(M,ee),n=S({sequence:P,oldSequence:q}),u=A({schemaName:N,sequence:n}),E=n.sequenceName?l(n.sequenceName):"",R=g({usingTryCatchWrapper:v});if(n.hasOwnProperty("sharing")){let j=y({schemaName:N,sequence:q,usingTryCatchWrapper:v}),m=o({schemaName:N,sequence:P,usingTryCatchWrapper:v});return j+`
`+m+`
`}return[{key:"options",value:u,name:$,template:e.alterSequence},{key:"newName",value:E,name:i,template:e.renameSequence}].filter(j=>j.value).map(j=>a(j.template,{[j.key]:j.value,name:j.name,ifExists:R})).join(`
`)},"alterSequenceScript"),y=t(({schemaName:N,sequence:P,usingTryCatchWrapper:q})=>{let v=L({schemaName:N,sequence:P}),M=l(P.sequenceName,v),ee=g({usingTryCatchWrapper:q});return a(e.dropSequence,{name:M,ifExists:ee})},"dropSequenceScript"),A=t(({schemaName:N,sequence:P})=>{let v=[{getOption:h,key:"increment",clause:"INCREMENT BY"},{getOption:h,key:"start",clause:"START WITH"},{getOption:h,key:"restart",clause:"RESTART WITH"},{getOption:h,key:"minValue",clause:"MINVALUE"},{getOption:h,key:"maxValue",clause:"MAXVALUE"},{getOption:O,key:"cache",extendedKey:"cacheValue"},{getOption:O,key:"cycle",extendedKey:""},{getOption:O,key:"order",extendedKey:""},{getOption:O,key:"keep",extendedKey:""},{getOption:O,key:"scale",extendedKey:"scaleExtend"},{getOption:O,key:"shard",extendedKey:"shardExtend"},{getOption:O,key:"type",extendedKey:""}].map(M=>{let ee=M.getOption({sequence:P,schemaName:N,config:M});return U({option:ee})}).filter(Boolean).join("");return v&&G({options:v})},"getSequenceOptions"),h=t(({sequence:N,config:P})=>{let q=Number(N[P.key]);return isNaN(q)?"":`${P.clause} ${q}`},"getNumberOption"),O=t(({sequence:N,config:P})=>{let q=s.toUpper(N[P.key]);return q?q.startsWith("NO")||!N[P.extendedKey]?q:q+" "+O({sequence:N,config:{key:P.extendedKey}}):""},"getLiteralOption"),U=t(({option:N})=>N?`	${N}
`:"","wrapOption"),G=t(({options:N})=>`
`+N.replace(/\n$/,""),"wrapOptionsBlock"),X=t(({sequence:N})=>N.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),g=t(({usingTryCatchWrapper:N})=>N?"":" IF EXISTS","getIfExists"),f=t(({sequence:N})=>N.sharing?" SHARING="+s.toUpper(N.sharing):"","getSharing"),S=t(({sequence:N,oldSequence:P})=>{let q=s.omitBy(N,(v,M)=>s.isEqual(v,P[M]));return N.minValue>P.minValue?{...q,restart:N.start}:q},"getModifiedSequence"),L=t(({schemaName:N,sequence:P})=>P.type==="session"?"":N,"getSequenceSchemaName");return{getSequencesScript:d,createSequenceScript:o,alterSequenceScript:T,dropSequenceScript:y}}});var Ut=H((sr,wt)=>{"use strict";var V=require("lodash"),rn=Je(),Ft=Qe(),w=Ze(),{DualityViewDdlCreatorFactory:sn}=mt(),{DualityViewSyntaxType:an}=Ce(),{DbVersion:on}=Ve(),{AlterIndexDto:nr}=pt(),{Sequence:rr}=ve(),pe=t(s=>Number.parseInt(s,10)<on.IF_NOT_EXISTS_SINCE,"shouldUseTryCatchIfNotExistsWrapper");wt.exports=(s,e,a)=>{var fe,ge;let l=t(r=>V.isArray(r)?r:[r],"toArray"),{tab:p,commentIfDeactivated:d,checkAllKeysDeactivated:o,divideIntoActivatedAndDeactivated:T,hasType:y,wrap:A,clean:h,getNamePrefixedWithSchemaNameForScriptFormat:O,wrapComment:U,getColumnsList:G,prepareNameForScriptFormat:X}=ce()(V),g=X((fe=e==null?void 0:e.targetScriptOptions)==null?void 0:fe.keyword),f=O((ge=e==null?void 0:e.targetScriptOptions)==null?void 0:ge.keyword),{assignTemplates:S}=Nt()({_:V}),L=Et()(V,h),{getColumnComments:N,getColumnConstraints:P,replaceTypeByVersion:q,getColumnDefault:v,getColumnEncrypt:M,decorateType:ee,canHaveIdentity:i}=bt()({_:V,wrap:A,assignTemplates:S,templates:w,commentIfDeactivated:d,wrapComment:U,prepareName:g}),{getTableType:$,getTableOptions:n,generateConstraintsString:u,foreignKeysToString:E,foreignActiveKeysToString:R,createKeyConstraint:x,customPropertiesForForeignKey:k}=It()({_:V,checkAllKeysDeactivated:o,getColumnsList:G,commentIfDeactivated:d,prepareName:g,assignTemplates:S}),{getUserDefinedType:j,isNotPlainType:m}=Ct()({_:V,commentIfDeactivated:d,assignTemplates:S,templates:w,getNamePrefixedWithSchemaName:f}),{getViewType:C,getViewData:K}=Rt()({_:V,prepareName:g}),{getIndexType:B,getIndexKeys:Z,getIndexOptions:J,getIndexName:te}=Kt()({_:V,prepareName:g}),se=t((r,c,b=955)=>{if(c){let I=p(p(r)),D=V.trim(I).replace(/;$/,"");return S(w.ifNotExists,{statement:D,errorCode:b})}return r+";"},"wrapIfNotExists"),{generateSynonymStatements:le}=Vt()({prepareName:g,templates:w,assignTemplates:S,getNamePrefixedWithSchemaName:f}),{getSequencesScript:ye,createSequenceScript:Ne,dropSequenceScript:Ie,alterSequenceScript:Ee}=Lt()({_:V,templates:w,assignTemplates:S,getNamePrefixedWithSchemaName:f,wrapIfNotExists:se});return{getDefaultType(r){return rn[r]},getTypesDescriptors(){return Ft},hasType(r){return y(Ft,r)},hydrateSchema(r,c){let b=V.get(c,"modelData.0.dbVersion");return{schemaName:r.name,ifNotExist:r.ifNotExist,dbVersion:b,synonyms:c.synonyms,sequences:c.sequences}},createSchema({schemaName:r,ifNotExist:c,dbVersion:b,sequences:I}){let _=`

`,D=";",W=g(r),Y=pe(b),z=S(w.createSchema,{schemaName:W,ifNotExists:!Y&&c?" IF NOT EXISTS":""}),ne=ye({schemaName:r,sequences:I,usingTryCatchWrapper:Y}),ie=ne?_+ne:"",Q=S(w.alterSession,{schemaName:W});return Y?se(z,c,1920)+ie:z+D+_+Q+ie},hydrateColumn({columnDefinition:r,jsonSchema:c,schemaData:b,definitionJsonSchema:I={}}){var Y;let _=b.dbVersion,D=!!c.$ref,W=D?r.type:V.toUpper(c.mode||c.type);return{name:r.name,type:W,ofType:c.ofType,notPersistable:c.notPersistable,size:c.size,primaryKey:L.isInlinePrimaryKey(c),primaryKeyOptions:c.primaryKeyOptions,unique:L.isInlineUnique(c),uniqueKeyOptions:c.uniqueKeyOptions,nullable:r.nullable,default:r.default,comment:c.refDescription||c.description||I.description,isActivated:r.isActivated,scale:r.scale,precision:r.precision,length:r.length,schemaName:b.schemaName,checkConstraints:c.checkConstraints,dbVersion:_,fractSecPrecision:c.fractSecPrecision,withTimeZone:c.withTimeZone,localTimeZone:c.localTimeZone,yearPrecision:c.yearPrecision,dayPrecision:c.dayPrecision,lengthSemantics:c.lengthSemantics,encryption:c.encryption,synonyms:((Y=b==null?void 0:b.synonyms)==null?void 0:Y.filter(z=>z.synonymEntityId===c.GUID))||[],isUDTRef:D,dimension:c.dimension,subtype:c.subtype,defaultOnNull:c.defaultOnNull,...i(c.mode)&&{identity:c.identity}}},hydrateJsonSchemaColumn(r,c){return!r.$ref||V.isEmpty(c)||m(c)?r:(r=V.omit(r,"$ref"),{...c,...r})},convertColumnDefinition(r,c=w.columnDefinition){let b=q(r.type,r.dbVersion);return d(S(c,{name:g(r.name),type:ee(b,r),default:v(r),encrypt:M(r),constraints:P(r)}),{isActivated:r.isActivated})},hydrateCheckConstraint(r){return{name:r.chkConstrName,expression:r.constrExpression,comments:r.constrComments,description:r.constrDescription}},createCheckConstraint({name:r,expression:c,comments:b,description:I}){return S(w.checkConstraint,{name:r?`CONSTRAINT ${g(r)} `:"",expression:V.trim(c).replace(/^\(([\s\S]*)\)$/,"$1")})},createForeignKeyConstraint({name:r,foreignKey:c,primaryTable:b,primaryKey:I,primaryTableActivated:_,foreignTableActivated:D,foreignSchemaName:W,primarySchemaName:Y,customProperties:z},ne,ie){let Q=o(I),re=o(c),oe=!Q&&!re&&_&&D,me=l(c),ue=l(I),{foreignOnDelete:de}=k(z),Te=S(w.createForeignKeyConstraint,{primaryTable:f(b,Y||ie.schemaName),name:r?`CONSTRAINT ${g(r)}`:"",foreignKey:oe?E(me):R(me),primaryKey:oe?E(ue):R(ue),onDelete:de?` ON DELETE ${de}`:""});return{statement:V.trim(Te),isActivated:oe}},createForeignKey({name:r,foreignTable:c,foreignKey:b,primaryTable:I,primaryKey:_,primaryTableActivated:D,foreignTableActivated:W,foreignSchemaName:Y,primarySchemaName:z,customProperties:ne},ie,Q){let re=o(_),oe=o(b),me=!re&&!oe&&D&&W,ue=l(b),de=l(_),{foreignOnDelete:Te}=k(ne),Se=S(w.createForeignKey,{primaryTable:f(I,z||Q.schemaName),foreignTable:f(c,Y||Q.schemaName),name:r?g(r):"",foreignKey:me?E(ue):R(ue),primaryKey:me?E(de):R(de),onDelete:Te?` ON DELETE ${Te}`:""});return{statement:V.trim(Se)+`
`,isActivated:me}},dropForeignKey(r,c){let b={tableName:r,fkConstraintName:c};return S(w.dropForeignKey,b)},hydrateTable({tableData:r,entityData:c,jsonSchema:b}){var W,Y;let I=c[0],_=V.first(I.partitioning)||{},D=L.getKeys(_.compositePartitionKey,b);return{...r,keyConstraints:L.getTableKeyConstraints(b),selectStatement:V.trim(I.selectStatement),partitioning:V.assign({},_,{compositePartitionKey:D}),...V.pick(I,"blockchain_table_clauses","duplicated","external","external_table_clause","immutable","sharded","storage","temporary","temporaryType","description","ifNotExist","tableProperties"),synonyms:((Y=(W=r==null?void 0:r.schemaData)==null?void 0:W.synonyms)==null?void 0:Y.filter(z=>z.synonymEntityId===b.GUID))||[]}},createTable({blockchain_table_clauses:r,checkConstraints:c,columnDefinitions:b,columns:I,duplicated:_,external:D,external_table_clause:W,foreignKeyConstraints:Y,keyConstraints:z,immutable:ne,name:ie,partitioning:Q,schemaData:re,selectStatement:oe,sharded:me,storage:ue,temporary:de,temporaryType:Te,description:Se,ifNotExist:He,tableProperties:Bt,synonyms:kt},$e){let be=f(ie,re.schemaName),je=Se?S(w.comment,{object:"TABLE",objectName:be,comment:U(Se)}):"",_t=T(z.map(x(w,$e)),Ae=>Ae.statement),vt=u(_t,$e),Dt=T(Y,Ae=>Ae.statement),Ht=u(Dt,$e),Ge=N(be,b),Ye=S(w.createTableProps,{columnDefinitions:V.join(I,`,
	`),foreignKeyConstraints:Ht,keyConstraints:vt,checkConstraints:V.isEmpty(c)?"":`,
	`+V.join(c,`,
	`)}),jt=le(kt,be,re.schemaName),Gt=je||Ge?`
`+je+Ge:"",Yt=re.dbVersion||"",We=pe(Yt),he=S(w.createTable,{name:be,ifNotExists:!We&&He?" IF NOT EXISTS":"",tableProps:Ye?`
(
	${Ye}
)`:"",tableType:$({duplicated:_,external:D,immutable:ne,sharded:me,temporary:de,temporaryType:Te,blockchain_table_clauses:r}),options:n({blockchain_table_clauses:r,external_table_clause:W,storage:ue,partitioning:Q,selectStatement:oe,tableProperties:Bt})});return We?he=se(he,He):he+=";",d(he+`${Gt}
`+jt,{isActivated:$e})},hydrateIndex(r,c,b){return{...r,schemaName:b.schemaName}},createIndex(r,c,b,I=!0){let _=te(c.indxName),D=B(c.indxType),W=Z(c),Y=J(c),z=e.dbVersion||"",ne=pe(z),ie=c.ifNotExist&&!ne,Q=S(w.createIndex,{indexType:D,ifNotExists:ie?" IF NOT EXISTS":"",name:_,keys:W,options:Y,tableName:f(r,c.schemaName)});return c.ifNotExist&&ne&&(Q=se(Q,!0)),ne?d(Q,{isActivated:c.isActivated}):d(Q,{isActivated:c.isActivated})},dropIndex({name:r}){return S(w.dropIndex,{name:r})},alterIndexRename({oldName:r,newName:c}){return S(w.alterIndexRename,{oldName:r,newName:c})},alterIndexRebuild({name:r,indexData:c}){let b=J(c);return S(w.alterIndexRebuild,{name:r,options:b})},hydrateViewColumn(r){return{name:r.name,tableName:r.entityName,alias:r.alias,isActivated:r.isActivated,dbName:r.dbName}},hydrateView({viewData:r,entityData:c,jsonSchema:b}){var _,D;let I=c[0];return{name:r.name,keys:r.keys,orReplace:I.or_replace,editionable:I.editionable,editioning:I.editioning,force:I.force,selectStatement:I.selectStatement,tableName:r.tableName,schemaName:r.schemaData.schemaName,description:I.description,ifNotExist:I.ifNotExist,materialized:I.materialized,sharing:I.sharing,duality:I.duality,rootTableAlias:I.rootTableAlias,tableTagsClause:I.tableTagsClause,viewProperties:I.materialized?I.mviewProperties:I.viewProperties,synonyms:((D=(_=r.schemaData)==null?void 0:_.synonyms)==null?void 0:D.filter(W=>W.synonymEntityId===b.GUID))||[],modelInfo:{dbVersion:V.get(r,"schemaData.dbVersion")},whereClause:I.whereClause}},hydrateViewIndex(r,c,b){var I;return{...r,schemaName:c.schemaName,materialized:(I=V.first(b))==null?void 0:I.materialized}},createViewIndex(r,c,b,I){let _=te(c.indxName),D=B(c.indxType),W=Z(c),Y=J(c,I);if(c.materialized)return d(S(w.createIndex,{indexType:D,name:_,keys:W,options:Y,tableName:f(r,c.schemaName)}),{isActivated:c.isActivated})},createView(r,c,b){let I=f(r.name,r.schemaName),{columns:_,tables:D}=K(r.keys),W=_.map(oe=>oe.statement).join(`,
		`),Y=r.description?`
`+S(w.comment,{object:"TABLE",objectName:I,comment:U(r.description)})+`
`:`
`,z=V.trim(r.selectStatement)?V.trim(p(r.selectStatement)):S(w.viewSelectStatement,{tableName:D.join(", "),keys:W}),ne=le(r.synonyms,I,r.schemaName),ie=V.get(r,"modelInfo.dbVersion",""),Q=pe(ie),re=S(w.createView,{name:I,ifNotExists:!Q&&r.ifNotExist?" IF NOT EXISTS":"",orReplace:r.orReplace&&!r.materialized?" OR REPLACE":"",force:r.force&&!r.materialized?" FORCE":"",materialized:r.materialized?" MATERIALIZED":"",viewType:r.materialized?"":C(r),viewProperties:r.viewProperties?` 
`+p(r.viewProperties):"",sharing:r.sharing&&!r.materialized?` SHARING=${r.sharing}`:"",selectStatement:z});return Q?re=se(re,r.ifNotExist):re+=";",d(re+Y+ne,{isActivated:b})},createDualityView({jsonSchema:r,view:c,relatedSchemas:b}){return sn.getCreatorInstance(an.SQL,{ddlTemplates:w,assignTemplates:S,lodash:V,prepareName:g,getNamePrefixedWithSchemaName:f}).convertDualityViewToDdl({view:c,jsonSchema:r,relatedSchemas:b})},createUdt(r){let c=le(r.synonyms,f(r.name,r.schemaName),r.schemaName);return d(j(r,this.convertColumnDefinition)+c,{isActivated:r.isActivated})},commentIfDeactivated(r,c,b){return r},renameColumn(r,c,b){return S(w.renameColumn,{tableName:r,oldColumnName:c,newColumnName:b})},createSchemaSequence({schemaName:r,sequence:c}){let b=pe(e==null?void 0:e.dbVersion);return Ne({schemaName:r,sequence:c,usingTryCatchWrapper:b})},dropSchemaSequence({schemaName:r,sequence:c}){let b=pe(e==null?void 0:e.dbVersion);return Ie({schemaName:r,sequence:c,usingTryCatchWrapper:b})},alterSchemaSequence({schemaName:r,sequence:c,oldSequence:b}){let I=pe(e==null?void 0:e.dbVersion);return Ee({schemaName:r,sequence:c,oldSequence:b,usingTryCatchWrapper:I})}}}});module.exports=Ut();
