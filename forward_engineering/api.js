"use strict";var jP=Object.defineProperty;var _=(r,e)=>jP(r,"name",{value:e,configurable:!0});var jE=r=>e=>{var t=r[e];if(t)return t();throw new Error("Module not found in bundle: "+e)};var JP=(r,e)=>()=>(r&&(e=r(r=0)),e);var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var JE=m(($B,ZP)=>{ZP.exports={name:"Oracle",version:"0.2.17",author:"hackolade",engines:{hackolade:"7.7.10",hackoladePlugin:"1.2.0"},contributes:{target:{applicationTarget:"Oracle",title:"Oracle",versions:["12c","18c","19c","21c","23ai"]},features:{nestedCollections:!1,disablePatternField:!0,disableMultipleTypes:!0,enableForwardEngineering:!0,disableReverseEngineering:!1,disableChoices:!0,enableJsonType:!0,useJsonTypesWithComplexTypes:!0,reverseSchemaIntoOneColumn:!0,disableDenormalization:!0,enableComplexTypesNormalization:!0,restrictNestedFieldsAsPrimaryKey:!1,views:{enabled:!0,viewLevel:"model",disablePipelines:!0},relationships:{compositeRelationships:{allowRelationshipsByProperties:["primaryKey","unique","compositeUniqueKey","compositePrimaryKey"]}},enableFetchSystemEntitiesCheckbox:!0,discoverRelationships:!0,enableKeysMultipleAbrr:!0}},description:"Hackolade plugin for Oracle and Autonomous databases",disabled:!1,dependencies:{"adm-zip":"0.5.9",async:"3.2.6",lodash:"4.17.21",oracledb:"6.6.0",perplex:"0.11.0"},"lint-staged":{"*.{js,json}":"prettier --write"},"simple-git-hooks":{"pre-commit":"npx lint-staged","pre-push":"npx eslint ."},scripts:{lint:"eslint . --max-warnings=0",package:"node esbuild.package.js"},devDependencies:{"@hackolade/hck-esbuild-plugins-pack":"0.0.1","@typescript-eslint/eslint-plugin":"7.11.0","@typescript-eslint/parser":"7.11.0",esbuild:"0.20.2","esbuild-plugin-clean":"1.0.1","esbuild-plugin-copy":"2.1.1",eslint:"8.57.0","eslint-config-prettier":"9.1.0","eslint-formatter-teamcity":"^1.0.0","eslint-plugin-import":"^2.26.0","eslint-plugin-prettier":"5.1.3","eslint-plugin-unused-imports":"3.2.0","lint-staged":"15.2.10",prettier:"3.2.5","simple-git-hooks":"2.11.1"}}});var eu=m((QB,ZE)=>{"use strict";var ns=require("os"),eR=JE(),tR=_(r=>r<10?"0"+r:r,"prefixZero"),sR=_(r=>r.reduce((e,t)=>Math.max(e,t.speed),0),"maxClock"),rR=_(r=>Math.floor(r/3600)+":"+tR(parseInt((r/3600-Math.floor(r/3600))*60)),"toTime"),nR=_(()=>eR.version,"getPluginVersion"),iR=_(r=>`Date: ${new Date}
Application version: ${r}
Plugin version: ${nR()}

System information:
 Hostname:  ${ns.hostname()}
 Platform:  ${ns.platform()} ${ns.arch()}
 Release:   ${ns.release()}
 Uptime:    ${rR(ns.uptime())}
 Total RAM: ${(ns.totalmem()/1073741824).toFixed(2)} GB
 CPU Model: ${ns.cpus()[0].model}
 CPU Clock: ${sR(ns.cpus())} MHZ
 CPU Cores: ${ns.cpus().length} cores

`,"getSystemInfo"),oR=_((r,e,t)=>{t.clear(),t.log("info",iR(e.appVersion),r),t.log("info",e,"connectionInfo",e.hiddenKeys)},"logInfo");ZE.exports=oR});var su=m((JB,tu)=>{tu.exports={VERSION_MAJOR:6,VERSION_MINOR:6,VERSION_PATCH:0,VERSION_SUFFIX:""}});var nt=m((ZB,nu)=>{"use strict";var ps=su(),ru=ps.VERSION_MAJOR+"."+ps.VERSION_MINOR+"."+ps.VERSION_PATCH+ps.VERSION_SUFFIX;nu.exports={VERSION_MAJOR:ps.VERSION_MAJOR,VERSION_MINOR:ps.VERSION_MINOR,VERSION_PATCH:ps.VERSION_PATCH,VERSION_SUFFIX:ps.VERSION_SUFFIX,VERSION_STRING:ru,DEFAULT_DRIVER_NAME:"node-oracledb : "+ru,DEFAULT_ERROR_URL:"https://node-oracledb.readthedocs.io/en/latest/user_guide/installation.html",DEFAULT_MAX_SIZE_FOR_OUT_BINDS:200,CSFRM_IMPLICIT:1,CSFRM_NCHAR:2,CQN_OPCODE_ALL_OPS:0,CQN_OPCODE_ALL_ROWS:1,CQN_OPCODE_ALTER:16,CQN_OPCODE_DELETE:8,CQN_OPCODE_DROP:32,CQN_OPCODE_INSERT:2,CQN_OPCODE_UPDATE:4,DEFAULT:0,STMT_TYPE_UNKNOWN:0,STMT_TYPE_SELECT:1,STMT_TYPE_UPDATE:2,STMT_TYPE_DELETE:3,STMT_TYPE_INSERT:4,STMT_TYPE_CREATE:5,STMT_TYPE_DROP:6,STMT_TYPE_ALTER:7,STMT_TYPE_BEGIN:8,STMT_TYPE_DECLARE:9,STMT_TYPE_CALL:10,STMT_TYPE_EXPLAIN_PLAN:15,STMT_TYPE_MERGE:16,STMT_TYPE_ROLLBACK:17,STMT_TYPE_COMMIT:21,SHUTDOWN_MODE_DEFAULT:0,SHUTDOWN_MODE_TRANSACTIONAL:1,SHUTDOWN_MODE_TRANSACTIONAL_LOCAL:2,SHUTDOWN_MODE_IMMEDIATE:3,SHUTDOWN_MODE_ABORT:4,SHUTDOWN_MODE_FINAL:5,STARTUP_MODE_DEFAULT:0,STARTUP_MODE_FORCE:1,STARTUP_MODE_RESTRICT:2,SUBSCR_EVENT_TYPE_SHUTDOWN:2,SUBSCR_EVENT_TYPE_SHUTDOWN_ANY:3,SUBSCR_EVENT_TYPE_STARTUP:1,SUBSCR_EVENT_TYPE_DEREG:5,SUBSCR_EVENT_TYPE_OBJ_CHANGE:6,SUBSCR_EVENT_TYPE_QUERY_CHANGE:7,SUBSCR_EVENT_TYPE_AQ:100,SUBSCR_GROUPING_CLASS_TIME:1,SUBSCR_GROUPING_TYPE_SUMMARY:1,SUBSCR_GROUPING_TYPE_LAST:2,SUBSCR_NAMESPACE_AQ:1,SUBSCR_NAMESPACE_DBCHANGE:2,SUBSCR_QOS_BEST_EFFORT:16,SUBSCR_QOS_DEREG_NFY:2,SUBSCR_QOS_QUERY:8,SUBSCR_QOS_RELIABLE:1,SUBSCR_QOS_ROWIDS:4,SYSASM:32768,SYSBACKUP:131072,SYSDBA:2,SYSDG:262144,SYSKM:524288,SYSOPER:4,SYSPRELIM:8,SYSRAC:1048576,BIND_IN:3001,BIND_INOUT:3002,BIND_OUT:3003,OUT_FORMAT_ARRAY:4001,OUT_FORMAT_OBJECT:4002,SODA_COLL_MAP_MODE:5001,POOL_STATUS_OPEN:6e3,POOL_STATUS_DRAINING:6001,POOL_STATUS_CLOSED:6002,POOL_STATUS_RECONFIGURING:6003,PURITY_DEFAULT:0,PURITY_NEW:1,PURITY_SELF:2,AQ_DEQ_NO_WAIT:0,AQ_DEQ_WAIT_FOREVER:4294967295,AQ_DEQ_MODE_BROWSE:1,AQ_DEQ_MODE_LOCKED:2,AQ_DEQ_MODE_REMOVE:3,AQ_DEQ_MODE_REMOVE_NO_DATA:4,AQ_DEQ_NAV_FIRST_MSG:1,AQ_DEQ_NAV_NEXT_TRANSACTION:2,AQ_DEQ_NAV_NEXT_MSG:3,AQ_MSG_DELIV_MODE_PERSISTENT:1,AQ_MSG_DELIV_MODE_BUFFERED:2,AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED:3,AQ_MSG_STATE_READY:0,AQ_MSG_STATE_WAITING:1,AQ_MSG_STATE_PROCESSED:2,AQ_MSG_STATE_EXPIRED:3,AQ_VISIBILITY_IMMEDIATE:1,AQ_VISIBILITY_ON_COMMIT:2,TPC_BEGIN_JOIN:2,TPC_BEGIN_NEW:1,TPC_BEGIN_PROMOTE:8,TPC_BEGIN_RESUME:4,TPC_END_NORMAL:0,TPC_END_SUSPEND:1048576,VECTOR_FORMAT_FLOAT32:2,VECTOR_FORMAT_FLOAT64:3,VECTOR_FORMAT_INT8:4,VECTOR_FORMAT_BINARY:5}});var Tt=m((e0,au)=>{"use strict";var as=nt(),or=W(),aR=require("util"),iu=new Map,ou=new Map,Mt=new Map,Eo=class Eo{constructor(e,t,s,n){this.num=e,this.name=t,this.columnTypeName=s,this._bufferSizeFactor=n.bufferSizeFactor||0,this._oraTypeNum=n.oraTypeNum||0,this._csfrm=n.csfrm||0,iu.set(e,this);let i=(n.csfrm||0)*256+n.oraTypeNum;ou.set(i,this),Mt.set(s,this)}[Symbol.toPrimitive](e){switch(e){case"number":return this.num;default:return this.toString()}}[aR.inspect.custom](){return this.toString()}toString(){return`[DbType ${this.name}]`}};_(Eo,"DbType");var _e=Eo;function _R(r){let e=Mt.get(r);return e||or.throwErr(or.ERR_UNKNOWN_COLUMN_TYPE_NAME,r),e}_(_R,"getTypeByColumnTypeName");function cR(r){let e=iu.get(r);return e||or.throwErr(or.ERR_INVALID_TYPE_NUM,r),e}_(cR,"getTypeByNum");function TR(r,e){let t=(e||0)*256+r,s=ou.get(t);return s||or.throwErr(or.ERR_INVALID_ORACLE_TYPE_NUM,r,e),s}_(TR,"getTypeByOraTypeNum");var io=new _e(2020,"DB_TYPE_BFILE","BFILE",{oraTypeNum:114,bufferSizeFactor:4e3}),fn=new _e(2008,"DB_TYPE_BINARY_DOUBLE","BINARY_DOUBLE",{oraTypeNum:101,bufferSizeFactor:8}),mn=new _e(2007,"DB_TYPE_BINARY_FLOAT","BINARY_FLOAT",{oraTypeNum:100,bufferSizeFactor:4}),Mr=new _e(2009,"DB_TYPE_BINARY_INTEGER","BINARY_INTEGER",{oraTypeNum:3,bufferSizeFactor:22}),Pn=new _e(2019,"DB_TYPE_BLOB","BLOB",{oraTypeNum:113,bufferSizeFactor:112}),Rn=new _e(2022,"DB_TYPE_BOOLEAN","BOOLEAN",{oraTypeNum:252,bufferSizeFactor:4}),sr=new _e(2003,"DB_TYPE_CHAR","CHAR",{oraTypeNum:96,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:4}),rr=new _e(2017,"DB_TYPE_CLOB","CLOB",{oraTypeNum:112,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:112}),oo=new _e(2021,"DB_TYPE_CURSOR","CURSOR",{oraTypeNum:102,bufferSizeFactor:4}),In=new _e(2011,"DB_TYPE_DATE","DATE",{oraTypeNum:12,bufferSizeFactor:7}),ao=new _e(2015,"DB_TYPE_INTERVAL_DS","INTERVAL DAY TO SECOND",{oraTypeNum:183,bufferSizeFactor:11}),_o=new _e(2016,"DB_TYPE_INTERVAL_YM","INTERVAL YEAR TO MONTH",{oraTypeNum:182}),Dn=new _e(2027,"DB_TYPE_JSON","JSON",{oraTypeNum:119}),Yt=new _e(2024,"DB_TYPE_LONG","LONG",{oraTypeNum:8,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:2**31-1}),fs=new _e(2031,"DB_TYPE_LONG_NVARCHAR","LONG",{oraTypeNum:8,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:2**31-1}),ms=new _e(2025,"DB_TYPE_LONG_RAW","LONG RAW",{oraTypeNum:24,bufferSizeFactor:2**31-1}),Ps=new _e(2004,"DB_TYPE_NCHAR","NCHAR",{oraTypeNum:96,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:4}),Cn=new _e(2018,"DB_TYPE_NCLOB","NCLOB",{oraTypeNum:112,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:112}),os=new _e(2010,"DB_TYPE_NUMBER","NUMBER",{oraTypeNum:2,bufferSizeFactor:22}),is=new _e(2002,"DB_TYPE_NVARCHAR","NVARCHAR2",{oraTypeNum:1,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:4}),co=new _e(2023,"DB_TYPE_OBJECT","OBJECT",{oraTypeNum:109}),nr=new _e(2006,"DB_TYPE_RAW","RAW",{oraTypeNum:23,bufferSizeFactor:1}),ir=new _e(2005,"DB_TYPE_ROWID","ROWID",{oraTypeNum:11,bufferSizeFactor:18}),On=new _e(2012,"DB_TYPE_TIMESTAMP","TIMESTAMP",{oraTypeNum:180,bufferSizeFactor:11}),zt=new _e(2014,"DB_TYPE_TIMESTAMP_LTZ","TIMESTAMP WITH LOCAL TIME ZONE",{oraTypeNum:231,bufferSizeFactor:11}),Rs=new _e(2013,"DB_TYPE_TIMESTAMP_TZ","TIMESTAMP WITH TIME ZONE",{oraTypeNum:181,bufferSizeFactor:13}),gn=new _e(2030,"DB_TYPE_UROWID","UROWID",{oraTypeNum:208}),ue=new _e(2001,"DB_TYPE_VARCHAR","VARCHAR2",{oraTypeNum:1,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:4}),To=new _e(2032,"DB_TYPE_XMLTYPE","XMLTYPE",{oraTypeNum:109,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:2147483647}),yn=new _e(2033,"DB_TYPE_VECTOR","VECTOR",{oraTypeNum:127}),lR=new Map([[fn,new Map([[ue,ue]])],[mn,new Map([[ue,ue]])],[Pn,new Map([[nr,ms],[ms,ms]])],[sr,new Map([[ue,ue]])],[rr,new Map([[ue,Yt],[Yt,Yt]])],[In,new Map([[ue,ue],[zt,zt]])],[Dn,new Map([[ue,ue]])],[Yt,new Map([[ue,Yt]])],[ms,new Map([[nr,ms]])],[Ps,new Map([[sr,Ps],[ue,is],[is,is]])],[Cn,new Map([[ue,fs],[is,fs],[Yt,fs],[fs,fs]])],[os,new Map([[ue,ue]])],[is,new Map([[sr,Ps],[Ps,Ps],[ue,is]])],[nr,new Map([[ue,ue]])],[ir,new Map([[ue,ir]])],[On,new Map([[ue,ue],[zt,zt]])],[zt,new Map([[ue,ue],[Rs,Rs]])],[Rs,new Map([[ue,ue],[zt,zt]])],[gn,new Map([[ue,ir]])],[yn,new Map([[ue,Yt],[Yt,Yt],[rr,rr]])]]),ER=new Map([[io,io],[fn,fn],[mn,mn],[Mr,Mr],[Pn,Pn],[Rn,Rn],[sr,sr],[rr,rr],[oo,oo],[In,In],[ao,ao],[_o,_o],[Dn,Dn],[Yt,Yt],[fs,fs],[ms,ms],[Ps,Ps],[Cn,Cn],[os,os],[is,is],[co,co],[nr,nr],[ir,ir],[On,On],[zt,Rs],[Rs,Rs],[gn,gn],[ue,ue],[To,To],[yn,yn]]);Mt.set("DOUBLE PRECISION",os);Mt.set("FLOAT",os);Mt.set("INTEGER",os);Mt.set("PL/SQL BOOLEAN",Rn);Mt.set("PL/SQL BINARY INTEGER",Mr);Mt.set("PL/SQL PLS INTEGER",Mr);Mt.set("REAL",os);Mt.set("SMALLINT",os);Mt.set("TIMESTAMP WITH LOCAL TZ",zt);Mt.set("TIMESTAMP WITH TZ",Rs);var uo=class uo extends Uint8Array{toJSON(){return Buffer.from(this.buffer).toString("hex")}};_(uo,"JsonId");var lo=uo;au.exports={DbType:_e,DB_TYPE_BFILE:io,DB_TYPE_BINARY_DOUBLE:fn,DB_TYPE_BINARY_FLOAT:mn,DB_TYPE_BINARY_INTEGER:Mr,DB_TYPE_BLOB:Pn,DB_TYPE_BOOLEAN:Rn,DB_TYPE_CHAR:sr,DB_TYPE_CLOB:rr,DB_TYPE_CURSOR:oo,DB_TYPE_DATE:In,DB_TYPE_INTERVAL_DS:ao,DB_TYPE_INTERVAL_YM:_o,DB_TYPE_JSON:Dn,DB_TYPE_LONG:Yt,DB_TYPE_LONG_NVARCHAR:fs,DB_TYPE_LONG_RAW:ms,DB_TYPE_NCHAR:Ps,DB_TYPE_NCLOB:Cn,DB_TYPE_NUMBER:os,DB_TYPE_NVARCHAR:is,DB_TYPE_OBJECT:co,DB_TYPE_RAW:nr,DB_TYPE_ROWID:ir,DB_TYPE_TIMESTAMP:On,DB_TYPE_TIMESTAMP_LTZ:zt,DB_TYPE_TIMESTAMP_TZ:Rs,DB_TYPE_UROWID:gn,DB_TYPE_VARCHAR:ue,DB_TYPE_VECTOR:yn,DB_TYPE_CONVERSION_MAP:lR,DB_TYPE_FETCH_TYPE_MAP:ER,DB_TYPE_XMLTYPE:To,getTypeByColumnTypeName:_R,getTypeByNum:cR,getTypeByOraTypeNum:TR,JsonId:lo}});var _u=m((s0,uR)=>{uR.exports={name:"oracledb",version:"6.6.0",description:"A Node.js module for Oracle Database access from JavaScript and TypeScript",license:"(Apache-2.0 OR UPL-1.0)",homepage:"http://oracle.github.io/node-oracledb/",keywords:["Oracle","Database","official","DB","SQL","JSON","PL/SQL","SODA","OCI","API","client","library","driver","add-on","extension","binding","interface","adapter","module"],repository:{type:"git",url:"git://github.com/oracle/node-oracledb.git"},scripts:{install:"node package/install.js",prune:"node package/prunebinaries.js"},engines:{node:">=14.6"},maintainers:[{name:"Oracle Corp."}],bugs:{url:"https://github.com/oracle/node-oracledb/issues"},main:"./index.js"}});var et=m((r0,hu)=>{"use strict";var{Buffer:cs}=require("buffer"),ke=W(),Rt=require("process"),hR=require("util"),NR=Tt(),_s=nt(),cu;try{cu=_u()}catch{ke.throwErr(ke.ERR_MISSING_FILE,"package.json")}var Tu=cu.version,SR="build/Release",AR="oracledb-"+Tu+"-"+Rt.platform+"-"+Rt.arch+".node",dR="oracledb.node",pR="package/Staging";function lu(){return"Node-oracledb installation instructions: https://node-oracledb.readthedocs.io/en/latest/user_guide/installation.html"}_(lu,"getInstallURL");function fR(){let r,e,t=lu()+`
`;return Rt.platform==="linux"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html
`,r="64-bit"):Rt.arch==="x32"?(e=`https://www.oracle.com/database/technologies/instant-client/linux-x86-32-downloads.html
`,r="32-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,r=Rt.arch),t+="You must have Linux "+r+` Oracle Client libraries configured with ldconfig, or in LD_LIBRARY_PATH.
`,t+=`If you do not have Oracle Database on this computer, then install the Instant Client Basic or Basic Light package from 
`,t+=e):Rt.platform==="darwin"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/macos-intel-x86-downloads.html
`,r="64-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,r=Rt.arch),t+="You must have macOS "+r+` Oracle Instant Client Basic or Basic Light package libraries in
`,t+=`/usr/local/lib or set by calling oracledb.initOracleClient({libDir: "/my/instant_client_directory"}).
`,t+="Oracle Instant Client can be downloaded from "+e):Rt.platform==="win32"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html
`,r="64-bit"):Rt.arch==="x32"?(e=`https://www.oracle.com/database/technologies/instant-client/microsoft-windows-32-downloads.html
`,r="32-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,r=Rt.arch),t+="You must have Windows "+r+` Oracle Client libraries in your PATH environment variable.
`,t+=`If you do not have Oracle Database on this computer, then install the Instant Client Basic or Basic Light package from
`,t+=e,t+=`A Microsoft Visual Studio Redistributable suitable for your Oracle client library version must be available.
`):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,t+="You must have "+Rt.arch+` Oracle Client libraries in your operating system library search path.
`,t+=`If you do not have Oracle Database on this computer, then install an Instant Client Basic or Basic Light package from: 
`,t+=e),t}_(fR,"getInstallHelp");function ho(r){let e=_(function(){if(typeof arguments[arguments.length-1]!="function")return r.apply(this,arguments).catch(_(function n(i){throw ke.transformErr(i,n)},"stackCapture"));let t=Array.prototype.slice.call(arguments,0,arguments.length-1),s=arguments[arguments.length-1];r.apply(this,t).then(function(n){s(null,n)},_(function n(i){s(ke.transformErr(i,n))},"stackCapture"))},"wrapper");return r.name&&Object.defineProperty(e,"name",{value:r.name}),e}_(ho,"callbackify");function No(r){return async function(){let e;this._impl&&(e=this._impl._getConnImpl(),await e._acquireLock());try{return await r.apply(this,arguments)}finally{e&&e._releaseLock()}}}_(No,"serialize");function Eu(r,e){return async function(){this._isActive&&ke.throwErr(e),this._isActive=!0;try{return await r.apply(this,arguments)}finally{this._isActive=!1}}}_(Eu,"preventConcurrent");function mR(r){let e=1,t;typeof arguments[1]=="number"&&(e=2,t=arguments[1]);for(let s=e;s<arguments.length;s++){let n=arguments[s],i=r[n];t?r[n]=ho(Eu(No(i),t)):r[n]=ho(No(i))}}_(mR,"wrapFns");function PR(r){if(!Array.isArray(r))return!1;for(let e=0;e<r.length;e++)if(typeof r[e]!="string")return!1;return!0}_(PR,"isArrayOfStrings");function Ao(r){return r!==null&&typeof r=="object"}_(Ao,"isObject");function RR(r){return r!==null&&typeof r=="object"||Array.isArray(r)}_(RR,"isObjectOrArray");function IR(r){return r&_s.SYSPRELIM&&(r=r^_s.SYSPRELIM),r===_s.SYSASM||r===_s.SYSBACKUP||r===_s.SYSDBA||r===_s.SYSDG||r===_s.SYSKM||r===_s.SYSOPER||r===_s.SYSRAC}_(IR,"isPrivilege");function DR(r){if(!Array.isArray(r))return!1;for(let e=0;e<r.length;e++){let t=r[e];if(!(typeof t=="string"||typeof t=="number"||cs.isBuffer(t)||hR.types.isDate(t)))return!1}return!0}_(DR,"isShardingKey");function uu(r){return r!=null&&r._sodaDocumentMarker}_(uu,"isSodaDocument");function CR(r){return Ao(r)&&Number.isInteger(r.formatId)&&(cs.isBuffer(r.globalTransactionId)||typeof r.globalTransactionId=="string")&&(cs.isBuffer(r.branchQualifier)||typeof r.branchQualifier=="string")}_(CR,"isXid");function OR(r){let e;return cs.isBuffer(r.globalTransactionId)&&cs.isBuffer(r.branchQualifier)?e=r:(e={formatId:r.formatId,globalTransactionId:r.globalTransactionId,branchQualifier:r.branchQualifier},typeof r.globalTransactionId=="string"&&(e.globalTransactionId=cs.from(r.globalTransactionId)),typeof r.branchQualifier=="string"&&(e.branchQualifier=cs.from(r.branchQualifier))),e.globalTransactionId.length>64&&ke.throwErr(ke.ERR_INVALID_TRANSACTION_SIZE,e.globalTransactionId.length),e.branchQualifier.length>64&&ke.throwErr(ke.ERR_INVALID_BRANCH_SIZE,e.branchQualifier.length),e}_(OR,"normalizeXid");function gR(r){return uu(r)?r._impl:(ke.assertParamValue(Ao(r),1),cs.from(JSON.stringify(r)))}_(gR,"verifySodaDoc");function So(r){ke.assert(typeof r=="string",ke.ERR_TOKEN_BASED_AUTH),r.split(".")[1]===void 0&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH);let t=r.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=cs.from(t,"base64").toString("ascii"),i=JSON.parse(n).exp;return ke.assert(i!=null,ke.ERR_TOKEN_BASED_AUTH),i=i*1e3,new Date().getTime()>i}_(So,"isTokenExpired");function yR(r){switch(typeof r){case"string":return r===""&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH),!So(r);case"object":return(r.token===void 0||r.token===""||r.privateKey===void 0||r.privateKey==="")&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH),!So(r.token);default:ke.throwErr(ke.ERR_TOKEN_BASED_AUTH)}}_(yR,"isTokenValid");function LR(r){return r=r.replace(/\n/g,""),r=r.replace("-----BEGIN PRIVATE KEY-----",""),r=r.replace("-----END PRIVATE KEY-----",""),r}_(LR,"denormalizePrivateKey");function wR(r,e){let t=e+"Class",s=e+"Name",n=r[t],i=r[e];typeof i=="number"&&(i=r[e]=NR.getTypeByNum(i)),n?r[s]=n.prototype.fqn:i&&(r[s]=i.columnTypeName)}_(wR,"addTypeProperties");function BR(r){return r instanceof Float32Array||r instanceof Float64Array||r instanceof Int8Array||Object.getPrototypeOf(r)===Uint8Array.prototype}_(BR,"isVectorValue");function UR(r,e,t,s,n,i,a,c,T){return r?new Date(e,t-1,s,n,i,a,c):new Date(Date.UTC(e,t-1,s,n,i,a,c)-T*6e4)}_(UR,"makeDate");hu.exports={BINARY_FILE:AR,BUILD_FILE:dR,PACKAGE_JSON_VERSION:Tu,RELEASE_DIR:SR,STAGING_DIR:pR,addTypeProperties:wR,callbackify:ho,denormalizePrivateKey:LR,getInstallURL:lu,getInstallHelp:fR,isArrayOfStrings:PR,isObject:Ao,isObjectOrArray:RR,isPrivilege:IR,isShardingKey:DR,isSodaDocument:uu,isTokenExpired:So,isTokenValid:yR,isVectorValue:BR,isXid:CR,normalizeXid:OR,makeDate:UR,preventConcurrent:Eu,serialize:No,verifySodaDoc:gR,wrapFns:mR}});var Fr=m((i0,Nu)=>{"use strict";var Vr=nt();Nu.exports={TNS_VECTOR_MAGIC_BYTE:219,TNS_VECTOR_VERSION_BASE:0,TNS_VECTOR_VERSION_WITH_BINARY:1,TNS_VECTOR_FLAG_NORMSRC:16,TNS_VECTOR_FLAG_NORM:2,TNS_JSON_MAGIC_BYTE_1:255,TNS_JSON_MAGIC_BYTE_2:74,TNS_JSON_MAGIC_BYTE_3:90,TNS_JSON_VERSION_MAX_FNAME_255:1,TNS_JSON_VERSION_MAX_FNAME_65535:3,TNS_JSON_FLAG_HASH_ID_UINT8:256,TNS_JSON_FLAG_HASH_ID_UINT16:512,TNS_JSON_FLAG_NUM_FNAMES_UINT16:1024,TNS_JSON_FLAG_FNAMES_SEG_UINT32:2048,TNS_JSON_FLAG_TINY_NODES_STAT:8192,TNS_JSON_FLAG_TREE_SEG_UINT32:4096,TNS_JSON_FLAG_REL_OFFSET_MODE:1,TNS_JSON_FLAG_INLINE_LEAF:2,TNS_JSON_FLAG_LEN_IN_PCODE:4,TNS_JSON_FLAG_NUM_FNAMES_UINT32:8,TNS_JSON_FLAG_IS_SCALAR:16,TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16:256,TNS_JSON_TYPE_NULL:48,TNS_JSON_TYPE_TRUE:49,TNS_JSON_TYPE_FALSE:50,TNS_JSON_TYPE_STRING_LENGTH_UINT8:51,TNS_JSON_TYPE_NUMBER_LENGTH_UINT8:52,TNS_JSON_TYPE_BINARY_DOUBLE:54,TNS_JSON_TYPE_STRING_LENGTH_UINT16:55,TNS_JSON_TYPE_STRING_LENGTH_UINT32:56,TNS_JSON_TYPE_TIMESTAMP:57,TNS_JSON_TYPE_BINARY_LENGTH_UINT16:58,TNS_JSON_TYPE_BINARY_LENGTH_UINT32:59,TNS_JSON_TYPE_DATE:60,TNS_JSON_TYPE_INTERVAL_YM:61,TNS_JSON_TYPE_INTERVAL_DS:62,TNS_JSON_TYPE_TIMESTAMP_TZ:124,TNS_JSON_TYPE_TIMESTAMP7:125,TNS_JSON_TYPE_BINARY_FLOAT:127,TNS_JSON_TYPE_OBJECT:132,TNS_JSON_TYPE_ARRAY:192,TNS_JSON_TYPE_EXTENDED:123,TNS_JSON_TYPE_VECTOR:1,TNS_JSON_TYPE_ID:126,TZ_HOUR_OFFSET:20,TZ_MINUTE_OFFSET:60,TNS_MAX_SHORT_LENGTH:252,TNS_DURATION_MID:2147483648,TNS_DURATION_OFFSET:60,TNS_CHUNK_SIZE:32767,TNS_HAS_REGION_ID:128,NUMBER_MAX_DIGITS:40,BUFFER_CHUNK_SIZE:65536,CSFRM_IMPLICIT:Vr.CSFRM_IMPLICIT,VECTOR_FORMAT_FLOAT32:Vr.VECTOR_FORMAT_FLOAT32,VECTOR_FORMAT_FLOAT64:Vr.VECTOR_FORMAT_FLOAT64,VECTOR_FORMAT_INT8:Vr.VECTOR_FORMAT_INT8,VECTOR_FORMAT_BINARY:Vr.VECTOR_FORMAT_BINARY,TNS_NULL_LENGTH_INDICATOR:255,TNS_LONG_LENGTH_INDICATOR:254}});var ar=m((o0,Au)=>{"use strict";var{Buffer:$t}=require("buffer"),Vt=Fr(),It=W(),Su=Tt(),YR=et(),fo=class fo{constructor(e){typeof e=="number"?(this.buf=$t.alloc(e),this.size=0,this.maxSize=e):e&&(this.buf=e,this.size=this.maxSize=e.length),this.pos=0}_grow(e){It.throwErr(It.ERR_BUFFER_LENGTH_INSUFFICIENT,this.numBytesLeft(),e)}_readBytesWithLength(e){return this.readBytes(e)}_readInteger(e,t,s){let n=!1,i=this.readUInt8();if(i===0)return 0;if(i&128&&(t||It.throwErr(It.ERR_UNEXPECTED_NEGATIVE_INTEGER,this.pos,this.packetNum),n=!0,i=i&127),i>e&&It.throwErr(It.ERR_INTEGER_TOO_LARGE,i,e,this.pos,this.packetNum),s)this.skipBytes(i);else{let c=this.readBytes(i).readUIntBE(0,i);return n?-c:c}}numBytesLeft(){return this.size-this.pos}parseBinaryDouble(e){return e=$t.from(e),e[0]&128?e[0]&=127:(e[0]^=255,e[1]^=255,e[2]^=255,e[3]^=255,e[4]^=255,e[5]^=255,e[6]^=255,e[7]^=255),e.readDoubleBE()}parseBinaryFloat(e){return e=$t.from(e),e[0]&128?e[0]&=127:(e[0]^=255,e[1]^=255,e[2]^=255,e[3]^=255),e.readFloatBE()}parseOracleDate(e,t=!0){let s=0;e.length>=11&&(s=Math.floor(e.readUInt32BE(7)/(1e3*1e3)));let n=(e[0]-100)*100+e[1]-100;return YR.makeDate(t,n,e[2],e[3],e[4]-1,e[5]-1,e[6]-1,s,0)}parseOracleNumber(e){let t=e[0],s=!!(t&128);s||(t=t^255),t-=193;let n=t*2+2;if(e.length===1)return s?"0":"-1e126";let i=e.length;!s&&e[e.length-1]===102&&(i-=1);let a,c=[];for(let l=1;l<i;l++){s?a=e[l]-1:a=101-e[l];let E=Math.floor(a/10);E===0&&l===1?n-=1:E===10?(c.push("1"),c.push("0"),n+=1):(E!==0||l>1)&&c.push(E.toString()),E=a%10,(E!==0||l<i-1)&&c.push(E.toString())}let T=[];s||T.push("-"),n<=0&&(T.push("."),n<0&&T.push("0".repeat(-n)));for(let l=0;l<c.length;l++)l>0&&l===n&&T.push("."),T.push(c[l]);if(n>c.length)for(let l=c.length;l<n;l++)T.push("0");return T.join("")}readBinaryDouble(){let e=this.readBytesWithLength();return e?this.parseBinaryDouble(e):null}readBinaryFloat(){let e=this.readBytesWithLength();return e?this.parseBinaryFloat(e):null}readBinaryInteger(){let e=this.readBytesWithLength();return e?(e.length>4&&It.throwErr(It.ERR_INTEGER_TOO_LARGE,e.length,4,this.pos,this.packetNum),e.readIntBE(0,e.length)):0}readBool(){let e=this.readBytesWithLength();return e?e[e.length-1]===1:null}readBytes(e){let t=this.numBytesLeft();e>t&&It.throwErr(It.ERR_UNEXPECTED_END_OF_DATA,e,t);let s=this.buf.subarray(this.pos,this.pos+e);return this.pos+=e,s}readBytesWithLength(){let e=this.readUInt8();return e===0||e===Vt.TNS_NULL_LENGTH_INDICATOR?null:this._readBytesWithLength(e)}readDbObject(){let e={},t=this.readUB4();return t>0&&(e.toid=$t.from(this.readBytesWithLength())),t=this.readUB4(),t>0&&(e.oid=$t.from(this.readBytesWithLength())),t=this.readUB4(),t>0&&(e.snapshot=$t.from(this.readBytesWithLength())),this.skipUB2(),t=this.readUB4(),this.skipUB2(),t>0&&(e.packedData=$t.from(this.readBytesWithLength())),e}readInt8(){return this.readBytes(1).readInt8()}readOracleDate(e){let t=this.readBytesWithLength();return t?this.parseOracleDate(t,e):null}readOracleNumber(){let e=this.readBytesWithLength();return e?this.parseOracleNumber(e):null}readSB2(){return this._readInteger(2,!0,!1)}readSB4(){return this._readInteger(4,!0,!1)}readSB8(){return this._readInteger(8,!0,!1)}readStr(e){let t=this.readBytesWithLength();return t?e===Vt.CSFRM_IMPLICIT?t.toString():$t.from(t).swap16().toString("utf16le"):null}readUB2(){return this._readInteger(2,!1,!1)}readUB4(){return this._readInteger(4,!1,!1)}readUB8(){return this._readInteger(8,!1,!1)}readUInt8(){return this.readBytes(1)[0]}readUInt16BE(){return this.readBytes(2).readUInt16BE()}readUInt16LE(){return this.readBytes(2).readUInt16LE()}readUInt32BE(){return this.readBytes(4).readUInt32BE()}reserveBytes(e){e>this.numBytesLeft()&&this._grow(this.pos+e);let t=this.pos;return this.pos+=e,t}skipBytes(e){e>this.numBytesLeft()&&It.throwErr(It.ERR_UNEXPECTED_END_OF_DATA),this.pos+=e}skipSB4(){return this._readInteger(4,!0,!0)}skipUB1(){this.skipBytes(1)}skipUB2(){return this._readInteger(2,!1,!0)}skipUB4(){return this._readInteger(4,!1,!0)}skipUB8(){return this._readInteger(8,!1,!0)}writeBinaryDouble(e,t){t||(t=this.reserveBytes(8)),this.buf.writeDoubleBE(e,t),this.buf[t]&128?(this.buf[t]^=255,this.buf[t+1]^=255,this.buf[t+2]^=255,this.buf[t+3]^=255,this.buf[t+4]^=255,this.buf[t+5]^=255,this.buf[t+6]^=255,this.buf[t+7]^=255):this.buf[t]|=128}writeBinaryFloat(e,t){t||(t=this.reserveBytes(4)),this.buf.writeFloatBE(e,t),this.buf[t]&128?(this.buf[t]^=255,this.buf[t+1]^=255,this.buf[t+2]^=255,this.buf[t+3]^=255):this.buf[t]|=128}writeBytes(e){let t=0,s=e.length;for(;s>0;){let n=this.numBytesLeft();n===0&&this._grow(this.pos+s);let i=Math.min(n,s);e.copy(this.buf,this.pos,t,t+i),this.pos+=i,t+=i,s-=i}}_writeRawBytesAndLength(e,t){if(t<=Vt.TNS_MAX_SHORT_LENGTH)this.writeUInt8(t),t>0&&this.writeBytes(e);else{let s=0;for(this.writeUInt8(Vt.TNS_LONG_LENGTH_INDICATOR);t>0;){let n=Math.min(t,Vt.BUFFER_CHUNK_SIZE);this.writeUB4(n),this.writeBytes(e.subarray(s,s+n)),t-=n,s+=n}this.writeUB4(0)}}writeBytesWithLength(e){let t=e.length;this._writeRawBytesAndLength(e,t)}writeDbObject(e){this.writeUB4(e.toid.length),this.writeBytesWithLength(e.toid),e.oid?(this.writeUB4(e.oid.length),this.writeBytesWithLength(e.oid)):this.writeUB4(0),this.writeUB4(0),this.writeUB4(0);let t=e._getPackedData();this.writeUB4(t.length),this.writeUB4(e.flags),this.writeBytesWithLength(t)}writeOracleDate(e,t,s=!0){let n,i=t._bufferSizeFactor;i>7&&(n=e.getUTCMilliseconds()*1e3*1e3,n===0&&i<=11&&(i=7)),s&&this.writeUInt8(i);let a=this.reserveBytes(i);if(t===Su.DB_TYPE_DATE||t==Su.DB_TYPE_TIMESTAMP){let c=e.getFullYear();this.buf[a]=Math.trunc(c/100)+100,this.buf[a+1]=c%100+100,this.buf[a+2]=e.getMonth()+1,this.buf[a+3]=e.getDate(),this.buf[a+4]=e.getHours()+1,this.buf[a+5]=e.getMinutes()+1,this.buf[a+6]=e.getSeconds()+1}else{let c=e.getUTCFullYear();this.buf[a]=Math.trunc(c/100)+100,this.buf[a+1]=c%100+100,this.buf[a+2]=e.getUTCMonth()+1,this.buf[a+3]=e.getUTCDate(),this.buf[a+4]=e.getUTCHours()+1,this.buf[a+5]=e.getUTCMinutes()+1,this.buf[a+6]=e.getUTCSeconds()+1}i>7&&(this.buf.writeInt32BE(n,a+7),i>11&&(this.buf[a+11]=Vt.TZ_HOUR_OFFSET,this.buf[a+12]=Vt.TZ_MINUTE_OFFSET))}writeOracleNumber(e){let t=!1;e[0]==="-"&&(t=!0,e=e.substring(1));let s=0,n=e.indexOf("e");n>0&&(s=Number(e.substring(n+1)),e=e.substring(0,n));let i=e.indexOf(".");if(i>0&&(s-=e.length-i-1,e=e.substring(0,i)+e.substring(i+1)),e[0]==="0"&&(e=e.replace(/^0+/,"")),e.length>0&&e[e.length-1]==="0"){let E=e.replace(/0+$/,"");s+=e.length-E.length,e=E}(e.length>Vt.NUMBER_MAX_DIGITS||s>=126||s<=-131)&&It.throwErr(It.ERR_ORACLE_NUMBER_NO_REPR),(s>0&&s%2===1||s<0&&s%2===-1)&&(s--,e+="0"),e.length%2===1&&(e="0"+e);let a=t&&e.length<Vt.NUMBER_MAX_DIGITS,c=e.length/2,T=(s+e.length)/2+192;t?T=T^255:e.length===0&&s===0&&(T=128);let l=this.reserveBytes(c+2+a);this.buf[l++]=c+1+a,this.buf[l++]=T;for(let E=0;E<e.length;E+=2){let u=Number(e.substring(E,E+2));t?this.buf[l++]=101-u:this.buf[l++]=u+1}a&&(this.buf[l]=102)}writeStr(e){this.writeBytes($t.from(e))}writeInt32BE(e){let t=this.reserveBytes(4);this.buf.writeInt32BE(e,t)}writeUB4(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):e<=65535?(this.writeUInt8(2),this.writeUInt16BE(e)):(this.writeUInt8(4),this.writeUInt32BE(e))}writeUB2(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):(this.writeUInt8(2),this.writeUInt16BE(e))}writeUB8(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):e<=65535?(this.writeUInt8(2),this.writeUInt16BE(e)):e<=4294967295?(this.writeUInt8(4),this.writeUInt32BE(e)):(this.writeUInt8(8),this.writeUInt64BE(e))}writeUInt8(e){let t=this.reserveBytes(1);this.buf[t]=e}writeSB1(e){let t=this.reserveBytes(1);this.buf[t]=e}writeUInt16BE(e){let t=this.reserveBytes(2);this.buf.writeUInt16BE(e,t)}writeUInt32BE(e){let t=this.reserveBytes(4);this.buf.writeUInt32BE(e,t)}writeUInt64BE(e){let t=this.reserveBytes(8);this.buf.writeUInt32BE(0,t),this.buf.writeUInt32BE(e,t+4)}writeUInt16LE(e){let t=this.reserveBytes(2);this.buf.writeUInt16LE(e,t)}};_(fo,"BaseBuffer");var Ln=fo,mo=class mo extends Ln{constructor(e){e?super(e):(super(Vt.BUFFER_CHUNK_SIZE),this.size=this.maxSize)}_grow(e){let t=e%Vt.BUFFER_CHUNK_SIZE;t>0&&(e+=Vt.BUFFER_CHUNK_SIZE-t);let s=$t.allocUnsafe(e);this.buf.copy(s),this.buf=s,this.maxSize=this.size=e}};_(mo,"GrowableBuffer");var po=mo;Au.exports={BaseBuffer:Ln,GrowableBuffer:po}});var wn=m((_0,du)=>{"use strict";var{BaseBuffer:MR,GrowableBuffer:VR}=ar(),{Buffer:FR}=require("buffer"),$e=Fr(),_r=W(),Io=class Io extends MR{decode(){let e=this.readUInt8();e!=$e.TNS_VECTOR_MAGIC_BYTE&&_r.throwErr(_r.ERR_UNEXPECTED_DATA,FR.from([e]).toString("hex"));let t=this.readUInt8();t>$e.TNS_VECTOR_VERSION_WITH_BINARY&&_r.throwErr(_r.ERR_VECTOR_VERSION_NOT_SUPPORTED,t);let s=this.readUInt16BE(),n=this.readUInt8(),i=this.readUInt32BE(),a,c;n===$e.VECTOR_FORMAT_FLOAT32?(a=4,c=new Float32Array(i)):n===$e.VECTOR_FORMAT_FLOAT64?(a=8,c=new Float64Array(i)):n===$e.VECTOR_FORMAT_INT8?(a=1,c=new Int8Array(i)):n===$e.VECTOR_FORMAT_BINARY?(a=1,i=i/8,c=new Uint8Array(i)):_r.throwErr(_r.ERR_VECTOR_FORMAT_NOT_SUPPORTED,n),(n===$e.VECTOR_FORMAT_BINARY||s&$e.TNS_VECTOR_FLAG_NORM)&&this.skipBytes(8);for(let T=0;T<i;T++){let l=this.readBytes(a);n===$e.VECTOR_FORMAT_FLOAT32?c[T]=this.parseBinaryFloat(l):n===$e.VECTOR_FORMAT_FLOAT64?c[T]=this.parseBinaryDouble(l):c[T]=l[0]}return c}};_(Io,"VectorDecoder");var Po=Io,Do=class Do extends VR{encode(e){let t=$e.VECTOR_FORMAT_FLOAT32,s=this.writeBinaryFloat.bind(this),n=e.length,i=$e.TNS_VECTOR_VERSION_BASE,a=$e.TNS_VECTOR_FLAG_NORMSRC|$e.TNS_VECTOR_FLAG_NORM;return Array.isArray(e)||e instanceof Float64Array?(t=$e.VECTOR_FORMAT_FLOAT64,s=this.writeBinaryDouble.bind(this)):e instanceof Int8Array?(t=$e.VECTOR_FORMAT_INT8,s=this.writeSB1.bind(this)):e.constructor.name==="Uint8Array"&&(t=$e.VECTOR_FORMAT_BINARY,n=n*8,i=$e.TNS_VECTOR_VERSION_WITH_BINARY,a=$e.TNS_VECTOR_FLAG_NORMSRC,s=this.writeUInt8.bind(this)),this.writeUInt8($e.TNS_VECTOR_MAGIC_BYTE),this.writeUInt8(i),this.writeUInt16BE(a),this.writeUInt8(t),this.writeUInt32BE(n),this.reserveBytes(8),e.forEach(c=>{s(c)}),this.buf.subarray(0,this.pos)}};_(Do,"VectorEncoder");var Ro=Do;du.exports={VectorDecoder:Po,VectorEncoder:Ro}});var Ft=m((T0,fu)=>{"use strict";var xR=nt(),Bn=W(),ie=Tt(),bR=et(),pu=wn(),Oo=class Oo{constructor(){this.autoCommit=!1,this.connectionClass="",this.dbObjectAsPojo=!1,this.edition="",this.errorOnConcurrentExecute=!1,this.events=!1,this.externalAuth=!1,this.fetchArraySize=100,this.fetchAsBuffer=[],this.fetchAsString=[],this.lobPrefetchSize=16384,this.maxRows=0,this.outFormat=xR.OUT_FORMAT_ARRAY,this.poolIncrement=1,this.poolMax=4,this.poolMaxPerShard=0,this.poolMin=0,this.poolPingInterval=60,this.poolPingTimeout=5e3,this.poolTimeout=60,this.prefetchRows=2,this.queueTimeout=6e4,this.queueMax=500,this.stmtCacheSize=30,this.thin=!0,this.thinDriverInitialized=!1,this.createFetchTypeMap(this.fetchAsString,this.fetchAsBuffer),this.fetchTypeHandler=void 0,this._JsonId=ie.JsonId}_getDateComponents(e,t){return e?[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()*1e3*1e3]:[t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()*1e3*1e3]}_makeDate(e,t,s,n,i,a,c,T,l){return bR.makeDate(e,t,s,n,i,a,c,T,l)}_decodeVector(e){return new pu.VectorDecoder(e).decode()}_encodeVector(e){return new pu.VectorEncoder().encode(e)}addToOptions(e){for(let t=1;t<arguments.length;t++){let s=arguments[t];e[s]===void 0&&(e[s]=this[s])}}createFetchTypeMap(e,t){let s=new Map(ie.DB_TYPE_FETCH_TYPE_MAP);for(let n of e)switch(n){case ie.DB_TYPE_NUMBER:s.set(ie.DB_TYPE_BINARY_DOUBLE,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_BINARY_FLOAT,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_BINARY_INTEGER,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_NUMBER,ie.DB_TYPE_VARCHAR);break;case ie.DB_TYPE_TIMESTAMP:s.set(ie.DB_TYPE_DATE,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_TIMESTAMP,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_TIMESTAMP_TZ,ie.DB_TYPE_VARCHAR),s.set(ie.DB_TYPE_TIMESTAMP_LTZ,ie.DB_TYPE_VARCHAR);break;case ie.DB_TYPE_CLOB:case ie.DB_TYPE_NCLOB:s.set(ie.DB_TYPE_CLOB,ie.DB_TYPE_LONG),s.set(ie.DB_TYPE_NCLOB,ie.DB_TYPE_LONG_NVARCHAR);break;case ie.DB_TYPE_VECTOR:s.set(ie.DB_TYPE_VECTOR,ie.DB_TYPE_LONG);break;case ie.DB_TYPE_RAW:s.set(ie.DB_TYPE_RAW,ie.DB_TYPE_VARCHAR);break;case ie.DB_TYPE_JSON:s.set(ie.DB_TYPE_JSON,ie.DB_TYPE_VARCHAR);break;default:Bn.throwErr(Bn.ERR_INVALID_TYPE_FOR_CONVERSION)}for(let n of t)switch(n){case ie.DB_TYPE_BLOB:s.set(ie.DB_TYPE_BLOB,ie.DB_TYPE_LONG_RAW);break;default:Bn.throwErr(Bn.ERR_INVALID_TYPE_FOR_CONVERSION)}this.fetchTypeMap=s}};_(Oo,"Settings");var Co=Oo;fu.exports=new Co});var W=m((E0,HN)=>{"use strict";var kR=require("util"),mu="NJS",qR=[1,1400,1438,2290,2291,2292,21525,40479],Pu=2,go=3,yo=4,Lo=5,wo=7,Bo=9,Ru=10,Iu=11,Du=12,Cu=13,Ou=15,gu=16,yu=17,Lu=18,wu=19,Bu=21,Uu=22,Yu=23,Mu=24,Vu=34,Fu=35,xu=36,bu=37,ku=40,qu=41,Gu=42,vu=43,Hu=44,Ku=45,Wu=46,Xu=47,zu=52,$u=55,Qu=56,ju=57,Ju=58,Zu=59,eh=60,th=61,sh=62,rh=63,nh=64,ih=65,oh=66,ah=67,Uo=68,_h=69,ch=70,Th=75,lh=76,Eh=78,uh=80,hh=81,Nh=82,Sh=83,Ah=84,dh=85,ph=86,Yo=87,Mo=89,fh=90,mh=91,Ph=92,Vo=95,Rh=97,Ih=98,Dh=99,Ch=100,Oh=101,gh=102,yh=103,Lh=104,Fo=105,wh=106,xo=107,Bh=109,Uh=110,Yh=111,Mh=112,Vh=113,Fh=114,bo=115,xh=116,bh=118,kh=119,qh=120,Gh=121,vh=122,ko=123,Hh=125,Kh=126,Wh=127,Xh=128,qo=129,zh=130,Go=131,vo=132,Ho=133,$h=134,Qh=135,jh=136,Jh=137,Zh=138,eN=139,tN=140,sN=141,rN=142,nN=143,iN=144,oN=145,aN=146,_N=147,cN=149,TN=150,lN=151,EN=152,uN=153,hN=154,NN=155,SN=156,cr=500,AN=501,dN=503,pN=504,fN=505,mN=506,PN=507,RN=508,IN=509,DN=510,CN=511,ON=512,gN=513,yN=514,LN=515,wN=516,BN=517,UN=518,YN=519,MN=520,VN=521,FN=522,xN=523,bN=524,kN=525,qN=526,GN=527,vN=528,Ko=700,it=new Map;it.set("DPI-1010",go);it.set("DPI-1024",[vo,"at index ([0-9]+) does"]);it.set("DPI-1044",bo);it.set("DPI-1055",Fo);it.set("DPI-1063",Vo);it.set("DPI-1067",[ko,"call timeout of ([0-9]+) ms"]);it.set("DPI-1080",cr);it.set("OCI-22303",[qo,'type "([^"]*"."[^"]*)"']);it.set("OCI-22164",Ho);it.set("OCI-22165",[Go,/index \[([0-9]+)\] must be in the range of \[([0-9]+)\] to \[([0-9]+)\]/]);it.set("ORA-00028",cr);it.set("ORA-00600",cr);it.set("ORA-24338",xo);it.set("ORA-25708",Yo);it.set("ORA-24344",Ko);var I=new Map;I.set(Pu,"invalid pool");I.set(go,"invalid or closed connection");I.set(yo,'invalid value for property "%s"');I.set(Lo,"invalid value for parameter %d");I.set(wo,'invalid value for "%s" in parameter %d');I.set(Bo,"invalid number of parameters");I.set(Ru,"unsupported data type %d in column %d");I.set(Iu,"encountered bind value and type mismatch");I.set(Du,"encountered invalid bind data type in parameter %d");I.set(Cu,"invalid bind direction");I.set(Ou,"type was not specified for conversion");I.set(gu,"buffer is too small for OUT binds");I.set(yu,"concurrent operations on ResultSet are not allowed");I.set(Lu,"invalid ResultSet");I.set(wu,"ResultSet cannot be returned for non-query statements");I.set(Bu,"invalid type for conversion specified");I.set(Uu,"invalid Lob");I.set(Yu,"concurrent operations on a Lob are not allowed");I.set(Mu,"memory allocation failed");I.set(Vu,"data type is unsupported for array bind");I.set(Fu,"maxArraySize is required for IN OUT array bind");I.set(xu,'length of given array is greater than "maxArraySize"');I.set(bu,'invalid data type at array index %d for bind ":%s"');I.set(ku,'connection request timeout. Request exceeded "queueTimeout" of %d');I.set(qu,"cannot convert ResultSet to QueryStream after invoking methods");I.set(Gu,"cannot invoke ResultSet methods after converting to QueryStream");I.set(vu,"ResultSet already converted to QueryStream");I.set(Hu,'bind object must contain one of the following attributes: "dir", "type", "maxSize", or "val"');I.set(Ku,"cannot load a node-oracledb Thick mode binary for Node.js. Please try using Thin mode. %s");I.set(Wu,'pool alias "%s" already exists in the connection pool cache');I.set(Xu,'pool alias "%s" not found in connection pool cache');I.set(zu,"invalid data type at array index %d for bind position %d");I.set($u,"binding by position and name cannot be mixed");I.set(Qu,"maxSize for bind position %d must be specified and be greater than zero");I.set(ju,'maxSize for bind "%s" must be specified and greater than zero');I.set(Ju,"maxSize of %d is too small for value of length %d in row %d");I.set(Zu,"type must be specified for bind position %d");I.set(eh,'type must be specified for bind "%s"');I.set(th,"invalid subscription");I.set(sh,"subscription notification callback missing");I.set(rh,"subscription notification SQL missing");I.set(nh,"connection pool is closing");I.set(ih,"connection pool was closed");I.set(oh,"invalid SODA document cursor");I.set(ah,"a pre-built node-oracledb Thick mode binary was not found for %s");I.set(Uo,"invalid error number %d supplied");I.set(_h,"node-oracledb %s requires Node.js %s or later");I.set(ch,"message must be a string, buffer, database object or an object containing a payload property which itself is a string, buffer or database object");I.set(Th,'only one of "connectString" and "connectionString" can be used');I.set(lh,'connection request rejected. Pool queue length "queueMax" %d reached');I.set(Eh,"unsupported data type %d in JSON value");I.set(uh,'only one of "user" and "username" can be used');I.set(hh,"concurrent operations on a connection are disabled");I.set(Nh,"connection pool is being reconfigured");I.set(Sh,"pool statistics are not enabled");I.set(Ah,"invalid access token");I.set(dh,'invalid connection pool configuration with token-based authentication. The "homogeneous" and "externalAuth" attributes must be set to true');I.set(ph,'invalid standalone configuration with token-based authentication. The "externalAuth" attribute must be set to true');I.set(Yo,"access token has expired");I.set(Mo,"%s is not supported by node-oracledb in Thin mode");I.set(fh,"initOracleClient() was already called with different arguments");I.set(mh,"file %s is missing");I.set(Ph,'"poolMax" %d must be greater than or equal to "poolMin" %d');I.set(Vo,'setting "batchErrors" or "dmlRowCounts" to true is only permitted for DML statements');I.set(Rh,'no bind placeholder named ":%s" was found in the statement text');I.set(Ih,"%s positional bind values are required but %s were provided");I.set(Dh,"internal error: buffer of length %s insufficient to hold %s bytes");I.set(Ch,"national character set id %d is not supported by node-oracledb in Thin mode");I.set(Oh,"no credentials specified");I.set(gh,"unexpected end of data: want %d bytes but only %d bytes are available");I.set(yh,"unexpected message type %d received at position %d of packet %d");I.set(Lh,"connection pool cannot be closed because connections are busy");I.set(Fo,"value is not a number (NaN) and cannot be used in Oracle Database numbers");I.set(wh,"internal error: %s");I.set(xo,"invalid cursor");I.set(Bh,"invalid type number %d");I.set(Uh,"invalid Oracle type number %d [csfrm: %d]");I.set(Yh,"internal error: read a negative integer when expecting a positive integer at position %d of packet %d");I.set(Mh,"internal error: read integer of length %d when expecting integer of no more than length %d at position %d of packet %d");I.set(Vh,"unexpected data received: %s");I.set(Fh,"OSON field names may not exceed %d UTF-8 encoded bytes");I.set(bo,"value cannot be represented as an Oracle Database number");I.set(xh,"password verifier type 0x%s is not supported by node-oracledb in Thin mode");I.set(bh,"node-oracledb Thick mode cannot be enabled because a Thin mode connection has already been created");I.set(kh,"conversion from type %s to type %s is not supported");I.set(qh,"fetchTypeHandler return value must be an object");I.set(Gh,'fetchTypeHandler return value attribute "type" must be a valid database type');I.set(vh,'fetchTypeHandler return value attribute "converter" must be a function');I.set(ko,"call timeout of %d ms exceeded");I.set(Hh,'"connectString" cannot be empty or undefined. Bequeath connections are not supported in Thin mode');I.set(Kh,"OSON version %s is not supported");I.set(Wh,"internal error: unknown server side piggyback opcode %s");I.set(Xh,'internal error: unknown column type name "%s"');I.set(qo,'invalid object type name: "%s"');I.set(zh,"Oracle TDS data type %d is not supported");I.set(Go,"given index %d must be in the range of %d to %d");I.set(vo,"element at index %d does not exist");I.set(Ho,"cannot delete elements of a VARRAY");I.set($h,"value is of wrong type for attribute %s of object %s");I.set(Qh,"value is of wrong type for an element of object %s");I.set(jh,"user name and password cannot be set when using external authentication");I.set(Jh,'a bind variable replacement value for placeholder ":%s" was not provided');I.set(Zh,"connections to this database server version are not supported by node-oracledb in Thin mode");I.set(eN,"unexpected XML type with flag %d");I.set(tN,"user name must be enclosed in [] when using external authentication with a proxy user");I.set(sN,"the number of batch errors from executemany() exceeds 65535");I.set(rN,"value too large for attribute %s of object %s (actual: %d, maximum: %d)");I.set(nN,"value too large for element %d of object %s (actual: %d, maximum: %d)");I.set(iN,"VECTOR format %d is not supported");I.set(oN,"VECTOR version %d is not supported");I.set(aN,"object %s is not a collection");I.set(_N,"cursor has been closed by the database");I.set(cN,'the bind variable placeholder "%s" cannot be used both before and after the RETURNING clause in a DML RETURNING statement');I.set(TN,"invalid flags for tpcBegin() in Two Phase Commit");I.set(lN,"invalid flags for tpcEnd() in Two Phase Commit");I.set(EN,"internal error: unknown transaction state {state} in Two Phase Commit");I.set(uN,"size of the transaction ID is %d and cannot exceed 64");I.set(hN,"size of the branch ID is %d and cannot exceed 64");I.set(NN,"operation is not supported on BFILE LOBs");I.set(SN,"operation is only supported on BFILE LOBs");I.set(cr,"connection to the Oracle Database was broken");I.set(AN,`connection to host %s port %d terminated unexpectedly. (CONNECTION_ID=%s)
%s`);I.set(dN,`connection to host %s port %d could not be established. (CONNECTION_ID=%s)
%s`);I.set(pN,`connection establishment through a web proxy at host %s port %d failed. (CONNECTION_ID=%s)
%s`);I.set(fN,"unable to initiate TLS connection. Please check if wallet credentials are valid");I.set(mN,`connection to host %s port %d encountered TLS handshake failure. (CONNECTION_ID=%s)
%s`);I.set(PN,"TLS detected an invalid certificate. Server DN in certificate does not match the specified DN");I.set(RN,"TLS detected an invalid certificate. %s not present in certificate");I.set(IN,"internal error: invalid packet type or malformed packet received");I.set(DN,'connection to host %s port %d timed out. Request exceeded "%s" of %d seconds. (CONNECTION_ID=%s)');I.set(CN,`connection to listener at host %s port %d was refused. (CONNECTION_ID=%s)
Cause: %s`);I.set(ON,`invalid connection string parameters.
%s`);I.set(gN,"error received through in-band notification: %s");I.set(yN,"syntax error in connection string");I.set(LN,"error in Easy Connect connection string: %s: %s");I.set(wN,"no configuration directory set or available to search for tnsnames.ora");I.set(BN,'cannot connect to Oracle Database. Unable to find "%s" in "%s"');I.set(UN,'cannot connect to Oracle Database. Service "%s" is not registered with the listener at host %s port %s. (CONNECTION_ID=%s)');I.set(YN,'cannot connect to Oracle Database. SID "%s" is not registered with the listener at host %s port %s. (CONNECTION_ID=%s)');I.set(MN,"cannot connect to Oracle Database. File tnsnames.ora not found in %s");I.set(VN,"connection to host %s port %d received end-of-file on communication channel. (CONNECTION_ID=%s)");I.set(FN,"Azure Authentication Failed: The authentication parameter value %s may be incorrect");I.set(xN,`Failed to retrieve configuration from Centralized Configuration Provider:
 %s`);I.set(bN,"Configuration Provider not supported: %s");I.set(kN,`Centralized Config Provider failed to load required libraries. Please install the required libraries.
 %s`);I.set(qN,"OCI authentication failed: The authentication parameter value %s may be incorrect");I.set(GN,"Azure Vault: Provide correct azure vault authentication details");I.set(vN,"Azure service principal authentication requires either a client certificate path or a client secret string");I.set(Ko,"creation succeeded with compilation errors");function xr(r){if(!r){let e=Array.prototype.slice.call(arguments,1);Wo(...e)}}_(xr,"assert");function GR(r,e,t){xr(r.length>=e&&r.length<=t,Bo)}_(GR,"assertArgCount");function vR(r,e,t){r[t]!==void 0&&xs(typeof r[t]=="boolean",e,t)}_(vR,"assertParamPropBool");function HR(r,e,t){r[t]!==void 0&&xs(typeof r[t]=="function",e,t)}_(HR,"assertParamPropFunction");function KR(r,e,t){r[t]!==void 0&&xs(Number.isInteger(r[t]),e,t)}_(KR,"assertParamPropInt");function WR(r,e,t){r[t]!==void 0&&xs(Number.isInteger(r[t])&&r[t]>=0,e,t)}_(WR,"assertParamPropUnsignedInt");function XR(r,e,t){r[t]!==void 0&&xs(Number.isInteger(r[t])&&r[t]>0,e,t)}_(XR,"assertParamPropUnsignedIntNonZero");function zR(r,e,t){r[t]!==void 0&&xs(typeof r[t]=="string",e,t)}_(zR,"assertParamPropString");function xs(r,e,t){xr(r,wo,t,e)}_(xs,"assertParamPropValue");function $R(r,e){xr(r,Lo,e)}_($R,"assertParamValue");function QR(r,e){xr(r,yo,e)}_(QR,"assertPropValue");function Un(r){let e=I.get(r),t=[...arguments];e||(t=[void 0,r],r=Uo,e=I.get(r));let s=r.toString().padStart(3,"0"),n=`${mu}-${s}`;t[0]=`${n}: ${e}`;let i=new Error(kR.format(...t));return i.code=n,Error.captureStackTrace(i,Un),i}_(Un,"getErr");function Wo(){throw Un(...arguments)}_(Wo,"throwErr");function jR(r){Wo(Mo,r)}_(jR,"throwNotImplemented");function JR(r,e){if(!r.code){let t=r.message.indexOf(":");if(t>0){r.code=r.message.substr(0,t);let s=Ft();if(r.errorNum&&s.thin&&(r.message+=`
Help: https://docs.oracle.com/error-help/db/ora-${r.errorNum.toString().padStart(5,"0")}/`),it.has(r.code)){let n=[],i,a=it.get(r.code);if(typeof a=="number")i=a;else{i=a[0];let T=a[1],l=r.message.match(T);l&&(n=l.slice(1))}let c=Un(i,...n);r.code=c.code,r.message=c.message+`
`+r.message}}}return r.requiresStackCapture&&(delete r.requiresStackCapture,Error.captureStackTrace(r,e)),r}_(JR,"transformErr");HN.exports={ERR_INTEGRITY_ERROR_CODES:qR,ERR_INVALID_POOL:Pu,ERR_INVALID_CONNECTION:go,ERR_INVALID_PROPERTY_VALUE:yo,ERR_INVALID_PARAMETER_VALUE:Lo,ERR_INVALID_PROPERTY_VALUE_IN_PARAM:wo,ERR_INVALID_NUMBER_OF_PARAMETERS:Bo,ERR_UNSUPPORTED_DATA_TYPE:Ru,ERR_BIND_VALUE_AND_TYPE_MISMATCH:Iu,ERR_INVALID_BIND_DATA_TYPE:Du,ERR_INVALID_BIND_DIRECTION:Cu,ERR_NO_TYPE_FOR_CONVERSION:Ou,ERR_INSUFFICIENT_BUFFER_FOR_BINDS:gu,ERR_BUSY_RS:yu,ERR_INVALID_RS:Lu,ERR_NOT_A_QUERY:wu,ERR_INVALID_TYPE_FOR_CONVERSION:Bu,ERR_INVALID_LOB:Uu,ERR_BUSY_LOB:Yu,ERR_INSUFFICIENT_MEMORY:Mu,ERR_INVALID_TYPE_FOR_ARRAY_BIND:Vu,ERR_REQUIRED_MAX_ARRAY_SIZE:Fu,ERR_INVALID_ARRAY_SIZE:xu,ERR_INCOMPATIBLE_TYPE_ARRAY_BIND:bu,ERR_CONN_REQUEST_TIMEOUT:ku,ERR_CANNOT_CONVERT_RS_TO_STREAM:qu,ERR_CANNOT_INVOKE_RS_METHODS:Gu,ERR_RS_ALREADY_CONVERTED:vu,ERR_INVALID_BIND_UNIT:Hu,ERR_CANNOT_LOAD_BINARY:Ku,ERR_POOL_WITH_ALIAS_ALREADY_EXISTS:Wu,ERR_POOL_WITH_ALIAS_NOT_FOUND:Xu,ERR_INCOMPATIBLE_TYPE_ARRAY_INDEX_BIND:zu,ERR_MIXED_BIND:$u,ERR_MISSING_MAX_SIZE_BY_POS:Qu,ERR_MISSING_MAX_SIZE_BY_NAME:ju,ERR_MAX_SIZE_TOO_SMALL:Ju,ERR_MISSING_TYPE_BY_POS:Zu,ERR_MISSING_TYPE_BY_NAME:eh,ERR_INVALID_SUBSCR:th,ERR_MISSING_SUBSCR_CALLBACK:sh,ERR_MISSING_SUBSCR_SQL:rh,ERR_POOL_CLOSING:nh,ERR_POOL_CLOSED:ih,ERR_INVALID_SODA_DOC_CURSOR:oh,ERR_NO_BINARY_AVAILABLE:ah,ERR_INVALID_ERR_NUM:Uo,ERR_NODE_TOO_OLD:_h,ERR_INVALID_AQ_MESSAGE:ch,ERR_DBL_CONNECT_STRING:Th,ERR_QUEUE_MAX_EXCEEDED:lh,ERR_UNSUPPORTED_DATA_TYPE_IN_JSON:Eh,ERR_DBL_USER:uh,ERR_CONCURRENT_OPS:hh,ERR_POOL_RECONFIGURING:Nh,ERR_POOL_STATISTICS_DISABLED:Sh,ERR_TOKEN_BASED_AUTH:Ah,ERR_POOL_TOKEN_BASED_AUTH:dh,ERR_CONN_TOKEN_BASED_AUTH:ph,ERR_TOKEN_HAS_EXPIRED:Yo,ERR_NOT_IMPLEMENTED:Mo,ERR_INIT_ORACLE_CLIENT_ARGS:fh,ERR_MISSING_FILE:mh,ERR_INVALID_NUMBER_OF_CONNECTIONS:Ph,ERR_EXEC_MODE_ONLY_FOR_DML:Vo,ERR_CONNECTION_CLOSED:cr,ERR_CONNECTION_LOSTCONTACT:AN,ERR_CONNECTION_INCOMPLETE:dN,ERR_PROXY_CONNECTION_FAILURE:pN,ERR_TLS_INIT_FAILURE:fN,ERR_TLS_AUTH_FAILURE:mN,ERR_TLS_DNMATCH_FAILURE:PN,ERR_TLS_HOSTMATCH_FAILURE:RN,ERR_INVALID_PACKET:IN,ERR_CONNECTION_TIMEDOUT:DN,ERR_CONNECTION_REFUSED:CN,ERR_INVALID_CONNECT_STRING_PARAMETERS:ON,ERR_CONNECTION_INBAND:gN,ERR_INVALID_CONNECT_STRING_SYNTAX:yN,ERR_INVALID_EZCONNECT_SYNTAX:LN,ERR_NO_CONFIG_DIR:wN,ERR_TNS_ENTRY_NOT_FOUND:BN,ERR_CONNECTION_EOF:VN,ERR_AZURE_CONFIG_PROVIDER_AUTH_FAILED:FN,ERR_OCIOBJECT_CONFIG_PROVIDER_AUTH_FAILED:qN,ERR_AZURE_VAULT_AUTH_FAILED:GN,ERR_AZURE_SERVICE_PRINCIPAL_AUTH_FAILED:vN,ERR_CONFIG_PROVIDER_FAILED_TO_RETRIEVE_CONFIG:xN,ERR_CONFIG_PROVIDER_NOT_SUPPORTED:bN,ERR_CONFIG_PROVIDER_LOAD_FAILED:kN,ERR_INVALID_BIND_NAME:Rh,ERR_WRONG_NUMBER_OF_POSITIONAL_BINDS:Ih,ERR_BUFFER_LENGTH_INSUFFICIENT:Dh,ERR_NCHAR_CS_NOT_SUPPORTED:Ch,ERR_MISSING_CREDENTIALS:Oh,ERR_UNEXPECTED_END_OF_DATA:gh,ERR_UNEXPECTED_MESSAGE_TYPE:yh,ERR_POOL_HAS_BUSY_CONNECTIONS:Lh,ERR_INTERNAL:wh,ERR_INVALID_REF_CURSOR:xo,ERR_UNSUPPORTED_VERIFIER_TYPE:xh,ERR_NAN_VALUE:Fo,ERR_ORACLE_NUMBER_NO_REPR:bo,ERR_INVALID_SERVICE_NAME:UN,ERR_INVALID_SID:YN,ERR_TNS_NAMES_FILE_MISSING:MN,ERR_INVALID_TYPE_NUM:Bh,ERR_INVALID_ORACLE_TYPE_NUM:Uh,ERR_UNEXPECTED_NEGATIVE_INTEGER:Yh,ERR_INTEGER_TOO_LARGE:Mh,ERR_UNEXPECTED_DATA:Vh,ERR_OSON_FIELD_NAME_LIMITATION:Fh,ERR_OSON_VERSION_NOT_SUPPORTED:Kh,ERR_THIN_CONNECTION_ALREADY_CREATED:bh,ERR_UNSUPPORTED_CONVERSION:kh,ERR_FETCH_TYPE_HANDLER_RETURN_VALUE:qh,ERR_FETCH_TYPE_HANDLER_TYPE:Gh,ERR_FETCH_TYPE_HANDLER_CONVERTER:vh,ERR_CALL_TIMEOUT_EXCEEDED:ko,ERR_EMPTY_CONNECT_STRING:Hh,ERR_UNKOWN_SERVER_SIDE_PIGGYBACK:Wh,ERR_UNKNOWN_COLUMN_TYPE_NAME:Xh,ERR_INVALID_OBJECT_TYPE_NAME:qo,ERR_TDS_TYPE_NOT_SUPPORTED:zh,ERR_INVALID_COLL_INDEX_SET:Go,ERR_INVALID_COLL_INDEX_GET:vo,ERR_DELETE_ELEMENTS_OF_VARRAY:Ho,ERR_WRONG_VALUE_FOR_DBOBJECT_ATTR:$h,ERR_WRONG_VALUE_FOR_DBOBJECT_ELEM:Qh,ERR_WRONG_CRED_FOR_EXTAUTH:jh,ERR_MISSING_BIND_VALUE:Jh,ERR_SERVER_VERSION_NOT_SUPPORTED:Zh,ERR_UNEXPECTED_XML_TYPE:eN,ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY:tN,ERR_TOO_MANY_BATCH_ERRORS:sN,ERR_WRONG_LENGTH_FOR_DBOBJECT_ATTR:rN,ERR_WRONG_LENGTH_FOR_DBOBJECT_ELEM:nN,ERR_VECTOR_FORMAT_NOT_SUPPORTED:iN,ERR_VECTOR_VERSION_NOT_SUPPORTED:oN,ERR_OBJECT_IS_NOT_A_COLLECTION:aN,ERR_CURSOR_HAS_BEEN_CLOSED:_N,ERR_DML_RETURNING_DUP_BINDS:cN,ERR_INVALID_TPC_BEGIN_FLAGS:TN,ERR_INVALID_TPC_END_FLAGS:lN,ERR_UNKNOWN_TRANSACTION_STATE:EN,ERR_INVALID_TRANSACTION_SIZE:uN,ERR_INVALID_BRANCH_SIZE:hN,ERR_CONNECTION_CLOSED_CODE:`${mu}-${cr}`,ERR_OPERATION_NOT_SUPPORTED_ON_BFILE:NN,ERR_OPERATION_ONLY_SUPPORTED_ON_BFILE:SN,WRN_COMPILATION_CREATE:Ko,assert:xr,assertArgCount:GR,assertParamPropBool:vR,assertParamPropFunction:HR,assertParamPropInt:KR,assertParamPropString:zR,assertParamPropUnsignedInt:WR,assertParamPropUnsignedIntNonZero:XR,assertParamPropValue:xs,assertParamValue:$R,assertPropValue:QR,getErr:Un,throwErr:Wo,throwNotImplemented:jR,transformErr:JR}});var Yn=m((h0,KN)=>{"use strict";var zo=class zo{constructor(e){let t=new URLSearchParams(e);this.paramMap=new URLSearchParams([...t].map(([s,n])=>[s.toLowerCase(),n]))}modifyOptionsPrecedence(e,t){return t={...t},t.user||(t.user=e.user),t.password||(t.password=e.password),e.connectString&&(t.connectString=e.connectString,t.connectionString=void 0),e.poolMin&&(t.poolMin=e.poolMin),e.poolMax&&(t.poolMax=e.poolMax),e.poolIncrement&&(t.poolIncrement=e.poolIncrement),e.poolTimeout&&(t.poolTimeout=e.poolTimeout),e.poolPingInterval&&(t.poolPingInterval=e.poolPingInterval),e.poolPingTimeout&&(t.poolPingTimeout=e.poolPingTimeout),e.stmtCacheSize&&(t.stmtCacheSize=e.stmtCacheSize),e.prefetchRows&&(t.prefetchRows=e.prefetchRows),e.lobPrefetch&&(t.lobPrefetch=e.lobPrefetch),t}_addParam(e,t){let s=e.toLowerCase();this.paramMap.set(s,t)}_parsePwd(e){let t=new RegExp("(?<vault_url>https://[A-Za-z0-9._-]+)/secrets/(?<secretKey>[A-Za-z][A-Za-z0-9-]*)$","g"),s=[];for(let n of e.matchAll(t))s[0]=n.groups.vault_url,s[1]=n.groups.secretKey;return s}};_(zo,"base");var Xo=zo;KN.exports={base:Xo}});var jN=m((S0,QN)=>{"use strict";var WN,$o,Qo,XN,zN,$N,Mn=W(),{base:ZR}=Yn(),Jo=class Jo extends ZR{constructor(e,t){super(t),this._addParam("appconfigname",e)}init(){({AppConfigurationClient:WN}=require("@azure/app-configuration")),{ClientSecretCredential:$o,ClientCertificateCredential:Qo,ChainedTokenCredential:XN,ManagedIdentityCredential:zN,EnvironmentCredential:$N}=require("@azure/identity")}_withChainedTokenCredential(){let e=[];return this.paramMap.get("azure_client_secret")&&e.push(new $o(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_secret"))),this.paramMap.get("azure_client_certificate_path")&&e.push(new Qo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_certificate_path"))),this.paramMap.get("azure_managed_identity_client_id")&&e.push(this.paramMap.get("azure_managed_identity_client_id")),e.push(new $N),new XN(...e)}_returnCredential(){let e=null;if(this.paramMap.get("authentication")&&(e=this.paramMap.get("authentication").toUpperCase()),e&&e!="AZURE_DEFAULT")if(e=="AZURE_SERVICE_PRINCIPAL"){if(this.paramMap.get("azure_client_certificate_path"))return new Qo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_certificate_path"));if(this.paramMap.get("azure_client_secret"))return new $o(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_secret"));Mn.throwErr(Mn.ERR_AZURE_SERVICE_PRINCIPAL_AUTH_FAILED)}else{if(e=="AZURE_MANAGED_IDENTITY")return new zN(this.paramMap.get("azure_managed_identity_client_id"));Mn.throwErr(Mn.ERR_AZURE_CONFIG_PROVIDER_AUTH_FAILED,e)}else return this._withChainedTokenCredential()}async _getConfigurationSetting(e,t,s){return await e.getConfigurationSetting({key:t,label:s})}async returnConfig(){let e={},t=this.paramMap.get("label"),s=this._returnCredential(),n=new WN("https://"+this.paramMap.get("appconfigname"),s);e.connectString=(await this._getConfigurationSetting(n,this.paramMap.get("key")+"connect_descriptor",t)).value;try{let c=(await this._getConfigurationSetting(n,this.paramMap.get("key")+"node-oracledb",t)).value,T=JSON.parse(c);for(let l in T){var i=T[l];e[l]=i}}catch{e["node-oracledb"]=null}try{e.user=(await this._getConfigurationSetting(n,this.paramMap.get("key")+"user",t)).value}catch{e.user=null}let a=null;try{a=await this._getConfigurationSetting(n,this.paramMap.get("key")+"password",t)}catch{e.password=null}if(a){let c;try{c=JSON.parse(a.value)}catch{c=a.value}if(c.uri){let{SecretClient:T}=require("@azure/keyvault-secrets"),l=await this._parsePwd(c.uri),E=new T(l[0],s);e.password=(await E.getSecret(l[1])).value}else e.password=a.value}return e}};_(Jo,"AzureProvider");var jo=Jo;QN.exports=jo});var ZN=m((d0,JN)=>{"use strict";var Tr=W(),{base:eI}=Yn(),tI=require("fs"),sI=new RegExp("(?<objservername>[A-Za-z0-9._-]+)/n/(?<namespace>[A-Za-z0-9._-]+)/b/(?<bucketname>[A-Za-z0-9._-]+)/o/(?<filename>[A-Za-z0-9._-]+)(/c/(?<alias>.+))?$"),Is={},ea=class ea extends eI{constructor(e,t){super(t);let s=e.match(sI);s&&(this._addParam("objservername",s.groups.objservername),this._addParam("namespace",s.groups.namespace),this._addParam("bucketname",s.groups.bucketname),this._addParam("filename",s.groups.filename),s.groups.alias&&this._addParam("alias",s.groups.alias))}init(){Is.common=require("oci-common"),Is.objectstorage=require("oci-objectstorage")}async _streamToString(e){let t=[];for await(let s of e)t.push(Buffer.from(s));return Buffer.concat(t).toString("utf-8")}async _returnCredential(){let e=null,t=null;if(this.paramMap.get("authentication")&&(t=this.paramMap.get("authentication").toUpperCase()),t&&t!="OCI_DEFAULT")t=="OCI_INSTANCE_PRINCIPAL"?e=await new Is.common.InstancePrincipalsAuthenticationDetailsProviderBuilder().build():t=="OCI_RESOURCE_PRINCIPAL"?e=await new Is.common.ResourcePrincipalAuthenticationDetailsProvider.builder:Tr.throwErr(Tr.ERR_OCIOBJECT_CONFIG_PROVIDER_AUTH_FAILED,t);else try{e=new Is.common.ConfigFileAuthenticationDetailsProvider(this.paramMap.get("oci_profile_path"),this.paramMap.get("oci_profile"))}catch(s){if(!this.paramMap.get("oci_tenancy")||!this.paramMap.get("oci_user"))throw s;let n=tI.readFileSync(this.paramMap.get("oci_key_file"),{encoding:"utf8"}),i=this.retrieveRegion(this.paramMap.get("objservername"));e=new Is.common.SimpleAuthenticationDetailsProvider(this.paramMap.get("oci_tenancy"),this.paramMap.get("oci_user"),this.paramMap.get("oci_fingerprint"),n,void 0,Is.common.Region[i])}return e}async returnConfig(){let e={},t=await this._returnCredential(),s=new Is.objectstorage.ObjectStorageClient({authenticationDetailsProvider:t}),n={objectName:this.paramMap.get("filename"),bucketName:this.paramMap.get("bucketname"),namespaceName:this.paramMap.get("namespace")},i,a=await s.getObject(n),c=await this._streamToString(a.value),T=JSON.parse(c),l=this.paramMap.get("alias");l&&(T=T[l]);let u=T["node-oracledb"];for(let A in u){var p=u[A];e[A]=p}if(e.connectString=T.connect_descriptor,e.user=T.user,T.password)if(T.password.type=="vault-azure")if(T.password.authentication){let{SecretClient:A}=require("@azure/keyvault-secrets"),{ClientSecretCredential:h,ClientCertificateCredential:N}=require("@azure/identity");T.password.authentication.azure_client_secret?i=new h(T.password.authentication.azure_tenant_id,T.password.authentication.azure_client_id,T.password.authentication.azure_client_secret):T.password.authentication.azure_client_certificate_path?i=new N(T.password.authentication.azure_tenant_id,T.password.authentication.azure_client_id,T.password.authentication.azure_client_certificate_path):Tr.throwErr(Tr.ERR_AZURE_VAULT_AUTH_FAILED);let d=await this._parsePwd(T.password.value),S=new A(d[0],i);e.password=(await S.getSecret(d[1])).value}else Tr.throwErr(Tr.ERR_AZURE_VAULT_AUTH_FAILED);else if(T.password.type=="vault-oci"){let A=require("oci-secrets"),h=new A.SecretsClient({authenticationDetailsProvider:t}),N={secretId:T.password.value},d=await h.getSecretBundle(N);e.password=d.secretBundle.secretBundleContent.content}else T.password&&(e.password=T.password);else e.password=null;return e}retrieveRegion(e){return e.split(".")[1].toUpperCase().replaceAll("-","_")}};_(ea,"OCIProvider");var Zo=ea;JN.exports=Zo});var og,ta=JP(()=>{og=jE({"./configProviders/azure.js":()=>jN(),"./configProviders/base.js":()=>Yn(),"./configProviders/ociobject.js":()=>ZN()})});var tS=m((P0,eS)=>{"use strict";var tt=W(),ra=class ra{getCondition(){tt.throwNotImplemented("getting condition (dequeue options)")}getConsumerName(){tt.throwNotImplemented("getting consumer name (dequeue options)")}getCorrelation(){tt.throwNotImplemented("getting correlation (dequeue options)")}getMode(){tt.throwNotImplemented("getting mode (dequeue options)")}getMsgId(){tt.throwNotImplemented("getting message id (dequeue options)")}getNavigation(){tt.throwNotImplemented("getting navigation (dequeue options)")}getTransformation(){tt.throwNotImplemented("getting transformation (dequeue options)")}getVisibility(){tt.throwNotImplemented("getting visibility (dequeue options)")}getWait(){tt.throwNotImplemented("getting wait (dequeue options)")}setCondition(){tt.throwNotImplemented("setting condition (dequeue options)")}setConsumerName(){tt.throwNotImplemented("setting consumer name (dequeue options)")}setCorrelation(){tt.throwNotImplemented("setting correlation (dequeue options)")}setMode(){tt.throwNotImplemented("setting mode (dequeue options)")}setMsgId(){tt.throwNotImplemented("setting message id (dequeue options)")}setNavigation(){tt.throwNotImplemented("setting navigation (dequeue options)")}setTransformation(){tt.throwNotImplemented("setting transformation (dequeue options)")}setVisibility(){tt.throwNotImplemented("setting visibility (dequeue options)")}setWait(){tt.throwNotImplemented("setting wait (dequeue options)")}};_(ra,"AqDeqOptionsImpl");var sa=ra;eS.exports=sa});var rS=m((I0,sS)=>{"use strict";var lr=W(),ia=class ia{getDeliveryMode(){lr.throwNotImplemented("getting delivery mode (enqueue options)")}getTransformation(){lr.throwNotImplemented("getting transformation (enqueue options)")}getVisibility(){lr.throwNotImplemented("getting visibility (enqueue options)")}setDeliveryMode(){lr.throwNotImplemented("setting delivery mode (enqueue options)")}setTransformation(){lr.throwNotImplemented("setting transformation (enqueue options)")}setVisibility(){lr.throwNotImplemented("setting visibility (enqueue options)")}};_(ia,"AqEnqOptionsImpl");var na=ia;sS.exports=na});var iS=m((C0,nS)=>{"use strict";var qt=W(),aa=class aa{getCorrelation(){qt.throwNotImplemented("getting correlation (message)")}getDelay(){qt.throwNotImplemented("getting delay (message)")}getDeliveryMode(){qt.throwNotImplemented("getting delivery mode (message)")}getExceptionQueue(){qt.throwNotImplemented("getting exception queue (message)")}getExpiration(){qt.throwNotImplemented("getting expiration (message)")}getMsgId(){qt.throwNotImplemented("getting message id (message)")}getNumAttempts(){qt.throwNotImplemented("getting number of attempts (message)")}getOriginalMsgId(){qt.throwNotImplemented("getting original message id (message)")}getPayload(){qt.throwNotImplemented("getting payload (message)")}getPriority(){qt.throwNotImplemented("getting priority (message)")}getState(){qt.throwNotImplemented("getting state (message)")}};_(aa,"AqMessageImpl");var oa=aa;nS.exports=oa});var aS=m((g0,oS)=>{"use strict";var Vn=W(),ca=class ca{_getConnImpl(){return this._connection}deqMany(){Vn.throwNotImplemented("dequeuing multiple items from a queue")}deqOne(){Vn.throwNotImplemented("dequeuing a single item from a queue")}enqMany(){Vn.throwNotImplemented("enqueuing multiple items from a queue")}enqOne(){Vn.throwNotImplemented("enqueuing a single item from a queue")}};_(ca,"AqQueueImpl");var _a=ca;oS.exports=_a});var Fn=m((L0,_S)=>{"use strict";var wt=W(),la=class la{constructor(e){this._objType=e}append(){wt.throwNotImplemented("appending element to collection")}copy(){wt.throwNotImplemented("copying an object")}deleteElement(){wt.throwNotImplemented("deleting an element from a collection")}getElement(){wt.throwNotImplemented("getting an element from a collection")}getFirstIndex(){wt.throwNotImplemented("getting the first index in a collection")}getKeys(){wt.throwNotImplemented("returning the keys of a collection")}getLastIndex(){wt.throwNotImplemented("getting the last index in a collection")}getNextIndex(){wt.throwNotImplemented("getting the next index in a collection")}getPrevIndex(){wt.throwNotImplemented("getting the previous index in a collection")}getValues(){wt.throwNotImplemented("getting the values in a collection")}hasElement(){wt.throwNotImplemented("getting if value exists in a collection")}setElement(){wt.throwNotImplemented("setting an element in a collection")}trim(){wt.throwNotImplemented("trimming elements from a collection")}};_(la,"DbObjectImpl");var Ta=la;_S.exports=Ta});var xn=m((B0,cS)=>{"use strict";var rI=Ft(),Q=W(),nI=require("util"),ua=class ua{constructor(){this._inProgress=!1,this._dbObjectTypes=new Map,this._requestQueue=[],this._osonMaxFieldNameSize=255}async _acquireLock(){this._inProgress&&(rI.errorOnConcurrentExecute&&Q.throwErr(Q.ERR_CONCURRENT_OPS),await new Promise((e,t)=>{let s={resolve:e,reject:t};this._requestQueue.push(s)})),this._inProgress=!0}_getConnImpl(){return this}_getDbObjectType(e,t,s,n){let i;if(n&&(i=this._dbObjectTypes.get(n),i))return i;let a=s?`${e}.${s}.${t}`:`${e}.${t}`;return i=this._dbObjectTypes.get(a),i||(i={oid:n,fqn:a,schema:e,name:t,packageName:s,partial:!0,isXmlType:e==="SYS"&&t==="XMLTYPE"},this._dbObjectTypes.set(a,i)),n&&!i.oid&&(i.oid=n,this._dbObjectTypes.set(n,i)),i}_isDate(e){return nI.types.isDate(e)}_releaseLock(){this._requestQueue.length>0?this._requestQueue.shift().resolve():this._inProgress=!1}breakExecution(){Q.throwNotImplemented("getting Oracle Server version number")}changePassword(){Q.throwNotImplemented("changing the password")}close(){Q.throwNotImplemented("closing the connection")}commit(){Q.throwNotImplemented("committing the transaction")}createLob(){Q.throwNotImplemented("creating a temporary LOB")}execute(){Q.throwNotImplemented("executing a SQL statement")}executeMany(){Q.throwNotImplemented("executing a SQL statement multiple times")}getCallTimeout(){Q.throwNotImplemented("getting call timeout")}getCurrentSchema(){Q.throwNotImplemented("getting current schema")}getDbDomain(){Q.throwNotImplemented("getting db domain")}getDbName(){Q.throwNotImplemented("getting db name")}getDbObjectClass(){Q.throwNotImplemented("getting a database object class")}getExternalName(){Q.throwNotImplemented("getting the external name")}getInstanceName(){Q.throwNotImplemented("getting the Oracle Database instance name.")}getInternalName(){Q.throwNotImplemented("getting the internal name")}getMaxOpenCursors(){Q.throwNotImplemented("getting max open cursors")}getOracleServerVersion(){Q.throwNotImplemented("getting Oracle Server version number")}getOracleServerVersionString(){Q.throwNotImplemented("getting Oracle Server version as a string")}getQueue(){Q.throwNotImplemented("getting a queue")}getServiceName(){Q.throwNotImplemented("getting service name")}getSodaDatabase(){Q.throwNotImplemented("getting a SODA database")}getStatementInfo(){Q.throwNotImplemented("getting information about a statement")}getStmtCacheSize(){Q.throwNotImplemented("getting the statement cache size")}getTag(){Q.throwNotImplemented("getting the tag for the connection")}getTransactionInProgress(){Q.throwNotImplemented("getting the status of an active transaction on the connection")}getWarning(){Q.throwNotImplemented("getting information about warning")}isHealthy(){Q.throwNotImplemented("getting the health of the connection")}ping(){Q.throwNotImplemented("sending a ping to the database")}rollback(){Q.throwNotImplemented("rolling back a transaction")}setAction(){Q.throwNotImplemented("setting end-to-end attribute 'action'")}setCallTimeout(){Q.throwNotImplemented("setting call timeout")}setClientId(){Q.throwNotImplemented("setting end-to-end attribute 'clientId'")}setClientInfo(){Q.throwNotImplemented("setting end-to-end attribute 'clientInfo'")}setCurrentSchema(){Q.throwNotImplemented("setting the current schema")}setDbOp(){Q.throwNotImplemented("setting end-to-end attribute 'dbOp'")}setECID(){Q.throwNotImplemented("setting end-to-end attribute 'ecid'")}setExternalName(){Q.throwNotImplemented("setting the external name")}setInternalName(){Q.throwNotImplemented("setting the internal name")}setStmtCacheSize(){Q.throwNotImplemented("setting the size of the statement cache")}setModule(){Q.throwNotImplemented("setting end-to-end attribute 'module'")}setTag(){Q.throwNotImplemented("setting the tag for the connection")}shutdown(){Q.throwNotImplemented("shutting down the database instance")}startup(){Q.throwNotImplemented("starting up the database instance")}subscribe(){Q.throwNotImplemented("subscribing to events in the database")}tpcBegin(){Q.throwNotImplemented("starting a two-phase transaction")}tpcCommit(){Q.throwNotImplemented("committing a two-phase transaction")}tpcEnd(){Q.throwNotImplemented("ending a two-phase transaction")}tpcForget(){Q.throwNotImplemented("forgetting a two-phase transaction")}tpcPrepare(){Q.throwNotImplemented("preparing a two-phase transaction")}tpcRollback(){Q.throwNotImplemented("rolling back a two-phase transaction")}unsubscribe(){Q.throwNotImplemented("unsubscribing from events")}};_(ua,"ConnectionImpl");var Ea=ua;cS.exports=Ea});var Sa=m((Y0,TS)=>{"use strict";var iI=xn(),bs=W(),Na=class Na{_getConnImpl(){let e=this._parentObj;for(;!(e instanceof iI);)e=e._parentObj;return e}close(){bs.throwNotImplemented("closing a LOB")}fileExists(){bs.throwNotImplemented("check if BFILE exists")}getData(){bs.throwNotImplemented("getting all of the data from a LOB")}getDirFileName(){bs.throwNotImplemented("getting directory and filename of LOB(BFILE)")}read(){bs.throwNotImplemented("reading from a LOB")}setDirFileName(){bs.throwNotImplemented("setting directory and filename of LOB(BFILE)")}write(){bs.throwNotImplemented("writing to a LOB")}};_(Na,"LobImpl");var ha=Na;TS.exports=ha});var pa=m((V0,ES)=>{"use strict";var st=W(),lS=et(),da=class da{async _accessTokenHandler(e,t,s,n){let i;try{let a=e(s,n);a instanceof Promise&&(a=await a),lS.isTokenValid(a)||st.throwErr(st.ERR_TOKEN_HAS_EXPIRED),typeof a=="object"&&a.privateKey!==void 0&&(a.privateKey=lS.denormalizePrivateKey(a.privateKey)),i=a}finally{this.returnAccessToken(t,i)}}close(){st.throwNotImplemented("closing the pool")}create(){st.throwNotImplemented("creating the pool")}getConnection(){st.throwNotImplemented("getting a connection from the pool")}getConnectionsInUse(){st.throwNotImplemented("getting num connection in use")}getConnectionsOpen(){st.throwNotImplemented("getting num connection open")}getPoolIncrement(){st.throwNotImplemented("getting the pool increment")}getPoolMax(){st.throwNotImplemented("getting the pool max")}getPoolMaxPerShard(){st.throwNotImplemented("getting the pool max per shard")}getPoolMin(){st.throwNotImplemented("getting the pool min")}getPoolPingInterval(){st.throwNotImplemented("getting the pool ping interval")}getPoolPingTimeout(){st.throwNotImplemented("getting the pool ping Timeout")}getPoolTimeout(){st.throwNotImplemented("getting the pool timeout")}getStmtCacheSize(){st.throwNotImplemented("getting the pool statement cache size")}getSodaMetaDataCache(){st.throwNotImplemented("getting the SODA metadata cache flag")}reconfigure(){st.throwNotImplemented("reconfiguring the pool")}setAccessToken(){st.throwNotImplemented("sets the access token")}};_(da,"PoolImpl");var Aa=da;ES.exports=Aa});var Pa=m((x0,uS)=>{"use strict";var oI=W(),ma=class ma{constructor(){this._featureFlags={},this._featureFlags.oldJsonColumnAsObj=!1}get oldJsonColumnAsObj(){return this._featureFlags.oldJsonColumnAsObj}set oldJsonColumnAsObj(e){oI.assertPropValue(typeof e=="boolean","oldJsonColumnAsObj"),this._featureFlags.oldJsonColumnAsObj=e}};_(ma,"Future");var fa=ma;uS.exports=new fa});var ks=m((k0,NS)=>{"use strict";var{Buffer:Ra}=require("buffer"),{Duplex:aI}=require("stream"),hS=nt(),qe=W(),kn=et(),bn=Tt(),Ia=class Ia extends aI{constructor(){super({decodeStrings:!1}),this.offset=1,this._isActive=!1,this.once("finish",function(){this._autoCloseLob&&this.destroy()})}_checkIsBfile(){this.type!==bn.DB_TYPE_BFILE&&qe.throwErr(qe.ERR_OPERATION_ONLY_SUPPORTED_ON_BFILE)}_checkNotBfile(){this.type===bn.DB_TYPE_BFILE&&qe.throwErr(qe.ERR_OPERATION_NOT_SUPPORTED_ON_BFILE)}async _destroy(e,t){if(e&&e.message.startsWith("NJS-003:")&&delete this._impl,this._impl){let s=this._impl;delete this._impl;try{await s.close()}catch(n){t(n);return}}t(e)}async _read(){try{let e=await this._serializedRead(this.offset);e?(this.offset+=e.length,this.push(e)):(this.push(null),this._autoCloseLob&&this.destroy())}catch(e){throw this._autoCloseLob&&this.destroy(e),e}}async _readData(e){qe.assert(this._impl,qe.ERR_INVALID_LOB);try{return await this._impl.read(e)}catch(t){throw qe.transformErr(t,this._readData)}}_setup(e,t){this._impl=e,this.type!==bn.DB_TYPE_BFILE&&(this._chunkSize=e.getChunkSize()),this._pieceSize=e.getPieceSize(),this._length=e.getLength(),this._type=e.getType(),typeof this._type=="number"&&(this._type=bn.getTypeByNum(this._type)),this._autoCloseLob=t}async _write(e,t,s){this.type==hS.DB_TYPE_BLOB&&!Ra.isBuffer(e)?e=Ra.from(e):this.type==hS.DB_TYPE_CLOB&&Ra.isBuffer(e)&&(e=e.toString());try{await this._serializedWrite(this.offset,e)}catch(n){this._autoCloseLob&&this.destroy(n),s(n);return}this.offset+=e.length,s(null)}async _writeData(e,t){qe.assert(this._impl,qe.ERR_INVALID_LOB);try{await this._impl.write(e,t)}catch(s){throw qe.transformErr(s,this._writeData)}}get chunkSize(){return this._checkNotBfile(),this._chunkSize}async close(){if(qe.assertArgCount(arguments,0,0),this._impl){let e=this._impl;delete this._impl;try{await e.close(),this.emit("close")}catch(t){this.destroy(t)}}}async getData(e,t){return qe.assertArgCount(arguments,0,2),e===void 0?e=1:qe.assertParamValue(Number.isInteger(e)&&e>0,1),t===void 0?t=0:qe.assertParamValue(Number.isInteger(t)&&t>0,2),qe.assert(this._impl,qe.ERR_INVALID_LOB),await this._impl.getData(e,t)}getDirFileName(){return this._checkIsBfile(),this._impl.getDirFileName()}setDirFileName(e){this._checkIsBfile(),qe.assertArgCount(arguments,1,1),qe.assertParamValue(kn.isObject(e),1),this._impl.setDirFileName(e)}async fileExists(){return this._checkIsBfile(),await this._impl.fileExists()}get length(){return this._length}get pieceSize(){return this._pieceSize}set pieceSize(e){qe.assertPropValue(Number.isInteger(e)&&e>=0,"pieceSize"),qe.assert(this._impl,qe.ERR_INVALID_LOB),this._impl.setPieceSize(e),this._pieceSize=e}get type(){return this._type}};_(Ia,"Lob");var Ds=Ia;kn.wrapFns(Ds.prototype,qe.ERR_BUSY_LOB,"close","fileExists","getData");Ds.prototype._serializedRead=kn.serialize(Ds.prototype._readData);Ds.prototype._serializedWrite=kn.serialize(Ds.prototype._writeData);NS.exports=Ds});var vn=m((G0,AS)=>{"use strict";var{BaseBuffer:_I,GrowableBuffer:ya}=ar(),{Buffer:Er}=require("buffer"),K=Fr(),Cs=W(),qn=Tt(),cI=require("util"),SS=wn(),TI=et(),La=class La extends _I{_decodeContainerNode(e){let t,s,n,i=this.pos-this.treeSegPos-1,a=this._getNumChildren(e),c=(e&64)===0;if(a===void 0){let T=this._getOffset(e);s=this.pos,this.pos=this.treeSegPos+T;let l=this.readUInt8();a=this._getNumChildren(l),t=c?{}:new Array(a),n=this.pos}else c?(t={},n=this.pos,s=this.pos+this.fieldIdLength*a):(t=new Array(a),s=this.pos);for(let T=0;T<a;T++){let l;if(c){let u;this.fieldIdLength===1?u=this.buf[n]:this.fieldIdLength==2?u=this.buf.readUInt16BE(n):u=this.buf.readUInt32BE(n),l=this.fieldNames[u-1],n+=this.fieldIdLength}this.pos=s;let E=this._getOffset(e);this.relativeOffsets&&(E+=i),s=this.pos,this.pos=this.treeSegPos+E,c?t[l]=this._decodeNode():t[T]=this._decodeNode()}return t}_decodeNode(){let e=this.readUInt8();if(e&128)return this._decodeContainerNode(e);if(e===K.TNS_JSON_TYPE_NULL)return null;if(e===K.TNS_JSON_TYPE_TRUE)return!0;if(e===K.TNS_JSON_TYPE_FALSE)return!1;if(e===K.TNS_JSON_TYPE_DATE||e===K.TNS_JSON_TYPE_TIMESTAMP7)return this.parseOracleDate(this.readBytes(7));if(e===K.TNS_JSON_TYPE_TIMESTAMP)return this.parseOracleDate(this.readBytes(11));if(e===K.TNS_JSON_TYPE_TIMESTAMP_TZ)return this.parseOracleDate(this.readBytes(13));if(e===K.TNS_JSON_TYPE_BINARY_FLOAT)return this.parseBinaryFloat(this.readBytes(4));if(e===K.TNS_JSON_TYPE_BINARY_DOUBLE)return this.parseBinaryDouble(this.readBytes(8));if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT8)return this.readBytes(this.readUInt8()).toString();if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT16)return this.readBytes(this.readUInt16BE()).toString();if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT32)return this.readBytes(this.readUInt32BE()).toString();if(e===K.TNS_JSON_TYPE_NUMBER_LENGTH_UINT8)return parseFloat(this.readOracleNumber());if(e===K.TNS_JSON_TYPE_ID){let s=this.readBytes(this.readUInt8()),n=new qn.JsonId(s.length);return s.copy(n),n}else{if(e===K.TNS_JSON_TYPE_BINARY_LENGTH_UINT16)return Er.from(this.readBytes(this.readUInt16BE()));if(e===K.TNS_JSON_TYPE_BINARY_LENGTH_UINT32)return Er.from(this.readBytes(this.readUInt32BE()));if(e===K.TNS_JSON_TYPE_EXTENDED&&(e=this.readUInt8(),e===K.TNS_JSON_TYPE_VECTOR)){let s=this.readBytes(this.readUInt32BE());return new SS.VectorDecoder(s).decode()}}let t=e&240;if(t===32||t===96){let s=e&15;return parseFloat(this.parseOracleNumber(this.readBytes(s+1)))}else if(t===64||t===80){let s=e&15;return parseFloat(this.parseOracleNumber(this.readBytes(s)))}else if(!(e&224))return e===0?"":this.readBytes(e).toString();Cs.throwErr(Cs.ERR_UNSUPPORTED_DATA_TYPE_IN_JSON,e)}_getNumChildren(e){let t=e&24;if(t===0)return this.readUInt8();if(t===8)return this.readUInt16BE();if(t===16)return this.readUInt32BE()}_getOffset(e){return e&32?this.readUInt32BE():this.readUInt16BE()}_getFieldNames(e,t,s,n,i){this.skipBytes(t*i);let a=this.pos;this.skipBytes(t*s);let c=this.readBytes(n),T=this.pos;this.pos=a;let l;for(let E=e;E<e+t;E++){s===2?l=this.readUInt16BE():l=this.readUInt32BE();let u;i===1?u=c.readUInt8(l):u=c.readUInt16BE(l),this.fieldNames[E]=c.subarray(l+i,l+u+i).toString()}this.pos=T}decode(){let e=this.readBytes(3);(e[0]!==K.TNS_JSON_MAGIC_BYTE_1||e[1]!==K.TNS_JSON_MAGIC_BYTE_2||e[2]!==K.TNS_JSON_MAGIC_BYTE_3)&&Cs.throwErr(Cs.ERR_UNEXPECTED_DATA,e.toString("hex"));let t=this.readUInt8();t!==K.TNS_JSON_VERSION_MAX_FNAME_255&&t!==K.TNS_JSON_VERSION_MAX_FNAME_65535&&Cs.throwErr(Cs.ERR_OSON_VERSION_NOT_SUPPORTED,t);let s=this.readUInt16BE();if(this.relativeOffsets=s&K.TNS_JSON_FLAG_REL_OFFSET_MODE,s&K.TNS_JSON_FLAG_IS_SCALAR)return s&K.TNS_JSON_FLAG_TREE_SEG_UINT32?this.skipBytes(4):this.skipBytes(2),this._decodeNode();let n;s&K.TNS_JSON_FLAG_NUM_FNAMES_UINT32?(n=this.readUInt32BE(),this.fieldIdLength=4):s&K.TNS_JSON_FLAG_NUM_FNAMES_UINT16?(n=this.readUInt16BE(),this.fieldIdLength=2):(n=this.readUInt8(),this.fieldIdLength=1);let i,a;s&K.TNS_JSON_FLAG_FNAMES_SEG_UINT32?(i=4,a=this.readUInt32BE()):(i=2,a=this.readUInt16BE());let c,T,l=0;return t===K.TNS_JSON_VERSION_MAX_FNAME_65535&&(this.readUInt16BE()&K.TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16?c=2:c=4,l=this.readUInt32BE(),T=this.readUInt32BE()),s&K.TNS_JSON_FLAG_TREE_SEG_UINT32?this.skipBytes(4):this.skipBytes(2),this.skipBytes(2),this.fieldNames=new Array(n+l),n>0&&this._getFieldNames(0,n,i,a,1),l>0&&this._getFieldNames(n,l,c,T,2),this.treeSegPos=this.pos,this._decodeNode()}};_(La,"OsonDecoder");var Da=La,wa=class wa{constructor(e,t){this.name=e,this.nameBytes=Er.from(e),this.nameBytes.length>t&&Cs.throwErr(Cs.ERR_OSON_FIELD_NAME_LIMITATION,t);let s=0x811C9DC5n,n=16777619n,i=0xffffffffn;this.hashId=s;for(let a=0;a<this.nameBytes.length;a++){let c=BigInt(this.nameBytes[a]);this.hashId=(this.hashId^c)*n&i}this.hashId=Number(this.hashId)&255}};_(wa,"OsonFieldName");var Ca=wa,Ba=class Ba extends ya{constructor(){super(),this.fieldNames=[]}addName(e){e.offset=this.pos,e.nameBytes.length<=255?this.writeUInt8(e.nameBytes.length):this.writeUInt16BE(e.nameBytes.length),this.writeBytes(e.nameBytes),this.fieldNames.push(e)}_processFieldNames(e){this.fieldNames.sort((t,s)=>t.hashId<s.hashId?-1:t.hashId>s.hashId?1:t.nameBytes.length<s.nameBytes.length?-1:t.nameBytes.length>s.nameBytes.length?1:t.name<s.name?-1:t.name>s.name?1:0);for(let t=0;t<this.fieldNames.length;t++)this.fieldNames[t].fieldId=e+t+1;this.fieldNames.length<256?this.fieldIdSize=1:this.fieldNames.length<65536?this.fieldIdSize=2:this.fieldIdSize=4}};_(Ba,"OsonFieldNamesSegment");var Gn=Ba,Ua=class Ua extends ya{_encodeArray(e,t){this._encodeContainer(K.TNS_JSON_TYPE_ARRAY,e.length);let s=e.length*4,i=this.reserveBytes(s);for(let a of e)this.buf.writeUInt32BE(this.pos,i),i+=4,this.encodeNode(a,t)}_encodeContainer(e,t){e|=32,t>65535?e|=16:t>255&&(e|=8),this.writeUInt8(e),t<256?this.writeUInt8(t):t<65536?this.writeUInt16BE(t):this.writeUInt32BE(t)}_encodeObject(e,t){let s=e.values.length;this._encodeContainer(K.TNS_JSON_TYPE_OBJECT,s);let n=this.pos,i=this.pos+s*t.fieldIdSize,a=i+s*4;this.reserveBytes(a-this.pos);for(let c=0;c<e.fields.length;c++){let T=t.fieldNamesMap.get(e.fields[c]);t.fieldIdSize==1?this.buf[n]=T.fieldId:t.fieldIdSize==2?this.buf.writeUInt16BE(T.fieldId,n):this.buf.writeUInt32BE(T.fieldId,n),this.buf.writeUInt32BE(this.pos,i),n+=t.fieldIdSize,i+=4,this.encodeNode(e.values[c],t)}}encodeNode(e,t){if(e==null)this.writeUInt8(K.TNS_JSON_TYPE_NULL);else if(typeof e=="boolean")e?this.writeUInt8(K.TNS_JSON_TYPE_TRUE):this.writeUInt8(K.TNS_JSON_TYPE_FALSE);else if(typeof e=="number")this.writeUInt8(K.TNS_JSON_TYPE_NUMBER_LENGTH_UINT8),this.writeOracleNumber(e.toString());else if(typeof e=="string"){let s=Er.from(e);s.length<256?(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT8),this.writeUInt8(s.length)):s.length<65536?(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT16),this.writeUInt16BE(s.length)):(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT32),this.writeUInt32BE(s.length)),s.length>0&&this.writeBytes(s)}else if(cI.types.isDate(e))e.getUTCMilliseconds()===0?(this.writeUInt8(K.TNS_JSON_TYPE_TIMESTAMP7),this.writeOracleDate(e,qn.DB_TYPE_DATE,!1)):(this.writeUInt8(K.TNS_JSON_TYPE_TIMESTAMP),this.writeOracleDate(e,qn.DB_TYPE_TIMESTAMP,!1));else if(Er.isBuffer(e))e.length<65536?(this.writeUInt8(K.TNS_JSON_TYPE_BINARY_LENGTH_UINT16),this.writeUInt16BE(e.length)):(this.writeUInt8(K.TNS_JSON_TYPE_BINARY_LENGTH_UINT32),this.writeUInt32BE(e.length)),this.writeBytes(e);else if(Array.isArray(e))this._encodeArray(e,t);else if(TI.isVectorValue(e)){this.writeUInt8(K.TNS_JSON_TYPE_EXTENDED),this.writeUInt8(K.TNS_JSON_TYPE_VECTOR);let n=new SS.VectorEncoder().encode(e);this.writeUInt32BE(n.length),this.writeBytes(n)}else e instanceof qn.JsonId?(this.writeUInt8(K.TNS_JSON_TYPE_ID),this.writeUInt8(e.length),this.writeBytes(Er.from(e.buffer))):this._encodeObject(e,t)}};_(Ua,"OsonTreeSegment");var Oa=Ua,Ya=class Ya extends ya{_addFieldName(e){let t=new Ca(e,this.maxFieldNameSize);this.fieldNamesMap.set(e,t),t.nameBytes.length<=255?this.shortFieldNamesSeg.addName(t):(this.longFieldNamesSeg||(this.longFieldNamesSeg=new Gn),this.longFieldNamesSeg.addName(t))}_examineNode(e){if(Array.isArray(e))for(let t of e)this._examineNode(t);else if(e&&Array.isArray(e.fields))for(let t=0;t<e.fields.length;t++){let s=e.fields[t],n=e.values[t];this.fieldNamesMap.has(s)||this._addFieldName(s),this._examineNode(n)}}_writeExtendedHeader(){if(this.fieldIdSize===1?this.writeUInt8(this.shortFieldNamesSeg.fieldNames.length):this.fieldIdSize===2?this.writeUInt16BE(this.shortFieldNamesSeg.fieldNames.length):this.writeUInt32BE(this.shortFieldNamesSeg.fieldNames.length),this.shortFieldNamesSeg.pos<65536?this.writeUInt16BE(this.shortFieldNamesSeg.pos):this.writeUInt32BE(this.shortFieldNamesSeg.pos),this.longFieldNamesSeg){let e=0;this.longFieldNamesSeg.pos<65536&&(e=K.TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16),this.writeUInt16BE(e),this.writeUInt32BE(this.longFieldNamesSeg.fieldNames.length),this.writeUInt32BE(this.longFieldNamesSeg.pos)}}_writeFieldNamesSeg(e){for(let t of e.fieldNames)t.nameBytes.length<=255?this.writeUInt8(t.hashId):this.writeUInt16BE(t.hashId);for(let t of e.fieldNames)e.pos<65536?this.writeUInt16BE(t.offset):this.writeUInt32BE(t.offset);e.pos>0&&this.writeBytes(e.buf.subarray(0,e.pos))}encode(e,t){this.maxFieldNameSize=t;let s=K.TNS_JSON_FLAG_INLINE_LEAF;if(Array.isArray(e)||e&&Array.isArray(e.fields)){this.fieldNamesMap=new Map,this.shortFieldNamesSeg=new Gn,this._examineNode(e);let i=0;this.shortFieldNamesSeg&&(this.shortFieldNamesSeg._processFieldNames(0),i+=this.shortFieldNamesSeg.fieldNames.length),this.longFieldNamesSeg&&(this.longFieldNamesSeg._processFieldNames(i),i+=this.longFieldNamesSeg.fieldNames.length),s|=K.TNS_JSON_FLAG_HASH_ID_UINT8|K.TNS_JSON_FLAG_TINY_NODES_STAT,i>65535?(s|=K.TNS_JSON_FLAG_NUM_FNAMES_UINT32,this.fieldIdSize=4):i>255?(s|=K.TNS_JSON_FLAG_NUM_FNAMES_UINT16,this.fieldIdSize=2):this.fieldIdSize=1,this.shortFieldNamesSeg.pos>65535&&(s|=K.TNS_JSON_FLAG_FNAMES_SEG_UINT32)}else s|=K.TNS_JSON_FLAG_IS_SCALAR;let n=new Oa;return n.encodeNode(e,this),n.pos>65535&&(s|=K.TNS_JSON_FLAG_TREE_SEG_UINT32),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_1),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_2),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_3),this.longFieldNamesSeg?this.writeUInt8(K.TNS_JSON_VERSION_MAX_FNAME_65535):this.writeUInt8(K.TNS_JSON_VERSION_MAX_FNAME_255),this.writeUInt16BE(s),this.shortFieldNamesSeg&&this._writeExtendedHeader(),n.pos<65536?this.writeUInt16BE(n.pos):this.writeUInt32BE(n.pos),this.shortFieldNamesSeg&&(this.writeUInt16BE(0),this._writeFieldNamesSeg(this.shortFieldNamesSeg),this.longFieldNamesSeg&&this._writeFieldNamesSeg(this.longFieldNamesSeg)),this.writeBytes(n.buf.subarray(0,n.pos)),this.buf.subarray(0,this.pos)}};_(Ya,"OsonEncoder");var ga=Ya;AS.exports={OsonDecoder:Da,OsonEncoder:ga}});var Fa=m((H0,fS)=>{"use strict";var lI=nt(),Qt=W(),EI=et(),dS=Ft(),uI=Pa(),Xe=Tt(),pS=ks(),hI=vn(),Va=class Va{_determineFetchType(e,t){if(delete e.fetchType,delete e.converter,t.fetchTypeHandler){let i=t.fetchTypeHandler(e);i!==void 0&&(Qt.assert(typeof i=="object",Qt.ERR_FETCH_TYPE_HANDLER_RETURN_VALUE),i.type!==void 0&&Qt.assert(i.type instanceof Xe.DbType,Qt.ERR_FETCH_TYPE_HANDLER_TYPE),i.converter!==void 0&&Qt.assert(typeof i.converter=="function",Qt.ERR_FETCH_TYPE_HANDLER_CONVERTER),e.fetchType=i.type,e.converter=i.converter)}if(e.fetchType||(t.fetchTypeMap&&t.fetchTypeMap.has(e.name)?(e.fetchType=t.fetchTypeMap.get(e.name),e.fetchType===lI.DEFAULT&&(e.fetchType=Xe.DB_TYPE_FETCH_TYPE_MAP.get(e.dbType))):e.fetchType=dS.fetchTypeMap.get(e.dbType)),e.fetchType!==e.dbType){let i=Xe.DB_TYPE_CONVERSION_MAP.get(e.dbType),a=i&&i.get(e.fetchType);a||Qt.throwErr(Qt.ERR_UNSUPPORTED_CONVERSION,e.dbType.name,e.fetchType.name),e.fetchType=a}let s,n=e.converter;if(e.dbType!==Xe.DB_TYPE_JSON&&uI.oldJsonColumnAsObj&&n===void 0){let i;e.isOson?(i=_(async function(a){if(!a)return a;let c=a;return a instanceof pS&&(c=await a.getData()),new hI.OsonDecoder(c).decode()},"outConverter"),s=i):e.isJson&&(i=_(async function(a){if(!a)return a;let c=a;return a instanceof pS&&(c=await a.getData()),c instanceof Buffer&&(c=c.toString()),c=JSON.parse(c),c},"outConverter"),s=i)}if(dS.thin&&(e.dbType===Xe.DB_TYPE_NUMBER&&e.fetchType===Xe.DB_TYPE_NUMBER?s=_(i=>i===null?null:parseFloat(i),"converter"):e.fetchType===Xe.DB_TYPE_VARCHAR?e.dbType===Xe.DB_TYPE_BINARY_DOUBLE||e.dbType===Xe.DB_TYPE_BINARY_FLOAT||e.dbType===Xe.DB_TYPE_DATE||e.dbType===Xe.DB_TYPE_TIMESTAMP||e.dbType===Xe.DB_TYPE_TIMESTAMP_LTZ||e.dbType===Xe.DB_TYPE_TIMESTAMP_TZ?s=_(i=>i===null?null:i.toString(),"converter"):e.dbType===Xe.DB_TYPE_RAW&&(s=_(i=>i===null?null:i.toString("hex").toUpperCase(),"converter")):e.dbType===Xe.DB_TYPE_XMLTYPE&&(s=_(async function(a){return!a||typeof a=="string"?a:await a.getData()},"xmlConverter")),n&&s)){let i=s;s=_(a=>n(i(a)),"converter")}s&&(e.converter=s)}_getConnImpl(){return this._parentObj}_setup(e,t){this._parentObj=e.connection._impl,this.metaData=t,this.lobIndices=[],this.dbObjectIndices=[],this.nestedCursorIndices=[],this.converterIndices=[],this.outFormat=e.outFormat,this.fetchArraySize=e.fetchArraySize,this.dbObjectAsPojo=e.dbObjectAsPojo,this.maxRows=e.maxRows;let s=new Map;for(let n=0;n<t.length;n++){let i=t[n].name;s.has(i)||s.set(i,n)}for(let n=0;n<t.length;n++){let i=t[n];if(i.dbTypeClass){let c=e.connection._getDbObjectClass(i.dbTypeClass);i.dbTypeClass=c}EI.addTypeProperties(i,"dbType"),this._determineFetchType(i,e),i.fetchType===Xe.DB_TYPE_CURSOR?this.nestedCursorIndices.push(n):i.fetchType===Xe.DB_TYPE_CLOB||i.fetchType===Xe.DB_TYPE_NCLOB||i.fetchType===Xe.DB_TYPE_BLOB||i.fetchType===Xe.DB_TYPE_BFILE?this.lobIndices.push(n):i.fetchType===Xe.DB_TYPE_OBJECT&&this.dbObjectIndices.push(n),i.converter&&this.converterIndices.push(n);let a=i.name;if(s.get(a)!==n){let c=0;for(;s.has(a);)c=c+1,a=`${i.name}_${c}`;s.set(a,n),i.name=a}}}close(){Qt.throwNotImplemented("closing a result set")}getRows(){Qt.throwNotImplemented("getting rows")}async _getAllRows(){let t=[];for(;;){let s=await this.getRows(100,{});if(s&&(await this._processRows(s,!1),t=t.concat(s)),s.length<100)break}return t}};_(Va,"ResultSetImpl");var Ma=Va;fS.exports=Ma});var PS=m((W0,mS)=>{"use strict";var Dt=W(),ba=class ba{_getConnImpl(){return this._database._connection}createIndex(){Dt.throwNotImplemented("creating an index on a SODA collection")}drop(){Dt.throwNotImplemented("dropping a SODA collection")}dropIndex(){Dt.throwNotImplemented("dropping an index on a SODA collection")}find(){Dt.throwNotImplemented("creating a SODA operation")}getDataGuide(){Dt.throwNotImplemented("getting the data guide for the collection")}getMetaData(){Dt.throwNotImplemented("getting the metadata for the collection")}getName(){Dt.throwNotImplemented("getting the name of the collection")}insertMany(){Dt.throwNotImplemented("inserting multiple docs into a collection")}insertManyAndGet(){Dt.throwNotImplemented("insert/return many docs in a collection")}insertOne(){Dt.throwNotImplemented("inserting a single doc into a collection")}insertOneAndGet(){Dt.throwNotImplemented("insert/return a single doc in a collection")}save(){Dt.throwNotImplemented("saving a single doc in a collection")}saveAndGet(){Dt.throwNotImplemented("saving a single doc in a collection")}truncate(){Dt.throwNotImplemented("removing all docs from a collection")}};_(ba,"SodaCollectionImpl");var xa=ba;mS.exports=xa});var IS=m((z0,RS)=>{"use strict";var Hn=W(),qa=class qa{_getConnImpl(){return this._connection}createCollection(){Hn.throwNotImplemented("creating a SODA collection")}createDocument(){Hn.throwNotImplemented("creating a SODA document")}getCollectionNames(){Hn.throwNotImplemented("getting a list of SODA collection names")}openCollection(){Hn.throwNotImplemented("getting a list of SODA collection names")}};_(qa,"SodaDatabaseImpl");var ka=qa;RS.exports=ka});var OS=m((Q0,CS)=>{"use strict";var DS=W(),va=class va{_getConnImpl(){return this._operation._getConnImpl()}close(){DS.throwNotImplemented("closing a SODA document cursor")}getNext(){DS.throwNotImplemented("getting a document from a SODA doc cursor")}};_(va,"SodaDocCursorImpl");var Ga=va;CS.exports=Ga});var yS=m((J0,gS)=>{"use strict";var qs=W(),Ka=class Ka{getContentAsBuffer(){qs.throwNotImplemented("getting doc content as a buffer")}getContentAsString(){qs.throwNotImplemented("getting doc content as a string")}getCreatedOn(){qs.throwNotImplemented("getting the created date of a document")}getKey(){qs.throwNotImplemented("getting the key of a document")}getLastModified(){qs.throwNotImplemented("getting the last modified date of a doc")}getMediaType(){qs.throwNotImplemented("getting the media type of a document")}getVersion(){qs.throwNotImplemented("getting the version of a document")}};_(Ka,"SodaDocumentImpl");var Ha=Ka;gS.exports=Ha});var wS=m((eU,LS)=>{"use strict";var Gs=W(),Xa=class Xa{_getConnImpl(){return this._collection._database._connection}count(){Gs.throwNotImplemented("getting a count of documents")}getCursor(){Gs.throwNotImplemented("getting a cursor for documents")}getDocuments(){Gs.throwNotImplemented("getting a cursor for documents")}getOne(){Gs.throwNotImplemented("getting a single document")}remove(){Gs.throwNotImplemented("removing documents from a collection")}replaceOne(){Gs.throwNotImplemented("replacing a single document")}replaceOneAndGet(){Gs.throwNotImplemented("replacing/returning a single document")}};_(Xa,"SodaOperationImpl");var Wa=Xa;LS.exports=Wa});var ur=m((sU,BS)=>{"use strict";var NI=tS(),SI=rS(),AI=iS(),dI=aS(),pI=Fn(),fI=xn(),mI=Sa(),PI=pa(),RI=Fa(),II=PS(),DI=IS(),CI=OS(),OI=yS(),gI=wS();BS.exports={AqDeqOptionsImpl:NI,AqEnqOptionsImpl:SI,AqMessageImpl:AI,AqQueueImpl:dI,DbObjectImpl:pI,ConnectionImpl:fI,LobImpl:mI,PoolImpl:PI,ResultSetImpl:RI,SodaCollectionImpl:II,SodaDatabaseImpl:DI,SodaDocCursorImpl:CI,SodaDocumentImpl:OI,SodaOperationImpl:gI}});var Qa=m((rU,US)=>{"use strict";var{Buffer:yI}=require("buffer"),Ts=nt(),ls=W(),$a=class $a{get condition(){return this._impl.getCondition()}set condition(e){ls.assertPropValue(typeof e=="string","condition"),this._impl.setCondition(e)}get consumerName(){return this._impl.getConsumerName()}set consumerName(e){ls.assertPropValue(typeof e=="string","consumerName"),this._impl.setConsumerName(e)}get correlation(){return this._impl.getCorrelation()}set correlation(e){ls.assertPropValue(typeof e=="string","correlation"),this._impl.setCorrelation(e)}get mode(){return this._impl.getMode()}set mode(e){ls.assertPropValue(e===Ts.AQ_DEQ_MODE_BROWSE||e===Ts.AQ_DEQ_MODE_LOCKED||e===Ts.AQ_DEQ_MODE_REMOVE||e===Ts.AQ_DEQ_MODE_REMOVE_NO_DATA,"mode"),this._impl.setMode(e)}get msgId(){return this._impl.getMsgId()}set msgId(e){ls.assertPropValue(yI.isBuffer(e),"msgId"),this._impl.setMsgId(e)}get navigation(){return this._impl.getNavigation()}set navigation(e){ls.assertPropValue(e===Ts.AQ_DEQ_NAV_FIRST_MSG||e===Ts.AQ_DEQ_NAV_NEXT_TRANSACTION||e===Ts.AQ_DEQ_NAV_NEXT_MSG,"navigation"),this._impl.setNavigation(e)}get transformation(){return this._impl.getTransformation()}set transformation(e){ls.assertPropValue(typeof e=="string","transformation"),this._impl.setTransformation(e)}get visibility(){return this._impl.getVisibility()}set visibility(e){ls.assertPropValue(e===Ts.AQ_VISIBILITY_IMMEDIATE||e===Ts.AQ_VISIBILITY_ON_COMMIT,"visibility"),this._impl.setVisibility(e)}get wait(){return this._impl.getWait()}set wait(e){ls.assertPropValue(Number.isInteger(e)&&e>=0,"wait"),this._impl.setWait(e)}};_($a,"AqDeqOptions");var za=$a;US.exports=za});var e_=m((iU,YS)=>{"use strict";var br=nt(),ja=W(),Za=class Za{get deliveryMode(){return this._impl.getDeliveryMode()}set deliveryMode(e){ja.assertPropValue(e===br.AQ_MSG_DELIV_MODE_PERSISTENT||e===br.AQ_MSG_DELIV_MODE_BUFFERED||e===br.AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED,"deliveryMode"),this._impl.setDeliveryMode(e)}get transformation(){return this._impl.getTransformation()}set transformation(e){ja.assertPropValue(typeof e=="string","transformation"),this._impl.setTransformation(e)}get visibility(){return this._impl.getVisibility()}set visibility(e){ja.assertPropValue(e===br.AQ_VISIBILITY_IMMEDIATE||e===br.AQ_VISIBILITY_ON_COMMIT,"visibility"),this._impl.setVisibility(e)}};_(Za,"AqEnqOptions");var Ja=Za;YS.exports=Ja});var r_=m((aU,MS)=>{"use strict";var LI=Fn(),s_=class s_{get correlation(){return this._impl.getCorrelation()}get delay(){return this._impl.getDelay()}get deliveryMode(){return this._impl.getDeliveryMode()}get exceptionQueue(){return this._impl.getExceptionQueue()}get expiration(){return this._impl.getExpiration()}get msgId(){return this._impl.getMsgId()}get numAttempts(){return this._impl.getNumAttempts()}get originalMsgId(){return this._impl.getOriginalMsgId()}get payload(){let e=this._impl.getPayload();if(e instanceof LI){let t=Object.create(this._payloadTypeClass.prototype);return t._impl=e,t}return e}get priority(){return this._impl.getPriority()}get state(){return this._impl.getState()}};_(s_,"AqMessage");var t_=s_;MS.exports=t_});var o_=m((cU,VS)=>{"use strict";var wI=require("process"),{Readable:BI}=require("stream"),i_=class i_ extends BI{constructor(e){super({objectMode:!0}),this._fetching=!1,this._numRows=0,e&&wI.nextTick(()=>{this._open(e)})}async _destroy(e,t){if(this._resultSet){let s=this._resultSet;this._resultSet=null,this._fetching&&await new Promise(n=>this.once("_doneFetching",n));try{await s._impl.close()}catch(n){t(n);return}}t(e)}_open(e){this._resultSet=e,this.emit("open"),this.emit("metadata",e.metaData)}async _read(){if(!this._resultSet){this.once("open",this._read);return}try{this._fetching=!0,this._resultSet._allowGetRowCall=!0;let e=await this._resultSet.getRow();e?this.push(e):this.push(null)}catch(e){this.destroy(e)}finally{this._fetching=!1,this._resultSet?this._resultSet._allowGetRowCall=!1:this.emit("_doneFetching")}}};_(i_,"QueryStream");var n_=i_;VS.exports=n_});var Xn=m((lU,FS)=>{"use strict";var UI=o_(),YI=hr(),MI=et(),VI=nt(),FI=ks(),Ge=W(),Wn=class Wn{constructor(){this._rowCache=[],this._processingStarted=!1,this._convertedToStream=!1,this._allowGetRowCall=!1,this._isActive=!1}async _getAllRows(){try{let e=this._impl.maxRows,t=this._impl.fetchArraySize,s=[];for(;;){e>0&&t>=e&&(t=e);let n=await this._getRows(t);if(n&&(await this._processRows(n,!0),s=s.concat(n)),n.length==e||n.length<t)break;e>0&&(e-=n.length)}return s}finally{await this._impl.close(),delete this._impl}}async _getRows(e){let t={};return this._impl.nestedCursorIndices.length>0&&(t={connection:this._connection,outFormat:this._impl.outFormat,fetchArraySize:this._impl.fetchArraySize,dbObjectAsPojo:this._impl.dbObjectAsPojo,maxRows:this._impl.maxRows,fetchTypeMap:this._impl.fetchTypeMap}),await this._impl.getRows(e,t)}async _processRows(e,t){for(let s of this._impl.nestedCursorIndices)for(let n=0;n<e.length;n++){let i=e[n][s];if(i){let a=new Wn;a._setup(this._connection,i),this._impl.metaData[s].metaData=i.metaData,t?e[n][s]=await a._getAllRows():e[n][s]=a}}for(let s of this._impl.lobIndices)for(let n=0;n<e.length;n++){let i=e[n][s];i&&(e[n][s]=new FI)._setup(i,!0)}for(let s of this._impl.dbObjectIndices){let n=this._impl.metaData[s].dbTypeClass;for(let i=0;i<e.length;i++){let a=e[i][s];if(a){let c=e[i][s]=Object.create(n.prototype);c._impl=a,this._impl.dbObjectAsPojo?e[i][s]=c._toPojo():c.isCollection&&(e[i][s]=new Proxy(c,YI._collectionProxyHandler))}}}for(let s of this._impl.converterIndices){let n=this._impl.metaData[s].converter;this._connection._impl._inProgress=!1;try{for(let i=0;i<e.length;i++){let a=n(e[i][s]);a instanceof Promise&&(a=await a),e[i][s]=a}}finally{this._connection._impl._inProgress=!0}}if(this._impl.outFormat===VI.OUT_FORMAT_OBJECT)for(let s=0;s<e.length;s++){let n=e[s],i=e[s]={},a=this._impl.metaData;for(let c=0;c<a.length;c++)i[a[c].name]=n[c]}}_setup(e,t){this._connection=e,this._impl=t}async close(){Ge.assertArgCount(arguments,0,0),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),this._convertedToStream&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._processingStarted=!0;let e=this._impl;delete this._impl,await e.close()}async getRow(){if(Ge.assertArgCount(arguments,0,0),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),this._convertedToStream&&!this._allowGetRowCall&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._allowGetRowCall=!1,this._processingStarted=!0,this._rowCache.length==0){let e=await this._getRows(this._impl.fetchArraySize);await this._processRows(e,!1),this._rowCache=e}return this._rowCache.shift()}async getRows(e){let t;Ge.assertArgCount(arguments,0,1),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),arguments.length==0?e=0:Ge.assertParamValue(Number.isInteger(e)&&e>=0,1),this._convertedToStream&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._processingStarted=!0;let s;if(e==0){s=this._rowCache;let n=this._impl.fetchArraySize;for(;;){let i=await this._getRows(n);if(i&&(await this._processRows(i,!1),s=s.concat(i)),i.length<n)break}return s}if(this._rowCache.length===0)s=await this._getRows(e),await this._processRows(s,!1);else if(t=e-this._rowCache.length,t<=0)s=this._rowCache.splice(0,e);else{let n=await this._getRows(t);await this._processRows(n,!1),s=this._rowCache.concat(n),this._rowCache=[]}return s}get metaData(){if(this._impl)return this._impl.metaData}toQueryStream(){return Ge.assertArgCount(arguments,0,0),this._processingStarted&&Ge.throwErr(Ge.ERR_CANNOT_CONVERT_RS_TO_STREAM),this._convertedToStream&&Ge.throwErr(Ge.ERR_RS_ALREADY_CONVERTED),this._convertedToStream=!0,new UI(this)}[Symbol.asyncIterator](){let e=this;return{async next(){let t=await e.getRow();return{value:t,done:t===void 0}},return(){return{done:!0}}}}};_(Wn,"ResultSet");var Kn=Wn;MI.wrapFns(Kn.prototype,Ge.ERR_BUSY_RS,"close","getRow","getRows");FS.exports=Kn});var $n=m((uU,qS)=>{"use strict";var a_=hr(),{Buffer:__}=require("buffer"),xI=ks(),bI=Xn(),kI=nt(),ve=W(),xS=require("util"),pe=Tt(),bS=et();function jt(r,e){if(r.type===void 0&&arguments.length>2)r.type=arguments[2];else{let t=!1;for(let s=2;s<arguments.length;s++)if(r.type===arguments[s]){t=!0;break}t||(r.attrName?ve.throwErr(ve.ERR_WRONG_VALUE_FOR_DBOBJECT_ATTR,r.attrName,r.fqn):r.fqn?ve.throwErr(ve.ERR_WRONG_VALUE_FOR_DBOBJECT_ELEM,r.fqn):r.isArray&&r.name?ve.throwErr(ve.ERR_INCOMPATIBLE_TYPE_ARRAY_BIND,e.pos,r.name):r.isArray?ve.throwErr(ve.ERR_INCOMPATIBLE_TYPE_ARRAY_INDEX_BIND,e.pos,r.pos):ve.throwErr(ve.ERR_BIND_VALUE_AND_TYPE_MISMATCH))}}_(jt,"checkType");function zn(r){if(r==null||typeof r=="number"||typeof r=="string"||typeof r=="boolean"||__.isBuffer(r)||xS.types.isDate(r)||bS.isVectorValue(r))return r;if(Array.isArray(r)){let t=new Array(r.length);for(let s=0;s<r.length;s++)t[s]=zn(r[s]);return t}if(r instanceof a_)return{fields:[],values:[]};if(r instanceof pe.JsonId)return r;let e={};e.fields=Object.getOwnPropertyNames(r),e.values=new Array(e.fields.length);for(let t=0;t<e.fields.length;t++)e.values[t]=zn(r[e.fields[t]]);return e}_(zn,"transformJsonValue");function kS(r,e,t){if(e!=null){if(r.type===pe.DB_TYPE_OBJECT){let s=e;return e instanceof a_||(s=new r.typeClass(e)),s._impl}else{if(r.type===pe.DB_TYPE_JSON)return zn(e);if(typeof e=="string"){if(jt(r,t,pe.DB_TYPE_VARCHAR,pe.DB_TYPE_NVARCHAR,pe.DB_TYPE_CHAR,pe.DB_TYPE_NCHAR,pe.DB_TYPE_CLOB,pe.DB_TYPE_NCLOB),r.type!==pe.DB_TYPE_CLOB&&r.type!==pe.DB_TYPE_NCLOB){let s=__.byteLength(e);(r.maxSize===void 0||s>r.maxSize)&&(r.checkSize&&ve.throwErr(ve.ERR_MAX_SIZE_TOO_SMALL,r.maxSize,s,t.pos),r.maxSize=s)}return e}else{if(typeof e=="number"||typeof e=="bigint")return jt(r,t,pe.DB_TYPE_NUMBER,pe.DB_TYPE_BINARY_INTEGER,pe.DB_TYPE_BINARY_FLOAT,pe.DB_TYPE_BINARY_DOUBLE),Number.isNaN(e)&&r.type===pe.DB_TYPE_NUMBER&&ve.throwErr(ve.ERR_NAN_VALUE),e;if(typeof e=="boolean")return jt(r,t,pe.DB_TYPE_BOOLEAN),e;if(xS.types.isDate(e))return jt(r,t,pe.DB_TYPE_TIMESTAMP,pe.DB_TYPE_TIMESTAMP_TZ,pe.DB_TYPE_TIMESTAMP_LTZ,pe.DB_TYPE_DATE),e;if(__.isBuffer(e))return jt(r,t,pe.DB_TYPE_RAW,pe.DB_TYPE_BLOB),r.type===pe.DB_TYPE_RAW&&(r.maxSize===void 0||e.length>r.maxSize)&&(r.checkSize&&ve.throwErr(ve.ERR_MAX_SIZE_TOO_SMALL,r.maxSize,e.length,t.pos),r.maxSize=e.length),e;if(e instanceof bI)return jt(r,t,pe.DB_TYPE_CURSOR),e._impl;if(e instanceof xI)return jt(r,t,e.type),e._impl;if(e instanceof a_)return jt(r,t,pe.DB_TYPE_OBJECT),e._impl;if(bS.isVectorValue(e))return jt(r,t,pe.DB_TYPE_VECTOR),e;if(r.type===pe.DB_TYPE_VECTOR&&Array.isArray(e))return new Float64Array(e);if(t.allowArray&&Array.isArray(e)){r.isArray=!0,r.dir===kI.BIND_IN?r.maxArraySize=e.length||1:r.maxArraySize===void 0?ve.throwErr(ve.ERR_REQUIRED_MAX_ARRAY_SIZE):e.length>r.maxArraySize&&ve.throwErr(ve.ERR_INVALID_ARRAY_SIZE),t.allowArray=!1;let s=new Array(e.length);for(let n=0;n<e.length;n++)t.pos=n,s[n]=kS(r,e[n],t);return s}}}r.type===void 0&&ve.throwErr(ve.ERR_INVALID_BIND_DATA_TYPE,2),jt(r,t)}}_(kS,"transformValueIn");qS.exports={transformJsonValue:zn,transformValueIn:kS}});var hr=m((NU,vS)=>{"use strict";var qI=ks(),GS=ur(),fe=W(),Nr=Tt(),c_=require("util");function T_(r,e,t,s){let n,i=!1;if(t){switch(e.type){case Nr.DB_TYPE_VARCHAR:case Nr.DB_TYPE_NVARCHAR:case Nr.DB_TYPE_NCHAR:case Nr.DB_TYPE_CHAR:n=Buffer.byteLength(t),n>e.maxSize&&(i=!0);break;case Nr.DB_TYPE_RAW:n=t.length,n>e.maxSize&&(i=!0);break;default:break}i&&(s!==void 0?fe.throwErr(fe.ERR_WRONG_LENGTH_FOR_DBOBJECT_ELEM,s,r.fqn,n,e.maxSize):fe.throwErr(fe.ERR_WRONG_LENGTH_FOR_DBOBJECT_ATTR,e.name,r.fqn,n,e.maxSize))}}_(T_,"validatePropertyValue");var kr=class kr{_getAttrValue(e){let t=this._impl.getAttrValue(e);return this._transformValueOut(t,e.typeClass)}_setAttrValue(e,t){let s={fqn:this._objType.fqn,attrName:e.name,type:e.type,typeClass:e.typeClass},n={allowArray:!1};t=l_.transformValueIn(s,t,n),T_(this._objType,e,t),this._impl.setAttrValue(e,t)}_toPojo(){if(this.isCollection){let t=this.getValues();if(this.elementType===Nr.DB_TYPE_OBJECT)for(let s=0;s<t.length;s++)t[s]=t[s]._toPojo();return t}let e={};for(let t in this.attributes){let s=this[t];s instanceof kr&&(s=s._toPojo()),e[t]=s}return e}_transformValueOut(e,t){let s=e;return e instanceof GS.LobImpl?(s=new qI,s._setup(e,!0)):e instanceof GS.DbObjectImpl&&(s=Object.create(t.prototype),s._impl=e,s.isCollection&&(s=new Proxy(s,kr._collectionProxyHandler))),s}append(e){fe.assertArgCount(arguments,1,1);let t={fqn:this._objType.fqn,type:this._objType.elementType,typeClass:this._objType.elementTypeClass},s={allowArray:!1};e=l_.transformValueIn(t,e,s);let n=this._impl.getLastIndex();n?n=n+1:n=0,T_(this._objType,this._objType.elementTypeInfo,e,n),this._impl.append(e)}get attributes(){if(!this._attributes){let e=this._objType.attributes||[],t={};for(let s=0;s<e.length;s++){let n=e[s],i={type:n.type,typeName:n.typeName};n.typeClass&&(i.typeClass=n.typeClass),t[n.name]=i}this._attributes=t}return this._attributes}deleteElement(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.deleteElement(e)}get elementType(){return this._objType.elementType}get elementTypeClass(){return this._objType.elementTypeClass}get elementTypeName(){return this._objType.elementTypeName}get fqn(){return this._objType.fqn}getElement(e){fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1);let t=this._impl.getElement(e);return this._transformValueOut(t,this.elementTypeClass)}getKeys(){return fe.assertArgCount(arguments,0,0),this._impl.getKeys()}getFirstIndex(){return fe.assertArgCount(arguments,0,0),this._impl.getFirstIndex()}getLastIndex(){return fe.assertArgCount(arguments,0,0),this._impl.getLastIndex()}getNextIndex(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.getNextIndex(e)}getPrevIndex(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.getPrevIndex(e)}getValues(){fe.assertArgCount(arguments,0,0);let e=this._impl.getValues();for(let t=0;t<e.length;t++)e[t]=this._transformValueOut(e[t],this.elementTypeClass);return e}hasElement(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.hasElement(e)}get isCollection(){return this._objType.isCollection}get name(){return this._objType.name}get schema(){return this._objType.schema}get packageName(){return this._objType.packageName}setElement(e,t){fe.assertArgCount(arguments,2,2),fe.assertParamValue(Number.isInteger(e),1);let s={fqn:this._objType.fqn,type:this._objType.elementType,typeClass:this._objType.elementTypeClass},n={allowArray:!1};t=l_.transformValueIn(s,t,n),T_(this._objType,this._objType.elementTypeInfo,t,e),this._impl.setElement(e,t)}trim(e){fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e)&&e>=0,1),this._impl.trim(e)}[c_.inspect.custom](e,t){return"["+this.fqn+"] "+c_.inspect(this._toPojo(),t)}[Symbol.iterator](){if(this.isCollection)return this.getValues()[Symbol.iterator]();throw TypeError("obj is not iterable")}[Symbol.toPrimitive](e){switch(e){case"number":return NaN;default:return"["+this.fqn+"] "+c_.inspect(this._toPojo(),{})}}get[Symbol.toStringTag](){return this.fqn}toJSON(){return this._toPojo()}toMap(){fe.assertArgCount(arguments,0,0),this.isCollection||fe.throwErr(fe.ERR_OBJECT_IS_NOT_A_COLLECTION,this.name);let e=new Map;return this.getKeys().forEach(t=>{e.set(t,this.getElement(t))}),e}};_(kr,"BaseDbObject");var qr=kr;function GI(r){return function(){try{return r.apply(this,arguments)}catch(e){throw fe.transformErr(e,fe.transformErr)}}}_(GI,"transformErr");function vI(r){for(let e=1;e<arguments.length;e++){let t=arguments[e];r[t]=GI(r[t])}}_(vI,"wrapFns");vI(qr.prototype,"_getAttrValue","_setAttrValue","append","deleteElement","getElement","getKeys","getFirstIndex","getLastIndex","getNextIndex","getPrevIndex","getValues","toMap","hasElement","setElement","trim");qr._collectionProxyHandler={deleteProperty(r,e){if(typeof e=="string"){let t=+e;if(!isNaN(t))return r.deleteElement(t)}return delete r[e]},get(r,e){if(typeof e=="string"){let s=+e;if(!isNaN(s))return r.getElement(s)}let t=r[e];return typeof t=="function"?t.bind(r):t},set(r,e,t){if(typeof e=="string"){let s=+e;if(!isNaN(s))return r.setElement(s,t),!0}return r[e]=t,!0}};vS.exports=qr;var l_=$n()});var N_=m((AU,KS)=>{"use strict";var{Buffer:E_}=require("buffer"),dt=W(),u_=et(),HI=Qa(),KI=e_(),WI=r_(),HS=hr(),XI=$n(),Gr=Tt(),h_=class h_{_isPayload(e){return typeof e=="string"||E_.isBuffer(e)||e instanceof HS}_makeMessage(e){let t=new WI;return t._impl=e,t._payloadTypeClass=this._payloadTypeClass,t}_verifyMessage(e){let t;return this._isPayload(e)?(t=e,e={}):(e={...e},this._isJson||this._isPayload(e.payload)?t=e.payload:this._payloadTypeClass?t=new this._payloadTypeClass(e.payload):dt.throwErr(dt.ERR_INVALID_AQ_MESSAGE)),this._isJson?e.payload=XI.transformJsonValue(t):typeof t=="string"?e.payload=E_.from(t):E_.isBuffer(t)?e.payload=t:e.payload=t._impl,e.correlation!==void 0&&dt.assertParamPropValue(typeof e.correlation=="string",1,"correlation"),e.delay!==void 0&&dt.assertParamPropValue(Number.isInteger(e.delay),1,"delay"),e.exceptionQueue!==void 0&&dt.assertParamPropValue(typeof e.exceptionQueue=="string",1,"exceptionQueue"),e.expiration!==void 0&&dt.assertParamPropValue(Number.isInteger(e.expiration),1,"expiration"),e.priority!==void 0&&dt.assertParamPropValue(Number.isInteger(e.priority),1,"priority"),e.recipients!==void 0&&dt.assertParamPropValue(u_.isArrayOfStrings(e.recipients),1,"recipients"),e}async create(e,t,s){if(s.payloadType===Gr.DB_TYPE_JSON)this._isJson=!0,this._payloadType=Gr.DB_TYPE_JSON,this._payloadTypeName="JSON";else if(s.payloadType===void 0||s.payloadType===Gr.DB_TYPE_RAW)this._payloadType=Gr.DB_TYPE_RAW,this._payloadTypeName="RAW";else{if(typeof s.payloadType=="string"){let n=await e._getDbObjectClassForName(s.payloadType);this._payloadTypeClass=n,s.payloadType=n}else dt.assertParamPropValue(u_.isObject(s.payloadType)&&s.payloadType.prototype instanceof HS,2,"payloadType"),this._payloadTypeClass=s.payloadType;this._payloadType=Gr.DB_TYPE_OBJECT,this._payloadTypeName=this._payloadTypeClass.prototype.name}this._name=t,this._impl=await e._impl.getQueue(t,this._payloadTypeClass,this._payloadType)}async deqMany(e){return dt.assertArgCount(arguments,1,1),dt.assertParamValue(Number.isInteger(e)&&e>0,1),(await this._impl.deq(e)).map(s=>this._makeMessage(s))}async deqOne(){dt.assertArgCount(arguments,0,0);let e=await this._impl.deq(1);if(e.length>0)return this._makeMessage(e[0])}get deqOptions(){if(!this._deqOptions){let e=new HI;e._impl=this._impl.deqOptions,this._deqOptions=e}return this._deqOptions}async enqMany(e){dt.assertArgCount(arguments,1,1),dt.assertParamValue(Array.isArray(e)&&e.length>0,1);let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this._verifyMessage(e[n]);return(await this._impl.enq(t)).map(n=>this._makeMessage(n))}async enqOne(e){dt.assertArgCount(arguments,1,1),e=this._verifyMessage(e);let t=await this._impl.enq([e]);return this._makeMessage(t[0])}get enqOptions(){if(!this._enqOptions){let e=new KI;e._impl=this._impl.enqOptions,this._enqOptions=e}return this._enqOptions}get name(){return this._name}get payloadType(){return this._payloadType}get payloadTypeName(){return this._payloadTypeName}get payloadTypeClass(){return this._payloadTypeClass}};_(h_,"AqQueue");var Qn=h_;u_.wrapFns(Qn.prototype,"deqOne","deqMany","enqOne","enqMany");KS.exports=Qn});var Sr=m((pU,WS)=>{"use strict";var S_=class S_{get createdOn(){return this._impl.getCreatedOn()}getContent(){return JSON.parse(this._impl.getContentAsString())}getContentAsBuffer(){return this._impl.getContentAsBuffer()}getContentAsString(){return this._impl.getContentAsString()}get key(){return this._impl.getKey()}get lastModified(){return this._impl.getLastModified()}get mediaType(){return this._impl.getMediaType()}get version(){return this._impl.getVersion()}};_(S_,"SodaDocument");var jn=S_;jn.prototype._sodaDocumentMarker=!0;WS.exports=jn});var d_=m((mU,XS)=>{"use strict";var Ar=W(),zI=et(),$I=Sr(),A_=class A_{async close(){Ar.assertArgCount(arguments,0,0),Ar.assert(this._impl,Ar.ERR_INVALID_SODA_DOC_CURSOR),await this._impl.close(),delete this._impl}async getNext(){Ar.assertArgCount(arguments,0,0),Ar.assert(this._impl,Ar.ERR_INVALID_SODA_DOC_CURSOR);let e=await this._impl.getNext();if(e){let t=new $I;return t._impl=e,t}}[Symbol.asyncIterator](){let e=this;return{async next(){let t=await e.getNext();return{value:t,done:t===void 0}},return(){return{done:!0}}}}};_(A_,"SodaDocCursor");var Jn=A_;zI.wrapFns(Jn.prototype,"close","getNext");XS.exports=Jn});var m_=m((RU,$S)=>{"use strict";var QI=d_(),p_=Sr(),we=W(),Zn=et(),zS=Ft(),f_=class f_{constructor(){this._options={autoCommit:zS.autoCommit,fetchArraySize:zS.fetchArraySize}}async count(){return we.assertArgCount(arguments,0,0),await this._impl.count(this._options)}async getCursor(){we.assertArgCount(arguments,0,0);let e=new QI;return e._impl=await this._impl.getCursor(this._options),e}async getDocuments(){we.assertArgCount(arguments,0,0);let e=await this._impl.getDocuments(this._options),t=new Array(e.length);for(let s=0;s<e.length;s++)t[s]=new p_,t[s]._impl=e[s];return t}async getOne(){we.assertArgCount(arguments,0,0);let e=await this._impl.getOne(this._options);if(e){let t=new p_;return t._impl=e,t}}lock(){return we.assertArgCount(arguments,0,0),this._options.lock=!0,this}async replaceOne(e){return we.assertArgCount(arguments,1,1),e=Zn.verifySodaDoc(e),await this._impl.replaceOne(this._options,e)}async replaceOneAndGet(e){we.assertArgCount(arguments,1,1),e=Zn.verifySodaDoc(e);let t=await this._impl.replaceOneAndGet(this._options,e);if(t){let s=new p_;return s._impl=t,s}}async remove(){return we.assertArgCount(arguments,0,0),await this._impl.remove(this._options)}fetchArraySize(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(Number.isInteger(e)&&e>=0,1),this._options.fetchArraySize=e,this}filter(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(Zn.isObject(e),1),this._options.filter=JSON.stringify(e),this}hint(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(typeof e=="string",1),this._options.hint=e,this}key(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(typeof e=="string",1),this._options.key=e,this._options.keys=void 0,this}keys(e){we.assertArgCount(arguments,1,1),we.assertParamValue(Array.isArray(e),1);for(let t=0;t<e.length;t++)we.assertParamValue(typeof e[t]=="string",1);return this._options.keys=e,this._options.key=void 0,this}limit(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(typeof e=="number",1),this._options.limit=e,this}skip(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(typeof e=="number",1),this._options.skip=e,this}version(e){return we.assertArgCount(arguments,1,1),we.assertParamValue(typeof e=="string",1),this._options.version=e,this}};_(f_,"SodaOperation");var ei=f_;Zn.wrapFns(ei.prototype,"count","getCursor","getDocuments","getOne","remove","replaceOne","replaceOneAndGet");$S.exports=ei});var R_=m((DU,QS)=>{"use strict";var ti=Sr(),jI=m_(),Ve=W(),Gt=et(),Es=Ft(),P_=class P_{async createIndex(e){Ve.assertArgCount(arguments,1,1),Ve.assertParamValue(Gt.isObject(e),1);let t={autoCommit:Es.autoCommit};return await this._impl.createIndex(JSON.stringify(e),t)}async drop(){Ve.assertArgCount(arguments,0,0);let e={autoCommit:Es.autoCommit};return await this._impl.drop(e)}async dropIndex(e,t){let s={autoCommit:Es.autoCommit};return Ve.assertArgCount(arguments,1,2),Ve.assertParamValue(typeof e=="string",1),arguments.length==2&&(Ve.assertParamValue(typeof t=="object",2),t.force!==void 0&&(Ve.assertParamPropValue(typeof t.force=="boolean",2,"force"),s.force=t.force)),await this._impl.dropIndex(e,s)}find(){Ve.assertArgCount(arguments,0,0);let e=new jI;return e._impl=this._impl.find(),e}async getDataGuide(){Ve.assertArgCount(arguments,0,0);let e=new ti;return e._impl=await this._impl.getDataGuide(),e}async insertMany(e){Ve.assertArgCount(arguments,1,1),Ve.assertParamValue(Array.isArray(e)&&e.length>0,1);let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=Gt.verifySodaDoc(e[n]);let s={autoCommit:Es.autoCommit};await this._impl.insertMany(t,s)}async insertManyAndGet(e,t){let s={autoCommit:Es.autoCommit};Ve.assertArgCount(arguments,1,2),Ve.assertParamValue(Array.isArray(e)&&e.length>0,1),arguments.length==2&&(Ve.assertParamValue(Gt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let n=Array(e.length);for(let a=0;a<e.length;a++)n[a]=Gt.verifySodaDoc(e[a]);let i=await this._impl.insertManyAndGet(n,s);for(let a=0;a<e.length;a++){let c=n[a]=new ti;c._impl=i[a]}return n}async insertOne(e){Ve.assertArgCount(arguments,1,1),e=Gt.verifySodaDoc(e);let t={autoCommit:Es.autoCommit};await this._impl.insertOne(e,t)}async insertOneAndGet(e,t){let s={autoCommit:Es.autoCommit};Ve.assertArgCount(arguments,1,2),e=Gt.verifySodaDoc(e),arguments.length==2&&(Ve.assertParamValue(Gt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let n=new ti;return n._impl=await this._impl.insertOneAndGet(e,s),n}async listIndexes(){return(await this._impl.listIndexes()).map(t=>JSON.parse(t))}get metaData(){return JSON.parse(this._impl.getMetaData())}get name(){return this._impl.getName()}async save(e){Ve.assertArgCount(arguments,1,1),e=Gt.verifySodaDoc(e);let t={autoCommit:Es.autoCommit};await this._impl.save(e,t)}async saveAndGet(e,t){Ve.assertArgCount(arguments,1,2),e=Gt.verifySodaDoc(e);let s={autoCommit:Es.autoCommit};arguments.length==2&&(Ve.assertParamValue(Gt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let n=new ti;return n._impl=await this._impl.saveAndGet(e,s),n}async truncate(){Ve.assertArgCount(arguments,0,0),await this._impl.truncate()}};_(P_,"SodaCollection");var si=P_;Gt.wrapFns(si.prototype,"createIndex","drop","dropIndex","getDataGuide","insertMany","insertManyAndGet","insertOne","insertOneAndGet","listIndexes","save","saveAndGet","truncate");QS.exports=si});var C_=m((OU,ZS)=>{"use strict";var{Buffer:I_}=require("buffer"),jS=R_(),JI=Sr(),lt=W(),vs=et(),JS=Ft(),D_=class D_{_getConnection(){return this._connection}async createCollection(e,t){let s={autoCommit:JS.autoCommit};lt.assertArgCount(arguments,1,2),lt.assertParamValue(typeof e=="string",1),arguments.length==2&&(lt.assertParamValue(vs.isObject(t),2),t.mode!==void 0&&(lt.assertParamPropValue(Number.isInteger(t.mode)&&t.mode>0,2,"mode"),s.mode=t.mode),t.metaData!==void 0&&(lt.assertParamPropValue(vs.isObject(t.metaData),2,"metaData"),s.metaData=JSON.stringify(t.metaData)));let n=new jS;return n._impl=await this._impl.createCollection(e,s),n}createDocument(e,t){let s={};lt.assertArgCount(arguments,1,2),lt.assertParamValue(I_.isBuffer(e)||typeof e=="string"||vs.isObject(e),1),arguments.length>1&&(lt.assertParamValue(vs.isObject(t),2),s=t,lt.assertParamPropString(s,2,"key"),lt.assertParamPropString(s,2,"mediaType")),typeof e=="string"?e=I_.from(e):vs.isObject(e)&&(e=I_.from(JSON.stringify(e)));let n=new JI;return n._impl=this._impl.createDocument(e,s),n}async getCollectionNames(e){let t={};return lt.assertArgCount(arguments,0,1),arguments.length==1&&(lt.assertParamValue(vs.isObject(e),1),t=e,t.startsWith!==void 0&&lt.assertParamPropValue(typeof t.startsWith=="string",1,"startsWith"),t.limit!==void 0&&lt.assertParamPropValue(Number.isInteger(t.limit),1,"limit")),await this._impl.getCollectionNames(t)}async openCollection(e){lt.assertArgCount(arguments,1,1),lt.assertParamValue(typeof e=="string",1);let t={autoCommit:JS.autoCommit},s=await this._impl.openCollection(e,t);if(s){let n=new jS;return n._impl=s,n}}};_(D_,"SodaDatabase");var ri=D_;vs.wrapFns(ri.prototype,"createCollection","getCollectionNames","openCollection");ZS.exports=ri});var L_=m((yU,rA)=>{"use strict";var ZI=N_(),dr=hr(),{Buffer:eA}=require("buffer"),O_=ks(),ni=Xn(),eD=C_(),tD=require("events"),sD=o_(),f=W(),Ne=et(),ii=ur(),rD=require("process"),nD=require("util"),Be=nt(),g_=Ft(),tA=$n(),De=Tt(),sA=vn(),vr=new Map,y_=class y_ extends tD{constructor(){super(),this._dbObjectClasses=new Map,this._closing=!1}_addDefaultsToExecOpts(e){e.connection=this,e.keepInStmtCache===void 0&&(e.keepInStmtCache=!0),g_.addToOptions(e,"autoCommit","dbObjectAsPojo","fetchArraySize","fetchTypeHandler","maxRows","outFormat","prefetchRows")}_buildDbObjectClass(e){let t=_(function(s){if(this._impl=new ii.DbObjectImpl(e),this.isCollection){let n=new Proxy(this,dr._collectionProxyHandler);if(s!==void 0)for(let i=0;i<s.length;i++)this.append(s[i]);return n}else s!==void 0&&Object.assign(this,s)},"DbObject");if(t.prototype=Object.create(dr.prototype),t.prototype.constructor=t,t.prototype._objType=e,e.elementTypeClass){let s=this._getDbObjectClass(e.elementTypeClass);e.elementTypeClass=s}if(e.isCollection&&(Ne.addTypeProperties(e,"elementType"),e.elementTypeInfo.type=e.elementType),e.attributes){let s={};for(let n of e.attributes){n.typeClass&&(n.typeClass=this._getDbObjectClass(n.typeClass)),Ne.addTypeProperties(n,"type");let i={get(){return this._getAttrValue(n)},set(a){this._setAttrValue(n,a)}};s[n.name]=i}Object.defineProperties(t.prototype,s)}return t.toString=function(){return"DbObjectClass ["+e.fqn+"]"},t}_getDbObjectClass(e){if(e.prototype instanceof dr)return e;let t=this._dbObjectClasses.get(e);return t||(t=this._buildDbObjectClass(e),t._connection=this,t._objType=e,e._connection=this._impl,this._dbObjectClasses.set(e,t)),t}async _getDbObjectClassForName(e){let t=this._dbObjectClasses.get(e);if(!t){let s=await this._impl.getDbObjectClass(e);t=this._getDbObjectClass(s),this._dbObjectClasses.set(e,t)}return t}_isBindDir(e){return e===Be.BIND_IN||e===Be.BIND_OUT||e===Be.BIND_INOUT}_isBindValue(e){return e==null||typeof e=="number"||typeof e=="string"||typeof e=="boolean"||typeof e=="bigint"||Array.isArray(e)||Ne.isVectorValue(e)||eA.isBuffer(e)||nD.types.isDate(e)||e instanceof O_||e instanceof ni||e instanceof dr}async _processBindUnit(e,t,s){let n=!1;if(t.dir===void 0?e.dir=Be.BIND_IN:(f.assert(this._isBindDir(t.dir),f.ERR_INVALID_BIND_DIRECTION),e.dir=t.dir,n=!0),t.type!==void 0?(typeof t.type=="string"?(e.type=De.DB_TYPE_OBJECT,e.typeClass=await this._getDbObjectClassForName(t.type),e.objType=e.typeClass._objType):t.type.prototype instanceof dr?(e.type=De.DB_TYPE_OBJECT,e.typeClass=t.type,e.objType=e.typeClass._objType):(f.assert(t.type instanceof De.DbType,f.ERR_INVALID_BIND_DATA_TYPE,2),e.type=t.type),n=!0):s&&(e.name&&f.throwErr(f.ERR_MISSING_TYPE_BY_NAME,e.name),f.throwErr(f.ERR_MISSING_TYPE_BY_POS,e.pos)),(e.dir!==Be.BIND_IN||s)&&(t.maxSize!==void 0?(f.assertParamPropValue(Number.isInteger(t.maxSize)&&t.maxSize>0,2,"maxSize"),e.maxSize=t.maxSize,e.checkSize=!0,n=!0):s?(e.type===De.DB_TYPE_VARCHAR||e.type===De.DB_TYPE_RAW)&&(e.name&&f.throwErr(f.ERR_MISSING_MAX_SIZE_BY_NAME,e.name),f.throwErr(f.ERR_MISSING_MAX_SIZE_BY_POS,e.pos)):e.maxSize=Be.DEFAULT_MAX_SIZE_FOR_OUT_BINDS),e.isArray=!1,s||t.maxArraySize!==void 0&&(f.assertParamPropValue(Number.isInteger(t.maxArraySize)&&t.maxArraySize>0,2,"maxArraySize"),e.maxArraySize=t.maxArraySize,e.isArray=!0),!s&&t.val!==void 0)return t.val;n||f.throwErr(f.ERR_INVALID_BIND_UNIT)}async _processBindValue(e,t,s){let n=tA.transformValueIn(e,t,s);e.isArray?e.values=n.concat(e.values.slice(n.length)):e.values[s.pos]=n,e.type===De.DB_TYPE_OBJECT&&e.typeClass===void 0&&(e.typeClass=await this._getDbObjectClass(t._objType),e.objType=e.typeClass._objType)}async _processExecuteBind(e,t){e.isArray=!1;let s;if(this._isBindValue(t)?(e.dir=Be.BIND_IN,s=t):s=await this._processBindUnit(e,t,!1),e.dir!==Be.BIND_OUT){let n={pos:0,allowArray:!0};await this._processBindValue(e,s,n)}e.type===void 0&&(e.type=De.DB_TYPE_VARCHAR,e.maxSize===void 0&&(e.maxSize=1)),e.isArray&&e.type!==De.DB_TYPE_VARCHAR&&e.type!==De.DB_TYPE_NVARCHAR&&e.type!==De.DB_TYPE_CHAR&&e.type!==De.DB_TYPE_NCHAR&&e.type!==De.DB_TYPE_NUMBER&&e.type!==De.DB_TYPE_BINARY_FLOAT&&e.type!==De.DB_TYPE_BINARY_DOUBLE&&e.type!==De.DB_TYPE_DATE&&e.type!==De.DB_TYPE_TIMESTAMP&&e.type!==De.DB_TYPE_TIMESTAMP_LTZ&&e.type!==De.DB_TYPE_TIMESTAMP_TZ&&e.type!==De.DB_TYPE_RAW&&f.throwErr(f.ERR_INVALID_TYPE_FOR_ARRAY_BIND)}async _processExecuteBinds(e){let t=[];if(Array.isArray(e))for(let s=0;s<e.length;s++){let n=t[s]={pos:s+1,values:[]};await this._processExecuteBind(n,e[s])}else{f.assertParamValue(Ne.isObject(e),2);let s=Object.getOwnPropertyNames(e);for(let n=0;n<s.length;n++){let i=t[n]={name:s[n],values:[]};await this._processExecuteBind(i,e[s[n]])}}return t}async _processExecuteManyBinds(e,t){let s=[],n;if(t!==void 0)if(Array.isArray(t)){n=!0;for(let i=0;i<t.length;i++){let a=s[i]={pos:i+1,values:[]};await this._processBindUnit(a,t[i],!0)}}else{n=!1;let i=Object.getOwnPropertyNames(t);for(let a=0;a<i.length;a++){let c=s[a]={name:i[a],values:[]};await this._processBindUnit(c,t[i[a]],!0)}}else{let i=e[0];if(f.assertParamValue(Ne.isObjectOrArray(i),2),Array.isArray(i)){n=!0;for(let a=0;a<i.length;a++)s[a]={pos:a+1}}else{n=!1;let a=Object.getOwnPropertyNames(i);for(let c=0;c<a.length;c++)s[c]={name:a[c]}}for(let a=0;a<s.length;a++)s[a].dir=Be.BIND_IN,s[a].isArray=!1,s[a].values=[]}for(let i=0;i<e.length;i++){let a=e[i],c={pos:i,allowArray:!1};f.assert(n&&Array.isArray(a)||!n&&Ne.isObject(a),f.ERR_MIXED_BIND);for(let T=0;T<s.length;T++){let l=s[T],E=n?a[T]:a[l.name];await this._processBindValue(l,E,c)}}for(let i=0;i<s.length;i++){let a=s[i];a.type===void 0&&(a.type=De.DB_TYPE_VARCHAR,a.maxSize=1)}return s}_transformOutBind(e,t){let s=e;if(Array.isArray(e)){s=[];for(let n=0;n<e.length;n++)s.push(this._transformOutBind(e[n],t))}else if(e instanceof ii.ResultSetImpl)s=new ni,s._setup(this,e);else if(e instanceof ii.LobImpl)s=new O_,s._setup(e,!0);else if(e instanceof ii.DbObjectImpl){let n=this._dbObjectClasses.get(e._objType);s=Object.create(n.prototype),s._impl=e,t.dbObjectAsPojo?s=s._toPojo():s.isCollection&&(s=new Proxy(s,dr._collectionProxyHandler))}return s}_verifyExecOpts(e,t){let s={};if(f.assertParamValue(Ne.isObject(e),3),e.autoCommit!==void 0&&(f.assertParamPropValue(typeof e.autoCommit=="boolean",3,"autoCommit"),s.autoCommit=e.autoCommit),e.dbObjectAsPojo!==void 0&&(f.assertParamPropValue(typeof e.dbObjectAsPojo=="boolean",3,"dbObjectAsPojo"),s.dbObjectAsPojo=e.dbObjectAsPojo),e.keepInStmtCache!==void 0&&(f.assertParamPropValue(typeof e.keepInStmtCache=="boolean",3,"keepInStmtCache"),s.keepInStmtCache=e.keepInStmtCache),t)e.bindDefs!==void 0&&(f.assertParamPropValue(Ne.isObjectOrArray(e.bindDefs),3,"bindDefs"),s.bindDefs=e.bindDefs),e.batchErrors!==void 0&&(f.assertParamPropValue(typeof e.batchErrors=="boolean",3,"batchErrors"),s.batchErrors=e.batchErrors),e.dmlRowCounts!==void 0&&(f.assertParamPropValue(typeof e.dmlRowCounts=="boolean",3,"dmlRowCounts"),s.dmlRowCounts=e.dmlRowCounts);else{if(f.assertParamPropUnsignedIntNonZero(e,3,"fetchArraySize"),s.fetchArraySize=e.fetchArraySize,e.fetchInfo!==void 0){f.assertParamPropValue(Ne.isObject(e.fetchInfo),3,"fetchInfo");let n=Object.getOwnPropertyNames(e.fetchInfo),i=new Map(g_.fetchTypeMap);for(let a of n){let c=e.fetchInfo[a];c.type===void 0&&f.throwErr(f.ERR_NO_TYPE_FOR_CONVERSION),c.type!==Be.DEFAULT&&c.type!==De.DB_TYPE_VARCHAR&&c.type!==De.DB_TYPE_RAW&&f.throwErr(f.ERR_INVALID_TYPE_FOR_CONVERSION),i.set(a,c.type)}s.fetchTypeMap=i}if(e.fetchTypeHandler!==void 0){let n=typeof e.fetchTypeHandler;f.assertParamPropValue(n==="function",3,"fetchTypeHandler"),s.fetchTypeHandler=e.fetchTypeHandler}e.maxRows!==void 0&&(f.assertParamPropValue(Number.isInteger(e.maxRows)&&e.maxRows>=0,3,"maxRows"),s.maxRows=e.maxRows),e.outFormat!==void 0&&(f.assertParamPropValue(e.outFormat===Be.OUT_FORMAT_ARRAY||e.outFormat===Be.OUT_FORMAT_OBJECT,3,"outFormat"),s.outFormat=e.outFormat),e.prefetchRows!==void 0&&(f.assertParamPropValue(Number.isInteger(e.prefetchRows)&&e.prefetchRows>=0,3,"prefetchRows"),s.prefetchRows=e.prefetchRows),e.resultSet!==void 0&&(f.assertParamPropValue(typeof e.resultSet=="boolean",3,"resultSet"),s.resultSet=e.resultSet)}return s}get action(){return null}set action(e){f.assertPropValue(typeof e=="string","action"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setAction(e)}async breakExecution(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.breakExecution()}get callTimeout(){if(this._impl)return this._impl.getCallTimeout()}set callTimeout(e){f.assertPropValue(Number.isInteger(e)&&e>=0,"callTimeout"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setCallTimeout(e)}async changePassword(e,t,s){f.assertArgCount(arguments,3,3),f.assertParamValue(typeof e=="string",1),f.assertParamValue(typeof t=="string",2),f.assertParamValue(typeof s=="string",3),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.changePassword(e,t,s)}get clientId(){return null}set clientId(e){f.assertPropValue(typeof e=="string","clientId"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setClientId(e)}get clientInfo(){return null}set clientInfo(e){f.assertPropValue(typeof e=="string","clientInfo"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setClientInfo(e)}async close(e){let t={};f.assertArgCount(arguments,0,1),arguments.length==1&&(f.assertParamValue(Ne.isObject(e),1),t=e,f.assertParamPropBool(t,1,"drop")),f.assert(this._impl&&!this._closing,f.ERR_INVALID_CONNECTION),this._closing=!0;try{await this._impl.close(t)}finally{this._closing=!1}delete this._impl,this._dbObjectClasses.clear(),this.emit("_afterConnClose")}async commit(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.commit()}async createLob(e){f.assertArgCount(arguments,1,1),f.assertParamValue(e===De.DB_TYPE_CLOB||e===De.DB_TYPE_BLOB||e===De.DB_TYPE_NCLOB,1),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let t=new O_;return t._setup(await this._impl.createLob(e),!1),t}get currentSchema(){if(this._impl)return this._impl.getCurrentSchema()}set currentSchema(e){f.assertPropValue(typeof e=="string","currentSchema"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setCurrentSchema(e)}get dbOp(){return null}set dbOp(e){f.assertPropValue(typeof e=="string","dbOp"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setDbOp(e)}get thin(){return g_.thin}get ecid(){return null}set ecid(e){f.assertPropValue(typeof e=="string","ecid"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setECID(e)}decodeOSON(e){return f.assertArgCount(arguments,1,1),f.assertParamValue(eA.isBuffer(e),1),new sA.OsonDecoder(e).decode()}encodeOSON(e){return new sA.OsonEncoder().encode(tA.transformJsonValue(e),this._impl._osonMaxFieldNameSize)}async execute(e,t,s){let i=[],a={};Ne.isObject(e)&&typeof e.statement=="string"?(f.assertArgCount(arguments,1,2),e.values&&(i=await this._processExecuteBinds(e.values)),e=e.statement,arguments.length==2&&(a=this._verifyExecOpts(t,!1))):(f.assertArgCount(arguments,1,3),f.assertParamValue(typeof e=="string",1),arguments.length>=2&&(i=await this._processExecuteBinds(t)),arguments.length==3&&(a=this._verifyExecOpts(s,!1))),this._addDefaultsToExecOpts(a),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let c;try{c=await this._impl.execute(e,1,i,a,!1)}catch(T){throw T.errorNum===1406&&f.throwErr(f.ERR_INSUFFICIENT_BUFFER_FOR_BINDS),T}if(c.warning&&(c.warning=f.transformErr(c.warning)),c.resultSet!==void 0){let T=new ni;T._setup(this,c.resultSet),c.metaData=T._impl.metaData,a.resultSet?c.resultSet=T:(c.rows=await T._getAllRows(),delete c.resultSet)}if(c.outBinds!==void 0)for(let[T,l]of Object.entries(c.outBinds)){let E=this._transformOutBind(l,a);c.outBinds[T]=E}if(c.implicitResults)for(let[T,l]of Object.entries(c.implicitResults)){let E=new ni;E._setup(this,l),a.resultSet?c.implicitResults[T]=E:c.implicitResults[T]=await E._getAllRows()}return c}async executeMany(e,t,s){let n={},i=[],a;f.assertArgCount(arguments,2,3),f.assertParamValue(typeof e=="string",1),arguments.length==3&&(n=this._verifyExecOpts(s,!0)),this._addDefaultsToExecOpts(n),typeof t=="number"?(f.assertParamValue(Number.isInteger(t)&&t>0,2),a=t,n.bindDefs!==void 0&&(i=await this._processExecuteManyBinds([],n.bindDefs))):(f.assertParamValue(Array.isArray(t)&&t.length>0,2),a=t.length,i=await this._processExecuteManyBinds(t,n.bindDefs)),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let c=await this._impl.execute(e,a,i,n,!0);if(c.warning&&(c.warning=f.transformErr(c.warning)),c.outBinds!==void 0)for(let T=0;T<c.outBinds.length;T++){let l=c.outBinds[T];for(let[E,u]of Object.entries(l))l[E]=this._transformOutBind(u,n)}return c}get externalName(){if(this._impl)return this._impl.getExternalName()}set externalName(e){f.assertPropValue(typeof e=="string","externalName"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setExternalName(e)}get dbDomain(){return this._impl&&this._impl.getDbDomain()}get dbName(){return this._impl&&this._impl.getDbName()}async getDbObjectClass(e){return f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._getDbObjectClassForName(e)}async getQueue(e,t){let s={};f.assertArgCount(arguments,1,2),f.assertParamValue(typeof e=="string",1),arguments.length==2&&(f.assertParamValue(Ne.isObject(t),2),s={...t}),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let n=new ZI;return await n.create(this,e,s),n}getSodaDatabase(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let e=new eD;return e._impl=this._impl.getSodaDatabase(),e}async getStatementInfo(e){f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let t=await this._impl.getStatementInfo(e);if(t.metaData)for(let s=0;s<t.metaData.length;s++){let n=t.metaData[s];Ne.addTypeProperties(n,"dbType"),n.fetchType=De.DB_TYPE_FETCH_TYPE_MAP.get(n.dbType)}return t}get instanceName(){if(this._impl)return this._impl.getInstanceName()}get internalName(){if(this._impl)return this._impl.getInternalName()}set internalName(e){f.assertPropValue(typeof e=="string","internalName"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setInternalName(e)}isHealthy(){return this._impl!==void 0&&!this._closing&&this._impl.isHealthy()}get maxOpenCursors(){return this._impl&&this._impl.getMaxOpenCursors()}get warning(){let e=this._impl.getWarning();return e&&(e=f.transformErr(e)),this._impl&&e}get module(){return null}set module(e){f.assertPropValue(typeof e=="string","module"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setModule(e)}get oracleServerVersion(){if(this._impl)return this._impl.getOracleServerVersion()}get oracleServerVersionString(){if(this._impl)return this._impl.getOracleServerVersionString()}get serviceName(){return this._impl&&this._impl.getServiceName()}get transactionInProgress(){return this._impl&&this._impl.getTransactionInProgress()}async ping(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.ping()}queryStream(e,t,s){f.assertArgCount(arguments,1,3),f.assertParamValue(typeof e=="string",1),arguments.length==3?(f.assertParamValue(Ne.isObject(s),3),s={...s}):s={},s.resultSet=!0;let n=new sD;return rD.nextTick(async()=>{try{let i=await this.execute(e,t||[],s);i.resultSet||f.throwErr(f.ERR_NOT_A_QUERY),n._open(i.resultSet)}catch(i){n.destroy(i);return}}),n}async rollback(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.rollback()}async shutdown(e){let t=Be.SHUTDOWN_MODE_DEFAULT;f.assertArgCount(arguments,0,1),e!==void 0&&(f.assertParamValue(typeof t=="number",1),t=e),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.shutdown(t)}async startup(e){let t={};f.assertArgCount(arguments,0,1),arguments.length==1&&(f.assertParamValue(typeof t=="object",1),t=e,f.assertParamPropBool(t,1,"force"),f.assertParamPropBool(t,1,"restrict"),f.assertParamPropString(t,1,"pfile")),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.startup(t)}get stmtCacheSize(){if(this._impl)return this._impl.getStmtCacheSize()}set stmtCacheSize(e){f.assertPropValue(Number.isInteger(e)&&e>=0,"stmtCacheSize"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setStmtCacheSize(e)}async subscribe(e,t){f.assertArgCount(arguments,2,2),f.assertParamValue(typeof e=="string",1),f.assertParamValue(Ne.isObject(t),2),t={name:e,...t},f.assertParamPropUnsignedInt(t,2,"namespace"),t.namespace===void 0&&(t.namespace=Be.SUBSCR_NAMESPACE_DBCHANGE),f.assertParamPropString(t,2,"ipAddress"),f.assertParamPropUnsignedInt(t,2,"port"),f.assertParamPropUnsignedInt(t,2,"timeout"),f.assertParamPropUnsignedInt(t,2,"operations"),f.assertParamPropUnsignedInt(t,2,"qos"),f.assertParamPropUnsignedInt(t,2,"groupingClass"),f.assertParamPropUnsignedInt(t,2,"groupingValue"),f.assertParamPropUnsignedInt(t,2,"groupingType"),f.assertParamPropBool(t,2,"clientInitiated"),f.assertParamPropFunction(t,2,"callback"),f.assert(t.callback,f.ERR_MISSING_SUBSCR_CALLBACK),t.namespace===Be.SUBSCR_NAMESPACE_DBCHANGE&&(f.assertParamPropString(t,2,"sql"),f.assert(t.sql&&t.sql.length>0,f.ERR_MISSING_SUBSCR_SQL),t.binds!==void 0&&(t.binds=await this._processExecuteBinds(t.binds))),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let s=vr.get(e),n=await this._impl.subscribe(s,t),i;return t.namespace===Be.SUBSCR_NAMESPACE_DBCHANGE?(i=n.subscription,delete n.subscription):i=n,vr.set(e,i),n}get tag(){if(this._impl)return this._impl.getTag()}set tag(e){f.assertPropValue(typeof e=="string","tag"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setTag(e)}async tpcBegin(e,t,s){f.assertArgCount(arguments,1,3),f.assertParamValue(Ne.isXid(e),1);let n=Ne.normalizeXid(e);arguments.length<3?s=60:f.assertParamValue(typeof s=="number",3),arguments.length<2?t=Be.TPC_BEGIN_NEW:(f.assertParamValue(typeof t=="number",2),[Be.TPC_BEGIN_NEW,Be.TPC_BEGIN_JOIN,Be.TPC_BEGIN_RESUME,Be.TPC_BEGIN_PROMOTE].indexOf(t)<0&&f.throwErr(f.ERR_INVALID_TPC_BEGIN_FLAGS)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcBegin(n,t,s)}async tpcCommit(e,t){f.assertArgCount(arguments,0,2),arguments.length<2?t=!1:f.assertParamValue(typeof t=="boolean",2);let s;arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),s=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcCommit(s,t)}async tpcEnd(e,t){f.assertArgCount(arguments,0,2),arguments.length<2?t=Be.TPC_END_NORMAL:(f.assertParamValue(typeof t=="number",2),[Be.TPC_END_NORMAL,Be.TPC_END_SUSPEND].includes(t)||f.throwErr(f.ERR_INVALID_TPC_END_FLAGS));let s;arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),s=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcEnd(s,t)}async tpcForget(e){f.assertArgCount(arguments,1,1),f.assertParamValue(Ne.isXid(e),1);let t=Ne.normalizeXid(e);f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcForget(t)}async tpcPrepare(e){f.assertArgCount(arguments,0,1);let t;return arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),t=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcPrepare(t)}async tpcRecover(e){f.assertArgCount(arguments,0,1),arguments.length==1?f.assertParamValue(typeof e=="boolean",1):e=!0;let t=`
      SELECT
          formatid as "formatId",
          UTL_RAW.CAST_TO_VARCHAR2(globalid) as "globalTransactionId",
          UTL_RAW.CAST_TO_VARCHAR2(branchid) as "branchQualifier"
      FROM DBA_PENDING_TRANSACTIONS`,s=`
      SELECT
          formatid as "formatId",
          globalid as "globalTransactionId",
          branchid as "branchQualifier"
      FROM DBA_PENDING_TRANSACTIONS`,n={outFormat:Be.OUT_FORMAT_OBJECT,resultSet:!1};return(await this.execute(e?t:s,{},n)).rows}async tpcRollback(e){f.assertArgCount(arguments,0,1);let t;arguments.length==1&&(f.assertParamValue(Ne.isXid(e),1),t=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcRollback(t)}async unsubscribe(e){f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION),f.assert(vr.has(e),f.ERR_INVALID_SUBSCR),await this._impl.unsubscribe(vr.get(e)),vr.delete(e)}};_(y_,"Connection");var Jt=y_;Jt.prototype.break=Ne.callbackify(Jt.prototype.breakExecution);Jt.prototype.tpcRecover=Ne.callbackify(Jt.prototype.tpcRecover);Ne.wrapFns(Jt.prototype,"changePassword","close","commit","createLob","execute","executeMany","getDbObjectClass","getQueue","getStatementInfo","ping","rollback","shutdown","startup","subscribe","tpcBegin","tpcCommit","tpcEnd","tpcForget","tpcPrepare","tpcRollback","unsubscribe");Jt.prototype.release=Jt.prototype.close;rA.exports=Jt});var U_=m((wU,nA)=>{"use strict";var iD=require("process"),oD=Ft(),B_=class B_{constructor(e){let t=0;e._totalRequestsEnqueued!==0&&(t=Math.round(e._totalTimeInQueue/e._totalRequestsEnqueued)),this.gatheredDate=Date.now(),this.upTime=this.gatheredDate-e._createdDate,this.upTimeSinceReset=this.gatheredDate-e._timeOfReset,this.connectionRequests=e._totalConnectionRequests,this.requestsEnqueued=e._totalRequestsEnqueued,this.requestsDequeued=e._totalRequestsDequeued,this.failedRequests=e._totalFailedRequests,this.rejectedRequests=e._totalRequestsRejected,this.requestTimeouts=e._totalRequestTimeouts,this.maximumQueueLength=e._maximumQueueLength,this.currentQueueLength=e._connRequestQueue.length,this.timeInQueue=e._totalTimeInQueue,this.minimumTimeInQueue=e._minTimeInQueue,this.maximumTimeInQueue=e._maxTimeInQueue,this.averageTimeInQueue=t,this.connectionsInUse=e.connectionsInUse,this.connectionsOpen=e.connectionsOpen,this.connectString=e.connectString,this.edition=e.edition,this.events=e.events,this.externalAuth=e.externalAuth,this.homogeneous=e.homogeneous,this.poolAlias=e.poolAlias,this.poolIncrement=e.poolIncrement,this.poolMax=e.poolMax,this.poolMaxPerShard=e.poolMaxPerShard,this.poolMin=e.poolMin,this.poolPingInterval=e.poolPingInterval,this.poolPingTimeout=e.poolPingTimeout,this.poolTimeout=e.poolTimeout,this.queueMax=e.queueMax,this.queueTimeout=e.queueTimeout,this.sodaMetaDataCache=e.sodaMetaDataCache,this.stmtCacheSize=e.stmtCacheSize,this.user=e.user,this.threadPoolSize=iD.env.UV_THREADPOOL_SIZE,this.thin=oD.thin}logStatistics(){console.log(`
Driver:`),console.log("...thin mode:",this.thin),console.log("Pool statistics:"),console.log("...gathered at:",new Date(this.gatheredDate).toISOString()),console.log("...up time (milliseconds):",this.upTime),console.log("...up time from last reset (milliseconds)",this.upTimeSinceReset),console.log("...connection requests:",this.connectionRequests),console.log("...requests enqueued:",this.requestsEnqueued),console.log("...requests dequeued:",this.requestsDequeued),console.log("...requests failed:",this.failedRequests),console.log("...requests exceeding queueMax:",this.rejectedRequests),console.log("...requests exceeding queueTimeout:",this.requestTimeouts),console.log("...current queue length:",this.currentQueueLength),console.log("...maximum queue length:",this.maximumQueueLength),console.log("...sum of time in queue (milliseconds):",this.timeInQueue),console.log("...minimum time in queue (milliseconds):",this.minimumTimeInQueue),console.log("...maximum time in queue (milliseconds):",this.maximumTimeInQueue),console.log("...average time in queue (milliseconds):",this.averageTimeInQueue),console.log("...pool connections in use:",this.connectionsInUse),console.log("...pool connections open:",this.connectionsOpen),console.log("Pool attributes:"),console.log("...connectString:",this.connectString),console.log("...edition:",this.edition),console.log("...events:",this.events),console.log("...externalAuth:",this.externalAuth),console.log("...homogeneous:",this.homogeneous),console.log("...poolAlias:",this.poolAlias),console.log("...poolIncrement:",this.poolIncrement),console.log("...poolMax:",this.poolMax),console.log("...poolMaxPerShard:",this.poolMaxPerShard),console.log("...poolMin:",this.poolMin),console.log("...poolPingInterval (seconds):",this.poolPingInterval),console.log("...poolPingTimeout (milliseconds):",this.poolPingTimeout),console.log("...poolTimeout (seconds):",this.poolTimeout),console.log("...queueMax:",this.queueMax),console.log("...queueTimeout (milliseconds):",this.queueTimeout),console.log("...sessionCallback:",this.sessionCallback),console.log("...sodaMetaDataCache:",this.sodaMetaDataCache),console.log("...stmtCacheSize:",this.stmtCacheSize),console.log("...user:",this.user),console.log("Related environment variables:"),console.log("...UV_THREADPOOL_SIZE:",this.threadPoolSize)}};_(B_,"PoolStatistics");var w_=B_;nA.exports=w_});var aA=m((UU,oA)=>{"use strict";var aD=L_(),_D=require("events"),us=nt(),z=W(),iA=Ft(),Zt=et(),cD=ur(),TD=U_(),Y_=class Y_ extends _D{constructor(){super(),this._impl=new cD.PoolImpl,this._queueMax=0,this._queueTimeout=0,this._enableStatistics=!1,this._timeOfReset=this._createdDate=Date.now(),this._sessionCallback=void 0,this._connRequestQueue=[],this._connectionClass=iA.connectionClass}_checkPoolOpen(e){this.status===us.POOL_STATUS_DRAINING?z.throwErr(z.ERR_POOL_CLOSING):this.status===us.POOL_STATUS_CLOSED?z.throwErr(z.ERR_POOL_CLOSED):e||this.status===us.POOL_STATUS_RECONFIGURING&&z.throwErr(z.ERR_POOL_RECONFIGURING)}_checkRequestQueue(){let e=this._connectionsOut;for(;this._connRequestQueue.length>0&&e<this.poolMax;){e+=1;let t=this._connRequestQueue.shift();this._enableStatistics&&(this._totalRequestsDequeued+=1,this._updateWaitStatistics(t)),t.timeoutHandle&&clearTimeout(t.timeoutHandle),t.resolve()}}get _enableStats(){return this._enableStatistics}_resetStatistics(){this._timeOfReset=Date.now(),this._totalConnectionRequests=0,this._totalRequestsEnqueued=0,this._totalRequestsDequeued=0,this._totalFailedRequests=0,this._totalRequestsRejected=0,this._totalRequestTimeouts=0,this._maximumQueueLength=this._connRequestQueue.length,this._totalTimeInQueue=0,this._minTimeInQueue=0,this._maxTimeInQueue=0}_setup(e,t){this._queueTimeout=e.queueTimeout,this._queueMax=e.queueMax,this._enableStatistics=e.enableStatistics,this._edition=e.edition,this._eventsFlag=e.events,this._externalAuth=e.externalAuth,this._homogeneous=e.homogeneous,this._user=e.user,this._connectString=e.connectString,this._status=us.POOL_STATUS_OPEN,this._connectionsOut=0,this._poolAlias=t,this.on("_checkRequestQueue",this._checkRequestQueue),this._resetStatistics()}_updateWaitStatistics(e){let t=Date.now()-e.enqueuedTime;this._totalTimeInQueue+=t,this._minTimeInQueue===0?this._minTimeInQueue=t:this._minTimeInQueue=Math.min(this._minTimeInQueue,t),this._maxTimeInQueue=Math.max(this._maxTimeInQueue,t)}_verifyGetConnectionOptions(e){let t={};if(e.user!==void 0&&(z.assertParamPropValue(typeof e.user=="string",1,"user"),t.user=e.user),e.username!==void 0&&(z.assert(t.user===void 0,z.ERR_DBL_USER),z.assertParamPropValue(typeof e.username=="string",1,"username"),t.user=e.username),this.externalAuth&&t.user&&(t.user[0]!=="["||t.user.slice(-1)!=="]")&&z.throwErr(z.ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY),e.password!==void 0&&(z.assertParamPropValue(typeof e.password=="string",1,"password"),this.externalAuth&&z.throwErr(z.ERR_WRONG_CRED_FOR_EXTAUTH),t.password=e.password),e.tag!==void 0&&(z.assertParamPropValue(typeof e.tag=="string",1,"tag"),t.tag=e.tag),e.matchAnyTag!==void 0&&(z.assertParamPropValue(typeof e.matchAnyTag=="boolean",1,"matchAnyTag"),t.matchAnyTag=e.matchAnyTag),e.shardingKey!==void 0){let s=e.shardingKey;z.assertParamPropValue(Zt.isShardingKey(s),1,"shardingKey"),t.shardingKey=e.shardingKey}if(e.superShardingKey!==void 0){let s=e.superShardingKey;z.assertParamPropValue(Zt.isShardingKey(s),1,"superShardingKey"),t.superShardingKey=e.superShardingKey}return e.privilege!==void 0&&(z.assertParamPropValue(Zt.isPrivilege(e.privilege),1,"privilege"),t.privilege=e.privilege),t}async close(e){let t=0,s=!1;z.assertArgCount(arguments,0,1),arguments.length==1&&(z.assertParamValue(typeof e=="number",1),(e<0||isNaN(e)||e>2**31)&&z.throwErr(z.ERR_INVALID_PARAMETER_VALUE,1),s=!0,this._connectionsOut>0&&(t=e*1e3)),this._checkPoolOpen(!1),t>0&&(this._status=us.POOL_STATUS_DRAINING,await new Promise(n=>{let i=setTimeout(()=>{this.removeAllListeners("_allCheckedIn"),n()},t);this.once("_allCheckedIn",()=>{clearTimeout(i),n()})})),!s&&this._connectionsOut>0&&z.throwErr(z.ERR_POOL_HAS_BUSY_CONNECTIONS),await this._impl.close(),this._status=us.POOL_STATUS_CLOSED,this.emit("_afterPoolClose")}get connectionsInUse(){return this._impl.getConnectionsInUse()}get connectionsOpen(){return this._impl.getConnectionsOpen()}get connectString(){return this._connectString}get thin(){return iA.thin}get edition(){return this._edition}get enableStatistics(){return this._enableStatistics}get events(){return this._eventsFlag}get externalAuth(){return this._externalAuth}async getConnection(e){let t,s={};z.assertArgCount(arguments,0,1),arguments.length==1&&(z.assertParamValue(Zt.isObject(e),1),s=this._verifyGetConnectionOptions(e)),s.connectionClass=this._connectionClass,this._checkPoolOpen(!0),this._enableStatistics&&(this._totalConnectionRequests+=1);try{t=this.poolMax}catch(n){throw this._enableStatistics&&(this._totalFailedRequests+=1),n}(this._connectionsOut>=t||this.status===us.POOL_STATUS_RECONFIGURING)&&(this._connRequestQueue.length>=this._queueMax&&this._queueMax>=0&&(this._enableStatistics&&(this._totalRequestsRejected+=1),z.throwErr(z.ERR_QUEUE_MAX_EXCEEDED,this._queueMax)),await new Promise((n,i)=>{let a={resolve:n,reject:i};this._queueTimeout!==0&&(a.timeoutHandle=setTimeout(()=>{let c=this._connRequestQueue.indexOf(a);c>=0&&this._connRequestQueue.splice(c,1),this._enableStatistics&&(this._totalRequestTimeouts+=1,this._updateWaitStatistics(a));try{z.throwErr(z.ERR_CONN_REQUEST_TIMEOUT,this._queueTimeout)}catch(T){i(T)}},this._queueTimeout)),this._connRequestQueue.push(a),this._enableStatistics&&(a.enqueuedTime=Date.now(),this._totalRequestsEnqueued+=1,this._maximumQueueLength=Math.max(this._maximumQueueLength,this._connRequestQueue.length))}),this._checkPoolOpen(!0)),this._connectionsOut+=1;try{let n=new aD;n._impl=await this._impl.getConnection(s),n._pool=this;let i=s.tag||"";if(typeof this.sessionCallback=="function"&&(n._impl._newSession||n.tag!=i))try{await new Promise((a,c)=>{this.sessionCallback(n,i,function(T){T?c(T):a()})})}catch(a){throw await n.close({drop:!0}),a}return n.on("_afterConnClose",()=>{this._connectionsOut-=1,this.emit("_checkRequestQueue"),this._connectionsOut==0&&this.emit("_allCheckedIn")}),n}catch(n){throw this._connectionsOut-=1,this._enableStatistics&&(this._totalFailedRequests+=1),this.emit("_checkRequestQueue"),n}}getStatistics(){return this._checkPoolOpen(!1),this._enableStatistics!==!0?null:new TD(this)}get homogeneous(){return this._homogeneous}logStatistics(){let e=this.getStatistics();e===null&&z.throwErr(z.ERR_POOL_STATISTICS_DISABLED),e.logStatistics()}get poolAlias(){return this._poolAlias}get poolIncrement(){return this._impl.getPoolIncrement()}get poolMax(){return this._impl.getPoolMax()}get poolMaxPerShard(){return this._impl.getPoolMaxPerShard()}get poolMin(){return this._impl.getPoolMin()}get poolPingInterval(){return this._impl.getPoolPingInterval()}get poolPingTimeout(){return this._impl.getPoolPingTimeout()}get poolTimeout(){return this._impl.getPoolTimeout()}get queueMax(){return this._queueMax}get queueTimeout(){return this._queueTimeout}async reconfigure(e){z.assertArgCount(arguments,1,1),z.assertParamValue(Zt.isObject(e)),z.assertParamPropUnsignedInt(e,1,"queueMax"),z.assertParamPropUnsignedInt(e,1,"queueTimeout"),z.assertParamPropBool(e,1,"enableStatistics"),z.assertParamPropBool(e,1,"resetStatistics"),z.assertParamPropUnsignedInt(e,1,"poolMin"),z.assertParamPropUnsignedIntNonZero(e,1,"poolMax"),z.assertParamPropUnsignedInt(e,1,"poolMaxPerShard"),z.assertParamPropUnsignedInt(e,1,"poolIncrement"),z.assertParamPropInt(e,1,"poolPingInterval"),z.assertParamPropUnsignedInt(e,1,"poolTimeout"),z.assertParamPropUnsignedInt(e,1,"stmtCacheSize"),z.assertParamPropBool(e,1,"sodaMetaDataCache"),e.poolMin>e.poolMax&&z.throwErr(z.ERR_INVALID_NUMBER_OF_CONNECTIONS,e.poolMax,e.poolMin),this._checkPoolOpen(!1),this._status=us.POOL_STATUS_RECONFIGURING;try{await this._impl.reconfigure(e),(e.resetStatistics==!0||e.enableStatistics==!0&&this._enableStatistics==!1)&&this._resetStatistics(),e.queueMax!==void 0&&(this._queueMax=e.queueMax),e.queueTimeout!==void 0&&(this._queueTimeout=e.queueTimeout),e.enableStatistics!==void 0&&(this._enableStatistics=e.enableStatistics)}finally{this._status=us.POOL_STATUS_OPEN}this.emit("_checkRequestQueue")}get sessionCallback(){return this._sessionCallback}async setAccessToken(e){z.assertArgCount(arguments,1,1),z.assertParamValue(Zt.isObject(e),1),z.assertParamPropString(e,1,"token"),z.assertParamPropString(e,1,"privateKey"),await this._impl.setAccessToken(e)}get sodaMetaDataCache(){return this._impl.getSodaMetaDataCache()}get status(){return this._status}get stmtCacheSize(){return this._impl.getStmtCacheSize()}get user(){return this._user}};_(Y_,"Pool");var pt=Y_;pt.prototype.close=Zt.callbackify(pt.prototype.close);pt.prototype.getConnection=Zt.callbackify(pt.prototype.getConnection);pt.prototype.reconfigure=Zt.callbackify(pt.prototype.reconfigure);pt.prototype.setAccessToken=Zt.callbackify(pt.prototype.setAccessToken);pt.prototype.terminate=pt.prototype.close;pt.prototype._logStats=pt.prototype.logStatistics;oA.exports=pt});var Ue=m((MU,TA)=>{"use strict";var{Buffer:_A}=require("buffer"),je=nt(),cA=Fr();TA.exports={BIND_IN:je.BIND_IN,BIND_INOUT:je.BIND_INOUT,BIND_OUT:je.BIND_OUT,CLIENT_VERSION:je.VERSION_MAJOR<<24|je.VERSION_MINOR<<20|je.VERSION_PATCH<<12,CSFRM_IMPLICIT:je.CSFRM_IMPLICIT,CSFRM_NCHAR:je.CSFRM_NCHAR,DRIVER_NAME:je.DEFAULT_DRIVER_NAME+" thn",PURITY_DEFAULT:je.PURITY_DEFAULT,PURITY_NEW:je.PURITY_NEW,PURITY_SELF:je.PURITY_SELF,SYSASM:je.SYSASM,SYSBKP:je.SYSBKP,SYSDBA:je.SYSDBA,SYSDG:je.SYSDG,SYSKM:je.SYSKM,SYSOPER:je.SYSOPER,SYSRAC:je.SYSRAC,AUTH_MODE_DEFAULT:0,AUTH_MODE_PRELIM:8,AUTH_MODE_SYSASM:32768,AUTH_MODE_SYSBKP:131072,AUTH_MODE_SYSDBA:2,AUTH_MODE_SYSDGD:262144,AUTH_MODE_SYSKMT:524288,AUTH_MODE_SYSOPER:4,AUTH_MODE_SYSRAC:1048576,TNS_AUTH_MODE_LOGON:1,TNS_AUTH_MODE_CHANGE_PASSWORD:2,TNS_AUTH_MODE_SYSDBA:32,TNS_AUTH_MODE_SYSOPER:64,TNS_AUTH_MODE_PRELIM:128,TNS_AUTH_MODE_WITH_PASSWORD:256,TNS_AUTH_MODE_SYSASM:4194304,TNS_AUTH_MODE_SYSBKP:16777216,TNS_AUTH_MODE_SYSDGD:33554432,TNS_AUTH_MODE_SYSKMT:67108864,TNS_AUTH_MODE_SYSRAC:134217728,TNS_AUTH_MODE_IAM_TOKEN:536870912,TNS_PACKET_TYPE_CONNECT:1,TNS_PACKET_TYPE_ACCEPT:2,TNS_PACKET_TYPE_REFUSE:4,TNS_PACKET_TYPE_REDIRECT:5,TNS_PACKET_TYPE_DATA:6,TNS_PACKET_TYPE_RESEND:11,TNS_PACKET_TYPE_MARKER:12,TNS_PACKET_TYPE_CONTROL:14,TNS_DATA_TYPE_DEFAULT:0,TNS_DATA_TYPE_VARCHAR:1,TNS_DATA_TYPE_NUMBER:2,TNS_DATA_TYPE_BINARY_INTEGER:3,TNS_DATA_TYPE_FLOAT:4,TNS_DATA_TYPE_STR:5,TNS_DATA_TYPE_VNU:6,TNS_DATA_TYPE_PDN:7,TNS_DATA_TYPE_LONG:8,TNS_DATA_TYPE_VCS:9,TNS_DATA_TYPE_TIDDEF:10,TNS_DATA_TYPE_ROWID:11,TNS_DATA_TYPE_DATE:12,TNS_DATA_TYPE_VBI:15,TNS_DATA_TYPE_RAW:23,TNS_DATA_TYPE_LONG_RAW:24,TNS_DATA_TYPE_UB2:25,TNS_DATA_TYPE_UB4:26,TNS_DATA_TYPE_SB1:27,TNS_DATA_TYPE_SB2:28,TNS_DATA_TYPE_SB4:29,TNS_DATA_TYPE_SWORD:30,TNS_DATA_TYPE_UWORD:31,TNS_DATA_TYPE_PTRB:32,TNS_DATA_TYPE_PTRW:33,TNS_DATA_TYPE_OER8:290,TNS_DATA_TYPE_FUN:291,TNS_DATA_TYPE_AUA:292,TNS_DATA_TYPE_RXH7:293,TNS_DATA_TYPE_NA6:294,TNS_DATA_TYPE_OAC9:39,TNS_DATA_TYPE_AMS:40,TNS_DATA_TYPE_BRN:41,TNS_DATA_TYPE_BRP:298,TNS_DATA_TYPE_BRV:299,TNS_DATA_TYPE_KVA:300,TNS_DATA_TYPE_CLS:301,TNS_DATA_TYPE_CUI:302,TNS_DATA_TYPE_DFN:303,TNS_DATA_TYPE_DQR:304,TNS_DATA_TYPE_DSC:305,TNS_DATA_TYPE_EXE:306,TNS_DATA_TYPE_FCH:307,TNS_DATA_TYPE_GBV:308,TNS_DATA_TYPE_GEM:309,TNS_DATA_TYPE_GIV:310,TNS_DATA_TYPE_OKG:311,TNS_DATA_TYPE_HMI:312,TNS_DATA_TYPE_INO:313,TNS_DATA_TYPE_LNF:315,TNS_DATA_TYPE_ONT:316,TNS_DATA_TYPE_OPE:317,TNS_DATA_TYPE_OSQ:318,TNS_DATA_TYPE_SFE:319,TNS_DATA_TYPE_SPF:320,TNS_DATA_TYPE_VSN:321,TNS_DATA_TYPE_UD7:322,TNS_DATA_TYPE_DSA:323,TNS_DATA_TYPE_UIN:68,TNS_DATA_TYPE_PIN:327,TNS_DATA_TYPE_PFN:328,TNS_DATA_TYPE_PPT:329,TNS_DATA_TYPE_STO:331,TNS_DATA_TYPE_ARC:333,TNS_DATA_TYPE_MRS:334,TNS_DATA_TYPE_MRT:335,TNS_DATA_TYPE_MRG:336,TNS_DATA_TYPE_MRR:337,TNS_DATA_TYPE_MRC:338,TNS_DATA_TYPE_VER:339,TNS_DATA_TYPE_LON2:340,TNS_DATA_TYPE_INO2:341,TNS_DATA_TYPE_ALL:342,TNS_DATA_TYPE_UDB:343,TNS_DATA_TYPE_AQI:344,TNS_DATA_TYPE_ULB:345,TNS_DATA_TYPE_ULD:346,TNS_DATA_TYPE_SLS:91,TNS_DATA_TYPE_SID:348,TNS_DATA_TYPE_NA7:349,TNS_DATA_TYPE_LVC:94,TNS_DATA_TYPE_LVB:95,TNS_DATA_TYPE_CHAR:96,TNS_DATA_TYPE_AVC:97,TNS_DATA_TYPE_AL7:354,TNS_DATA_TYPE_K2RPC:355,TNS_DATA_TYPE_BINARY_FLOAT:100,TNS_DATA_TYPE_BINARY_DOUBLE:101,TNS_DATA_TYPE_CURSOR:102,TNS_DATA_TYPE_RDD:104,TNS_DATA_TYPE_XDP:359,TNS_DATA_TYPE_OSL:106,TNS_DATA_TYPE_OKO8:363,TNS_DATA_TYPE_EXT_NAMED:108,TNS_DATA_TYPE_INT_NAMED:109,TNS_DATA_TYPE_EXT_REF:110,TNS_DATA_TYPE_INT_REF:111,TNS_DATA_TYPE_CLOB:112,TNS_DATA_TYPE_BLOB:113,TNS_DATA_TYPE_BFILE:114,TNS_DATA_TYPE_CFILE:115,TNS_DATA_TYPE_RSET:116,TNS_DATA_TYPE_CWD:117,TNS_DATA_TYPE_JSON:119,TNS_DATA_TYPE_OAC122:120,TNS_DATA_TYPE_UD12:380,TNS_DATA_TYPE_AL8:381,TNS_DATA_TYPE_LFOP:382,TNS_DATA_TYPE_VECTOR:127,TNS_DATA_TYPE_FCRT:383,TNS_DATA_TYPE_DNY:384,TNS_DATA_TYPE_OPR:385,TNS_DATA_TYPE_PLS:386,TNS_DATA_TYPE_XID:387,TNS_DATA_TYPE_TXN:388,TNS_DATA_TYPE_DCB:389,TNS_DATA_TYPE_CCA:390,TNS_DATA_TYPE_WRN:391,TNS_DATA_TYPE_TLH:393,TNS_DATA_TYPE_TOH:394,TNS_DATA_TYPE_FOI:395,TNS_DATA_TYPE_SID2:396,TNS_DATA_TYPE_TCH:397,TNS_DATA_TYPE_PII:398,TNS_DATA_TYPE_PFI:399,TNS_DATA_TYPE_PPU:400,TNS_DATA_TYPE_PTE:401,TNS_DATA_TYPE_CLV:146,TNS_DATA_TYPE_RXH8:404,TNS_DATA_TYPE_N12:405,TNS_DATA_TYPE_AUTH:406,TNS_DATA_TYPE_KVAL:407,TNS_DATA_TYPE_DTR:152,TNS_DATA_TYPE_DUN:153,TNS_DATA_TYPE_DOP:154,TNS_DATA_TYPE_VST:155,TNS_DATA_TYPE_ODT:156,TNS_DATA_TYPE_FGI:413,TNS_DATA_TYPE_DSY:414,TNS_DATA_TYPE_DSYR8:415,TNS_DATA_TYPE_DSYH8:416,TNS_DATA_TYPE_DSYL:417,TNS_DATA_TYPE_DSYT8:418,TNS_DATA_TYPE_DSYV8:419,TNS_DATA_TYPE_DSYP:420,TNS_DATA_TYPE_DSYF:421,TNS_DATA_TYPE_DSYK:422,TNS_DATA_TYPE_DSYY:423,TNS_DATA_TYPE_DSYQ:424,TNS_DATA_TYPE_DSYC:425,TNS_DATA_TYPE_DSYA:426,TNS_DATA_TYPE_OT8:427,TNS_DATA_TYPE_DOL:172,TNS_DATA_TYPE_DSYTY:429,TNS_DATA_TYPE_AQE:430,TNS_DATA_TYPE_KV:431,TNS_DATA_TYPE_AQD:432,TNS_DATA_TYPE_AQ8:433,TNS_DATA_TYPE_TIME:178,TNS_DATA_TYPE_TIME_TZ:179,TNS_DATA_TYPE_TIMESTAMP:180,TNS_DATA_TYPE_TIMESTAMP_TZ:181,TNS_DATA_TYPE_INTERVAL_YM:182,TNS_DATA_TYPE_INTERVAL_DS:183,TNS_DATA_TYPE_EDATE:184,TNS_DATA_TYPE_ETIME:185,TNS_DATA_TYPE_ETTZ:186,TNS_DATA_TYPE_ESTAMP:187,TNS_DATA_TYPE_ESTZ:188,TNS_DATA_TYPE_EIYM:189,TNS_DATA_TYPE_EIDS:190,TNS_DATA_TYPE_RFS:449,TNS_DATA_TYPE_RXH10:450,TNS_DATA_TYPE_DCLOB:195,TNS_DATA_TYPE_DBLOB:196,TNS_DATA_TYPE_DBFILE:197,TNS_DATA_TYPE_DJSON:198,TNS_DATA_TYPE_KPN:454,TNS_DATA_TYPE_KPDNR:455,TNS_DATA_TYPE_DSYD:456,TNS_DATA_TYPE_DSYS:457,TNS_DATA_TYPE_DSYR:458,TNS_DATA_TYPE_DSYH:459,TNS_DATA_TYPE_DSYT:460,TNS_DATA_TYPE_DSYV:461,TNS_DATA_TYPE_AQM:462,TNS_DATA_TYPE_OER11:463,TNS_DATA_TYPE_UROWID:208,TNS_DATA_TYPE_AQL:466,TNS_DATA_TYPE_OTC:467,TNS_DATA_TYPE_KFNO:468,TNS_DATA_TYPE_KFNP:469,TNS_DATA_TYPE_KGT8:470,TNS_DATA_TYPE_RASB4:471,TNS_DATA_TYPE_RAUB2:472,TNS_DATA_TYPE_RAUB1:473,TNS_DATA_TYPE_RATXT:474,TNS_DATA_TYPE_RSSB4:475,TNS_DATA_TYPE_RSUB2:476,TNS_DATA_TYPE_RSUB1:477,TNS_DATA_TYPE_RSTXT:478,TNS_DATA_TYPE_RIDL:479,TNS_DATA_TYPE_GLRDD:480,TNS_DATA_TYPE_GLRDG:481,TNS_DATA_TYPE_GLRDC:482,TNS_DATA_TYPE_OKO:483,TNS_DATA_TYPE_DPP:484,TNS_DATA_TYPE_DPLS:485,TNS_DATA_TYPE_DPMOP:486,TNS_DATA_TYPE_TIMESTAMP_LTZ:231,TNS_DATA_TYPE_ESITZ:232,TNS_DATA_TYPE_UB8:233,TNS_DATA_TYPE_STAT:490,TNS_DATA_TYPE_RFX:491,TNS_DATA_TYPE_FAL:492,TNS_DATA_TYPE_CKV:493,TNS_DATA_TYPE_DRCX:494,TNS_DATA_TYPE_KGH:495,TNS_DATA_TYPE_AQO:496,TNS_DATA_TYPE_PNTY:241,TNS_DATA_TYPE_OKGT:498,TNS_DATA_TYPE_KPFC:499,TNS_DATA_TYPE_FE2:500,TNS_DATA_TYPE_SPFP:501,TNS_DATA_TYPE_DPULS:502,TNS_DATA_TYPE_BOOLEAN:252,TNS_DATA_TYPE_AQA:509,TNS_DATA_TYPE_KPBF:510,TNS_DATA_TYPE_TSM:513,TNS_DATA_TYPE_MSS:514,TNS_DATA_TYPE_KPC:516,TNS_DATA_TYPE_CRS:517,TNS_DATA_TYPE_KKS:518,TNS_DATA_TYPE_KSP:519,TNS_DATA_TYPE_KSPTOP:520,TNS_DATA_TYPE_KSPVAL:521,TNS_DATA_TYPE_PSS:522,TNS_DATA_TYPE_NLS:523,TNS_DATA_TYPE_ALS:524,TNS_DATA_TYPE_KSDEVTVAL:525,TNS_DATA_TYPE_KSDEVTTOP:526,TNS_DATA_TYPE_KPSPP:527,TNS_DATA_TYPE_KOL:528,TNS_DATA_TYPE_LST:529,TNS_DATA_TYPE_ACX:530,TNS_DATA_TYPE_SCS:531,TNS_DATA_TYPE_RXH:532,TNS_DATA_TYPE_KPDNS:533,TNS_DATA_TYPE_KPDCN:534,TNS_DATA_TYPE_KPNNS:535,TNS_DATA_TYPE_KPNCN:536,TNS_DATA_TYPE_KPS:537,TNS_DATA_TYPE_APINF:538,TNS_DATA_TYPE_TEN:539,TNS_DATA_TYPE_XSSCS:540,TNS_DATA_TYPE_XSSSO:541,TNS_DATA_TYPE_XSSAO:542,TNS_DATA_TYPE_KSRPC:543,TNS_DATA_TYPE_KVL:560,TNS_DATA_TYPE_SESSGET:563,TNS_DATA_TYPE_SESSREL:564,TNS_DATA_TYPE_XSSDEF:565,TNS_DATA_TYPE_PDQCINV:572,TNS_DATA_TYPE_PDQIDC:573,TNS_DATA_TYPE_KPDQCSTA:574,TNS_DATA_TYPE_KPRS:575,TNS_DATA_TYPE_KPDQIDC:576,TNS_DATA_TYPE_RTSTRM:578,TNS_DATA_TYPE_SESSRET:579,TNS_DATA_TYPE_SCN6:580,TNS_DATA_TYPE_KECPA:581,TNS_DATA_TYPE_KECPP:582,TNS_DATA_TYPE_SXA:583,TNS_DATA_TYPE_KVARR:584,TNS_DATA_TYPE_KPNGN:585,TNS_DATA_TYPE_XSNSOP:590,TNS_DATA_TYPE_XSATTR:591,TNS_DATA_TYPE_XSNS:592,TNS_DATA_TYPE_TXT:593,TNS_DATA_TYPE_XSSESSNS:594,TNS_DATA_TYPE_XSATTOP:595,TNS_DATA_TYPE_XSCREOP:596,TNS_DATA_TYPE_XSDETOP:597,TNS_DATA_TYPE_XSDESOP:598,TNS_DATA_TYPE_XSSETSP:599,TNS_DATA_TYPE_XSSIDP:600,TNS_DATA_TYPE_XSPRIN:601,TNS_DATA_TYPE_XSKVL:602,TNS_DATA_TYPE_XSSSDEF2:603,TNS_DATA_TYPE_XSNSOP2:604,TNS_DATA_TYPE_XSNS2:605,TNS_DATA_TYPE_IMPLRES:611,TNS_DATA_TYPE_OER19:612,TNS_DATA_TYPE_UB1ARRAY:613,TNS_DATA_TYPE_SESSSTATE:614,TNS_DATA_TYPE_AC_REPLAY:615,TNS_DATA_TYPE_AC_CONT:616,TNS_DATA_TYPE_KPDNREQ:622,TNS_DATA_TYPE_KPDNRNF:623,TNS_DATA_TYPE_KPNGNC:624,TNS_DATA_TYPE_KPNRI:625,TNS_DATA_TYPE_AQENQ:626,TNS_DATA_TYPE_AQDEQ:627,TNS_DATA_TYPE_AQJMS:628,TNS_DATA_TYPE_KPDNRPAY:629,TNS_DATA_TYPE_KPDNRACK:630,TNS_DATA_TYPE_KPDNRMP:631,TNS_DATA_TYPE_KPDNRDQ:632,TNS_DATA_TYPE_CHUNKINFO:636,TNS_DATA_TYPE_SCN:637,TNS_DATA_TYPE_SCN8:638,TNS_DATA_TYPE_UD21:639,TNS_DATA_TYPE_TNP:640,TNS_DATA_TYPE_OAC:646,TNS_DATA_TYPE_OER:652,TNS_DATA_TYPE_UDS:663,TNS_TYPE_REP_NATIVE:0,TNS_TYPE_REP_UNIVERSAL:1,TNS_TYPE_REP_ORACLE:10,TNS_MSG_TYPE_PROTOCOL:1,TNS_MSG_TYPE_DATA_TYPES:2,TNS_MSG_TYPE_FUNCTION:3,TNS_MSG_TYPE_ERROR:4,TNS_MSG_TYPE_ROW_HEADER:6,TNS_MSG_TYPE_ROW_DATA:7,TNS_MSG_TYPE_PARAMETER:8,TNS_MSG_TYPE_STATUS:9,TNS_MSG_TYPE_IO_VECTOR:11,TNS_MSG_TYPE_LOB_DATA:14,TNS_MSG_TYPE_WARNING:15,TNS_MSG_TYPE_DESCRIBE_INFO:16,TNS_MSG_TYPE_PIGGYBACK:17,TNS_MSG_TYPE_FLUSH_OUT_BINDS:19,TNS_MSG_TYPE_BIT_VECTOR:21,TNS_MSG_TYPE_SERVER_SIDE_PIGGYBACK:23,TNS_MSG_TYPE_ONEWAY_FN:26,TNS_MSG_TYPE_IMPLICIT_RESULTSET:27,TNS_MSG_TYPE_RENEGOTIATE:28,TNS_MSG_TYPE_END_OF_REQUEST:29,TNS_MSG_TYPE_FAST_AUTH:34,TNS_KEYWORD_NUM_CURRENT_SCHEMA:168,TNS_KEYWORD_NUM_EDITION:172,TNS_BIND_USE_INDICATORS:1,TNS_BIND_USE_LENGTH:2,TNS_BIND_ARRAY:64,TNS_BIND_DIR_OUTPUT:16,TNS_BIND_DIR_INPUT:32,TNS_BIND_DIR_INPUT_OUTPUT:48,TNS_EXEC_OPTION_PARSE:1,TNS_EXEC_OPTION_BIND:8,TNS_EXEC_OPTION_DEFINE:16,TNS_EXEC_OPTION_EXECUTE:32,TNS_EXEC_OPTION_FETCH:64,TNS_EXEC_OPTION_COMMIT:256,TNS_EXEC_OPTION_COMMIT_REEXECUTE:1,TNS_EXEC_OPTION_PLSQL_BIND:1024,TNS_EXEC_OPTION_DML_ROWCOUNTS:16384,TNS_EXEC_OPTION_NOT_PLSQL:32768,TNS_EXEC_OPTION_IMPLICIT_RESULTSET:32768,TNS_EXEC_OPTION_DESCRIBE:131072,TNS_EXEC_OPTION_NO_COMPRESSED_FETCH:262144,TNS_EXEC_OPTION_BATCH_ERRORS:524288,TNS_EXEC_OPTION_NO_IMPL_REL:2097152,TNS_SERVER_PIGGYBACK_QUERY_CACHE_INVALIDATION:1,TNS_SERVER_PIGGYBACK_OS_PID_MTS:2,TNS_SERVER_PIGGYBACK_TRACE_EVENT:3,TNS_SERVER_PIGGYBACK_SESS_RET:4,TNS_SERVER_PIGGYBACK_SYNC:5,TNS_SERVER_PIGGYBACK_LTXID:7,TNS_SERVER_PIGGYBACK_AC_REPLAY_CONTEXT:8,TNS_SERVER_PIGGYBACK_EXT_SYNC:9,TNS_SESSGET_SESSION_CHANGED:4,TNS_LOB_OP_GET_LENGTH:1,TNS_LOB_OP_READ:2,TNS_LOB_OP_TRIM:32,TNS_LOB_OP_WRITE:64,TNS_LOB_OP_GET_CHUNK_SIZE:16384,TNS_LOB_OP_CREATE_TEMP:272,TNS_LOB_OP_FREE_TEMP:273,TNS_LOB_OP_OPEN:32768,TNS_LOB_OP_CLOSE:65536,TNS_LOB_OP_IS_OPEN:69632,TNS_LOB_OP_ARRAY:524288,TNS_LOB_OP_FILE_OPEN:256,TNS_LOB_OP_FILE_CLOSE:512,TNS_LOB_OP_FILE_ISOPEN:1024,TNS_LOB_OP_FILE_EXISTS:2048,TNS_LOB_LOC_OFFSET_FLAG_1:4,TNS_LOB_LOC_OFFSET_FLAG_3:6,TNS_LOB_LOC_OFFSET_FLAG_4:7,TNS_LOB_QLOCATOR_VERSION:4,TNS_LOB_LOC_FIXED_OFFSET:16,TNS_LOB_LOC_FLAGS_BLOB:1,TNS_LOB_LOC_FLAGS_VALUE_BASED:32,TNS_LOB_LOC_FLAGS_ABSTRACT:64,TNS_LOB_LOC_FLAGS_INIT:8,TNS_LOB_LOC_FLAGS_TEMP:1,TNS_LOB_LOC_FLAGS_VAR_LENGTH_CHARSET:128,TNS_LOB_OPEN_READ_WRITE:2,TNS_LOB_OPEN_READ_ONLY:11,TNS_LOB_PREFETCH_FLAG:33554432,TNS_JSON_MAX_LENGTH:32*1024*1024,TNS_END_TO_END_ACTION:16,TNS_END_TO_END_CLIENT_IDENTIFIER:1,TNS_END_TO_END_CLIENT_INFO:256,TNS_END_TO_END_DBOP:512,TNS_END_TO_END_MODULE:8,TNS_VERSION_MIN_ACCEPTED:315,TNS_VERSION_MIN_LARGE_SDU:315,TNS_FUNC_AUTH_PHASE_ONE:118,TNS_FUNC_AUTH_PHASE_TWO:115,TNS_FUNC_CLOSE_CURSORS:105,TNS_FUNC_COMMIT:14,TNS_FUNC_EXECUTE:94,TNS_FUNC_FETCH:5,TNS_FUNC_LOB_OP:96,TNS_FUNC_LOGOFF:9,TNS_FUNC_PING:147,TNS_FUNC_ROLLBACK:15,TNS_FUNC_SET_END_TO_END_ATTR:135,TNS_FUNC_REEXECUTE:4,TNS_FUNC_REEXECUTE_AND_FETCH:78,TNS_FUNC_SET_SCHEMA:152,TNS_FUNC_SESSION_GET:162,TNS_FUNC_SESSION_RELEASE:163,TNS_FUNC_SESSION_STATE:176,TNS_FUNC_CANCEL_ALL:120,TNS_FUNC_TPC_TXN_SWITCH:103,TNS_FUNC_TPC_TXN_CHANGE_STATE:104,TNS_CHARSET_UTF8:873,TNS_CHARSET_UTF16:2e3,TNS_ENCODING_UTF8:"UTF-8",TNS_ENCODING_UTF16:"UTF-16LE",TNS_ENCODING_MULTI_BYTE:1,TNS_ENCODING_CONV_LENGTH:2,TNS_CCAP_SQL_VERSION:0,TNS_CCAP_LOGON_TYPES:4,TNS_CCAP_CTB_FEATURE_BACKPORT:5,TNS_CCAP_FIELD_VERSION:7,TNS_CCAP_SERVER_DEFINE_CONV:8,TNS_CCAP_TTC1:15,TNS_CCAP_OCI1:16,TNS_CCAP_TDS_VERSION:17,TNS_CCAP_RPC_VERSION:18,TNS_CCAP_RPC_SIG:19,TNS_CCAP_DBF_VERSION:21,TNS_CCAP_LOB:23,TNS_CCAP_TTC2:26,TNS_CCAP_UB2_DTY:27,TNS_CCAP_OCI2:31,TNS_CCAP_CLIENT_FN:34,TNS_CCAP_TTC3:37,TNS_CCAP_TTC4:40,TNS_CCAP_LOB2:42,TNS_CCAP_TTC5:44,TNS_CCAP_VECTOR_FEATURES:52,TNS_CCAP_MAX:53,TNS_CCAP_SQL_VERSION_MAX:6,TNS_CCAP_FIELD_VERSION_11_2:6,TNS_CCAP_FIELD_VERSION_12_1:7,TNS_CCAP_FIELD_VERSION_12_2:8,TNS_CCAP_FIELD_VERSION_12_2_EXT1:9,TNS_CCAP_FIELD_VERSION_18_1:10,TNS_CCAP_FIELD_VERSION_18_1_EXT_1:11,TNS_CCAP_FIELD_VERSION_19_1:12,TNS_CCAP_FIELD_VERSION_19_1_EXT_1:13,TNS_CCAP_FIELD_VERSION_20_1:14,TNS_CCAP_FIELD_VERSION_20_1_EXT_1:15,TNS_CCAP_FIELD_VERSION_21_1:16,TNS_CCAP_FIELD_VERSION_23_1:17,TNS_CCAP_FIELD_VERSION_23_1_EXT_1:18,TNS_CCAP_FIELD_VERSION_23_1_EXT_2:19,TNS_CCAP_FIELD_VERSION_23_1_EXT_3:20,TNS_CCAP_FIELD_VERSION_23_1_EXT_4:21,TNS_CCAP_FIELD_VERSION_23_1_EXT_5:22,TNS_CCAP_FIELD_VERSION_23_1_EXT_6:23,TNS_CCAP_FIELD_VERSION_23_4:24,TNS_CCAP_FIELD_VERSION_MAX:24,TNS_CCAP_O5LOGON:8,TNS_CCAP_O5LOGON_NP:2,TNS_CCAP_O7LOGON:32,TNS_CCAP_O8LOGON_LONG_IDENTIFIER:64,TNS_CCAP_O9LOGON_LONG_PASSWORD:128,TNS_CCAP_END_OF_CALL_STATUS:1,TNS_CCAP_IND_RCD:8,TNS_CCAP_FAST_BVEC:32,TNS_CCAP_FAST_SESSION_PROPAGATE:16,TNS_CCAP_APP_CTX_PIGGYBACK:128,TNS_CCAP_TDS_VERSION_MAX:3,TNS_CCAP_RPC_VERSION_MAX:7,TNS_CCAP_RPC_SIG_VALUE:3,TNS_CCAP_DBF_VERSION_MAX:1,TNS_CCAP_IMPLICIT_RESULTS:16,TNS_CCAP_BIG_CHUNK_CLR:32,TNS_CCAP_KEEP_OUT_ORDER:128,TNS_CCAP_LOB_UB8_SIZE:1,TNS_CCAP_LOB_ENCS:2,TNS_CCAP_LOB_PREFETCH_DATA:4,TNS_CCAP_LOB_TEMP_SIZE:8,TNS_CCAP_LOB_PREFETCH:64,TNS_CCAP_LOB_12C:128,TNS_CCAP_DRCP:16,TNS_CCAP_ZLNP:4,TNS_CCAP_INBAND_NOTIFICATION:4,TNS_CCAP_END_OF_REQUEST:32,TNS_CCAP_CLIENT_FN_MAX:12,TNS_CCAP_LOB2_QUASI:1,TNS_CCAP_LOB2_2GB_PREFETCH:4,TNS_CCAP_CTB_IMPLICIT_POOL:8,TNS_CCAP_VECTOR_SUPPORT:8,TNS_CCAP_VECTOR_FEATURE_BINARY:1,TNS_RCAP_COMPAT:0,TNS_RCAP_TTC:6,TNS_RCAP_MAX:7,TNS_RCAP_COMPAT_81:2,TNS_RCAP_TTC_ZERO_COPY:1,TNS_RCAP_TTC_32K:4,TNS_VERIFIER_TYPE_11G_1:45394,TNS_VERIFIER_TYPE_11G_2:6949,TNS_VERIFIER_TYPE_12C:18453,TNS_UDS_FLAGS_IS_JSON:256,TNS_UDS_FLAGS_IS_OSON:2048,TNS_EOCS_FLAGS_TXN_IN_PROGRESS:2,TNS_EOCS_FLAGS_SESS_RELEASE:32768,TNS_TPC_TXN_START:1,TNS_TPC_TXN_DETACH:2,TNS_TPC_TXN_COMMIT:1,TNS_TPC_TXN_ABORT:2,TNS_TPC_TXN_PREPARE:3,TNS_TPC_TXN_FORGET:4,TNS_TPC_TXN_STATE_PREPARE:0,TNS_TPC_TXN_STATE_REQUIRES_COMMIT:1,TNS_TPC_TXN_STATE_COMMITTED:2,TNS_TPC_TXN_STATE_ABORTED:3,TNS_TPC_TXN_STATE_READ_ONLY:4,TNS_TPC_TXN_STATE_FORGOTTEN:5,TNS_ESCAPE_CHAR:253,TNS_LONG_LENGTH_INDICATOR:cA.TNS_LONG_LENGTH_INDICATOR,TNS_NULL_LENGTH_INDICATOR:cA.TNS_NULL_LENGTH_INDICATOR,TNS_MAX_ROWID_LENGTH:18,TNS_DURATION_SESSION:10,TNS_MAX_LONG_LENGTH:2147483647,TNS_SDU:8192,TNS_TDU:65535,TNS_MAX_CONNECT_DATA:230,TNS_MAX_UROWID_LENGTH:3950,TNS_SERVER_CONVERTS_CHARS:1,DRCP_DEAUTHENTICATE:2,TNS_OBJ_IS_VERSION_81:128,TNS_OBJ_IS_DEGENERATE:16,TNS_OBJ_IS_COLLECTION:8,TNS_OBJ_NO_PREFIX_SEG:4,TNS_OBJ_IMAGE_VERSION:1,TNS_OBJ_MAX_SHORT_LENGTH:245,TNS_OBJ_ATOMIC_NULL:253,TNS_OBJ_NON_NULL_OID:2,TNS_OBJ_HAS_EXTENT_OID:8,TNS_OBJ_TOP_LEVEL:1,TNS_OBJ_HAS_INDEXES:16,TNS_OBJ_PLSQL_INDEX_TABLE:1,TNS_OBJ_NESTED_TABLE:2,TNS_OBJ_VARRAY:3,TNS_OBJ_TDS_TYPE_CHAR:1,TNS_OBJ_TDS_TYPE_DATE:2,TNS_OBJ_TDS_TYPE_FLOAT:5,TNS_OBJ_TDS_TYPE_NUMBER:6,TNS_OBJ_TDS_TYPE_VARCHAR:7,TNS_OBJ_TDS_TYPE_BOOLEAN:8,TNS_OBJ_TDS_TYPE_RAW:19,TNS_OBJ_TDS_TYPE_TIMESTAMP:21,TNS_OBJ_TDS_TYPE_TIMESTAMP_TZ:23,TNS_OBJ_TDS_TYPE_OBJ:27,TNS_OBJ_TDS_TYPE_COLL:28,TNS_OBJ_TDS_TYPE_CLOB:29,TNS_OBJ_TDS_TYPE_BLOB:30,TNS_OBJ_TDS_TYPE_TIMESTAMP_LTZ:33,TNS_OBJ_TDS_TYPE_BINARY_FLOAT:37,TNS_OBJ_TDS_TYPE_START_EMBED_ADT:39,TNS_OBJ_TDS_TYPE_END_EMBED_ADT:40,TNS_OBJ_TDS_TYPE_SUBTYPE_MARKER:43,TNS_OBJ_TDS_TYPE_EMBED_ADT_INFO:44,TNS_OBJ_TDS_TYPE_BINARY_DOUBLE:45,TNS_XML_TYPE_LOB:1,TNS_XML_TYPE_STRING:4,TNS_XML_TYPE_FLAG_SKIP_NEXT_4:1048576,TNS_ERR_INCONSISTENT_DATA_TYPES:932,TNS_ERR_VAR_NOT_IN_SELECT_LIST:1007,TNS_ERR_INBAND_MESSAGE:12573,TNS_ERR_INVALID_SERVICE_NAME:12514,TNS_ERR_INVALID_SID:12505,TNS_ERR_NO_DATA_FOUND:1403,TNS_ERR_SESSION_SHUTDOWN:12572,TNS_WARN_COMPILATION_CREATE:32,TNS_VECTOR_MAX_LENGTH:1048576,VECTOR_FORMAT_FLEX:0,VECTOR_META_FLAG_FLEXIBLE_DIM:1,PACKET_HEADER_SIZE:8,NUMBER_AS_TEXT_CHARS:172,CHUNKED_BYTES_CHUNK_SIZE:65536,TNS_DATA_FLAGS_END_OF_REQUEST:8192,TNS_BASE64_ALPHABET_ARRAY:_A.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),TNS_EXTENT_OID:_A.from("00000000000000000000000000010001","hex")}});var Hr=m((VU,EA)=>{"use strict";var{Buffer:V_}=require("buffer"),lA=Ue(),lD=require("crypto"),F_=class F_ extends Error{};_(F_,"OutOfPacketsError");var M_=F_;function oi(r,e,t,s){for(let n=0;n<t;n++)r[s+t-n-1]=lA.TNS_BASE64_ALPHABET_ARRAY[e&63],e=e>>6;return s+t}_(oi,"_convertBase64");function ED(r){let e=0;if(r.rba!==0||r.partitionID!==0||r.blockNum!==0||r.slotNum!=0){let t=V_.allocUnsafe(lA.TNS_MAX_ROWID_LENGTH);return e=oi(t,r.rba,6,e),e=oi(t,r.partitionID,3,e),e=oi(t,r.blockNum,6,e),oi(t,r.slotNum,3,e),t.toString("utf8")}}_(ED,"encodeRowID");function uD(r){let e=V_.from(r),t=lD.randomBytes(e.length);for(let s=0;s<e.length;s++)e[s]=t[s]^e[s];return{obfuscatedValue:t,value:e}}_(uD,"setObfuscatedValue");function hD(r,e){let t=V_.from(r);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];let s=t.toString();return t.fill(0),s}_(hD,"getDeobfuscatedValue");EA.exports={encodeRowID:ED,getDeobfuscatedValue:hD,OutOfPacketsError:M_,setObfuscatedValue:uD}});var Ct=m((xU,uA)=>{"use strict";var{Buffer:x_}=require("buffer"),ne=Ue(),hs=W(),k_=class k_{constructor(e){this.errorInfo={},this.connection=e,this.messageType=ne.TNS_MSG_TYPE_FUNCTION,this.functionCode=0,this.callStatus=0,this.flushOutBinds=!1,this.endOfResponse=!1,this.endToEndSeqNum=0,this.errorOccurred=!1,this.warning=void 0}preProcess(){}async postProcess(){}writeFunctionHeader(e){e.writeUInt8(this.messageType),e.writeUInt8(this.functionCode),e.writeSeqNum(),e.caps.ttcFieldVersion>=ne.TNS_CCAP_FIELD_VERSION_23_1_EXT_1&&e.writeUB8(0)}processErrorInfo(e){this.callStatus=e.readUB4(),e.skipUB2(),e.skipUB4(),e.skipUB2(),e.skipUB2(),e.skipUB2(),this.errorInfo.cursorId=e.readUB2();let t=e.readSB2();e.skipUB1(),e.skipUB1(),e.skipUB1(),e.skipUB1(),e.skipUB1(),e.readUInt8()&ne.TNS_WARN_COMPILATION_CREATE&&(this.warning=hs.getErr(hs.WRN_COMPILATION_CREATE)),this.errorInfo.rowID=e.readRowID(),e.skipUB4(),e.skipUB1(),e.skipUB1(),e.skipUB2(),e.skipUB4(),e.readUB4()>0&&e.skipBytesChunked();let i=e.readUB2();if(i>0){this.errorInfo.batchErrors=[];let T=e.readUInt8();for(let l=0;l<i;l++){T===ne.TNS_LONG_LENGTH_INDICATOR&&e.skipUB4();let E=e.readUB2();this.errorInfo.batchErrors.push(new Error(E))}T===ne.TNS_LONG_LENGTH_INDICATOR&&e.skipBytes(1)}let a=e.readUB4();if(a>0){a>65535&&hs.throwErr(hs.ERR_TOO_MANY_BATCH_ERRORS);let T=e.readUInt8(),l;for(let E=0;E<a;E++)T===ne.TNS_LONG_LENGTH_INDICATOR&&e.skipUB4(),l=e.readUB4(),E<i&&(this.errorInfo.batchErrors[E].offset=l);T===ne.TNS_LONG_LENGTH_INDICATOR&&e.skipBytes(1)}let c=e.readUB2();if(c>0){e.skipBytes(1);for(let T=0;T<c;T++)e.skipUB2(),this.errorInfo.batchErrors[T].message=e.readStr(ne.CSFRM_IMPLICIT),e.skipBytes(2)}this.errorInfo.num=e.readUB4(),this.errorInfo.rowCount=e.readUB8(),e.caps.ttcFieldVersion>=ne.TNS_CCAP_FIELD_VERSION_20_1&&(e.skipUB4(),e.skipUB4()),this.errorInfo.num!==0&&(this.errorOccurred=!0,t>=0&&(this.errorInfo.pos=t),this.errorInfo.message=e.readStr(ne.CSFRM_IMPLICIT),this.errorInfo.message=this.errorInfo.message.trim()),this.endOfResponse=!this.connection.nscon.endOfRequestSupport}processReturnParameter(){}processWarningInfo(e){let t=e.readUB2(),s=e.readUB2();if(e.skipUB2(),t!=0&&s>0){let n=e.readStr(ne.CSFRM_IMPLICIT).trim();this.warning=new Error(n),this.warning.errorNum=t}}decode(e){this.process(e)}process(e){this.endOfResponse=!1,this.flushOutBinds=!1;do{this.savePoint(e);let t=e.readUInt8();this.processMessage(e,t)}while(!this.endOfResponse)}savePoint(e){e.savePoint()}processMessage(e,t){t===ne.TNS_MSG_TYPE_ERROR?this.processErrorInfo(e):t===ne.TNS_MSG_TYPE_WARNING?this.processWarningInfo(e):t===ne.TNS_MSG_TYPE_STATUS?(this.callStatus=e.readUB4(),this.endToEndSeqNum=e.readUB2(),this.endOfResponse=!this.connection.nscon.endOfRequestSupport):t===ne.TNS_MSG_TYPE_PARAMETER?this.processReturnParameter(e):t===ne.TNS_MSG_TYPE_SERVER_SIDE_PIGGYBACK?this.processServerSidePiggyBack(e):t===ne.TNS_MSG_TYPE_END_OF_REQUEST?this.endOfResponse=!0:hs.throwErr(hs.ERR_UNEXPECTED_MESSAGE_TYPE,t,e.pos,e.packetNum)}processServerSidePiggyBack(e){let t=e.readUInt8();if(t===ne.TNS_SERVER_PIGGYBACK_LTXID)e.readUB4()>0&&e.skipBytesChunked();else if(!(t===ne.TNS_SERVER_PIGGYBACK_QUERY_CACHE_INVALIDATION||t===ne.TNS_SERVER_PIGGYBACK_TRACE_EVENT))if(t===ne.TNS_SERVER_PIGGYBACK_OS_PID_MTS){let s=e.readUB2();e.skipUB1(),e.skipBytes(s)}else if(t===ne.TNS_SERVER_PIGGYBACK_SYNC){e.skipUB2(),e.skipUB1();let s=e.readUB4();e.skipBytes(1);for(let n=0;n<s;n++){let i=e.readUB2();i>0&&e.skipBytesChunked(),i=e.readUB2(),i>0&&e.skipBytesChunked(),e.skipUB2()}e.skipUB4()}else if(t===ne.TNS_SERVER_PIGGYBACK_EXT_SYNC)e.skipUB2(),e.skipUB1();else if(t===ne.TNS_SERVER_PIGGYBACK_AC_REPLAY_CONTEXT)e.skipUB2(),e.skipUB1(),e.skipUB4(),e.skipUB4(),e.skipUB1(),e.readUB4()>0&&e.skipBytesChunked();else if(t===ne.TNS_SERVER_PIGGYBACK_SESS_RET){e.skipUB2(),e.skipUB1();let s=e.readUB2();if(s>0){e.skipUB1();for(let i=0;i<s;++i){let a=e.readUB2();a>0&&e.skipBytesChunked(),a=e.readUB2(),a>0&&e.skipBytesChunked(),e.skipUB2()}}e.readUB4()&ne.TNS_SESSGET_SESSION_CHANGED&&this.connection._drcpEstablishSession&&this.connection.statementCache.clearCursors(),this.connection._drcpEstablishSession=!1,e.skipUB4(),e.skipUB2()}else hs.throwErr(hs.ERR_UNKOWN_SERVER_SIDE_PIGGYBACK,t)}writePiggybacks(e){this.connection._currentSchemaModified&&this._writeCurrentSchemaPiggyback(e),this.connection.statementCache._cursorsToClose.size>0&&!this.connection._drcpEstablishSession&&this.writeCloseCursorsPiggyBack(e),(this.connection._actionModified||this.connection._clientIdentifierModified||this.connection._dbopModified||this.connection._clientInfoModified||this.connection._moduleModified)&&this._writeEndToEndPiggybacks(e),this.connection._tempLobsTotalSize>0&&this.writeCloseTempLobsPiggyback(e)}writePiggybackHeader(e,t){e.writeUInt8(ne.TNS_MSG_TYPE_PIGGYBACK),e.writeUInt8(t),e.writeSeqNum(),e.caps.ttcFieldVersion>=ne.TNS_CCAP_FIELD_VERSION_23_1_EXT_1&&e.writeUB8(0)}writeCloseCursorsPiggyBack(e){this.writePiggybackHeader(e,ne.TNS_FUNC_CLOSE_CURSORS),e.writeUInt8(1),this.connection.statementCache.writeCursorsToClose(e)}writeCloseTempLobsPiggyback(e){let t=this.connection._tempLobsToClose,s=ne.TNS_LOB_OP_FREE_TEMP|ne.TNS_LOB_OP_ARRAY;this.writePiggybackHeader(e,ne.TNS_FUNC_LOB_OP),e.writeUInt8(1),e.writeUB4(this.connection._tempLobsTotalSize),e.writeUInt8(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(s),e.writeUInt8(0),e.writeUB4(0),e.writeUB8(0),e.writeUB8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);for(let n of t)e.writeBytes(n);this.connection._tempLobsToClose=[],this.connection._tempLobsTotalSize=0}_writeCurrentSchemaPiggyback(e){this.writePiggybackHeader(e,ne.TNS_FUNC_SET_SCHEMA),e.writeUInt8(1);let t=x_.byteLength(this.connection.currentSchema);e.writeUB4(t),e.writeBytesWithLength(x_.from(this.connection.currentSchema))}_writeEndToEndPiggybacks(e){let t=0;this.connection._actionModified&&(t|=ne.TNS_END_TO_END_ACTION),this.connection._clientIdentifierModified&&(t|=ne.TNS_END_TO_END_CLIENT_IDENTIFIER),this.connection._clientInfoModified&&(t|=ne.TNS_END_TO_END_CLIENT_INFO),this.connection._moduleModified&&(t|=ne.TNS_END_TO_END_MODULE),this.connection._dbOpModified&&(t|=ne.TNS_END_TO_END_DBOP),this.writePiggybackHeader(e,ne.TNS_FUNC_SET_END_TO_END_ATTR),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(t);let s=this.writeEndEndTraceValue(e,this.connection._clientIdentifier,this.connection._clientIdentifierModified),n=this.writeEndEndTraceValue(e,this.connection._module,this.connection._moduleModified),i=this.writeEndEndTraceValue(e,this.connection._action,this.connection._actionModified);e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);let a=this.writeEndEndTraceValue(e,this.connection._clientInfo,this.connection._clientInfoModified);e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);let c=this.writeEndEndTraceValue(e,this.connection._dbOp,this.connection._dbOpModified);this.connection._clientIdentifierModified&&this.connection._clientIdentifier&&e.writeBytesWithLength(s),this.connection._moduleModified&&this.connection._module&&e.writeBytesWithLength(n),this.connection._actionModified&&this.connection._action&&e.writeBytesWithLength(i),this.connection._clientInfoModified&&this.connection._clientInfo&&e.writeBytesWithLength(a),this.connection._dbOpModified&&this.connection._dbOp&&e.writeBytesWithLength(c),this.connection._actionModified=!1,this.connection._action="",this.connection._clientIdentifierModified=!1,this.connection._clientIdentifier="",this.connection._clientInfoModified=!1,this.connection._clientInfo="",this.connection._dbOpModified=!1,this.connection._dbOp="",this.connection._moduleModified=!1,this.connection._module=""}writeEndEndTraceValue(e,t,s){let n;return s?(e.writeUInt8(1),t?(n=x_.from(t),e.writeUB4(n.length)):e.writeUB4(0)):(e.writeUInt8(0),e.writeUB4(0)),n}saveDeferredErr(){this.deferredErr||(this.deferredErr=hs.getErr(...arguments))}};_(k_,"Message");var b_=k_;uA.exports=b_});var v_=m((kU,hA)=>{"use strict";var{Buffer:Kr}=require("buffer"),He=Ue(),ND=Ct(),G_=class G_ extends ND{constructor(e,t){super(e),this.sourceLobImpl=t.sourceLobImpl||null,this.operation=t.operation,this.destLobImpl=t.destLobImpl||null,this.sourceOffset=t.sourceOffset||0,this.destOffset=t.destOffset||0,this.boolFlag=!1,t.data&&(this.data=t.data),this.functionCode=He.TNS_FUNC_LOB_OP,this.sendAmount=t.sendAmount,this.amount=t.amount||0}encode(e){this.writeFunctionHeader(e),this.sourceLobImpl===null?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(this.sourceLobImpl._locator.length)),this.destLobImpl===null?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(this.destLobImpl._locator.length)),e.writeUB4(0),e.writeUB4(0),this.operation===He.TNS_LOB_OP_CREATE_TEMP?e.writeUInt8(1):e.writeUInt8(0),e.writeUInt8(0),[He.TNS_LOB_OP_CREATE_TEMP,He.TNS_LOB_OP_IS_OPEN,He.TNS_LOB_OP_FILE_EXISTS,He.TNS_LOB_OP_FILE_ISOPEN].includes(this.operation)?e.writeUInt8(1):e.writeUInt8(0),e.writeUB4(this.operation),e.writeUInt8(0),e.writeUInt8(0),e.writeUB8(this.sourceOffset),e.writeUB8(this.destOffset),this.sendAmount?e.writeUInt8(1):e.writeUInt8(0);for(let s=0;s<3;s++)e.writeUInt16BE(0);if(this.sourceLobImpl&&e.writeBytes(this.sourceLobImpl._locator),this.destLobImpl&&e.writeBytes(this.destLobImpl._locator),this.operation===He.TNS_LOB_OP_CREATE_TEMP&&(this.sourceLobImpl.dbType._csfrm===He.CSFRM_NCHAR?(e.caps.checkNCharsetId(),e.writeUB4(He.TNS_CHARSET_UTF16)):e.writeUB4(He.TNS_CHARSET_UTF8)),this.data){let s;e.writeUInt8(He.TNS_MSG_TYPE_LOB_DATA),this.sourceLobImpl.dbType._oraTypeNum===He.TNS_DATA_TYPE_BLOB?s=this.data:this.sourceLobImpl.getCsfrm()===He.CSFRM_NCHAR?(s=this.data,Kr.isBuffer(this.data)&&(s=s.toString()),s=Kr.from(s,He.TNS_ENCODING_UTF16).swap16()):s=Kr.from(this.data),e.writeBytesWithLength(s)}this.sendAmount&&e.writeUB8(this.amount)}processMessage(e,t){if(t===He.TNS_MSG_TYPE_LOB_DATA){let s=this.sourceLobImpl.dbType._oraTypeNum,n=e.readBytesWithLength();n!==null&&(s===He.TNS_DATA_TYPE_BLOB||s===He.TNS_DATA_TYPE_BFILE?n=Kr.from(n):this.sourceLobImpl.getCsfrm()===He.CSFRM_NCHAR?n=Kr.from(n).swap16().toString("utf16le"):n=n.toString()),this.data=n}else super.processMessage(e,t)}processReturnParameter(e){let t,s,n,i;this.sourceLobImpl!==null&&(i=this.sourceLobImpl._locator.length,t=e.readBytes(i),s=t.slice(0,i),s.copy(this.sourceLobImpl._locator)),this.destLobImpl!==null&&(i=this.destLobImpl._locator.length,t=e.readBytes(i),s=t.slice(0,i),s.copy(this.destLobImpl._locator)),this.operation===He.TNS_LOB_OP_CREATE_TEMP?(e.skipUB2(),e.skipBytes(3)):this.sendAmount&&(this.amount=e.readSB8()),(this.operation===He.TNS_LOB_OP_IS_OPEN||this.operation===He.TNS_LOB_OP_FILE_EXISTS||this.operation===He.TNS_LOB_OP_FILE_ISOPEN)&&(n=e.readUInt8(),this.boolFlag=n>0)}};_(G_,"LobOpMessage");var q_=G_;hA.exports=q_});var Wr=m((GU,SA)=>{"use strict";var{Buffer:ai}=require("buffer"),SD=Sa(),Se=Ue(),AD=v_(),NA=W(),dD=Tt(),K_=class K_ extends SD{_getConnImpl(){return this.conn}async _sendMessage(e){let t=new AD(this.conn,e);return await this.conn._protocol._processMessage(t),e.operation===Se.TNS_LOB_OP_READ?t.data?t.data:null:e.operation===Se.TNS_LOB_OP_FILE_EXISTS||e.operation===Se.TNS_LOB_OP_FILE_ISOPEN?t.boolFlag:t.amount}getChunkSize(){return this._chunkSize}async _getChunkSizeAsync(){this.checkConn();let e={operation:Se.TNS_LOB_OP_GET_CHUNK_SIZE,sourceLobImpl:this,sendAmount:!0};this._chunkSize=this._pieceSize=await this._sendMessage(e)}getLength(){return this._length}getPieceSize(){return this._pieceSize}setPieceSize(e){this._pieceSize=e}getType(){return this.dbType}async getData(e=1,t=this._length){let s=!1;t||(t=this._length),this.dbType===dD.DB_TYPE_BFILE&&(await this.isFileOpen()||(s=!0,await this.openFile()));let n;try{n=await this.read(e,t)}finally{s&&await this.closeFile()}return n}async read(e,t){this.checkConn();let s={operation:Se.TNS_LOB_OP_READ,sourceLobImpl:this,sourceOffset:e,sendAmount:!0,amount:t||this._pieceSize};return await this._sendMessage(s)}async write(e,t){this.checkConn();let s={operation:Se.TNS_LOB_OP_WRITE,sourceLobImpl:this,sourceOffset:e,data:t};await this._sendMessage(s),this._length+=t.length}getCsfrm(){return this.dbType._csfrm!==Se.CSFRM_NCHAR&&this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_3]&Se.TNS_LOB_LOC_FLAGS_VAR_LENGTH_CHARSET?Se.CSFRM_NCHAR:this.dbType._csfrm}async create(e,t){this.dirtyLength=!1,this.conn=e,this.dbType=t,this._locator=ai.alloc(40),this._isTempLob=!0,this._length=0;let s={operation:Se.TNS_LOB_OP_CREATE_TEMP,sourceLobImpl:this,amount:Se.TNS_DURATION_SESSION,destOffset:t._oraTypeNum,sourceOffset:t._csfrm,sendAmount:!0};await this._sendMessage(s),await this._getChunkSizeAsync()}async fileExists(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_EXISTS,sourceLobImpl:this};return await this._sendMessage(e)}getDirFileName(){let e=Se.TNS_LOB_LOC_FIXED_OFFSET+2,t=this._locator.readUInt16BE(Se.TNS_LOB_LOC_FIXED_OFFSET),s=Se.TNS_LOB_LOC_FIXED_OFFSET+t+4,n=this._locator.readUInt16BE(e+t),i=this._locator.slice(e,e+t).toString(),a=this._locator.slice(s,s+n).toString();return{dirName:i,fileName:a}}checkConn(){this.conn.nscon.connected||NA.throwErr(NA.ERR_INVALID_CONNECTION)}close(){this.checkConn(),this._isTempLob&&(this.conn._tempLobsToClose.push(this._locator),this.conn._tempLobsTotalSize+=this._locator.length)}async closeFile(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_CLOSE,sourceLobImpl:this};await this._sendMessage(e)}init(e,t,s,n,i){this.dirtyLength=!1,this.conn=e,this._locator=t,this._isTempLob=!1,(this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_4]&Se.TNS_LOB_LOC_FLAGS_TEMP===Se.TNS_LOB_LOC_FLAGS_TEMP||this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_1]&Se.TNS_LOB_LOC_FLAGS_ABSTRACT===Se.TNS_LOB_LOC_FLAGS_ABSTRACT)&&(this._isTempLob=!0),this.dbType=s,this._length=n,this._chunkSize=i,this._pieceSize=i}async isFileOpen(){let e={operation:Se.TNS_LOB_OP_FILE_ISOPEN,sourceLobImpl:this};await this._sendMessage(e)}async openFile(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_OPEN,sourceLobImpl:this,amount:Se.TNS_LOB_OPEN_READ_ONLY,sendAmount:!0};return await this._sendMessage(e)}setDirFileName(e){let t=ai.byteLength(e.dirName),s=Se.TNS_LOB_LOC_FIXED_OFFSET+2,n=s+t+2,i=ai.byteLength(e.fileName),a=n+i,c=ai.allocUnsafe(a);this._locator.copy(c,0,0,Se.TNS_LOB_LOC_FIXED_OFFSET+1),c.writeUInt16BE(t,Se.TNS_LOB_LOC_FIXED_OFFSET),c.write(e.dirName,s),c.writeInt16BE(i,s+t),c.write(e.fileName,n),this._locator=c}};_(K_,"ThinLobImpl");var H_=K_;SA.exports=H_});var z_=m((HU,dA)=>{"use strict";var{Buffer:Hs}=require("buffer"),Ae=Ue(),Ot=W(),Te=Tt(),pD=Fn(),{GrowableBuffer:fD}=ar(),mD=Wr(),X_=class X_ extends fD{_readBytesWithLength(e){return e===Ae.TNS_LONG_LENGTH_INDICATOR&&(e=this.readUInt32BE()),this.readBytes(e)}getIsAtomicNull(){let e=this.readUInt8();return e===Ae.TNS_OBJ_ATOMIC_NULL||e===Ae.TNS_NULL_LENGTH_INDICATOR?!0:(this.pos-=1,!1)}readHeader(e){if(e.imageFlags=this.readUInt8(),e.imageVersion=this.readUInt8(),this.readLength(),!(e.imageFlags&Ae.TNS_OBJ_NO_PREFIX_SEG)){let t=this.readLength();this.skipBytes(t)}}readLength(){let e=this.readUInt8();return e!==Ae.TNS_LONG_LENGTH_INDICATOR?e:this.readUInt32BE()}writeHeader(e){this.writeUInt8(e.imageFlags),this.writeUInt8(e.imageVersion),this.writeUInt8(Ae.TNS_LONG_LENGTH_INDICATOR),this.writeUInt32BE(0),e._objType.isCollection&&(this.writeUInt8(1),this.writeUInt8(1))}writeLength(e){e<=Ae.TNS_OBJ_MAX_SHORT_LENGTH?this.writeUInt8(e):(this.writeUInt8(Ae.TNS_LONG_LENGTH_INDICATOR),this.writeUInt32BE(e))}_writeRawBytesAndLength(e,t){this.writeLength(t),this.writeBytes(e)}};_(X_,"DbObjectPickleBuffer");var Xr=X_,_i=class _i extends pD{constructor(e,t){if(typeof e=="function"&&(e=e.prototype._objType),super(e),this.packedData=t,this.unpackedAttrs=new Map,t)this.unpackedAssocArray=new Map,this.unpackedAssocKeys=void 0;else if(e){let s=Hs.from([0,34,Ae.TNS_OBJ_NON_NULL_OID,Ae.TNS_OBJ_HAS_EXTENT_OID]);this.toid=Hs.concat([s,e.oid,Ae.TNS_EXTENT_OID]),this.flags=Ae.TNS_OBJ_TOP_LEVEL,this.imageFlags=Ae.TNS_OBJ_IS_VERSION_81,this.imageVersion=Ae.TNS_OBJ_IMAGE_VERSION,e.isCollection?(this.imageFlags|=Ae.TNS_OBJ_IS_COLLECTION,e.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?this.unpackedAssocArray=new Map:this.unpackedArray=[]):this.imageFlags|=Ae.TNS_OBJ_NO_PREFIX_SEG}}_ensureAssocKeys(){this.unpackedAssocKeys||(this.unpackedAssocKeys=[...this.unpackedAssocArray.keys()].sort())}_ensureUnpacked(){this.packedData&&this._unpackData()}_getPackedData(){if(this.packedData)return this.packedData;let e=new Xr;e.writeHeader(this),this._packData(e);let t=e.pos;return e.pos=3,e.writeUInt32BE(t),e.buf.subarray(0,t)}_packData(e){let t=this._objType;if(t.isCollection)if(e.writeUInt8(t.collectionFlags),t.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE){this._ensureAssocKeys(),e.writeLength(this.unpackedAssocKeys.length);for(let s of this.unpackedAssocKeys)e.writeInt32BE(s),this._packValue(e,t.elementType,t.elementTypeClass,this.unpackedAssocArray.get(s))}else{e.writeLength(this.unpackedArray.length);for(let s of this.unpackedArray)this._packValue(e,t.elementType,t.elementTypeClass,s)}else for(let s of t.attributes)this._packValue(e,s.type,s.typeClass,this.unpackedAttrs.get(s.name))}_packValue(e,t,s,n){if(n==null)s&&!s.prototype.isCollection?e.writeUInt8(Ae.TNS_OBJ_ATOMIC_NULL):e.writeUInt8(Ae.TNS_NULL_LENGTH_INDICATOR);else switch(t){case Te.DB_TYPE_CHAR:case Te.DB_TYPE_VARCHAR:e.writeBytesWithLength(Hs.from(n));break;case Te.DB_TYPE_NCHAR:case Te.DB_TYPE_NVARCHAR:e.writeBytesWithLength(Hs.from(n,"utf16le").swap16());break;case Te.DB_TYPE_NUMBER:e.writeOracleNumber(n.toString());break;case Te.DB_TYPE_BINARY_INTEGER:case Te.DB_TYPE_BOOLEAN:e.writeUInt8(4),e.writeUInt32BE(n);break;case Te.DB_TYPE_RAW:e.writeBytesWithLength(n);break;case Te.DB_TYPE_BINARY_DOUBLE:e.writeUInt8(8),e.writeBinaryDouble(n);break;case Te.DB_TYPE_BINARY_FLOAT:e.writeUInt8(4),e.writeBinaryFloat(n);break;case Te.DB_TYPE_DATE:case Te.DB_TYPE_TIMESTAMP:case Te.DB_TYPE_TIMESTAMP_LTZ:case Te.DB_TYPE_TIMESTAMP_TZ:e.writeOracleDate(n,t);break;case Te.DB_TYPE_OBJECT:this._objType.isCollection||n._objType.isCollection?e.writeBytesWithLength(n._getPackedData()):n._packData(e);break;default:Ot.throwErr(Ot.ERR_NOT_IMPLEMENTED,t)}}_unpackData(){let e=new Xr(this.packedData);e.readHeader(this),this._unpackDataFromBuf(e),this.packedData=void 0}_unpackDataFromBuf(e){let t,s,n,i,a=this._objType;if(a.isCollection){a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?s=new Map:t=[],this.collectionFlags=e.readUInt8();let c=e.readLength();for(let T=0;T<c;T++){a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE&&(n=e.readUInt32BE());let l=this._unpackValue(e,a.elementType,a.elementTypeClass);a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?s.set(n,l):t.push(l)}}else{i=new Map;for(let c of a.attributes){let T=this._unpackValue(e,c.type,c.typeClass);i.set(c.name,T)}}this.unpackedAttrs=i,this.unpackedArray=t,this.unpackedAssocArray=s}_unpackValue(e,t,s){let n,i,a;switch(t){case Te.DB_TYPE_NUMBER:return a=e.readOracleNumber(),a!==null&&(a=parseFloat(a)),a;case Te.DB_TYPE_BINARY_INTEGER:return e.readBinaryInteger();case Te.DB_TYPE_VARCHAR:case Te.DB_TYPE_CHAR:return e.readStr(Ae.CSFRM_IMPLICIT);case Te.DB_TYPE_NVARCHAR:case Te.DB_TYPE_NCHAR:return e.readStr(Ae.CSFRM_NCHAR);case Te.DB_TYPE_RAW:return a=e.readBytesWithLength(),a!==null&&(a=Hs.from(a)),a;case Te.DB_TYPE_BINARY_DOUBLE:return e.readBinaryDouble();case Te.DB_TYPE_BINARY_FLOAT:return e.readBinaryFloat();case Te.DB_TYPE_DATE:case Te.DB_TYPE_TIMESTAMP:return e.readOracleDate(!0);case Te.DB_TYPE_TIMESTAMP_LTZ:case Te.DB_TYPE_TIMESTAMP_TZ:return e.readOracleDate(!1);case Te.DB_TYPE_BOOLEAN:return e.readBool();case Te.DB_TYPE_OBJECT:case Te.DB_TYPE_XMLTYPE:return n=e.getIsAtomicNull(),n?null:(i=new _i(s),i._objType.isXmlType?AA(i._objType._connection,e.readBytesWithLength()):(i._objType.isCollection||this._objType.isCollection?i.packedData=Hs.from(e.readBytesWithLength()):i._unpackDataFromBuf(e),i));default:Ot.throwErr(Ot.ERR_NOT_IMPLEMENTED,t)}}append(e){if(this._ensureUnpacked(),this.unpackedArray){let t=this._objType;t.maxNumElements>0&&this.unpackedArray.length>=t.maxNumElements&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_SET,this.unpackedArray.length,0,t.maxNumElements),this.unpackedArray.push(e)}else{this._ensureAssocKeys();let t;if(this.unpackedAssocKeys.length===0)t=0;else{let s=this.unpackedAssocKeys.length-1;t=this.unpackedAssocKeys[s]+1}this.unpackedAssocArray.set(t,e),this.unpackedAssocKeys.push(t)}}deleteElement(e){this._ensureUnpacked(),this.unpackedArray?(this._objType.collectionType==Ae.TNS_OBJ_VARRAY&&Ot.throwErr(Ot.ERR_DELETE_ELEMENTS_OF_VARRAY),this.unpackedArray.splice(e,1)):(this._unpackedAssocKeys=void 0,this.unpackedAssocArray.delete(e))}getAttrValue(e){this._ensureUnpacked();let t=this.unpackedAttrs.get(e.name);return t===void 0?null:t}getElement(e){let t;return this._ensureUnpacked(),this.unpackedArray?t=this.unpackedArray[e]:t=this.unpackedAssocArray.get(e),t===void 0&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_GET,e),t}getFirstIndex(){if(this._ensureUnpacked(),this.unpackedArray)return 0;if(this.unpackedAssocArray)return this._ensureAssocKeys(),this.unpackedAssocKeys[0]}getKeys(){return this._ensureUnpacked(),this.unpackedArray?Array.from(this.unpackedArray.keys()):this.unpackedAssocArray?(this._ensureAssocKeys(),Array.from(this.unpackedAssocKeys)):[]}getLastIndex(){if(this._ensureUnpacked(),this.unpackedArray){if(this.unpackedArray.length>0)return this.unpackedArray.length-1}else if(this.unpackedAssocArray)return this._ensureAssocKeys(),this.unpackedAssocKeys[this.unpackedAssocKeys.length-1]}getNextIndex(e){if(this._ensureUnpacked(),this.unpackedArray){if(e+1<this.unpackedArray.length)return e+1}else if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys)if(t>e)return t}}getPrevIndex(e){if(this._ensureUnpacked(),this.unpackedArray){if(e>0)return e-1}else if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys.reverse())if(t<e)return t}}getValues(){let e=[];if(this._ensureUnpacked(),this.unpackedArray)return Array.from(this.unpackedArray);if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys)e.push(this.unpackedAssocArray.get(t))}return e}hasElement(e){return this._ensureUnpacked(),this.unpackedArray?e>=0&&e<this.unpackedArray.length:this.unpackedAssocArray.has(e)}setAttrValue(e,t){this._ensureUnpacked(),this.unpackedAttrs.set(e.name,t)}setElement(e,t){if(this._ensureUnpacked(),this.unpackedArray){let s=Math.max(this.unpackedArray.length-1,0);e>s&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_SET,e,0,s),this.unpackedArray[e]=t}else this.unpackedAssocArray.has(e)||(this.unpackedAssocKeys=void 0),this.unpackedAssocArray.set(e,t)}trim(e){this._ensureUnpacked(),e>0&&(this.unpackedArray=this.unpackedArray.slice(0,this.unpackedArray.length-e))}};_(_i,"ThinDbObjectImpl");var W_=_i;function AA(r,e){let t,s=new Xr(e),n={};s.readHeader(n),s.skipBytes(1);let i=s.readUInt32BE();i&Ae.TNS_XML_TYPE_FLAG_SKIP_NEXT_4&&s.skipBytes(4);let a=s.numBytesLeft(),c=s.readBytes(a);if(i&Ae.TNS_XML_TYPE_STRING)t=c.toString();else if(i&Ae.TNS_XML_TYPE_LOB){let T=new mD,l=Hs.from(c);T.init(r,l,Te.DB_TYPE_CLOB,0,0),t=T}else Ot.throwErr(Ot.ERR_UNEXPECTED_XML_TYPE,i);return t}_(AA,"readXML");dA.exports={ThinDbObjectImpl:W_,readXML:AA}});var j_=m((WU,mA)=>{"use strict";var{Buffer:Os}=require("buffer"),pA=Hr(),L=Ue(),PD=Ct(),{ThinDbObjectImpl:RD,readXML:ID}=z_(),DD=Wr(),gs=W(),Re=Tt(),Q_=class Q_ extends PD{constructor(e,t=null,s=null){super(e),this.statement=t,this.options=s,this.offset=0,this.numExecs=1,this.arrayDmlRowCounts=!1,this.requiresDefine=!1,this.rowIndex=t.bufferRowCount||0,this.dmlRowCounts=[],this.batchErrors=!1,this.outVariables=[],this.inFetch=!1,this.parseOnly=!1,this.resultSetsToSetup=[],this.deferredErr=null}processMessage(e,t){if(t===L.TNS_MSG_TYPE_DESCRIBE_INFO){e.skipBytesChunked();let s=this.statement.queryVars;this.statement.queryVars=[],this.statement.numQueryVars=0,this.statement.bufferRowCount=0,this.statement.bufferRowIndex=0,this.processDescribeInfo(e,this.resultSet,s),this.outVariables=this.statement.queryVars}else t===L.TNS_MSG_TYPE_ROW_HEADER?this.processRowHeader(e):t===L.TNS_MSG_TYPE_ROW_DATA?this.processRowData(e):t===L.TNS_MSG_TYPE_IMPLICIT_RESULTSET?this.processImplicitResultSet(e):t===L.TNS_MSG_TYPE_BIT_VECTOR?this.processBitVector(e):t===L.TNS_MSG_TYPE_IO_VECTOR?this.processIOVector(e):t===L.TNS_MSG_TYPE_FLUSH_OUT_BINDS?(this.flushOutBinds=!0,this.endOfResponse=!0):t===L.TNS_MSG_TYPE_ERROR?this.processErrorInfo(e):super.processMessage(e,t)}processErrorInfo(e){super.processErrorInfo(e),this.errorInfo.cursorId!==0&&(this.statement.cursorId=this.errorInfo.cursorId),this.statement.isPlSql||(this.statement.rowCount=this.errorInfo.rowCount),this.errorInfo.rowCount>0&&(this.statement.lastRowid=pA.encodeRowID(this.errorInfo.rowID)),this.options.batchErrors=this.errorInfo.batchErrors,this.batchErrors&&this.options.batchErrors===null&&(this.options.batchErrors=[]),this.errorInfo.num===L.TNS_ERR_NO_DATA_FOUND&&this.statement.isQuery?(this.errorInfo.num=0,this.errorOccurred=!1,this.statement.moreRowsToFetch=!1):this.retry?this.retry=!1:this.statement.isQuery&&(this.errorInfo.num===L.TNS_ERR_VAR_NOT_IN_SELECT_LIST||this.errorInfo.num===L.TNS_ERR_INCONSISTENT_DATA_TYPES)?(this.retry=!0,this.connection.statementCache.clearCursor(this.statement)):this.errorInfo.num!==0&&this.errorInfo.cursorId!==0&&(gs.ERR_INTEGRITY_ERROR_CODES.includes(this.errorInfo.num)||(this.connection.statementCache.clearCursor(this.statement),this.statement.returnToCache=!1)),this.errorInfo.batchErrors&&(this.errorOccurred=!1)}_adjustFetchType(e,t){(t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_CLOB&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_BLOB&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG_RAW||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_JSON&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_VARCHAR||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_VECTOR&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG)&&(t.type=e.fetchInfo.fetchType,t.maxSize=e.maxSize)}processDescribeInfo(e,t,s){let n=t.statement;e.skipUB4(),n.numQueryVars=e.readUB4(),n.numQueryVars>0&&e.skipUB1(),t.metadata=[];let i=[],a=[];for(let T=0;T<n.numQueryVars;T++){let l=this.processColumnInfo(e,T+1);s&&T<s.length&&this._adjustFetchType(s[T],l),a.push(l),i.push(l.fetchInfo)}let c=e.readUB4();c>0&&e.skipBytesChunked(),e.skipUB4(),e.skipUB4(),e.skipUB4(),e.skipUB4(),c=e.readUB4(),c>0&&e.skipBytesChunked(),t.metadata=i,n.queryVars=a,this.resultSetsToSetup.push(t)}processColumnInfo(e,t){let s=e.readUInt8();e.skipUB1();let n=e.readInt8(),i=e.readInt8(),a=e.readUB4();e.skipUB4(),e.skipUB8();let c,T=e.readUB4();T>0&&(c=Os.from(e.readBytesWithLength())),e.skipUB2(),e.skipUB2();let l=e.readUInt8(),E=e.readUB4();s===L.TNS_DATA_TYPE_RAW&&(E=a),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_12_2&&e.skipUB4();let u=!!e.readUInt8();e.skipUB1();let p;T=e.readUB4(),T>0&&(p=e.readStr(L.CSFRM_IMPLICIT));let A;T=e.readUB4(),T>0&&(A=e.readStr(L.CSFRM_IMPLICIT)),T=e.readUB4();let h;T>0&&(h=e.readStr(L.CSFRM_IMPLICIT)),e.skipUB2();let N=e.readUB4(),d={name:p,dbType:Re.getTypeByOraTypeNum(s,l),nullable:u};if(d.isJson=!!(N&L.TNS_UDS_FLAGS_IS_JSON),d.isOson=!!(N&L.TNS_UDS_FLAGS_IS_OSON),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_1&&(T=e.readUB4(),T>0&&(d.domainSchema=e.readStr(L.CSFRM_IMPLICIT)),T=e.readUB4(),T>0&&(d.domainName=e.readStr(L.CSFRM_IMPLICIT))),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_1_EXT_3&&e.readUB4()>0){d.annotations={},e.skipUB1();let S=e.readUB4();e.skipUB1();let D,P;for(let y=0;y<S;y++)e.skipUB4(),P="",D=e.readStr(L.CSFRM_IMPLICIT),T=e.readUB4(),T>0&&(P=e.readStr(L.CSFRM_IMPLICIT)),d.annotations[D]=P,e.skipUB4();e.skipUB4()}if(e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_4){let S=e.readUB4(),D=e.readUInt8(),P=e.readUInt8();d.dbType===Re.DB_TYPE_VECTOR&&(P&L.VECTOR_META_FLAG_FLEXIBLE_DIM||(d.vectorDimensions=S),D!==L.VECTOR_FORMAT_FLEX&&(d.vectorFormat=D))}switch(d.dbType){case Re.DB_TYPE_VARCHAR:case Re.DB_TYPE_NVARCHAR:case Re.DB_TYPE_CHAR:case Re.DB_TYPE_NCHAR:case Re.DB_TYPE_RAW:d.byteSize=E;break;case Re.DB_TYPE_NUMBER:d.precision=n;break;case Re.DB_TYPE_TIMESTAMP:case Re.DB_TYPE_TIMESTAMP_TZ:case Re.DB_TYPE_TIMESTAMP_LTZ:d.precision=i;break;case Re.DB_TYPE_OBJECT:d.dbTypeClass=this.connection._getDbObjectType(A,h,void 0,c),d.dbTypeClass.partial&&this.connection._partialDbObjectTypes.push(d.dbTypeClass),d.dbTypeClass.isXmlType&&(d.dbType=Re.DB_TYPE_XMLTYPE);break;default:break}return d.dbType===Re.DB_TYPE_NUMBER&&(d.scale=i),{fetchInfo:d,type:d.dbType,maxSize:a,columnNum:t,values:new Array(this.options.fetchArraySize)}}processRowHeader(e){e.skipUB1(),e.skipUB2(),e.skipUB4(),e.skipUB4(),e.skipUB2();let t=e.readUB4();t>0&&(this.bitVector=Os.from(e.readBytesWithLength())),t=e.readUB4(),t>0&&e.skipBytesChunked()}isDuplicateData(e){if(!this.bitVector)return!1;let t=Math.floor(e/8),s=e%8;return(this.bitVector[t]&1<<s)===0}processRowData(e){let t;for(let[s,n]of this.outVariables.entries())if(n.isArray){n.numElementsInArray=e.readUB4();let i=new Array(n.numElementsInArray).fill(null);for(let a=0;a<n.numElementsInArray;a++)t=this.processColumnData(e,n,a),i[a]=t;n.values[this.rowIndex]=i}else if(this.statement.isReturning){let i=e.readUB4(),a=Array(i).fill(null);for(let c=0;c<i;c++)a[c]=this.processColumnData(e,n,c);n.values[this.rowIndex]=a}else this.isDuplicateData(s)?(this.rowIndex===0&&n.outConverter?t=n.lastRawValue:t=n.values[this.statement.lastRowIndex],n.values[this.rowIndex]=t):(t=this.processColumnData(e,n,this.rowIndex),n.values[this.rowIndex]=t);this.rowIndex++,this.inFetch&&(this.statement.lastRowIndex=this.rowIndex-1,this.statement.bufferRowCount++,this.bitVector=null)}processIOVector(e){let t;e.skipUB1();let s=e.readUB2(),i=e.readUB4()*256+s;e.skipUB4(),e.skipUB2(),t=e.readUB2(),t>0&&e.skipBytes(t),t=e.readUB2(),t>0&&e.skipBytes(t),this.outVariables=[];for(let a=0;a<i;a++){let c=this.statement.bindInfoList[a];c.bindDir=e.readUInt8(),c.bindDir!==L.TNS_BIND_DIR_INPUT&&this.outVariables.push(c.bindVar)}}processColumnData(e,t){let s=t.type,n=s._oraTypeNum,i=s._csfrm,a=t.maxSize,c=null;if(a===0&&n!==L.TNS_DATA_TYPE_LONG&&n!==L.TNS_DATA_TYPE_LONG_RAW&&n!==L.TNS_DATA_TYPE_UROWID)c=null;else if(n===L.TNS_DATA_TYPE_VARCHAR||n===L.TNS_DATA_TYPE_CHAR||n===L.TNS_DATA_TYPE_LONG)i===L.CSFRM_NCHAR&&e.caps.checkNCharsetId(),c=e.readStr(i);else if(n===L.TNS_DATA_TYPE_RAW||n===L.TNS_DATA_TYPE_LONG_RAW)c=e.readBytesWithLength(),c!==null&&(c=Os.from(c));else if(n===L.TNS_DATA_TYPE_NUMBER)c=e.readOracleNumber(),!this.inFetch&&c!==null&&(c=parseFloat(c));else if(n===L.TNS_DATA_TYPE_DATE||n===L.TNS_DATA_TYPE_TIMESTAMP||n===L.TNS_DATA_TYPE_TIMESTAMP_LTZ||n===L.TNS_DATA_TYPE_TIMESTAMP_TZ){let T=n===L.TNS_DATA_TYPE_DATE||n===L.TNS_DATA_TYPE_TIMESTAMP;c=e.readOracleDate(T)}else if(n===L.TNS_DATA_TYPE_ROWID)if(!this.inFetch)c=e.readStr(L.CSFRM_IMPLICIT);else{let T=e.readUInt8();if(fA(T))c=null;else{let l=e.readRowID();c=pA.encodeRowID(l)}}else if(n===L.TNS_DATA_TYPE_UROWID)this.inFetch?c=e.readURowID():c=e.readStr(L.CSFRM_IMPLICIT);else if(n===L.TNS_DATA_TYPE_BINARY_DOUBLE)c=e.readBinaryDouble();else if(n===L.TNS_DATA_TYPE_BINARY_FLOAT)c=e.readBinaryFloat();else if(n===L.TNS_DATA_TYPE_BINARY_INTEGER)c=e.readOracleNumber(),c!==null&&(c=parseFloat(c));else if(n===L.TNS_DATA_TYPE_CURSOR){let T=e.readUInt8();fA(T)?c=null:(c=this.createCursorFromDescribe(e),c.statement.cursorId=e.readUB2(),c.statement.cursorId===0&&t.dir!==L.BIND_IN&&(this.options.nullifyInvalidCursor?c=null:gs.throwErr(gs.ERR_INVALID_REF_CURSOR)))}else if(n===L.TNS_DATA_TYPE_BOOLEAN)c=e.readBool();else if(n===L.TNS_DATA_TYPE_CLOB||n===L.TNS_DATA_TYPE_BLOB||n===L.TNS_DATA_TYPE_BFILE){let T=0,l=0;if(e.readUB4()>0){c=new DD,n===L.TNS_DATA_TYPE_BFILE?e.skipUB4():(T=e.readUB8(),l=e.readUB4());let u=Os.from(e.readBytesWithLength());c.init(this.connection,u,s,T,l)}}else if(n===L.TNS_DATA_TYPE_JSON)c=e.readOson();else if(n===L.TNS_DATA_TYPE_VECTOR)c=e.readVector();else if(n===L.TNS_DATA_TYPE_INT_NAMED){let T=e.readDbObject();if(T.packedData){let l=t.fetchInfo?t.fetchInfo.dbTypeClass:t.typeClass;t.type===Re.DB_TYPE_XMLTYPE?c=ID(this.connection,T.packedData):(c=new RD(l,T.packedData),c.toid=T.toid,c.oid=T.oid)}}else gs.throwErr(gs.ERR_UNSUPPORTED_DATA_TYPE,s.num,t.columnNum);if(this.inFetch)(n===L.TNS_DATA_TYPE_LONG||n===L.TNS_DATA_TYPE_LONG_RAW||t.maxSize>e.caps.maxStringSize)&&(e.skipSB4(),e.skipUB4());else{let T=e.readSB4();T<0&&n===L.TNS_DATA_TYPE_BOOLEAN?c=null:T!==0&&c!==null&&n!==L.TNS_DATA_TYPE_INT_NAMED&&this.saveDeferredErr(gs.ERR_INSUFFICIENT_BUFFER_FOR_BINDS)}return c}processReturnParameter(e){let t=0,s,n=e.readUB2();for(let a=0;a<n;a++)e.skipUB4();let i=e.readUB2();i>0&&e.skipBytes(i),n=e.readUB2();for(let a=0;a<n;a++)i=e.readUB2(),i>0&&(s=e.readStr(L.CSFRM_IMPLICIT)),i=e.readUB2(),i>0&&e.skipBytesChunked(),t=e.readUB2(),t===L.TNS_KEYWORD_NUM_CURRENT_SCHEMA?this.connection.currentSchema=s:t===L.TNS_KEYWORD_NUM_EDITION&&(this.connection._edition=s);if(i=e.readUB2(),i>0&&e.skip(i),this.arrayDmlRowCounts){let a=e.readUB4(),c=this.options.dmlRowCounts=[];for(let T=0;T<a;T++){let l=e.readUB8();c.push(l)}}}async postProcess(){if(this.deferredErr)throw this.deferredErr;if(this.outVariables)for(let e of this.outVariables)if(e.isArray){if(e.outConverter)for(let t=0;t<e.numElementsInArray;t++)e.values[0][t]=await e.outConverter(e.values[0][t])}else e.outConverter&&(e.values[0]=await e.outConverter(e.values[0]));await this.connection._populatePartialDbObjectTypes();for(let e of this.resultSetsToSetup){e._setup(this.options,e.metadata);for(let t of e.statement.queryVars)(t.type===Re.DB_TYPE_CLOB||t.type===Re.DB_TYPE_NCLOB||t.type===Re.DB_TYPE_BLOB||t.type===Re.DB_TYPE_BFILE||t.type===Re.DB_TYPE_JSON||t.type===Re.DB_TYPE_VECTOR)&&(t.type!==t.fetchInfo.fetchType&&(t.type=t.fetchInfo.fetchType,t.maxSize=L.TNS_MAX_LONG_LENGTH),e.statement.noPrefetch||(e.statement.requiresDefine=!0,e.statement.noPrefetch=!0))}}preProcess(){if(this.statement.isReturning&&!this.parseOnly){this.outVariables=[];for(let e of this.statement.bindInfoList)e.isReturnBind&&this.outVariables.push(e.bindVar)}if(this.statement.isQuery&&(this.inFetch=!0,this.statement.queryVars)){this.outVariables=[];for(let e=0;e<this.statement.queryVars.length;e++)this.outVariables.push(this.statement.queryVars[e])}}processBitVector(e){this.numColumnsSent=e.readUB2();let t=Math.floor(this.statement.numQueryVars/8);this.statement.numQueryVars%8>0&&(t+=1),this.bitVector=Os.from(e.readBytes(t))}processBindParams(e,t){let s=[],n=[];for(let i of t)i.isReturnBind||n.push(i),s.push(i.bindVar);return this.writeColumnMetadata(e,s),n}writeColumnMetadata(e,t){for(let s of t){let n=s.type._oraTypeNum,i=s.maxSize||s.type._bufferSizeFactor,a=0;s.type._csfrm===L.CSFRM_NCHAR&&(i*=s.type._bufferSizeFactor),[L.TNS_DATA_TYPE_ROWID,L.TNS_DATA_TYPE_UROWID].includes(n)&&(n=L.TNS_DATA_TYPE_VARCHAR,i=L.TNS_MAX_UROWID_LENGTH);let c=L.TNS_BIND_USE_INDICATORS;s.isArray&&(c|=L.TNS_BIND_ARRAY);let T=0;if(s.type===Re.DB_TYPE_BLOB||s.type===Re.DB_TYPE_CLOB||s.type===Re.DB_TYPE_NCLOB||s.type===Re.DB_TYPE_BFILE?T=L.TNS_LOB_PREFETCH_FLAG:s.type===Re.DB_TYPE_JSON?(T=L.TNS_LOB_PREFETCH_FLAG,i=a=L.TNS_JSON_MAX_LENGTH):s.type===Re.DB_TYPE_VECTOR&&(T=L.TNS_LOB_PREFETCH_FLAG,i=a=L.TNS_VECTOR_MAX_LENGTH),e.writeUInt8(n),e.writeUInt8(c),e.writeUInt8(0),e.writeUInt8(0),i>e.caps.maxStringSize?e.writeUB4(L.TNS_MAX_LONG_LENGTH):e.writeUB4(i),s.isArray?e.writeUB4(s.maxArraySize):e.writeUB4(0),e.writeUB4(T),s.objType){let l=s.objType;e.writeUB4(l.oid.length),e.writeBytesWithLength(l.oid),e.writeUB2(l.version)}else e.writeUB4(0),e.writeUB2(0);s.type._csfrm!==0?e.writeUB2(L.TNS_CHARSET_UTF8):e.writeUB2(0),e.writeUInt8(s.type._csfrm),e.writeUB4(a),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_12_2&&e.writeUB4(0)}}writeBindParamsRow(e,t,s){let n=this.offset,i=!1;for(let a of t){if(a.isReturnBind)continue;let c=a.bindVar;if(c.isArray){let T=c.values.length;e.writeUB4(T);for(let l=0;l<T;l++)this.writeBindParamsColumn(e,c,c.values[l])}else!this.statement.isPlSql&&c.maxSize>e.caps.maxStringSize?i=!0:this.writeBindParamsColumn(e,c,c.values[s+n])}if(i)for(let a of t){if(a.isReturnBind)continue;let c=a.bindVar;c.maxSize>e.caps.maxStringSize&&this.writeBindParamsColumn(e,c,c.values[s+n])}}writeBindParamsColumn(e,t,s){let n=t.type._oraTypeNum,i;if(s==null&&n!==L.TNS_DATA_TYPE_CURSOR&&n!==L.TNS_DATA_TYPE_JSON)n===L.TNS_DATA_TYPE_BOOLEAN?(e.writeUInt8(L.TNS_ESCAPE_CHAR),e.writeUInt8(1)):n===L.TNS_DATA_TYPE_INT_NAMED?(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(L.TNS_OBJ_TOP_LEVEL)):e.writeUInt8(0);else if(n===L.TNS_DATA_TYPE_NUMBER||n===L.TNS_DATA_TYPE_BINARY_INTEGER)typeof s=="boolean"?i=s?"1":"0":i=s.toString(),e.writeOracleNumber(i);else if(n===L.TNS_DATA_TYPE_VARCHAR||n===L.TNS_DATA_TYPE_CHAR||n===L.TNS_DATA_TYPE_LONG||n===L.TNS_DATA_TYPE_RAW||n===L.TNS_DATA_TYPE_LONG_RAW)t.type._csfrm===L.CSFRM_NCHAR?(e.caps.checkNCharsetId(),s=Os.from(s,L.TNS_ENCODING_UTF16).swap16()):s=Os.from(s),e.writeBytesWithLength(s);else if(n===L.TNS_DATA_TYPE_DATE||n===L.TNS_DATA_TYPE_TIMESTAMP||n===L.TNS_DATA_TYPE_TIMESTAMP_TZ||n===L.TNS_DATA_TYPE_TIMESTAMP_LTZ)e.writeOracleDate(s,t.type);else if(n===L.TNS_DATA_TYPE_BINARY_DOUBLE)e.writeUInt8(8),e.writeBinaryDouble(s);else if(n===L.TNS_DATA_TYPE_BINARY_FLOAT)e.writeUInt8(4),e.writeBinaryFloat(s);else if(n===L.TNS_DATA_TYPE_CURSOR){let a=s;s||(a=this.connection._createResultSet()),a.statement.cursorId===0?(e.writeUInt8(1),e.writeUInt8(0)):(e.writeUB4(1),e.writeUB4(a.statement.cursorId))}else if(n===L.TNS_DATA_TYPE_BOOLEAN)s?(e.writeUInt8(2),e.writeUInt16BE(257)):e.writeUInt16BE(256);else if(n===L.TNS_DATA_TYPE_CLOB||n===L.TNS_DATA_TYPE_BLOB||n===L.TNS_DATA_TYPE_BFILE)e.writeUB4(s._locator.length),e.writeBytesWithLength(s._locator);else if([L.TNS_DATA_TYPE_ROWID,L.TNS_DATA_TYPE_UROWID].includes(n))e.writeBytesWithLength(Os.from(s));else if(n===L.TNS_DATA_TYPE_JSON)e.writeOson(s,this.connection._osonMaxFieldNameSize);else if(n===L.TNS_DATA_TYPE_VECTOR)e.writeVector(s);else if(n===L.TNS_DATA_TYPE_INT_NAMED)e.writeDbObject(s);else{let a=`Binding data of type ${t.type}`;gs.throwErr(gs.ERR_NOT_IMPLEMENTED,a)}}createCursorFromDescribe(e){let t=this.connection._createResultSet(this.options);return t.options.moreRowsToFetch=!0,t.statement.isQuery=!0,t.statement.requiresFullExecute=!0,this.processDescribeInfo(e,t),t}processImplicitResultSet(e){this.options.implicitResultSet=[];let t=e.readUB4();for(let s=0;s<t;s++){let n=e.readUInt8();e.skipBytes(n);let i=this.createCursorFromDescribe(e);i.statement.cursorId=e.readUB2(),this.options.implicitResultSet.push(i)}}};_(Q_,"MessageWithData");var $_=Q_,fA=_(r=>r===0||r===L.TNS_NULL_LENGTH_INDICATOR,"isNullLength");mA.exports=$_});var ec=m((zU,RA)=>{"use strict";var CD=j_(),Ce=Ue(),PA=W(),Z_=class Z_ extends CD{constructor(e,t,s,n){super(e,t,s),!n&&t.isQuery&&(n=e._createResultSet(s,t)),this.resultSet=n,this.functionCode=Ce.TNS_FUNC_EXECUTE,this.bindParams=void 0,this.currentRow=0}writeExecuteMessage(e){let t=0,s=0,n=0,i=1,a=this.statement,c=a.bindInfoList;if(this.noImplicitRelease&&(s|=Ce.TNS_EXEC_OPTION_NO_IMPL_REL),!a.requiresDefine&&!this.parseOnly&&c&&(n=c.length),a.requiresDefine?t|=Ce.TNS_EXEC_OPTION_DEFINE:!this.parseOnly&&a.sql&&(s|=Ce.TNS_EXEC_OPTION_IMPLICIT_RESULTSET,t|=Ce.TNS_EXEC_OPTION_EXECUTE),(a.cursorId===0||a.isDdl)&&(t|=Ce.TNS_EXEC_OPTION_PARSE),a.isQuery&&(this.parseOnly?t|=Ce.TNS_EXEC_OPTION_DESCRIBE:(a.cursorId===0||a.requiresDefine?i=this.options.prefetchRows:i=this.options.fetchArraySize,i>0&&!a.noPrefetch&&(t|=Ce.TNS_EXEC_OPTION_FETCH))),!a.isPlSql&&!this.parseOnly?t|=Ce.TNS_EXEC_OPTION_NOT_PLSQL:a.isPlSql&&n>0&&(t|=Ce.TNS_EXEC_OPTION_PLSQL_BIND),n>0&&(t|=Ce.TNS_EXEC_OPTION_BIND),this.batchErrors&&(t|=Ce.TNS_EXEC_OPTION_BATCH_ERRORS),this.arrayDmlRowCounts&&(s=Ce.TNS_EXEC_OPTION_DML_ROWCOUNTS),this.options.autoCommit&&(t|=Ce.TNS_EXEC_OPTION_COMMIT),this.writePiggybacks(e),this.writeFunctionHeader(e),e.writeUB4(t),e.writeUB4(a.cursorId),a.cursorId===0||a.isDdl?(e.writeUInt8(1),e.writeUB4(a.sqlLength)):(e.writeUInt8(0),e.writeUB4(0)),e.writeUInt8(1),e.writeUB4(13),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(i),e.writeUB4(Ce.TNS_MAX_LONG_LENGTH),n===0?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(n)),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),a.requiresDefine?(e.writeUInt8(1),e.writeUB4(this.statement.queryVars.length)):(e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(0),e.writeUInt8(0),e.writeUInt8(1),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUB4(0),this.arrayDmlRowCounts?(e.writeUInt8(1),e.writeUB4(this.numExecs),e.writeUInt8(1)):(e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0)),e.caps.ttcFieldVersion>=Ce.TNS_CCAP_FIELD_VERSION_12_2&&(e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.caps.ttcFieldVersion>=Ce.TNS_CCAP_FIELD_VERSION_12_2_EXT1&&(e.writeUInt8(0),e.writeUB4(0))),a.cursorId===0||a.isDdl?a.sql?(e.writeBytesWithLength(a.sqlBytes),e.writeUB4(1)):PA.throwErr(PA.ERR_INVALID_REF_CURSOR):e.writeUB4(0),a.isQuery?a.cursorId===0?e.writeUB4(0):e.writeUB4(i):e.writeUB4(this.numExecs),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(a.isQuery?1:0),e.writeUB4(0),e.writeUB4(s),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),a.requiresDefine)this.writeColumnMetadata(e,this.statement.queryVars);else if(n>0)return this.processBindParams(e,c)}writeReExecuteMessage(e){let t=this.statement,s=t.bindInfoList,n=0,i=0,a;if(s!==void 0){t.isQuery||(this.outVariables=[],s.forEach(T=>{T.bindDir!==Ce.TNS_BIND_DIR_INPUT&&this.outVariables.push(T.bindVar)}));let c=[];s.forEach(T=>{T.bindDir!==Ce.TNS_BIND_DIR_OUTPUT&&!T.isReturnBind&&c.push(T)}),s=c}return this.functionCode===Ce.TNS_FUNC_REEXECUTE_AND_FETCH?(n|=Ce.TNS_EXEC_OPTION_EXECUTE,a=this.options.prefetchRows):(this.options.autoCommit&&(i|=Ce.TNS_EXEC_OPTION_COMMIT_REEXECUTE),a=this.numExecs),this.writePiggybacks(e),this.writeFunctionHeader(e),e.writeUB4(t.cursorId),e.writeUB4(a),e.writeUB4(n),e.writeUB4(i),s}encode(e){if(this.currentRow===0){let t=this.statement;t.cursorId!==0&&!t.requiresFullExecute&&!this.parseOnly&&!t.requiresDefine&&!t.noPrefetch&&!t.isDdl&&!this.batchErrors?(t.isQuery&&this.options.prefetchRows>0?this.functionCode=Ce.TNS_FUNC_REEXECUTE_AND_FETCH:this.functionCode=Ce.TNS_FUNC_REEXECUTE,this.bindParams=this.writeReExecuteMessage(e)):(this.functionCode=Ce.TNS_FUNC_EXECUTE,this.bindParams=this.writeExecuteMessage(e))}if(this.bindParams&&this.bindParams.length>0){let t=e.nsi.ntAdapter;for(;this.currentRow<this.numExecs;)if(e.writeUInt8(Ce.TNS_MSG_TYPE_ROW_DATA),this.writeBindParamsRow(e,this.bindParams,this.currentRow),this.currentRow++,this.currentRow<this.numExecs&&t.shouldPauseWrite())return!0}this.currentRow=0,this.bindParams=void 0}};_(Z_,"ExecuteMessage");var J_=Z_;RA.exports=J_});var rc=m((QU,DA)=>{"use strict";var OD=Ue(),gD=j_(),IA=W(),sc=class sc extends gD{constructor(e,t,s,n){super(e,t,s),this.resultSet=n,this.functionCode=OD.TNS_FUNC_FETCH}encode(e){this.writeFunctionHeader(e),this.statement.cursorId===0&&IA.throwErr(IA.ERR_CURSOR_HAS_BEEN_CLOSED),e.writeUB4(this.statement.cursorId),e.writeUB4(this.options.fetchArraySize)}};_(sc,"FetchMessage");var tc=sc;DA.exports=tc});var oc=m((JU,CA)=>{"use strict";var yD=Fa(),LD=ec(),wD=rc(),ic=class ic extends yD{async _fetchMoreRows(e){let t=this.statement.requiresFullExecute?LD:wD,s=new t(this.connection,this.statement,e,this);await this.connection._protocol._processMessage(s),this.statement.requiresFullExecute=!1}_resultSetNew(e,t,s){this.connection=e,this.statement=t,this._nestedCursorIndices=[],this.options=s,this.prefetchRowsProcessed=!1,this.statement.bufferRowIndex=0}close(){this.connection._returnStatement(this.statement)}_processRows(e){let t=[],s=this.statement.bufferRowIndex;for(let n=s;n<s+e;n++){let i=[];for(let a=0;a<this.statement.numQueryVars;a++)i.push(this.statement.queryVars[a].values[n]);t.push(i)}return this.statement.bufferRowIndex+=e,this.statement.bufferRowIndex===this.statement.bufferRowCount&&(this.statement.bufferRowCount=0,this.statement.bufferRowIndex=0),t}async getRows(e,t){if(t.fetchArraySize=e||this.options.fetchArraySize,t.prefetchRows=this.options.prefetchRows,this.statement.bufferRowCount-this.statement.bufferRowIndex>=t.fetchArraySize)return this._processRows(t.fetchArraySize);{t.fetchArraySize=t.fetchArraySize-(this.statement.bufferRowCount-this.statement.bufferRowIndex);let n=this.statement.bufferRowCount;if(this.statement.moreRowsToFetch&&t.fetchArraySize>0&&await this._fetchMoreRows(t),t.fetchArraySize=e||this.options.fetchArraySize,n===this.statement.bufferRowCount){let i=this.statement.bufferRowCount-this.statement.bufferRowIndex;return this.statement.bufferRowCount=0,i>0?this._processRows(i):[]}}let s=this.statement.bufferRowCount-this.statement.bufferRowIndex;return this._processRows(s)}};_(ic,"ThinResultSetImpl");var nc=ic;CA.exports=nc});var LA=m((eY,yA)=>{"use strict";var{Buffer:OA}=require("buffer"),b=Ue(),gA=W(),_c=class _c{constructor(e){this.protocolVersion=e.sAtts.version,this.ttcFieldVersion=b.TNS_CCAP_FIELD_VERSION_MAX,this.supports12cLogon=!0,this.supportsOob=!1,this.nCharsetId=b.TNS_CHARSET_UTF16,this.compileCaps=OA.alloc(b.TNS_CCAP_MAX),this.runtimeCaps=OA.alloc(b.TNS_RCAP_MAX),this.initCompileCaps(e),this.initRuntimeCaps(),this.maxStringSize=0}adjustForServerCompileCaps(e,t){e[b.TNS_CCAP_FIELD_VERSION]<this.ttcFieldVersion&&(this.ttcFieldVersion=e[b.TNS_CCAP_FIELD_VERSION],this.compileCaps[b.TNS_CCAP_FIELD_VERSION]=this.ttcFieldVersion),this.ttcFieldVersion<b.TNS_CCAP_FIELD_VERSION_23_4&&t.endOfRequestSupport&&(this.compileCaps[b.TNS_CCAP_TTC4]^=b.TNS_CCAP_END_OF_REQUEST,t.endOfRequestSupport=!1)}adjustForServerRuntimeCaps(e){e[b.TNS_RCAP_TTC]&b.TNS_RCAP_TTC_32K?this.maxStringSize=32767:this.maxStringSize=4e3}initCompileCaps(e){this.compileCaps[b.TNS_CCAP_SQL_VERSION]=b.TNS_CCAP_SQL_VERSION_MAX,this.compileCaps[b.TNS_CCAP_LOGON_TYPES]=b.TNS_CCAP_O5LOGON|b.TNS_CCAP_O5LOGON_NP|b.TNS_CCAP_O7LOGON|b.TNS_CCAP_O8LOGON_LONG_IDENTIFIER|b.TNS_CCAP_O9LOGON_LONG_PASSWORD,this.compileCaps[b.TNS_CCAP_FIELD_VERSION]=this.ttcFieldVersion,this.compileCaps[b.TNS_CCAP_SERVER_DEFINE_CONV]=1,this.compileCaps[b.TNS_CCAP_TTC1]=b.TNS_CCAP_FAST_BVEC|b.TNS_CCAP_END_OF_CALL_STATUS|b.TNS_CCAP_IND_RCD,this.compileCaps[b.TNS_CCAP_OCI1]=b.TNS_CCAP_FAST_SESSION_PROPAGATE|b.TNS_CCAP_APP_CTX_PIGGYBACK,this.compileCaps[b.TNS_CCAP_TDS_VERSION]=b.TNS_CCAP_TDS_VERSION_MAX,this.compileCaps[b.TNS_CCAP_RPC_VERSION]=b.TNS_CCAP_RPC_VERSION_MAX,this.compileCaps[b.TNS_CCAP_RPC_SIG]=b.TNS_CCAP_RPC_SIG_VALUE,this.compileCaps[b.TNS_CCAP_DBF_VERSION]=b.TNS_CCAP_DBF_VERSION_MAX,this.compileCaps[b.TNS_CCAP_LOB]=b.TNS_CCAP_LOB_UB8_SIZE|b.TNS_CCAP_LOB_ENCS|b.TNS_CCAP_LOB_PREFETCH|b.TNS_CCAP_LOB_TEMP_SIZE|b.TNS_CCAP_LOB_12C|b.TNS_CCAP_LOB_PREFETCH_DATA,this.compileCaps[b.TNS_CCAP_UB2_DTY]=1,this.compileCaps[b.TNS_CCAP_LOB2]=b.TNS_CCAP_LOB2_QUASI|b.TNS_CCAP_LOB2_2GB_PREFETCH,this.compileCaps[b.TNS_CCAP_TTC3]=b.TNS_CCAP_IMPLICIT_RESULTS|b.TNS_CCAP_BIG_CHUNK_CLR|b.TNS_CCAP_KEEP_OUT_ORDER,this.compileCaps[b.TNS_CCAP_TTC2]=b.TNS_CCAP_ZLNP,this.compileCaps[b.TNS_CCAP_OCI2]=b.TNS_CCAP_DRCP,this.compileCaps[b.TNS_CCAP_CLIENT_FN]=b.TNS_CCAP_CLIENT_FN_MAX,this.compileCaps[b.TNS_CCAP_TTC4]=b.TNS_CCAP_INBAND_NOTIFICATION,e.endOfRequestSupport&&(this.compileCaps[b.TNS_CCAP_TTC4]|=b.TNS_CCAP_END_OF_REQUEST),this.compileCaps[b.TNS_CCAP_CTB_FEATURE_BACKPORT]=b.TNS_CCAP_CTB_IMPLICIT_POOL,this.compileCaps[b.TNS_CCAP_TTC5]=b.TNS_CCAP_VECTOR_SUPPORT,this.compileCaps[b.TNS_CCAP_VECTOR_FEATURES]=b.TNS_CCAP_VECTOR_FEATURE_BINARY}initRuntimeCaps(){this.runtimeCaps[b.TNS_RCAP_COMPAT]=b.TNS_RCAP_COMPAT_81,this.runtimeCaps[b.TNS_RCAP_TTC]=b.TNS_RCAP_TTC_ZERO_COPY|b.TNS_RCAP_TTC_32K}checkNCharsetId(){this.nCharsetId!==b.TNS_CHARSET_UTF16&&gA.throwErr(gA.ERR_NCHAR_CS_NOT_SUPPORTED,this.nCharsetId)}};_(_c,"Capabilities");var ac=_c;yA.exports=ac});var FA=m((sY,VA)=>{"use strict";var{BaseBuffer:UA}=ar(),{Buffer:es}=require("buffer"),rt=Ue(),YA=vn(),wA=Hr(),MA=wn(),ci=W(),pr=es.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/","utf8"),BD=2048,UD=8,BA=11,Ec=class Ec{constructor(e){this.allocLen=e;let t=e%rt.CHUNKED_BYTES_CHUNK_SIZE;t>0&&(this.allocLen+=rt.CHUNKED_BYTES_CHUNK_SIZE-t),this.buf=es.allocUnsafe(this.allocLen),this.actualLen=0}};_(Ec,"BytesChunk");var Ti=Ec,uc=class uc{constructor(){this.chunks=[]}endChunkedRead(){if(this.chunks.length>1){let t=0;for(let i of this.chunks)t+=i.actualLen;let s=0,n=new Ti(t);for(let i of this.chunks)i.buf.copy(n.buf,s,0,i.actualLen),s+=i.actualLen;n.actualLen=t,this.chunks=[n]}let e=this.chunks[0];return e.buf.subarray(0,e.actualLen)}getBuf(e){let t;this.chunks.length>0&&(t=this.chunks[this.chunks.length-1],t.allocLen-t.actualLen<e&&(t=void 0)),t||(t=new Ti(e),this.chunks.push(t));let s=t.buf.subarray(t.actualLen,t.actualLen+e);return t.actualLen+=e,s}startChunkedRead(){this.chunks.length>0&&(this.chunks=this.chunks.splice(0,1),this.chunks[0].actualLen=0)}};_(uc,"ChunkedBytesBuffer");var cc=uc,hc=class hc extends UA{constructor(e,t){super(),this.nsi=e,this.caps=t,this.chunkedBytesBuf=new cc}_readBytesWithLength(e){if(e!==rt.TNS_LONG_LENGTH_INDICATOR)return this.readBytes(e);for(this.chunkedBytesBuf.startChunkedRead();;){let t=this.readUB4();if(t===0)break;this.readBytes(t,!0)}return this.chunkedBytesBuf.endChunkedRead()}skipBytes(e){this.pos===this.size&&this.receivePacket();let t=this.numBytesLeft();if(e<=t){this.pos+=e;return}for(e-=t;e>0;){this.receivePacket();let s=Math.min(e,this.size-this.pos);this.pos+=s,e-=s}}readBytes(e,t=!1){this.pos===this.size&&this.receivePacket();let s=this.numBytesLeft();if(e<=s){let a;return t?(a=this.chunkedBytesBuf.getBuf(e),this.buf.copy(a,0,this.pos,this.pos+e)):a=this.buf.subarray(this.pos,this.pos+e),this.pos+=e,a}let n;t?n=this.chunkedBytesBuf.getBuf(e):n=es.allocUnsafe(e);let i=0;for(this.buf.copy(n,i,this.pos,this.pos+s),i+=s,e-=s;e>0;){this.receivePacket();let a=Math.min(e,this.size-this.pos);this.buf.copy(n,i,this.pos,this.pos+a),this.pos+=a,i+=a,e-=a}return n}receivePacket(){if(this.savedPacketPos===this.savedPackets.length){let e=this.nsi.syncRecvPacket();if(!e||this.nsi.isBreak)throw new wA.OutOfPacketsError;this.savedPackets.push(e)}this.startPacket(this.savedPackets[this.savedPacketPos++])}restorePoint(){this.savedPacketPos=0,this.startPacket(this.savedPackets[this.savedPacketPos++]),this.pos=this.savedPos}savePoint(){this.savedPackets?this.savedPackets=this.savedPackets.splice(this.savedPacketPos-1):this.savedPackets=[this.packet],this.savedPacketPos=1,this.savedPos=this.pos}startPacket(e){this.packet=e,this.buf=e.buf,this.pos=10,this.size=e.buf.length,this.packetNum=e.num}async waitForPackets(e=!1){let t=await this.nsi.recvPacket();if(this.savedPackets?this.savedPackets.push(t):(this.savedPackets=[t],this.savedPacketPos=0),e&&this.nsi.endOfRequestSupport)for(;t.type===rt.TNS_PACKET_TYPE_DATA&&!(t.buf.readUInt16BE(8)&rt.TNS_DATA_FLAGS_END_OF_REQUEST||t.buf.length===BA&&t.buf[BA-1]===rt.TNS_MSG_TYPE_END_OF_REQUEST);)t=await this.nsi.recvPacket(),this.savedPackets.push(t);this.startPacket(this.savedPackets[this.savedPacketPos++])}readOson(){if(this.readUB4()===0)return null;this.skipUB8(),this.skipUB4();let t=new YA.OsonDecoder(this.readBytesWithLength());return this.skipBytesChunked(),t.decode()}readURowID(){let e=0,t=1,s=this.readBytesWithLength();if(s===null)return null;s=this.readBytesWithLength();let n=s.length;if(s&&s[0]===1){let T=s.readUInt32BE(1),l=s.readUInt16BE(5),E=s.readUInt32BE(7),u=s.readUInt16BE(11);return wA.encodeRowID({rba:T,partitionID:l,blockNum:E,slotNum:u})}let i=Math.floor(n/3)*4,a=n%3;a===1?i+=1:a===2&&(i+=3);let c=es.allocUnsafe(i);for(n-=1,c[0]=42,e+=1;n>0;){let T=s[t]>>2;if(c[e]=pr[T],e+=1,T=(s[t]&3)<<4,n==1){c[e]=pr[T];break}if(t+=1,T|=(s[t]&240)>>4,c[e]=pr[T],e+=1,T=(s[t]&15)<<2,n==2){c[e]=pr[T];break}t+=1,T|=(s[t]&192)>>6,c[e]=pr[T],e+=1,T=s[t]&63,c[e]=pr[T],e+=1,t+=1,n-=3}return c.toString("utf-8")}readRowID(){let e=this.readUB4(),t=this.readUB2();this.skipUB1();let s=this.readUB4(),n=this.readUB2();return{rba:e,partitionID:t,blockNum:s,slotNum:n}}readVector(){if(this.readUB4()===0)return null;this.skipUB8(),this.skipUB4();let t=new MA.VectorDecoder(this.readBytesWithLength());return this.skipBytesChunked(),t.decode()}skipBytesChunked(){let e=this.readUInt8();if(!(e===0||e===rt.TNS_NULL_LENGTH_INDICATOR))if(e!==rt.TNS_LONG_LENGTH_INDICATOR)this.skipBytes(e);else for(;;){let t=this.readUB4();if(t===0)break;this.skipBytes(t)}}readNullTerminatedBytes(e=50){let t=0,s=es.allocUnsafe(e);for(;t<e&&(s[t]=this.readUInt8(),s[t]!==0);)t=t+1;if(t===e){let n=`Byte Arrray Exceeded MaxSize ${e}`;ci.throwErr(ci.ERR_INTERNAL,n)}return s.subarray(0,t+1)}};_(hc,"ReadPacket");var Tc=hc,Nc=class Nc extends UA{constructor(e,t,s){super(e.sAtts.sdu),this.size=this.maxSize,this.isLargeSDU=e.sAtts.version>=rt.TNS_VERSION_MIN_LARGE_SDU,this.protocol=s,this.packetType=rt.TNS_PACKET_TYPE_DATA,this.caps=t,this.nsi=e}_grow(){this._sendPacket()}_sendPacket(e=!1){let t=this.pos;this.pos=0,this.isLargeSDU?this.writeUInt32BE(t):(this.writeUInt16BE(t),this.writeUInt16BE(0)),this.writeUInt8(this.packetType),this.writeUInt8(0),this.writeUInt16BE(0);let s=this.buf.subarray(0,t);e?this.buf.writeUInt16BE(BD,UD):(s=es.from(s),this.startPacket()),this.nsi.ntAdapter||ci.throwErr(ci.ERR_INVALID_CONNECTION),this.nsi.ntAdapter.send(s)}startPacket(e=0){this.pos=rt.PACKET_HEADER_SIZE,this.packetType===rt.TNS_PACKET_TYPE_DATA&&this.writeUInt16BE(e)}startRequest(e,t=0){this.packetType=e,this.startPacket(t)}endRequest(){this.pos>rt.PACKET_HEADER_SIZE&&this._sendPacket(!0)}writeKeyValue(e,t,s=0){let n=es.byteLength(e),i=es.byteLength(t);this.writeUB4(n),this.writeBytesWithLength(es.from(e)),this.writeUB4(i),i>0&&this.writeBytesWithLength(es.from(t)),this.writeUB4(s)}writeOson(e,t){let n=new YA.OsonEncoder().encode(e,t);this.writeQLocator(n.length),this.writeBytesWithLength(n)}writeSeqNum(){this.writeUInt8(this.protocol.sequenceId),this.protocol.sequenceId=(this.protocol.sequenceId+1)%256}writeVector(e){let s=new MA.VectorEncoder().encode(e);this.writeQLocator(s.length),this.writeBytesWithLength(s)}writeQLocator(e){this.writeUB4(40),this.writeUInt8(40),this.writeUInt16BE(38),this.writeUInt16BE(rt.TNS_LOB_QLOCATOR_VERSION),this.writeUInt8(rt.TNS_LOB_LOC_FLAGS_VALUE_BASED|rt.TNS_LOB_LOC_FLAGS_BLOB|rt.TNS_LOB_LOC_FLAGS_ABSTRACT),this.writeUInt8(rt.TNS_LOB_LOC_FLAGS_INIT),this.writeUInt16BE(0),this.writeUInt16BE(1),this.writeUInt64BE(e),this.writeUInt16BE(0),this.writeUInt16BE(0),this.writeUInt16BE(0),this.writeUInt64BE(0),this.writeUInt64BE(0)}};_(Nc,"WritePacket");var lc=Nc;VA.exports={ReadPacket:Tc,WritePacket:lc}});var bA=m((nY,xA)=>{"use strict";var fr=Ue(),YD=LA(),{WritePacket:MD,ReadPacket:VD}=FA(),Ks=W(),FD=Hr(),Ac=class Ac{constructor(e){this._breakInProgress=!1,this.txnInProgress=!1,this.connInProgress=!0,this.nsi=e.nscon,this.sequenceId=1,this.caps=new YD(e.nscon),this.writeBuf=new MD(e.nscon,this.caps,this),this.readBuf=new VD(e.nscon,this.caps),this.callTimeout=0}async _decodeMessage(e){for(e.preProcess(),await this.readBuf.waitForPackets(!0);;){this.nsi.isBreak&&(await this.resetMessage(),delete this.readBuf.savedPackets,await this.readBuf.waitForPackets());try{e.decode(this.readBuf);break}catch(t){if(t instanceof FD.OutOfPacketsError){this.nsi.isBreak||(await this.readBuf.waitForPackets(),this.readBuf.restorePoint());continue}throw t}}await e.postProcess()}async _encodeMessage(e){let t=this.nsi.ntAdapter;for(this.writeBuf.startRequest(fr.TNS_PACKET_TYPE_DATA);e.encode(this.writeBuf);)await t.pauseWrite();this.writeBuf.endRequest()}async _recoverFromError(e,t){try{this.breakMessage(),this._breakInProgress=!1,await this.resetMessage(),await this.readBuf.waitForPackets(),t.decode(this.readBuf)}catch(s){this.nsi.disconnect();let n=Ks.getErr(Ks.ERR_CONNECTION_CLOSED);throw e.message=n.message+`
Error recovery failed: `+s.message+`
Original error: `+e.message,e}}async _processMessage(e){let t,s=!1;try{this.callTimeout>0&&(t=setTimeout(()=>{s=!0,this.breakMessage()},this.callTimeout)),await this._encodeMessage(e),e.messageType!==fr.TNS_MSG_TYPE_ONEWAY_FN&&await this._decodeMessage(e)}catch(n){throw!this.connInProgress&&n.code!==Ks.ERR_CONNECTION_CLOSED_CODE&&await this._recoverFromError(n,e),n}finally{clearTimeout(t)}if(e.flushOutBinds&&await this.flushOutBindMessage(e),this.txnInProgress=!!(e.callStatus&fr.TNS_EOCS_FLAGS_TXN_IN_PROGRESS),e.callStatus&fr.TNS_EOCS_FLAGS_SESS_RELEASE&&e.connection.statementCache.clearCursors(),e.errorOccurred){if(s&&Ks.throwErr(Ks.ERR_CALL_TIMEOUT_EXCEEDED,this.callTimeout),e.retry)return e.errorOccurred=!1,await this._processMessage(e);let n=new Error(e.errorInfo.message);throw n.offset=e.errorInfo.pos,n.errorNum=e.errorInfo.num,n=Ks.transformErr(n),n.code===Ks.ERR_CONNECTION_CLOSED_CODE&&this.nsi.disconnect(),n}}async flushOutBindMessage(e){this.writeBuf.startRequest(fr.TNS_PACKET_TYPE_DATA),this.writeBuf.writeUInt8(fr.TNS_MSG_TYPE_FLUSH_OUT_BINDS),this.writeBuf.endRequest(),await this._decodeMessage(e)}breakMessage(){this._breakInProgress=!0,this.nsi.sendBreak()}async resetMessage(){await this.nsi.reset()}};_(Ac,"Protocol");var Sc=Ac;xA.exports=Sc});var mr=m((oY,kA)=>{kA.exports={NSPTCN:1,NSPTAC:2,NSPTAK:3,NSPTRF:4,NSPTRD:5,NSPTDA:6,NSPTNL:7,NSPTAB:9,NSPTRS:11,NSPTMK:12,NSPTAT:13,NSPTCNL:14,NSPTDD:15,NSPTHI:19,NSPHDLEN:0,NSPHDPSM:2,NSPHDTYP:4,NSPHDFLGS:5,NSPHDHSM:6,NSPSIZHD:8,NSPFSID:1,NSPFRDS:2,NSPFRDR:4,NSPFLSD:32,NO_HEADER_FLAGS:0,NSPFSRN:8,NSPCNVSN:8,NSPCNLOV:10,NSPCNOPT:12,NSPCNSDU:14,NSPCNTDU:16,NSPCNNTC:18,NSPCNTNA:20,NSPCNONE:22,NSPCNLEN:24,NSPCNOFF:26,NSPCNMXC:28,NSPCNFL0:32,NSPCNFL1:33,NSPCNTMO:50,NSPCNTCK:52,NSPCNADL:54,NSPCNAOF:56,NSPCNLSD:58,NSPCNLTD:62,NSPCNCFL:66,NSPCNCFL2:70,NSPCNDAT:74,NSPMXCDATA:230,NSINAWANTED:1,NSINAINTCHG:2,NSINADISABLEDFORCONNECTION:4,NSINANOSERVICES:8,NSINAREQUIRED:16,NSINAAUTHWANTED:32,NSISUPSECRENEG:128,NSGDONTCARE:1,NSGHDX:2,NSGFDX:4,NSGHDRCHKSUM:8,NSGPAKCHKSUM:16,NSGBROKEN:32,NSGUSEVIO:64,NSGOSAUTHOK:128,NSGSENDATTN:512,NSGRECVATTN:1024,NSGNOATTNPR:2048,NSGRAW:4096,TNS_VERSION_DESIRED:319,TNS_VERSION_MINIMUM:300,TNS_VERSION_MIN_DATA_FLAGS:318,TNS_VERSION_MIN_END_OF_RESPONSE:319,TNS_UUID_OFFSET:45,NSPACVSN:8,NSPACOPT:10,NSPACSDU:12,NSPACTDU:14,NSPACONE:16,NSPACLEN:18,NSPACOFF:20,NSPACFL0:22,NSPACFL1:23,NSPACTMO:24,NSPACTCK:26,NSPACADL:28,NSPACAOF:30,NSPACLSD:32,NSPACLTD:36,NSPACCFL:40,NSPACFL2:41,NSPACV310DAT:32,NSPACV315DAT:41,NSPRFURS:8,NSPRFSRS:9,NSPRFLEN:10,NSPRFDAT:12,NSPACCFON:128,NSPACCFAT:64,NSPACCFNT:2,NSPACOOB:1,NSGPCHKSCMD:16777216,TNS_ACCEPT_FLAG_HAS_END_OF_REQUEST:33554432,TNS_ACCEPT_FLAG_FAST_AUTH:268435456,NSPRDLEN:8,NSPRDDAT:10,NSPDAFLG:8,NSPDADAT:10,NSPDAFEOF:64,NSPMKTYP:8,NSPMKODT:9,NSPMKDAT:10,NSPMKTD0:0,NSPMKTD1:1,NSPMKTAT:2,NIQBMARK:1,NIQRMARK:2,NIQIMARK:3,NSPCTLCMD:8,NSPCTLDAT:10,NSPCTL_SERR:8,NSPCTL_CLRATTN:9,NSPDFSDULN:8192,NSPABSSDULN:2097152,NSPMXSDULN:65535,NSPMNSDULN:512,NSPDFTDULN:2097152,NSPMXTDULN:2097152,NSPMNTDULN:255,NSFIMM:64,DISABLE_OOB_STR:"DISABLE_OOB",EXPIRE_TIME:"EXPIRE_TIME",PEM_WALLET_FILE_NAME:"ewallet.pem",NT_MOREDATA:1,NS_MOREDATA:2,SVCNAME:3,SERVERTYPE:4,REMOTEADDR:5,HEALTHCHECK:6,CONNCLASS:7,PURITY:8,SID:9,NSNOBLOCK:1}});var vA=m((aY,GA)=>{"use strict";var li=require("buffer").Buffer,F=mr(),ys=W(),xD=230,qA=74;function bD(r,e,t=0){this.connectData=r,this.connectDataLen=r.length,this.overflow=!1;let s;this.connectDataLen<=xD?s=qA+this.connectDataLen:(s=qA,this.overflow=!0),this.buf=li.allocUnsafe(s).fill(0),this.buf.writeUInt16BE(s,F.NSPHDLEN),this.buf.writeUInt8(t,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTCN,F.NSPHDTYP),this.buf.writeUInt16BE(F.TNS_VERSION_DESIRED,F.NSPCNVSN),this.buf.writeUInt16BE(F.TNS_VERSION_MINIMUM,F.NSPCNLOV);let n=F.NSGDONTCARE;this.buf.writeUInt16BE(n,F.NSPCNOPT),e.sdu>F.NSPMXSDULN?this.buf.writeUInt16BE(F.NSPMXSDULN,F.NSPCNSDU):this.buf.writeUInt16BE(e.sdu,F.NSPCNSDU),e.tdu>F.NSPMXSDULN?this.buf.writeUInt16BE(F.NSPMXSDULN,F.NSPCNTDU):this.buf.writeUInt16BE(e.tdu,F.NSPCNTDU),this.buf.writeUInt16BE(e.ntCha,F.NSPCNNTC),this.buf.writeUInt16BE(1,F.NSPCNONE),this.buf.writeUInt16BE(this.connectDataLen,F.NSPCNLEN),this.buf.writeUInt16BE(F.NSPCNDAT,F.NSPCNOFF),this.buf.writeUInt8(F.NSISUPSECRENEG|F.NSINADISABLEDFORCONNECTION,F.NSPCNFL0),this.buf.writeUInt8(F.NSISUPSECRENEG|F.NSINADISABLEDFORCONNECTION,F.NSPCNFL1),this.buf.writeUInt16BE(0,F.NSPCNTMO),this.buf.writeUInt16BE(0,F.NSPCNTCK),this.buf.writeUInt16BE(0,F.NSPCNADL),this.buf.writeUInt16BE(0,F.NSPCNAOF),this.buf.writeUInt32BE(e.sdu,F.NSPCNLSD),this.buf.writeUInt32BE(e.tdu,F.NSPCNLTD),this.buf.writeUInt32BE(0,F.NSPCNCFL),this.buf.writeUInt32BE(0,F.NSPCNCFL2),!this.overflow&&this.connectDataLen&&this.buf.write(r.toString("ascii"),F.NSPCNDAT,this.connectDataLen,"ascii")}_(bD,"ConnectPacket");function kD(r){this.dataPtr=0,this.dataLen=0,this.offset=0,this.len=0,this.bufLen=0,this.createPacket=function(e){this.dataPtr=F.NSPDADAT,this.dataLen=F.NSPDADAT,this.buf=li.allocUnsafe(e).fill(0),this.buf.writeUInt8(0,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTDA,F.NSPHDTYP),this.bufLen=e},this.fillBuf=function(e,t,s,n=0){let i;return this.buf||this.createPacket(s+F.NSPDADAT),s>this.bufLen-this.dataLen?i=this.bufLen-this.dataLen:i=s,i&&e.copy(this.buf,this.dataLen,t,t+i),this.dataLen+=i,this.prepare2Send(n),i},this.prepare2Send=function(e=0){r?this.buf.writeUInt32BE(this.dataLen,F.NSPHDLEN):this.buf.writeUInt16BE(this.dataLen,F.NSPHDLEN),this.buf.writeUInt16BE(e,F.NSPDAFLG),this.dataBuf=this.buf.subarray(0,this.dataLen)},this.fromPacket=function(e){this.buf=e.buf,this.dataLen=e.buf.length,this.dataPtr=F.NSPDADAT,this.offset=this.dataPtr,this.len=this.dataLen,e.dataOffset=this.dataPtr}}_(kD,"DataPacket");function qD(r,e){this.buf=r.buf,this.len=r.buf.length,e.version=r.buf.readUInt16BE(F.NSPACVSN),e.options=r.buf.readUInt16BE(F.NSPACOPT),e.sdu=r.buf.readUInt16BE(F.NSPACSDU),e.tdu=r.buf.readUInt16BE(F.NSPACTDU),e.version>=315&&(e.sdu=r.buf.readUInt32BE(F.NSPACLSD),e.tdu=r.buf.readUInt32BE(F.NSPACLTD),e.largeSDU=!0),this.flag0=r.buf.readUInt8(F.NSPACFL0),this.flag1=r.buf.readUInt8(F.NSPACFL1),e.version>=F.TNS_VERSION_MIN_DATA_FLAGS&&(r.flags=r.buf.readUInt32BE(F.NSPACFL2))}_(qD,"AcceptPacket");function GD(r){this.buf=r.buf,this.len=r.buf.length,this.userReason=r.buf.readUInt8(F.NSPRFURS),this.systemReason=r.buf.readUInt8(F.NSPRFURS),this.dataLen=r.buf.readUInt16BE(F.NSPRFLEN),this.dataOff=F.NSPRFDAT,this.len>this.dataOff?(this.dataBuf=this.buf.toString("ascii",this.dataOff,this.len),this.overflow=!1):this.overflow=!0}_(GD,"RefusePacket");function vD(r){this.buf=r.buf,this.len=r.buf.length,this.flags=r.flags,this.dataLen=r.buf.readUInt16BE(F.NSPRDLEN),this.dataOff=F.NSPRDDAT,this.len>this.dataOff?(this.dataBuf=this.buf.subarray(this.dataOff,this.len),this.overflow=!1):this.overflow=!0}_(vD,"RedirectPacket");function HD(r){this.len=F.NSPMKDAT+1,this.buf=li.allocUnsafe(F.NSPMKDAT+1).fill(0),r?this.buf.writeUInt32BE(this.len,F.NSPHDLEN):this.buf.writeUInt16BE(this.len,F.NSPHDLEN),this.buf.writeUInt8(0,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTMK,F.NSPHDTYP),this.prepare=function(e,t){this.buf.writeUInt8(e,F.NSPMKTYP),this.buf.writeUInt8(t,F.NSPMKDAT)},this.fromPacket=function(e,t){switch(this.type=e.buf.readUInt8(F.NSPMKTYP),this.type){case F.NSPMKTD0:t.isBreak=!0;break;case F.NSPMKTD1:this.data=e.buf.readUInt8(F.NSPMKDAT),t.isBreak=!0,this.data==F.NIQRMARK&&(t.isReset=!0,t.isBreak=!0);break;default:ys.throwErr(ys.ERR_INVALID_PACKET)}}}_(HD,"MarkerPacket");function KD(){this.clear=function(){this.errno=0,this.notif=null,this.notifLen=0,this.cmd=0},this.fromPacket=function(r){let n,i,a;switch(this.cmd=r.buf.readUInt16BE(F.NSPCTLCMD),this.cmd){case F.NSPCTL_SERR:n=r.buf.readUInt32BE(F.NSPCTLDAT),i=r.buf.readUInt32BE(F.NSPCTLDAT+4),a=r.buf.readUInt32BE(F.NSPCTLDAT+8),i==12572?this.errno=i:i==12573?(this.errno=i,this.notifLen=a,this.notif=li.allocUnsafe(a+1).fill(0),this.buf.copy(this.notif,0,F.NSPCTLDAT+12,F.NSPCTLDAT+12+a)):(this.errno=i,n==22?ys.throwErr(ys.ERR_CONNECTION_INBAND,"ORA-"+i):ys.throwErr(ys.ERR_CONNECTION_INBAND,"TNS-"+i));break;default:ys.throwErr(ys.ERR_INVALID_PACKET)}}}_(KD,"ControlPacket");GA.exports={ConnectPacket:bD,DataPacket:kD,AcceptPacket:qD,RefusePacket:GD,RedirectPacket:vD,MarkerPacket:HD,ControlPacket:KD}});var Pr=m((cY,QA)=>{"use strict";var me=W(),HA=0,zr=1,dc=2,pc=3,Ei=4,gc=class gc{constructor(e){this.name=e,this.listType=pc,this.rhsType=HA}set setAtom(e){this._containsComment(e)&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.rhsType=zr,this.list=null,this.atom=e}_containsComment(e){for(let t=0;t<e.length;t++)if(e.charAt(t)=="#")if(t!=0){if(e.charAt(t-1)=="\\")continue;return!0}else return!0;return!1}getListSize(){return this.list==null?0:this.list.length}getListElement(e){return this.list==null?null:this.list[e]}addListElement(e){this.list==null&&(this.rhsType=dc,this.list=new Array,this.atom=null),this.list.push(e),e.parent=this}removeListElement(e){this.list!=null&&(this.list.splice(e,1),this.getListSize==0&&(this.list=null,this.rhsType=HA))}_space(e){var t="";for(let s=0;s<e;s++)t+=" ";return t}valueToString(){let e="";if(this.rhsType==zr)e=e+this.atom;else if(this.rhsType==dc){if(this.listType==pc)for(let t=0;t<this.getListSize();t++)e=e+this.getListElement(t).toString();else if(this.listType==Ei)for(let t=0;t<this.getListSize();t++){let s=this.getListElement(t);e=e+s.name,t!=this.getListSize()-1&&(e=e+", ")}}return e}toString(){let e="("+this.name+"=";if(this.rhsType==zr)e=e+this.atom;else if(this.rhsType==dc){if(this.listType==pc)for(let t=0;t<this.getListSize();t++)e=e+this.getListElement(t).toString();else if(this.listType==Ei){e=e+" (";for(let t=0;t<this.getListSize();t++){let s=this.getListElement(t);e=e+s.name,t!=this.getListSize()-1&&(e=e+", ")}e=e+")"}}return e=e+")",e}};_(gc,"NVPair");var ui=gc,WD=0,hi=1,Ic=2,Ls=3,WA=4,Ni=8,XD=9,fc="(",mc=")",Pc=",",Rc="=",zD="\\",KA='"',$D="'",QD="%",jD=" ",JD="	",ZD=`
`,eC="\r",yc=class yc{constructor(){this.tkType=null,this.tkValue=null,this.numTokens=0,this.tkPos=0}_isWhiteSpace(e){return e==jD||e==JD||e==ZD||e==eC}_trimWhiteSpace(e){let t=e.length,s=0,n=t;for(;s<t&&this._isWhiteSpace(e.charAt(s));)s++;for(;s<n&&this._isWhiteSpace(e.charAt(n-1));)n--;return e.substring(s,n)}parseTokens(e){this.numTokens=0,this.tkPos=0,this.tkType=new Array,this.tkValue=new Array;let t=e.length,s=!1,n=new Array;n=Array.from(e);let i=0;for(;i<t;){for(;i<t&&this._isWhiteSpace(n[i]);)i++;if(i<t)switch(n[i]){case fc:s=!1,this._addToken(hi,fc),i++;break;case Rc:s=!0,this._addToken(WA,Rc),i++;break;case mc:s=!1,this._addToken(Ic,mc),i++;break;case Pc:s=!1,this._addToken(Ls,Pc),i++;break;default:{let a=i,c=-1,T=!1,l=KA;for((n[i]==$D||n[i]==KA)&&(T=!0,l=n[i],i++,a=i);i<t;){if(n[i]==zD){i+=2;continue}if(T){if(n[i]==l){i++,c=i-1;break}}else if(n[i]==fc||n[i]==mc||n[i]==Pc&&!s||n[i]==Rc&&!s){c=i;break}i++}c==-1&&(c=i),this._addToken(Ni,e.substring(a,c).trim());break}}}return this._addToken(XD,QD),!0}getToken(){if(this.tkType==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens)return Number(this.tkType[this.tkPos]);me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX)}popToken(){let e=WD;return this.tkType==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=Number(this.tkType[this.tkPos++]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}getLiteral(){let e=null;return this.tkValue==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=String(this.tkValue[this.tkPos]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}popLiteral(){let e=null;return this.tkValue==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=String(this.tkValue[this.tkPos++]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}eatToken(){this.tkPos<this.numTokens&&this.tkPos++}toString(){if(this.tkType==null)return"*NO TOKENS*";let e="Tokens";for(let t=0;t<this.numTokens;t++)e=e+" : "+this.tkValue[t];return e}_addToken(e,t){this.tkType.push(Number(e)),this.tkValue.push(String(t)),this.numTokens++}};_(yc,"NVTokens");var Dc=yc;function tC(r){let e=new Dc;return e.parseTokens(r),sC(e)}_(tC,"createNVPair");function sC(r){let e=r.getToken();r.eatToken(),e!=hi&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=Oc(r),s=new ui(t);if((e=r.getToken())==Ls){for(;e==Ni||e==Ls;)t+=r.popLiteral(),e=r.getToken();return s.name=t,Cc(s,r)}return Cc(s,r)}_(sC,"readTopLevelNVPair");function rC(r){let e=r.getToken();r.eatToken(),e==hi||e==Ls||me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=Oc(r),s=new ui(t);return Cc(s,r)}_(rC,"readNVPair");function Cc(r,e){let t=e.getToken();switch(t){case WA:if(e.eatToken(),t=e.getToken(),t==Ni){let s=Oc(e);r.setAtom=s}else XA(e,r);break;case Ls:case Ic:r.setAtom=r.name;break;default:me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX)}return t=e.getToken(),t==Ic?e.eatToken():t!=Ls&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),r}_(Cc,"readRightHandSide");function Oc(r){return r.getToken()!=Ni&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),r.popLiteral()}_(Oc,"readNVLiteral");function XA(r,e){let t=r.getToken();if(!(t==hi||t==Ls))return;let s=rC(r);e.addListElement(s),(t==Ls||s.name==s.atom)&&e.getListType!=Ei&&(e.setListType=Ei),XA(r,e)}_(XA,"readNVList");function zA(r,e){if(!r)return null;if(e.toUpperCase()==r.name.toUpperCase())return r;if(r.getRHSType==zr)return null;for(let t=0;t<r.getListSize();t++){let s=zA(r.getListElement(t),e);if(s!==null)return s}return null}_(zA,"findNVPairRecurse");function $A(r,e){if(!r||r.getRHSType==zr)return null;for(let t=0;t<r.getListSize();t++){let s=r.getListElement(t);if(e.toUpperCase()==s.name.toUpperCase())return s}return null}_($A,"findNVPair");function nC(r,e){if(!r||e[0].toUpperCase()!=r.name.toUpperCase())return null;let t=r,s=e.length;for(let n=1;n<s;n++)if(t=$A(t,e[n]),!t)return null;return t.atom==null?t.list==null?null:t.list.toString():t.atom.toString()}_(nC,"findValue");QA.exports={findNVPairRecurse:zA,createNVPair:tC,findNVPair:$A,findValue:nC}});var ZA=m((lY,JA)=>{"use strict";var{Buffer:iC}=require("buffer"),oC=require("net"),jA=require("process"),$r=require("tls"),aC=require("http"),_C=require("timers"),Lc=mr(),Fe=W(),{findValue:cC}=Pr(),TC=8,lC=1521,EC=80,uC=4878,hC=1,Bc=class Bc{constructor(e){this.atts=e,this.cha=uC,this.connected=!1,this.err=!1,this.needsDrain=!1,this.numPacketsSinceLastWait=0,this.secure=!1,this.largeSDU=!1,this.streamNum=hC++,this.packetNum=1,this.doDNMatch=!0}dnMatch(e,t){if(this.atts.sslServerDNMatch&&this.doDNMatch){let s=_(n=>n.split(",").map(i=>i.split("=").map(a=>a.trim())).reduce((i,a)=>(i[a[0]]=a[1],i),{}),"toObject");if(this.atts.sslServerCertDN){let n=s(this.atts.sslServerCertDN);if(Object.keys(n).length==Object.keys(t.subject).length){for(let i in n)if(n[i]!=t.subject[i])return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else if($r.checkServerIdentity(this.hostName,t)&&(!this.originHost||$r.checkServerIdentity(this.originHost,t)))if(this.atts.sslAllowWeakDNMatch){if(cC(this.atts.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"])!=t.subject.CN)return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else{let n=this.hostName+" "+(this.originHost?"or "+this.originHost:"");return Fe.getErr(Fe.ERR_TLS_HOSTMATCH_FAILURE,n)}}}async tlsConnect(e,t){this.stream.removeAllListeners();let s,n={host:this.host,socket:t,rejectUnauthorized:!0,secureContext:e,enableTrace:!1,checkServerIdentity:this.dnMatch.bind(this)};await new Promise(i=>{this.stream=$r.connect(n,()=>{this.stream.authorized||(s="server certificate unauthorized"),i()}).on("error",a=>{s=a.message,i()})}),s&&Fe.throwErr(Fe.ERR_TLS_AUTH_FAILURE,this.host,this.port,this.atts.connectionId,s),this.connStream=t}async ntConnect(e){e.port||(e.port=lC);let t,s,n,i=e.httpsProxy||this.atts.httpsProxy,a=e.httpsProxyPort||this.atts.httpsProxyPort;await new Promise(c=>{i?(a||(a=EC),n=aC.request({host:i,port:a,method:"CONNECT",path:e.host+":"+e.port}),n.once("connect",(T,l)=>{T.statusCode==200?(this.connected=!0,this.stream=l):s=T.statusCode,c()}),n.once("error",T=>{s=T.message,c()}),n.end()):(this.stream=oC.connect(e.port,e.host,()=>{this.connected=!0,c()}),this.stream.once("error",T=>{t=T.message,c()}))}),n&&n.removeAllListeners(),this.connected||(s?Fe.throwErr(Fe.ERR_PROXY_CONNECTION_FAILURE,i,a,this.atts.connectionId,s):Fe.throwErr(Fe.ERR_CONNECTION_INCOMPLETE,this.host,this.port,this.atts.connectionId,t))}async connect(e){this.originHost=e.originHost,this.host=e.host,this.hostName=e.hostname,this.port=e.port;try{if(await this.ntConnect(e),(this.atts.expireTime||this.atts.enableDCD)&&(this.atts.expireTime?this.stream.setKeepAlive(!0,this.atts.expireTime):this.stream.setKeepAlive(!0)),this.atts.tcpNoDelay&&this.stream.setNoDelay(!0),e.protocol.toUpperCase()=="TCPS"){let t;this.secure=!0,this.atts.sslAllowWeakDNMatch&&(this.doDNMatch=!1);try{t=$r.createSecureContext({cert:this.atts.wallet,key:this.atts.wallet,passphrase:this.atts.walletPassword,ca:this.atts.wallet})}catch{Fe.throwErr(Fe.ERR_TLS_INIT_FAILURE)}await this.tlsConnect(t,this.stream)}}finally{this.stream&&this.setupEventHandlers()}}disconnect(e){this.connected&&!this.err&&(e==Lc.NSFIMM?this.stream.destroy():this.stream.end()),this.stream=null,this.connected=!1,this.drainWaiter=null,this.readWaiter=null}getPacketDump(e){let t=[];for(let s=0;s<e.length;s+=8){let n=s.toString().padStart(4,"0"),i=e.slice(s,s+8),a=[],c=[];for(let E of i)a.push(E.toString(16).toUpperCase().padStart(2,"0")),E>32&&E<127?c.push(String.fromCharCode(E)):c.push(".");for(;a.length<8;)a.push("  "),c.push(" ");let T=a.join(" "),l=c.join("");t.push(`${n} : ${T} |${l}|`)}return t.join(`
`)}printPacket(e,t){let s=new Date,n=`${s.getFullYear()}-${s.getMonth().toString().padStart(2,"0")}-${s.getDay().toString().padStart(2,"0")} ${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}:${s.getSeconds().toString().padStart(2,"0")}.${s.getMilliseconds().toString().padStart(3,"0")}`,i=this.getPacketDump(t);console.log(`${n} ${e}:
${i}
`)}checkErr(){if(!this.connected||this.err){let e;this.savedErr?e=Fe.getErr(Fe.ERR_CONNECTION_LOSTCONTACT,this.host,this.port,this.atts.connectionId,this.savedErr.message):e=Fe.getErr(Fe.ERR_CONNECTION_EOF,this.host,this.port,this.atts.connectionId);let t=Fe.getErr(Fe.ERR_CONNECTION_CLOSED);throw t.message=t.message+`
`+e.message,t}}send(e){this.checkErr(),jA.env.NODE_ORACLEDB_DEBUG_PACKETS&&this.printPacket(`Sending packet ${this.packetNum} on stream ${this.streamNum}`,e),this.stream.write(e,s=>{s&&(this.savedErr=s,this.err=!0,this._notifyWaiters())})||(this.needsDrain=!0),this.numPacketsSinceLastWait++,this.packetNum++}shouldPauseWrite(){return this.needsDrain||this.numPacketsSinceLastWait>=100}async pauseWrite(){this.checkErr(),this.needsDrain?(await new Promise(e=>{this.drainWaiter=e}),this.checkErr()):await new Promise(e=>_C.setImmediate(e)),this.numPacketsSinceLastWait=0}startRead(){let e;this.packets=[],this.stream.on("data",t=>{for(e?e=iC.concat([e,t]):e=t;e.length>=TC;){let s;if(this.largeSDU?s=e.readUInt32BE():s=e.readUInt16BE(),s>e.length)break;let n={buf:e.subarray(0,s),type:e[4],flags:e[5],num:this.packetNum++};if(this.packets.push(n),this.readWaiter&&(this.readWaiter(),this.readWaiter=null),jA.env.NODE_ORACLEDB_DEBUG_PACKETS&&this.printPacket(`Receiving packet ${n.num} on stream ${this.streamNum}`,n.buf),s===e.length){e=null;break}else e=e.subarray(s)}})}syncReceive(){return this.packets.shift()}async receive(){return this.packets.length===0&&(this.checkErr(),await new Promise(e=>{this.readWaiter=e,this.numPacketsSinceLastWait=0}),this.checkErr()),this.packets.shift()}async renegTLS(){try{this.checkErr(),this.doDNMatch=!0;let e=$r.createSecureContext({cert:this.atts.wallet,key:this.atts.wallet,passphrase:this.atts.walletPassword,ca:this.atts.wallet});await this.tlsConnect(e,this.connStream)}finally{this.setupEventHandlers()}}setupEventHandlers(){this.stream.removeAllListeners(),this.stream.on("error",e=>{this.savedErr=e,this.err=!0,this._notifyWaiters()}),this.stream.on("end",()=>{this.err=!0,this._notifyWaiters()}),this.stream.on("close",()=>{this.connected=!1,this._notifyWaiters()}),this.stream.on("drain",()=>{this.needsDrain=!1,this.drainWaiter&&(this.drainWaiter(),this.drainWaiter=null)})}getOption(e){switch(this.checkErr(),e){case Lc.NT_MOREDATA:return this.packets.length>0;case Lc.REMOTEADDR:{let t=this.secure?this.connStream:this.stream;return t.remoteAddress+":"+t.remotePort}default:Fe.throwErr(Fe.ERR_INTERNAL,"getOption not supported for opcode "+e)}}_notifyWaiters(){this.drainWaiter&&(this.drainWaiter(),this.drainWaiter=null),this.readWaiter&&(this.readWaiter(),this.readWaiter=null)}};_(Bc,"NTTCP");var wc=Bc;JA.exports=wc});var sd=m((uY,td)=>{"use strict";var NC=require("crypto"),SC=require("path"),ed=mr(),AC=require("fs");async function dC(){return await new Promise((r,e)=>{NC.randomBytes(16,(t,s)=>{t?e(t):r(s)})})}_(dC,"genuuid");var Yc=class Yc{constructor(e){this.largeSDU=!1,this.tdu=ed.NSPDFTDULN,this.nt={},this.nt.tcpNoDelay=!0,this.uuid=e,this.nt.sslServerDNMatch=!0,this.nt.sslAllowWeakDNMatch=!1}setFrom(e){e&&(e.sdu>0&&(this.sdu=parseInt(e.sdu)),typeof e.walletLocation=="string"&&(this.nt.walletFile=SC.join(e.walletLocation,ed.PEM_WALLET_FILE_NAME)),typeof e.walletPassword=="string"&&(this.nt.walletPassword=e.walletPassword),typeof e.walletContent=="string"&&(this.nt.wallet=e.walletContent),e.expireTime>0&&(this.nt.expireTime=e.expireTime*1e3*60),e.connectTimeout>0&&(this.connectTimeout=e.connectTimeout*1e3),e.transportConnectTimeout>0&&(this.transportConnectTimeout=e.transportConnectTimeout*1e3),e.recvTimeout>0&&(this.recvTimeout=e.recvTimeout*1e3),e.sendTimeout>0&&(this.sendTimeout=e.sendTimeout*1e3),typeof e.connectionIdPrefix=="string"&&(this.connectionIdPrefix=e.connectionIdPrefix),typeof e.tcpNoDelay=="boolean"&&(this.nt.tcpNoDelay=e.tcpNoDelay),typeof e.sslServerDNMatch=="boolean"&&(this.nt.sslServerDNMatch=e.sslServerDNMatch),typeof e.sslAllowWeakDNMatch=="boolean"&&(this.nt.sslAllowWeakDNMatch=e.sslAllowWeakDNMatch),typeof e.sslServerCertDN=="string"&&(this.nt.sslServerCertDN=e.sslServerCertDN),typeof e.enable=="string"&&e.enable.toUpperCase()=="BROKEN"&&(this.nt.enabledDCD=!0),typeof e.httpsProxy=="string"&&(this.nt.httpsProxy=e.httpsProxy),e.httpsProxyPort>=0&&(this.nt.httpsProxyPort=parseInt(e.httpsProxyPort)))}readWalletFile(){return new Promise((e,t)=>{AC.readFile(this.nt.walletFile,(s,n)=>{s?t(s):e(n)})})}clearWallet(){this.nt.wallet&&Buffer.isBuffer(this.nt.wallet)&&this.nt.wallet.fill(0),this.nt.wallet=null}async prepare(e){this.uuid||(this.uuid=await dC(),this.uuid=this.uuid.toString("base64")),this.connectionIdPrefix?this.connectionId=this.connectionIdPrefix+this.uuid:this.connectionId=this.uuid,this.nt.connectionId=this.connectionId,e&&e.toUpperCase()=="TCPS"&&!this.nt.wallet&&this.nt.walletFile&&(this.nt.wallet=await this.readWalletFile()),!this.connectTimeout&&!this.transportConnectTimeout&&(this.transportConnectTimeout=60*1e3)}};_(Yc,"SessionAtts");var Uc=Yc;td.exports=Uc});var Qr=m((NY,id)=>{"use strict";var pC=nt(),Si=W(),rd=require("os");function fC(){this.program=process.argv0,this.terminal="unknown",this.pid=process.pid.toString();try{this.userName=rd.userInfo().username}catch{this.userName="unknown"}this.hostName=rd.hostname()}_(fC,"populateClientInfo");var mC=new fC;function PC(r){let e=[];for(let t of r)e.push(t.fetchInfo);return e}_(PC,"getMetadataMany");function nd(r,e){let t=r[0].name===void 0,s=t?[]:{};for(let n=0;n<r.length;n++)t?s.push(r[n].values[e]):s[r[n].name]=r[n].values[e];return s}_(nd,"getOutBindValues");function RC(r,e,t){let n=r.bindInfoList.map(i=>i.bindVar).filter(i=>i.dir!==pC.BIND_IN);if(n.length>0){if(t){let i=new Array(e);for(let a=0;a<e;a++)i[a]=nd(n,a);return i}return nd(n,0)}}_(RC,"getOutBinds");function IC(r){let e="",t="",s=!1,n=!1,i=0,a={status:-1,proxyUser:"",schemaUser:""},c=r.length,T=0,l,E;for(;T<c;){if(r.charAt(T)==='"'&&(s=!s,i=T),r.charAt(T)==="["&&!s){if(n=!0,i!=0){for(l=i+1;l<T;l++)if(r.charAt(l)!==" ")return a;for(l=0;l<=i;l++)t+=r.charAt(l)}else for(l=0;l<T&&r.charAt(l)!==" ";l++)t+=r.charAt(l);break}T++}if(t.length===0)return a;a.proxyUser=t,T=T+1,s=!1;let u=T;for(i=0;T<c;){if(r.charAt(T)==='"'&&(s=!s,i=T),r.charAt(T)==="["&&!s&&n)return a;if(r.charAt(T)==="]"&&!s){if(i!=u&&i!=0){for(l=u;l<=i;l++)e+=r.charAt(l);for(l=i+1;l<T;l++)if(r.charAt(l)!=" ")return a}else{for(l=u;l<T&&r.charAt(l)==" ";l++);if(l==T)return a;for(E=l;E<T;E++)e+=r[E]}for(l=T+1;l<c;l++)if(r[l]!=" ")return a}T++}return e.length===0||(a.schemaUser=e,a.status=0),a}_(IC,"checkProxyUserValidity");function DC(r){r.token===void 0&&(r.externalAuth===!0&&Si.throwErr(Si.ERR_NOT_IMPLEMENTED,"External Authentication"),r.password===void 0&&Si.throwErr(Si.ERR_MISSING_CREDENTIALS))}_(DC,"checkCredentials");function CC(r){return`-----BEGIN PRIVATE KEY-----
`+r+`
-----END PRIVATE KEY-----`}_(CC,"normalizePrivateKey");id.exports={getMetadataMany:PC,CLIENT_INFO:mC,getOutBinds:RC,checkProxyUserValidity:IC,checkCredentials:DC,normalizePrivateKey:CC}});var cd=m((AY,_d)=>{"use strict";var{findNVPairRecurse:jr,createNVPair:fi}=Pr(),Et=W(),OC=require("os"),gC=require("net"),yC=require("dns"),od=yC.promises,Mc=Qr().CLIENT_INFO,mi={ADDR:0,ADDR_LIST:1,DESC:2,DESC_LIST:3},kc=class kc{isS(){return mi.ADDR}initFromString(e){let t=fi(e);this.initFromNVPair(t)}initFromNVPair(e){(e==null||e.name.toUpperCase()!="ADDRESS")&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=jr(e,"protocol"),s=jr(e,"port"),n=jr(e,"host"),i=jr(e,"https_proxy"),a=jr(e,"https_proxy_port");s&&(this.port=Number(s.atom)),n&&(this.host=n.atom),t&&(this.prot=t.atom),i&&(this.httpsProxy=i.atom),a&&(this.httpsProxyPort=Number(a.atom)),this.addr=e.toString()}toString(){return this.addr}};_(kc,"Address");var Vc=kc,qc=class qc{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!1,this.failover=!0}isS(){return mi.ADDR_LIST}initFromString(e){let t=fi(e);this.initFromNVPair(t)}initFromNVPair(e){this.children=[];let t,s,n=e.getListSize();n==0&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let i=0;i<n;i++)t=e.getListElement(i),t.name.toUpperCase()=="SOURCE_ROUTE"?this.sourceRoute=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="LOAD_BALANCE"?this.loadBalance=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="FAILOVER"?this.failover=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="ADDRESS"?(s=new Jr,s.initFromNVPair(t),this.children.push(s)):t.name.toUpperCase()=="ADDRESS_LIST"?(s=new Zr,s.initFromNVPair(t),this.children.push(s)):Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);this.children.length==0&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX)}toString(){let e=new String("");if(this.children.size()<1)return e;e+="(ADDRESS_LIST=";for(let t=0;t<this.children.size();t++)e+=this.children[t].toString();return this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"+Rr.HC),this.loadBalance&&(e+="(LOAD_BALANCE=yes)"),this.failover||(e+="(FAILOVER=false)"),e+=")",e}};_(qc,"AddressList");var Fc=qc,Gc=class Gc{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!1,this.failover=!0,this.delayInMillis=-1,this.params={}}isS(){return mi.DESC}initFromString(e){let t=fi(e);this.initFromNVPair(t)}initFromNVPair(e){let t=e.getListSize(),s,n;t==0&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let i=0;i<t;i++)if(s=e.getListElement(i),s.name.toUpperCase()=="SOURCE_ROUTE")this.sourceRoute=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="LOAD_BALANCE")this.loadBalance=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="FAILOVER")this.failover=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="ADDRESS_LIST")n=new Zr,n.initFromNVPair(s),this.children.push(n);else if(s.name.toUpperCase()=="ADDRESS")n=new Jr,n.initFromNVPair(s),this.children.push(n);else if(s.name.toUpperCase()=="CONNECT_DATA"){let a,c=s.getListSize();for(let T=0;T<c;T++)if(a=s.getListElement(T),a.name.toUpperCase()=="CONNECTION_ID_PREFIX"){this.params.connectionIdPrefix=a.atom,s.removeListElement(T);break}this.connectData=s.valueToString()}else if(s.name.toUpperCase()=="RETRY_DELAY")s.atom>0&&(this.delayInMillis=s.atom*1e3);else if(s.name.toUpperCase()=="RETRY_COUNT")this.retryCount=s.atom;else if(s.name.toUpperCase()=="CONNECTION_ID_PREFIX")this.conidPrefix=s.atom;else if(s.name.toUpperCase()=="CONNECT_TIMEOUT")s.atom>0&&(this.params.connectTimeout=s.atom);else if(s.name.toUpperCase()=="TRANSPORT_CONNECT_TIMEOUT")s.atom>0&&(this.params.transportConnectTimeout=s.atom);else if(s.name.toUpperCase()=="ENABLE")this.params.enable=s.atom;else if(s.name.toUpperCase()=="RECV_TIMEOUT")s.atom>0&&(this.params.recvTimeout=s.atom);else if(s.name.toUpperCase()=="SDU")this.params.sdu=s.atom;else if(s.name.toUpperCase()=="EXPIRE_TIME")s.atom>0&&(this.params.expireTime=s.atom);else if(s.name.toUpperCase()=="SECURITY"){let a=s.getListSize(),c;for(let T=0;T<a;T++)c=s.getListElement(T),c.name.toUpperCase()=="SSL_SERVER_CERT_DN"?this.params.sslServerCertDN=c.valueToString():c.name.toUpperCase()=="SSL_SERVER_DN_MATCH"?this.params.sslServerDNMatch=c.atom.toLowerCase()=="yes"||c.atom.toLowerCase()=="on"||c.atom.toLowerCase()=="true":c.name.toUpperCase()=="SSL_ALLOW_WEAK_DN_MATCH"?this.params.sslAllowWeakDNMatch=c.atom.toLowerCase()=="yes"||c.atom.toLowerCase()=="on"||c.atom.toLowerCase()=="true":(c.name.toUpperCase()=="WALLET_LOCATION"||c.name.toUpperCase()=="MY_WALLET_DIRECTORY")&&(this.params.walletLocation=c.atom)}}toString(){let e=new String(""),t;t=new String("");for(let s=0;s<this.children.size();s++)t=this.children[s].toString(),!t==""&&(e+=t);return!e==""&&this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"),!e==""&&this.loadBalance&&(e+="(LOAD_BALANCE=yes)"),!e==""&&!this.failover&&(e+="(FAILOVER=false)"),e.equals("")||(e="(DESCRIPTION="+e+")"),e}};_(Gc,"Description");var xc=Gc,vc=class vc{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!0,this.failover=!0}isS(){return mi.ADDR_LIST}initFromString(e){let t=fi(e);this.initFromNVPair(t)}initFromNVPair(e){let t=e.getListSize(),s,n;t==0&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let i=0;i<t;i++)n=e.getListElement(i),n.name.toUpperCase()=="SOURCE_ROUTE"?this.sourceRoute=n.atom.toLowerCase()=="yes"||n.atom.toLowerCase()=="on"||n.atom.toLowerCase=="true":n.name.toUpperCase()=="LOAD_BALANCE"?this.loadBalance=n.atom.toLowerCase()=="yes"||n.atom.toLowerCase()=="on"||n.atom.toLowerCase()=="true":n.name.toUpperCase()=="FAILOVER"?this.failover=n.atom.toLowerCase()=="yes"||n.atom.toLowerCase()=="on"||n.atom.toLowerCase()=="true":n.name.toUpperCase()=="DESCRIPTION"?(s=new di,s.initFromNVPair(n),this.children.push(s)):Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX);this.children.length==0&&Et.throwErr(Et.ERR_INVALID_CONNECT_STRING_SYNTAX)}toString(){let e=new String("");if(this.children.size()<1)return e;let t=new String("");for(let s=0;s<this.children.size();s++)t=this.children[s].toString(),t.equals("")||(e+=t);return e.equals("")&&this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"),e.equals("")&&!this.loadBalance&&(e+="(LOAD_BALANCE=no)"),e.equals("")&&!this.failover&&(e+="(FAILOVER=false)"),e.equals("")||(e="(DESCRIPTION_LIST="+e+")"),e}};_(vc,"DescriptionList");var bc=vc,Hc=class Hc{constructor(){this.CNdata=new Array}};_(Hc,"ConnOption");var Ai=Hc,Rr={DEBUG:!1,SR:"(SOURCE_ROUTE=yes)",HC:"(HOP_COUNT=0)",LB:"(LOAD_BALANCE=yes)",NFO:"(FAILOVER=false)",CD:"(CONNECT_DATA=",CONID:"(CONNECTION_ID="},ad={all:!0},Kc=class Kc extends Vc{constructor(){super()}async navigate(e){let t,s=0,n=!1;if(!this.host){s=1,this.host=OC.hostname();try{await od.lookup(this.host,ad)}catch{this.host="localhost"}}if(e.getcurrentDescription()==null&&(e.newConnectionDescription(),n=!0),gC.isIP(this.host)){let i=new Ai;i.hostname=this.host,i.port=this.port,i.protocol=this.prot,i.httpsProxy=this.httpsProxy,i.httpsProxyPort=this.httpsProxyPort,i.desc=e.getcurrentDescription(),i.CNdata.push(e.sBuf.join("")),i.CNdata.push(this.toString()),i.host=this.host,i.addr=this.addr,e.getcurrentDescription().addConnectOption(i)}else try{t=await od.lookup(this.host,ad);for(let i of t){let a=new Ai;a.hostname=this.host,a.port=this.port,a.protocol=this.prot,a.httpsProxy=this.httpsProxy,a.httpsProxyPort=this.httpsProxyPort,a.desc=e.getcurrentDescription(),a.CNdata.push(e.sBuf.join("")),s==1?a.CNdata.push("(address=(protocol="+this.prot+")(host="+this.host+")(port="+this.port+"))"):a.CNdata.push(this.toString()),a.host=i.address,a.addr=this.addr,e.getcurrentDescription().addConnectOption(a)}}catch{}n&&e.closeDescription()}addToString(e){let t=this.toString(),s=new Array;s=e.getcurrentDescription().getConnectOptions();for(let n=0;n<s.length;n++)s[n].done||s[n].CNdata.push(t)}};_(Kc,"NavAddress");var Jr=Kc,Wc=class Wc extends Fc{constructor(){super(),this.activeChildren=new Array,this.sBuflength=0}async navigate(e){await this.navigate2(e,0)}async navigate2(e,t){if(t++,this.sBuflength=e.sBuf.length,e.sBuf.push("(ADDRESS_LIST="),this.sourceRoute){this.activeChildren=this.children,await this.activeChildren[0].navigate(e);for(let s=1;s<this.activeChildren.length;s++)this.activeChildren[s].addToString(e)}else{this.activeChildren=en.setActiveChildren(this.children,this.failover,this.loadBalance);for(let s=0;s<this.activeChildren.length;s++)this.getChildrenType(s)==1?await this.activeChildren[s].navigate2(e,t):await this.activeChildren[s].navigate(e)}this.closeNVPair(e),e.sBuf.length=this.sBuflength}addToString(e){let t=this.toString(),s=new Array;s=e.getcurrentDescription().getConnectOptions();for(let n=0;n<s.length;n++)s[n].done||s[n].CNdata.push(t)}getChildrenSize(){let e=0;for(let t=0;t<this.activeChildren.length;t++)if(this.getChildrenType(t)==1?e+=this.activeChildren[t].getChildrenSize():e++,this.sourceRoute)return e;return e}getChildrenType(e){return this.activeChildren[e].isS()}getChild(e){return this.children[e]}closeNVPair(e){let t=new Array,s=this.getChildrenSize();if(e.getcurrentDescription()!=null){t=e.getcurrentDescription().getConnectOptions();let n=0,i=null,a=null;for(let c=t.length-1;c>=0&&!t[c].done&&((t[c].hostname!=i||t[c].port!=a)&&n++,i=t[c].hostname,a=t[c].port,!(n>s));c--)this.sourceRoute&&(t[c].CNdata.push(Rr.SR),t[c].CNdata.push(Rr.HC),t[c].done=!0),t[c].CNdata.push(")")}}};_(Wc,"NavAddressList");var Zr=Wc,Xc=class Xc extends xc{constructor(){super(),this.activeChildren=new Array,this.descProcessed=0}async navigate(e){e.sBuf.length=0,e.sBuf.push("(DESCRIPTION=");let t=e.newConnectionDescription();if(this.retryCount!=null&&(e.retryCount=this.getIntValue(this.retryCount,e.retryCount),t.retryCount=e.retryCount),this.delayInMillis!=-1&&(t.delayInMillis=this.delayInMillis),t.params=this.params,"connectTimeout"in this.params&&e.sBuf.push("(CONNECT_TIMEOUT="+this.params.connectTimeout+")"),"transportConnectTimeout"in this.params&&e.sBuf.push("(TRANSPORT_CONNECT_TIMEOUT="+this.params.transportConnectTimeout+")"),"recvTimeout"in this.params&&e.sBuf.push("(RECV_TIMEOUT="+this.params.recvTimeout+")"),"sdu"in this.params&&e.sBuf.push("(SDU="+this.params.sdu+")"),"expireTime"in this.params&&e.sBuf.push("(EXPIRE_TIME="+this.params.expireTime+")"),"enable"in this.params&&e.sBuf.push("(ENABLE="+this.params.enable+")"),("sslServerCertDN"in this.params||"sslServerDNMatch"in this.params||"walletLocation"in this.params||"sslAllowWeakDNMatch"in this.params)&&(e.sBuf.push("(SECURITY="),"sslServerCertDN"in this.params&&e.sBuf.push("(SSL_SERVER_CERT_DN="+this.params.sslServerCertDN+")"),"sslServerDNMatch"in this.params&&e.sBuf.push("(SSL_SERVER_DN_MATCH="+this.params.sslServerDNMatch+")"),"sslAllowWeakDNMatch"in this.params&&e.sBuf.push("(SSL_ALLOW_WEAK_DN_MATCH="+this.params.sslAllowWeakDNMatch+")"),"walletLocation"in this.params&&e.sBuf.push("(WALLET_LOCATION="+this.params.walletLocation+")"),e.sBuf.push(")")),"httpsProxyPort"in this.params&&e.sBuf.push("(HTTPS_PROXY_PORT="+this.params.httpsProxyPort+")"),"httpsProxy"in this.params&&e.sBuf.push("(HTTPS_PROXY="+this.params.httpsProxy+")"),this.failover||e.sBuf.push(Rr.NFO),this.sourceRoute){this.activeChildren=this.children,await this.activeChildren[0].navigate(e);for(let s=1;s<this.activeChildren.length;s++)this.activeChildren[s].addToString(e);this.closeNVPair(e)}else{this.activeChildren=en.setActiveChildren(this.children,this.failover,this.loadBalance);for(let s=0;s<this.activeChildren.length;s++)await this.activeChildren[s].navigate(e);this.closeNVPair(e)}e.closeDescription()}closeNVPair(e){if(e.getcurrentDescription()==null)return;let t=new Array;t=e.getcurrentDescription().getConnectOptions();for(let s=0;s<t.length;++s){this.sourceRoute&&t[s].CNdata.push(Rr.SR),this.connectData==null&&(this.connectData="(SERVICE_NAME=)");let i=`(CID=(PROGRAM=${`"'`+Mc.program+`'"`})(HOST=${Mc.hostName})(USER=${Mc.userName}))`;t[s].CNdata.push(Rr.CD),t[s].CNdata.push(this.connectData),t[s].CNdata.push(i),t[s].CNdata.push(")"),this.SID!=null&&(t[s].sid=this.SID),this.serviceName!=null&&(t[s].service_name=this.serviceName),this.instanceName!=null&&(t[s].instance_name=this.instanceName),t[s].CNdata.push(")"),t[s].done=!0}}getIntValue(e,t){try{return parseInt(e)}catch{return t}}};_(Xc,"NavDescription");var di=Xc,pi=class pi extends bc{constructor(e=new Array,t=0,s=0){super(),this.activeChildren=e,this.descProcessed=t,this.done=s}async navigate(e){for(e.sBuf.push("(DESCRIPTION_LIST="),this.activeChildren=pi.setActiveChildren(this.children,this.failover,this.loadBalance);this.descProcessed<this.activeChildren.length;)await this.activeChildren[this.descProcessed].navigate(e),this.descProcessed++}static setActiveChildren(e,t,s){let n,i=e.length,a=new Array,c=Math.floor(Math.random()*10),T=new Array(i).fill(!1);if(t)if(s)for(let l=0;l<i;l++){do n=Math.abs(Math.floor(Math.random()*10))%i;while(T[n]);T[n]=!0,a.push(e[n])}else a=e;else s?(n=Math.abs(c)%i,a.push(e[n])):a.push(e[0]);return a}};_(pi,"NavDescriptionList");var en=pi;_d.exports={NavAddress:Jr,NavAddressList:Zr,NavDescription:di,NavDescriptionList:en}});var tT=m((pY,ld)=>{"use strict";var{NavAddress:LC,NavAddressList:wC,NavDescription:BC,NavDescriptionList:UC}=cd(),{createNVPair:YC}=Pr(),Td=W(),Jc=class Jc{constructor(){this.cOpts=new Array}addConnectOption(e){this.cOpts.push(e)}getConnectOptions(){return this.cOpts}};_(Jc,"ConnectDescription");var zc=Jc,Zc=class Zc{constructor(){this.reset(),this.retryCount=0,this.currentDescription=null,this.descriptionList=new Array,this.sBuf=new Array}reset(){this.nextOptToTry=0,this.lastRetryCounter=0,this.lastRetryConnectDescription=0,this.reorderDescriptionList=0}hasMoreOptions(){let e=0;for(let t=0;t<this.descriptionList.length;++t)e+=this.descriptionList[t].getConnectOptions().length;return this.nextOptToTry<e}newConnectionDescription(){return this.currentDescription=new zc,this.currentDescription}getcurrentDescription(){return this.currentDescription}closeDescription(){this.descriptionList.push(this.currentDescription),this.currentDescription=null}async execute(e){e!=null&&this.retryCount==0&&e.retryCount>0&&(this.retryCount=e.retryCount),this.reorderDescriptionList||(this.descriptionList=jc.reorderDescriptionList(this.descriptionList),this.reorderDescriptionList=!0);for(let t=this.lastRetryConnectDescription;t<this.descriptionList.length;t++){let s=this.descriptionList[t],n=new Array;n=s.getConnectOptions();let i=s.delayInMillis;e!=null&&(i==0||i==null)&&e.retryDelay>0&&(i=e.retryDelay*1e3);for(let a=this.lastRetryCounter;a<=this.retryCount;++a){for(this.nextOptToTry==0&&(n=jc.reorderAddresses(n));this.nextOptToTry<n.length;){let c=n[this.nextOptToTry];return this.lastRetryCounter=a,this.lastRetryConnectDescription=t,this.nextOptToTry++,c}this.nextOptToTry=0,i>0&&a<this.retryCount&&await MC(i)}this.lastRetryCounter=0}throw this.nextOptToTry=1e3,this.lastRetryCounter=1e3,new Error("All options tried")}};_(Zc,"ConnStrategy");var $c=Zc;function MC(r){return new Promise(e=>setTimeout(e,r))}_(MC,"sleep");async function VC(r){let e;typeof r=="string"?e=YC(r):e=r;let t=e.name.toUpperCase(),s=null;switch(t){case"ADDRESS":s=new LC;break;case"ADDRESS_LIST":s=new wC;break;case"DESCRIPTION":s=new BC;break;case"DESCRIPTION_LIST":s=new UC;break;default:Td.throwErr(Td.ERR_INVALID_CONNECT_STRING_PARAMETERS,`unknown top element ${t}`)}s.initFromNVPair(e);let n=new $c;return await s.navigate(n),n}_(VC,"createNode");var eT=class eT{constructor(){this.DOWN_HOSTS_TIMEOUT=600,this.MIN_TIME_BETWEEN_REFRESH=60,this.downHostsCacheMap=new Map,this.lastRefreshTime=0}markDownHost(e){return this.downHostsCacheMap.set(e,Date.now())}refreshCache(){Date.now()-this.MIN_TIME_BETWEEN_REFRESH*1e3>this.lastRefreshTime&&(this.downHostsCacheMap.forEach((e,t)=>{let s=e;s!=null&&Date.now()-this.DOWN_HOSTS_TIMEOUT*1e3>s&&this.downHostsCacheMap.delete(t)}),this.lastRefreshTime=Date.now())}reorderAddresses(e){this.refreshCache();let t=0,s=e.length-1;for(;t<s;){for(;t<=s&&!this.isDownHostsCached(e[t]);)t++;for(;s>=t&&this.isDownHostsCached(e[s]);)s--;t<s&&([e[t],e[s]]=[e[s],e[t]])}return e}isDownDescCached(e){let t=e.getConnectOptions();for(let s=0;s<t.length;s++)if(!this.isDownHostsCached(t[s]))return!1;return!0}reorderDescriptionList(e){this.refreshCache();let t=0,s=e.length-1;for(;t<s;){for(;t<=s&&!this.isDownDescCached(e[t]);)t++;for(;s>=t&&this.isDownDescCached(e[s]);)s--;t<s&&([e[t],e[s]]=[e[s],e[t]])}return e}isDownHostsCached(e){return this.downHostsCacheMap.has(e.host)}};_(eT,"DownHostsCache");var Qc=eT,jc=new Qc;ld.exports={createNode:VC,SOLE_INST_DHCACHE:jc}});var Nd=m((mY,hd)=>{"use strict";var ws=W(),ud=new RegExp("((?=(?<hostnames>(((\\[[A-z0-9:]+\\])|([A-z0-9][A-z0-9._-]+))[,]?)+)))\\k<hostnames>(:(?<port>\\d+)?)?","g"),FC=new RegExp("^(((?<protocol>[A-z0-9]+):)?//)?(?<hostinfo>("+ud.source+"(?=([,]|[;]|[/]|[:]|$))([,]|[;])?)+)(/(?<servicename>[A-z0-9][A-z0-9,-.]+)?)?(:(?<servermode>dedicated|shared|pooled))?(/(?<instance>[A-z0-9][A-z0-9]+))?$","ig"),Ed='"',xC="=",bC="&",kC=["ENABLE","FAILOVER","LOAD_BALANCE","RECV_BUF_SIZE","SEND_BUF_SIZE","SDU","SOURCE_ROUTE","RETRY_COUNT","RETRY_DELAY","CONNECT_TIMEOUT","TRANSPORT_CONNECT_TIMEOUT","RECV_TIMEOUT"],rT=class rT{constructor(e){this.URL_PROPS_ALIAS=this.initializeUrlAlias(),this.url=e,this.resolvedUrl="",this.connectionProps=new Map,this.urlProps=new Map,this.lb=!1}getResolvedUrl(){return this.parse(),this.resolvedUrl}parse(){let e=this.parseExtendedSettings(this.url);this.connectionProps.size===0&&this.urlProps.size===0&&(e=this.url),this.resolvedUrl=this.resolveToLongURLFormat(e)}resolveToLongURLFormat(e){let t=e.replace(/\s/g,""),s=0,n=null,i=null,a=null,c=null,T=null;for(let h of t.matchAll(FC))s=1,n=h.groups.protocol,i=h.groups.hostinfo,a=h.groups.servicename,c=h.groups.servermode,T=h.groups.instance;s||ws.throwErr(ws.ERR_INVALID_EZCONNECT_SYNTAX,"input string not in easy connect format",t),n==null?e.includes("//")||(n="TCP"):n.toLowerCase()!="tcp"&&n.toLowerCase()!="tcps"&&ws.throwErr(ws.ERR_INVALID_EZCONNECT_SYNTAX,"Unsupported protocol in thin mode",n);let l=this.urlProps.get("HTTPS_PROXY"),E=this.urlProps.get("HTTPS_PROXY_PORT"),u=this.buildAddressList(i,n,l,E),p=this.urlProps.get("CONNECTION_ID_PREFIX"),A=[];return this.lb&&A.push("(LOAD_BALANCE=ON)"),A.push(this.buildDescriptionParams()),A.push(u),A.push(this.buildConnectData(a,c,T,p)),A.push(this.buildSecurityInfo(n)),`(DESCRIPTION=${A.join("")})`}buildConnectData(e,t,s,n){let i=this.urlProps.get("POOL_CONNECTION_CLASS"),a=this.urlProps.get("POOL_PURITY"),c=this.urlProps.get("SERVICE_TAG"),T=this.urlProps.get("POOL_BOUNDARY"),l=[];return e?l.push(`(SERVICE_NAME=${e})`):l.push("(SERVICE_NAME=)"),t&&l.push(`(SERVER=${t})`),s&&l.push(`(INSTANCE_NAME=${s})`),i&&l.push(`(POOL_CONNECTION_CLASS=${i})`),a&&l.push(`(POOL_PURITY=${a})`),c&&l.push(`(SERVICE_TAG=${c})`),n&&l.push(`(CONNECTION_ID_PREFIX=${n})`),T&&l.push(`(POOL_BOUNDARY=${T})`),`(CONNECT_DATA=${l.join("")})`}buildAddressList(e,t,s,n){let i=new Array,a="";s!=null&&(n!=null?a=`(HTTPS_PROXY=${s})(HTTPS_PROXY_PORT=${n})`:a=`(HTTPS_PROXY=${s})`),t==null&&(t="TCP");let c=0,T=e.split(";");for(let l of T){let E=0,u=new Array;for(let A of l.matchAll(ud)){let h=A.groups.hostnames.split(","),N=A.groups.port;N==null&&(N="1521");for(let d of h)u.push(this.getAddrStr(d,N,t,a)),E++}c+=E;let p=[];T.length>1&&E>1&&p.push("(LOAD_BALANCE=ON)"),p.push(u.join("")),T.length>1?i.push(`(ADDRESS_LIST=${p.join("")})`):i.push(p.join(""))}return T.length<2&&c>1&&(this.lb=!0),i.join("")}getAddrStr(e,t,s,n){let i=e.trim();return i.startsWith("[")&&i.endsWith("]")&&(i=i.substring(1,i.length-1)),`(ADDRESS=(PROTOCOL=${s})(HOST=${i})(PORT=${t})${n})`}buildDescriptionParams(){if(this.urlProps.size===0)return"";let e=new Array;return this.urlProps.forEach(function(t,s){kC.includes(s)&&e.push(`(${s}=${t})`)}),e.join("")}buildSecurityInfo(e){let t=new Array;if(e!=null&&e.toLowerCase()=="tcps"){let s=this.urlProps.get("SSL_SERVER_DN_MATCH"),n=this.urlProps.get("SSL_SERVER_CERT_DN"),i=this.urlProps.get("MY_WALLET_DIRECTORY");s!=null&&t.push(`(SSL_SERVER_DN_MATCH=${s})`),n!=null&&t.push(`(SSL_SERVER_CERT_DN=${n}})`),i!=null&&t.push(`(MY_WALLET_DIRECTORY=${i})`)}return t.length===0?"":`(SECURITY=${t.join("")})`}parseExtendedSettings(e){let t=Array.from(e.trim()),s=this.findExtendedSettingPosition(t);return s==-1?e:(this.parseExtendedProperties(t,s+1),e.substring(0,s))}parseExtendedProperties(e,t){let s=null,n=null,i=new Array(e.length),a=0,c="";for(let T=t;T<e.length;T++)if(e[T].trim()!="")switch(e[T]){case Ed:c=this.parseQuotedString(T,e,a,i),a=c[1],T=c[0];break;case xC:s!=null&&ws.throwErr(ws.ERR_INVALID_EZCONNECT_SYNTAX,"unable to parse, invalid syntax",this.url),s=i.join("").substring(0,a).trim(),a=0;break;case bC:s==null&&ws.throwErr(ws.ERR_INVALID_EZCONNECT_SYNTAX,"unable to parse, invalid syntax",this.url),n=i.join("").substring(0,a).trim(),this.addParam(s,n),s=null,n=null,a=0;break;default:i[a++]=e[T]}s!=null&&(n=i.join("").substring(0,a).trim(),this.addParam(s,n))}parseQuotedString(e,t,s,n){let i=e+1;for(;i<t.length;){let a=t[i];if(a==Ed)return[i,s];n[s++]=a,i++}}addParam(e,t){let s=e.toLowerCase(),n=this.URL_PROPS_ALIAS.get(s);n!=null?this.urlProps.set(n,t):this.connectionProps.set(n,t)}findExtendedSettingPosition(e){let t=0;for(let s=0;s<e.length;s++)if(e[s]=="(")t++;else if(e[s]==")")t--;else if(e[s]=="?"&&t==0)return s;return-1}initializeUrlAlias(){let e=new Map;return e.set("enable","ENABLE"),e.set("failover","FAILOVER"),e.set("load_balance","LOAD_BALANCE"),e.set("recv_buf_size","RECV_BUF_SIZE"),e.set("send_buf_size","SEND_BUF_SIZE"),e.set("sdu","SDU"),e.set("source_route","SOURCE_ROUTE"),e.set("retry_count","RETRY_COUNT"),e.set("retry_delay","RETRY_DELAY"),e.set("https_proxy","HTTPS_PROXY"),e.set("https_proxy_port","HTTPS_PROXY_PORT"),e.set("connect_timeout","CONNECT_TIMEOUT"),e.set("transport_connect_timeout","TRANSPORT_CONNECT_TIMEOUT"),e.set("recv_timeout","RECV_TIMEOUT"),e.set("ssl_server_cert_dn","SSL_SERVER_CERT_DN"),e.set("ssl_server_dn_match","SSL_SERVER_DN_MATCH"),e.set("wallet_location","MY_WALLET_DIRECTORY"),e.set("pool_connection_class","POOL_CONNECTION_CLASS"),e.set("pool_purity","POOL_PURITY"),e.set("service_tag","SERVICE_TAG"),e.set("connection_id_prefix","CONNECTION_ID_PREFIX"),e.set("pool_boundary","POOL_BOUNDARY"),e}};_(rT,"EZConnectResolver");var sT=rT;hd.exports=sT});var dd=m((RY,Ad)=>{"use strict";var{createNVPair:qC,findValue:GC}=Pr(),Dr=require("fs"),Sd=require("process"),vC=require("readline"),Ir=W(),HC=4;function KC(r){let e=null,t=Sd.env.TNS_ADMIN;if(r){if(e=r+"/tnsnames.ora",Dr.existsSync(e))return e;Ir.throwErr(Ir.ERR_TNS_NAMES_FILE_MISSING,r)}else return t?(e=t,e+="/tnsnames.ora",Dr.existsSync(e)||Ir.throwErr(Ir.ERR_TNS_NAMES_FILE_MISSING,t)):Ir.throwErr(Ir.ERR_NO_CONFIG_DIR),e}_(KC,"tnsnamesFilePath");var iT=class iT{constructor(){this.waiters=[],this.readInProgress=!1}async initializeNlpa(e){return this.readInProgress&&await new Promise(t=>{this.waiters.push(t)}),this.checkModfTime()?(this.ht=new Map,this.modTime=new Map,this.readInProgress=!0,await this.start(e,0),this.ht):this.ht}async start(e,t){if(t>HC)return;let s=Dr.statSync(e);this.modTime.set(e,s.mtime);let n=vC.createInterface({input:Dr.createReadStream(e),output:Sd.stdout,terminal:!1}),i="";for await(let c of n)if(c.length!=0){if(c[0]=="#")continue;if(c[0]==" "||c[0]=="	"||c[0]==")"||c[0]=="("){if(c=c.replace(/\s+/g,""),c=this.checkNLPforComments(c),c.length==0)continue;i=i+c}else i.length==0?(c=this.checkNLPforComments(c),i=i+c):i.length!=0&&(await this.addNLPListElement(i,t),i="",c=this.checkNLPforComments(c),i=i+c)}i.length!=0&&(await this.addNLPListElement(i,t),i=""),this.readInProgress=!1;let a;for(;a=this.waiters.pop();)a()}checkNLPforComments(e){let t=new Array(e.length);for(let s=0;s<e.length;s++){let n=e[s];if(n=="#"){if(s!=0)break;return""}else t.push(n)}return t.join("")}checkModfTime(){if(this.modTime)for(let[e,t]of this.modTime)if(Dr.existsSync(e)){if(Dr.statSync(e).mtime-t>0)return!0}else return!0;else return!0;return!1}async addNLPListElement(e,t){let s=e.split(/\r?\n/).filter(n=>n);for(let n=0;n<s.length;n++){s[n].charAt(0)!="("&&(s[n]="("+s[n]+")");let i=qC(s[n]),c=i.name.toUpperCase();if(i.name=c,c=="IFILE")await this.start(i.atom,t+1);else{let T=c.split(",");for(let l=0;l<T.length;l++)this.ht.set(T[l],i)}}}toString(){let e="";return this.ht.forEach(t=>{e=e+t.toString()+`
`}),e}findValueOf(e){let t=e.split("/");return GC(this.ht.get(t[0].toUpperCase()),t)}};_(iT,"NLParamParser");var nT=iT;Ad.exports={NLParamParser:nT,tnsnamesFilePath:KC}});var TT=m((DY,Rd)=>{"use strict";var vt=vA(),WC=ZA(),XC=sd(),Z=mr(),{createNode:md}=tT(),Ye=W(),{findNVPairRecurse:zC,createNVPair:Pi,findValue:Ht}=Pr(),{Buffer:pd}=require("buffer"),fd=Nd(),{NLParamParser:$C,tnsnamesFilePath:QC}=dd(),jC=require("process"),JC=tT().SOLE_INST_DHCACHE;async function ZC(r){let e=await Pd(r.connectString,r.configDir),t=await md(e),s;typeof e=="string"?s=Pi(e):s=e;let n=Ht(s,["DESCRIPTION","CONNECT_DATA","SERVER"]),i=Ht(s,["DESCRIPTION","CONNECT_DATA","POOL_CONNECTION_CLASS"]),a=Ht(s,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"]),c=Ht(s,["DESCRIPTION","CONNECT_DATA","SID"]),T=Ht(s,["DESCRIPTION","CONNECT_DATA","POOL_PURITY"]);return[n,i,a,T,c,t]}_(ZC,"getConnectionInfo");var eO=new $C;async function Pd(r,e){let t=r.trim(),s=t;if(t.indexOf(")")==-1||t.indexOf("(")!=0){if(t.indexOf(":")!=-1||t.indexOf("/")!=-1)return s=new fd(t).getResolvedUrl(),s;{let n=QC(e);if(s=(await eO.initializeNlpa(n)).get(t.toUpperCase()),s||Ye.throwErr(Ye.ERR_TNS_ENTRY_NOT_FOUND,t,e?e+"/tnsnames.ora":jC.env.TNS_ADMIN+"/tnsnames.ora"),s.rhsType==1){let a=s.atom;if(a.indexOf(":")!=-1||a.indexOf("/")!=-1)return new fd(a).getResolvedUrl()}s=s.getListElement(0)}}return s}_(Pd,"resolveConnectStr");async function aT(r,e){let t=await Pd(r,e);return md(t)}_(aT,"resolveAddress");function oT(r,e,t,s,n){let i,a=new Promise((c,T)=>{e>2147483647&&(e=2147483647),i=setTimeout(()=>T(Ye.getErr(Ye.ERR_CONNECTION_TIMEDOUT,s.host,s.port,t,e/1e3,n)),e)});return Promise.race([r,a]).then(c=>(clearTimeout(i),c)).catch(c=>{throw clearTimeout(i),c})}_(oT,"timeout");var cT=class cT{constructor(){this.connected=!1,this.isBreak=!1,this.isReset=!1,this.breakPosted=!1}async getAddress(e,t){let s=await e.execute(t),n=this.sAtts?this.sAtts.uuid:null;this.sAtts=new XC(n),this.sAtts.setFrom(t),this.sAtts.setFrom(s.desc.params),await this.sAtts.prepare(s.protocol);let i=Pi(s.CNdata.join("")),a=zC(i,"CONNECT_DATA"),c=`(CONNECTION_ID=${this.sAtts.connectionId})`,T=Pi(c);return a.addListElement(T),this.cData=pd.from(i.toString(),"ascii"),this.cDataNVPair=i,this.sAtts.nt.cDataNVPair=i,s}async transportConnect(e){e.protocol.toUpperCase()=="TCP"&&e.httpsProxy&&Ye.throwErr(Ye.ERR_INVALID_CONNECT_STRING_PARAMETERS,"https proxy requires protocol as","tcps "),e.protocol&&(e.protocol.toUpperCase()=="TCP"||e.protocol.toUpperCase()=="TCPS")?this.ntAdapter=new WC(this.sAtts.nt):Ye.throwErr(Ye.ERR_INVALID_CONNECT_STRING_PARAMETERS,e.protocol+" protocol not supported"),await this.ntAdapter.connect(e),this.ntAdapter.startRead(),this.sAtts.ntCha=this.ntAdapter.cha,this.sndDatapkt=new vt.DataPacket(this.sAtts.largeSDU),this.rcvDatapkt=new vt.DataPacket(this.sAtts.largeSDU)}_sendConnect(e){this._sendPacket(e.buf),e.overflow&&(this._send(e.connectData,0,e.connectDataLen),this.flush())}async connect2(e){if(this.sAtts.sdu?this.sAtts.sdu>Z.NSPABSSDULN?this.sAtts.sdu=Z.NSPABSSDULN:this.sAtts.sdu<Z.NSPMNSDULN&&(this.sAtts.sdu=Z.NSPMNSDULN):this.sAtts.sdu=Z.NSPDFSDULN,this.sAtts.transportConnectTimeout){let s=this.transportConnect(e);await oT(s,this.sAtts.transportConnectTimeout,"transportConnectTimeout",e,this.sAtts.connectionId)}else await this.transportConnect(e);let t=new vt.ConnectPacket(this.cData,this.sAtts);for(this._sendConnect(t);;){let s=await this._recvPacket();if(s.type===Z.NSPTAC)break;if(s.type===Z.NSPTRF){this.refusePkt.overflow&&(await this._recvPacket(),this.refusePkt.dataBuf=this.rcvDatapkt.buf.subarray(this.rcvDatapkt.offset,this.rcvDatapkt.len).toString());let n=Pi(this.refusePkt.dataBuf);this.refusePkt=null;let i=Ht(n,["DESCRIPTION","ERR"]);i=="12514"?Ye.throwErr(Ye.ERR_INVALID_SERVICE_NAME,this.getOption(Z.SVCNAME),e.host,e.port,this.sAtts.connectionId):i=="12505"?Ye.throwErr(Ye.ERR_INVALID_SID,this.getOption(Z.SID),e.host,e.port,this.sAtts.connectionId):i?Ye.throwErr(Ye.ERR_CONNECTION_REFUSED,e.host,e.port,this.sAtts.connectionId,"ORA-"+i):Ye.throwErr(Ye.ERR_CONNECTION_REFUSED,e.host,e.port,this.sAtts.connectionId,"refused")}else if(s.type===Z.NSPTRS)(s.flags&Z.NSPFSRN)==Z.NSPFSRN&&(await this.ntAdapter.renegTLS(),this.ntAdapter.startRead()),this._sendConnect(t);else if(s.type===Z.NSPTRD){let n,i,a;this.redirectPkt.overflow&&(await this._recvPacket(),this.redirectPkt.dataBuf=this.rcvDatapkt.buf.subarray(this.rcvDatapkt.offset,this.rcvDatapkt.len)),this.redirectPkt.flags&Z.NSPFRDS?(n=this.redirectPkt.dataBuf.indexOf("\0",0,"ascii"),i=this.redirectPkt.dataBuf.toString("ascii",0,n),a=this.redirectPkt.dataBuf.subarray(n+1,this.redirectPkt.dataLen)):(i=this.redirectPkt.dataBuf.toString("ascii"),a=this.cData);let c=await aT(i),T=e.hostname;if(e=await c.execute(),e.desc&&this.sAtts.setFrom(e.desc.params),e.originHost=T,this.redirectPkt=null,this.ntAdapter.disconnect(Z.NSFIMM),this.sAtts.transportConnectTimeout){let l=this.transportConnect(e);await oT(l,this.sAtts.transportConnectTimeout,"transportConnectTimeout",e,this.sAtts.connectionId)}else await this.transportConnect(e);t=new vt.ConnectPacket(a,this.sAtts,Z.NSPFRDR),this.sndDatapkt=new vt.DataPacket(this.sAtts.largeSDU),this._sendConnect(t)}}return this.connected=!0,this.cData=null,this.sndDatapkt=new vt.DataPacket(this.sAtts.largeSDU),this.sndDatapkt.createPacket(Z.NSPDADAT),this.sndDatapkt.offset=this.sndDatapkt.dataPtr,this.sndDatapkt.len=this.sndDatapkt.bufLen,this.markerPkt=new vt.MarkerPacket(this.sAtts.largeSDU),this.controlPkt=new vt.ControlPacket,this.ntAdapter.largeSDU=this.sAtts.largeSDU,this.sAtts.clearWallet(),this.sAtts.nt.walletPassword=null,!0}async connect1(e,t,s){let n,i;do try{if(this.sAtts.connectTimeout){let a=this.connect2(e);n=await oT(a,this.sAtts.connectTimeout,"connectTimeout",e,this.sAtts.connectionId)}else n=await this.connect2(e)}catch(a){a.message.startsWith("NJS-510")&&!this.ntAdapter.connected&&(JC.markDownHost(e.host,Date.now()),this.ntAdapter.connected=!0),this.ntAdapter&&(this.ntAdapter.disconnect(Z.NSFIMM),this.ntAdapter=null),this.sAtts.clearWallet(),n=!1,i=a;try{e=await this.getAddress(t,s)}catch{break}}while(!n);if(!n)throw i}_processPacket(e){switch(e.type){case Z.NSPTDA:this.rcvDatapkt.fromPacket(e);break;case Z.NSPTMK:this.markerPkt.fromPacket(e,this);break;case Z.NSPTCNL:this.controlPkt.fromPacket(e);break;case Z.NSPTAC:vt.AcceptPacket(e,this.sAtts),this.sAtts.version>=Z.TNS_VERSION_MIN_END_OF_RESPONSE&&e.flags&Z.TNS_ACCEPT_FLAG_HAS_END_OF_REQUEST&&(this.endOfRequestSupport=!0),e.flags&Z.TNS_ACCEPT_FLAG_FAST_AUTH&&(this.supportsFastAuth=!0);break;case Z.NSPTRF:this.refusePkt=new vt.RefusePacket(e);break;case Z.NSPTRS:break;case Z.NSPTRD:this.redirectPkt=new vt.RedirectPacket(e);break;default:Ye.throwErr(Ye.ERR_CONNECTION_INVALID_PACKET)}}async _recvPacket(){for(;;){let e=await this.ntAdapter.receive();if(!e)break;if(this._processPacket(e),e.type!==Z.NSPTCNL)return e}}_sendPacket(e){this.ntAdapter.send(e)}sendBreak(){if(!this.isBreak){if(!this.connected){this.isBreak=!0,this.breakPosted=!0;return}this.isBreak=!0,this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQIMARK),this._sendPacket(this.markerPkt.buf)}}async reset(){for(this.breakPosted&&(this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQBMARK),this._sendPacket(this.markerPkt.buf),this.breakPosted=!1),this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQRMARK),this._sendPacket(this.markerPkt.buf);!this.isReset;)await this._recvPacket();this.sndDatapkt.dataPtr=this.sndDatapkt.dataLen=Z.NSPDADAT,this.sndDatapkt.offset=this.sndDatapkt.dataPtr,this.sndDatapkt.len=this.sndDatapkt.bufLen,this.isBreak=this.isReset=!1}async recvPacket(){return await this._recvPacket()}syncRecvPacket(){for(;this.ntAdapter.packets.length>0;){let e=this.ntAdapter.syncReceive();if(!e)break;if(this._processPacket(e),e.type!==Z.NSPTCNL)return e}}_send(e,t,s){if(this.isBreak)return;let n=0;for(this.sndDatapkt.dataLen=this.sndDatapkt.offset,(this.sndDatapkt.dataLen<this.sndDatapkt.bufLen||!this.sndDatapkt.bufLen)&&(n=this.sndDatapkt.fillBuf(e,t,s),s-=n,t+=n,this.sndDatapkt.offset=this.sndDatapkt.dataLen);s;){if(this._sendPacket(this.sndDatapkt.dataBuf),this.isBreak)return;this.sndDatapkt.dataLen=this.sndDatapkt.dataPtr,this.sndDatapkt.offset=this.sndDatapkt.dataPtr,n=this.sndDatapkt.fillBuf(e,t,s),s-=n,t+=n,this.sndDatapkt.offset=this.sndDatapkt.dataLen}}flush(){this.isBreak||(this.sndDatapkt.dataLen=this.sndDatapkt.offset,this.sndDatapkt.prepare2Send(),this._sendPacket(pd.from(this.sndDatapkt.dataBuf)),this.sndDatapkt.dataLen=this.sndDatapkt.dataPtr,this.sndDatapkt.offset=this.sndDatapkt.dataPtr)}async connect(e){let t=e.connectString?e.connectString:e.connectionString,s;e._connInfo?(s=e._connInfo[5],s.reset()):s=await aT(t,e.configDir);let n;try{n=await this.getAddress(s,e)}catch(i){i.message=="All options tried"?Ye.throwErr(Ye.ERR_INVALID_CONNECT_STRING_PARAMETERS,"Ensure the ADDRESS parameters have been entered correctly, the most likely incorrect parameter is the host name"):Ye.throwErr(Ye.ERR_INVALID_CONNECT_STRING_PARAMETERS,i.message)}await this.connect1(n,s,e)}forceDisconnect(e){this.connected&&(this.ntAdapter.stream.destroy(e),this.connected=!1)}disconnect(e){this.connected&&(e!=Z.NSFIMM&&!this.ntAdapter.err&&(this.sndDatapkt.dataLen=this.sndDatapkt.offset,this.sndDatapkt.prepare2Send(Z.NSPDAFEOF),this._sendPacket(this.sndDatapkt.dataBuf)),this.ntAdapter.disconnect(e),this.ntAdapter=null,this.connected=!1)}getOption(e){switch(e){case Z.NS_MOREDATA:return this.ntAdapter.packets.length>0;case Z.SVCNAME:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"]);case Z.SID:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SID"]);case Z.SERVERTYPE:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVER"]);case Z.REMOTEADDR:return this.ntAdapter?this.ntAdapter.getOption(e):null;case Z.CONNCLASS:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","POOL_CONNECTION_CLASS"]);case Z.PURITY:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","POOL_PURITY"]);case Z.HEALTHCHECK:return this.connected&&this.ntAdapter.connected&&!this.ntAdapter.err;default:Ye.throwErr(Ye.ERR_INTERNAL,"getOption not supported for opcode "+e)}}recvInbandNotif(){let e=0;if(this.controlPkt.errno)return e=this.controlPkt.errno,e;if(this.getOption(Z.HEALTHCHECK))if(this.getOption(Z.NS_MOREDATA)){let t=this.ntAdapter.syncReceive();return t.type==Z.NSPTCNL?(this.controlPkt.fromPacket(t),e=this.controlPkt.errno,e):(this.ntAdapter.packets.unshift(t),0)}else return 0;else return Ye.ERR_CONNECTION_CLOSED}};_(cT,"NetworkSession");var _T=cT;Rd.exports={NetworkSession:_T,resolveAddress:aT,getConnectionInfo:ZC}});var ST=m((OY,uT)=>{"use strict";var{Buffer:tO}=require("buffer"),ut=nt(),Id=W(),sO=Ue(),hT=class hT{constructor(e,t=!1){this.bindName=e,this.isReturnBind=t,this.maxSize=0,this.numElements=0,this.maxArraySize=0,this.type=null,this.isArray=!1,this.dir=ut.BIND_IN,this.bindVar=null}};_(hT,"BindInfo");var tn=hT;uT.exports.BindInfo=tn;var NT=class NT{constructor(){this.returningKeywordFound=!1,this.pos=0,this.maxPos=0,this.sqlData=""}_parseBindName(e){let t=!1,s=!1,n=!1,i=0,a=this.pos+1,c,T;for(;a<=this.maxPos;){if(T=this.sqlData[a],s){if(n&&!new RegExp("\\p{N}","u").test(T)){this.pos=a-1;break}else if(t&&T==='"'){this.pos=a;break}else if(!n&&!t&&!/[\p{L}\p{N}]/u.test(T)&&!["$","_","#"].includes(T)){this.pos=a-1;break}}else{if(new RegExp("\\p{space}","u").test(T)){a+=1;continue}else if(T==='"')t=!0;else if(new RegExp("\\p{N}","u").test(T))n=!0;else if(!new RegExp("\\p{Alpha}","u").test(T))break;s=!0,i=a}a+=1}s&&(t?c=e.sql.substring(i+1,a):n?c=e.sql.substring(i,a):c=e.sql.substring(i,a).toUpperCase(),e._addBind(c))}_parseMultiLineComment(){let e=!1,t=!1,s=this.pos+1,n;for(;s<=this.maxPos;){if(n=this.sqlData[s],e){if(n==="*")t=!0;else if(t){if(n==="/"){this.pos=s;break}t=!1}}else{if(n!=="*")break;e=!0}s+=1}}_parseQstring(){let e=!1,t=!1,s,n;for(this.pos+=1;this.pos<=this.maxPos;){if(n=this.sqlData[this.pos],!t)n==="["?s="]":n==="{"?s="}":n==="("?s=")":n==="<"?s=">":s=n,t=!0;else if(!e&&n===s)e=!0;else if(e){if(n==="'")break;n!==s&&(e=!1)}this.pos+=1}}_parseQuotedString(e){let t;for(this.pos+=1;this.pos<=this.maxPos&&(t=this.sqlData[this.pos],t!==e);)this.pos+=1}_parseSingleLineComment(){let e=!1,t=this.pos+1,s;for(;t<=this.maxPos;){if(s=this.sqlData[t],e){if(s===`
`)break}else{if(s!=="-")return;e=!0}t+=1}this.pos=t}parse(e){let t=!1,s=!1,n,i="",a="",c=0,T,l,E=!1,u;for(this.pos=0,this.maxPos=e.sql.length-1,this.sqlData=e.sql;this.pos<=this.maxPos;){if(n=this.sqlData[this.pos],l=new RegExp("\\p{L}","u").test(n),l&&!E)c=this.pos,a=n;else if(!l&&E){if(T=this.pos-c,t)e.isDml&&!this.returningKeywordFound&&(T===9||T===6)&&["r","R"].includes(a)?(u=e.sql.substring(c,this.pos).toUpperCase(),["RETURNING","RETURN"].includes(u)&&(this.returningKeywordFound=!0)):this.returningKeywordFound&&T===4&&["i","I"].includes(a)&&(u=e.sql.substring(c,this.pos).toUpperCase(),u==="INTO"&&(e.isReturning=!0));else if(u=e.sql.substring(c,this.pos).toUpperCase(),e._determineStatementType(u),t=!0,e.isDdl)break}n==="'"?(s=!0,["q","Q"].includes(i)?this._parseQstring():this._parseQuotedString(n)):new RegExp("\\p{space}","u").test(n)||(n==="-"?this._parseSingleLineComment():n==="/"?this._parseMultiLineComment():n==='"'?this._parseQuotedString(n):n===":"&&!s&&this._parseBindName(e),s=!1),this.pos+=1,E=l,i=n}t||e._determineStatementType(e.sql.toUpperCase())}};_(NT,"Parser");var lT=NT,Ri=class Ri{constructor(){this.sql="",this.sqlBytes=[],this.sqlLength=0,this.cursorId=0,this.requiresDefine=!1,this.isQuery=!1,this.isPlSql=!1,this.isDml=!1,this.isDdl=!1,this.isReturning=!1,this.bindInfoList=[],this.queryVars=[],this.bindInfoDict=new Map,this.requiresFullExecute=!1,this.noPrefetch=!1,this.returnToCache=!1,this.numColumns=0,this.lastRowIndex,this.lastRowid,this.moreRowsToFetch=!0,this.inUse=!1,this.bufferRowIndex=0,this.bufferRowCount=0,this.pendingClear=!1,this.statementType=ut.STMT_TYPE_UNKNOWN}_copy(){let e=new Ri;e.sql=this.sql,e.sqlBytes=this.sqlBytes,e.sqlLength=this.sqlLength,e.isQuery=this.isQuery,e.isPlSql=this.isPlSql,e.isDml=this.isDml,e.isDdl=this.isDdl,e.isReturning=this.isReturning,e.bindInfoList=[];for(let s of this.bindInfoList){let n=new tn(s.bindName,s.isReturnBind);e.bindInfoList.push(n)}let t=e.bindInfoDict=new Map;for(let s of e.bindInfoList)t.has(s.bindName)?t.get(s.bindName).push(s):t.set(s.bindName,[s]);return e.returnToCache=!1,e}_determineStatementType(e){switch(e){case"DECLARE":this.isPlSql=!0,this.statementType=ut.STMT_TYPE_DECLARE;break;case"CALL":this.isPlSql=!0,this.statementType=ut.STMT_TYPE_CALL;break;case"BEGIN":this.isPlSql=!0,this.statementType=ut.STMT_TYPE_BEGIN;break;case"SELECT":this.isQuery=!0,this.statementType=ut.STMT_TYPE_SELECT;break;case"WITH":this.isQuery=!0;break;case"INSERT":this.isDml=!0,this.statementType=ut.STMT_TYPE_INSERT;break;case"UPDATE":this.isDml=!0,this.statementType=ut.STMT_TYPE_UPDATE;break;case"DELETE":this.isDml=!0,this.statementType=ut.STMT_TYPE_DELETE;break;case"MERGE":this.isDml=!0,this.statementType=ut.STMT_TYPE_MERGE;break;case"ALTER":this.isDdl=!0,this.statementType=ut.STMT_TYPE_ALTER;break;case"CREATE":this.isDdl=!0,this.statementType=ut.STMT_TYPE_CREATE;break;case"DROP":this.isDdl=!0,this.statementType=ut.STMT_TYPE_DROP;break;case"ANALYZE":case"AUDIT":case"COMMENT":case"GRANT":case"REVOKE":case"TRUNCATE":this.isDdl=!0;break;case"COMMIT":this.statementType=ut.STMT_TYPE_COMMIT;break;case"ROLLBACK":this.statementType=ut.STMT_TYPE_ROLLBACK;break;default:this.statementType=ut.STMT_TYPE_UNKNOWN;break}}_prepare(e){this.sql=e,this.sqlBytes=tO.from(this.sql,"utf8"),this.sqlLength=this.sqlBytes.length,new lT().parse(this)}_addBind(e){if(!this.isPlSql||!this.bindInfoDict.has(e)){let t=new tn(e,this.isReturning);this.bindInfoList.push(t),this.bindInfoDict.has(t.bindName)?(this.isReturning&&(this.bindInfoDict.get(t.bindName)[0].isReturnBind||Id.throwErr(Id.ERR_DML_RETURNING_DUP_BINDS,e)),this.bindInfoDict.get(t.bindName).push(t)):this.bindInfoDict.set(t.bindName,[t])}}_setVariable(e,t){t.type._oraTypeNum===sO.TNS_DATA_TYPE_CURSOR&&(this.requiresFullExecute=!0),(t.maxSize!==e.maxSize||t.dir!==e.dir||t.isArray!==e.isArray||t.values.length>e.numElements||t.type!=e.type||t.maxArraySize!=e.maxArraySize)&&(e.isArray=t.isArray,e.numElements=t.values.length,e.maxSize=t.maxSize,e.type=t.type,e.dir=t.dir,e.maxArraySize=t.maxArraySize,this.requiresFullExecute=!0),e.bindVar=t}_clearAllState(){this.cursorId=0,this.requiresDefine=!1,this.noPrefetch=!1,this.requiresFullExecute=!1,this.queryVars=[],this.numQueryVars=0,this.bufferRowCount=0,this.bufferRowIndex=0}_clearState(){this.cursorId=0,this.requiresDefine=!1,this.noPrefetch=!1,this.requiresFullExecute=!1}};_(Ri,"Statement");var ET=Ri;uT.exports.Statement=ET});var Cd=m((yY,Dd)=>{"use strict";var{Buffer:de}=require("buffer"),Kt=require("crypto"),Ii="aes-256-cbc",rO=de.from([0,1]),dT=class dT{_decrypt(e,t){let s=de.alloc(16,0),n=Kt.createDecipheriv(Ii,e,s);n.setAutoPadding(!1);let i=n.update(t);return i=de.concat([i,n.final()]),i}_encrypt(e,t,s){let i=de.alloc(16,0),a=16-t.length%16,c=de.alloc(a,a);a>0&&(s?t+=de.alloc(a):t=de.concat([t,c]));let T=Kt.createCipheriv(Ii,e,i),l=T.update(t);return l=de.concat([l,T.final()]),s||(l=l.slice(0,t.length)),t.fill(0),l}_setEncryptedPasswordBuffers(e,t,s,n){let i=de.alloc(16);Kt.randomFillSync(i,0,16);let a=de.concat([i,e]);if(n.encodedPassword=this._encrypt(s,a),a.fill(0),n.encodedPassword=n.encodedPassword.slice().toString("hex").toUpperCase(),t){let c=de.concat([i,t]);n.encodedNewPassword=this._encrypt(s,c),c.fill(0),n.encodedNewPassword=n.encodedNewPassword.slice().toString("hex").toUpperCase()}e.fill(0),t&&t.fill(0)}updateVerifierData(e,t,s,n,i){let a=32,c="sha512",T=de.from(e.AUTH_VFR_DATA,"hex"),l=de.from(e.AUTH_SESSKEY,"hex"),E=Number(e.AUTH_PBKDF2_VGEN_COUNT),u=de.from(t,"utf8"),p,A;if(n){Ii="aes-192-cbc",a=24,c="sha1";let P=Kt.createHash(c);P.update(u),P.update(T);let y=P.digest();p=de.alloc(y.length+4),y.copy(p,0,0,y.length)}else{Ii="aes-256-cbc";let P=de.from("AUTH_PBKDF2_SPEEDY_KEY","utf8"),y=de.concat([T,P]);A=Kt.pbkdf2Sync(u,y,E,64,"sha512");let Y=Kt.createHash(c);Y.update(A),Y.update(T),p=Y.digest().slice(0,a)}let h;s&&(h=de.from(s,"utf8"));let N=this._decrypt(p,l),d=de.alloc(N.length);Kt.randomFillSync(d);let S=this._encrypt(p,d);if(N.length===48){i.sessionKey=S.slice().toString("hex").toUpperCase().slice(0,96);let P=de.alloc(24);for(let V=16;V<=40;V++)P[V-16]=N[V]^d[V];let y=Kt.createHash("md5").update(P.subarray(0,16)).digest(),Y=Kt.createHash("md5").update(P.subarray(16)).digest();i.comboKey=de.concat([y,Y]).slice(0,a)}else{i.sessionKey=S.slice().toString("hex").toUpperCase().slice(0,64);let P=de.from(e.AUTH_PBKDF2_CSK_SALT,"hex");E=Number(e.AUTH_PBKDF2_SDER_COUNT);let Y=de.concat([d.slice(0,a),N.slice(0,a)]).toString("hex").toUpperCase(),V=de.from(Y,"utf8");i.comboKey=Kt.pbkdf2Sync(V,P,E,a,"sha512")}let D=de.alloc(16);if(!n){Kt.randomFillSync(D,0,16);let P=de.concat([D,A]);i.speedyKey=this._encrypt(i.comboKey,P),i.speedyKey=i.speedyKey.slice(0,80).toString("hex").toUpperCase()}this._setEncryptedPasswordBuffers(u,h,i.comboKey,i)}getEncryptedJSWPData(e,t){let s=this._encrypt(e,t,!0);return s=s.slice().toString("hex").toUpperCase(),s=de.concat([s,rO]),s}updatePasswordsWithComboKey(e,t,s,n){let i=de.from(e,"utf8"),a;t&&(a=de.from(t,"utf8")),this._setEncryptedPasswordBuffers(i,a,s,n)}};_(dT,"EncryptDecrypt");var AT=dT,nO=new AT;Dd.exports=nO});var Ld=m((wY,yd)=>{"use strict";var{Buffer:pT}=require("buffer"),ce=Ue(),Od=W(),gd=require("process"),fT=Cd(),iO=Ct(),mT=Qr(),sn=mT.CLIENT_INFO,oO=require("crypto"),RT=class RT extends iO{constructor(e,t){super(e),this.functionCode=ce.TNS_FUNC_AUTH_PHASE_ONE,this.messageType=ce.TNS_MSG_TYPE_FUNCTION,this.sessionData={},this.conn=e,this.sessionKey="",this.encodedPassword="",this.changePassword=!1,Object.defineProperty(this,"password",{enumerable:!1,value:t.password}),this.username=t.user,this.username===void 0?this.username="":this.username=this.username.trim(),this.schemaUser="",this.proxyUser="",this.proxyStatus=-1,this.username.length!==0&&(this.proxyStatusObj=mT.checkProxyUserValidity(this.username),this.proxyStatusObj.status===0&&(this.proxyStatus=0,this.proxyUser=this.proxyStatusObj.proxyUser,this.schemaUser=this.proxyStatusObj.schemaUser,this.username=this.proxyUser)),this.newPassword=t.newPassword,t.changePassword&&(this.changePassword=!0,this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO),this.username?this.userByteLen=pT.byteLength(this.username):this.userByteLen=0,this.token=t.token,this.token&&(this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO),this.privateKey=t.privateKey,this.privateKey&&(this.privateKey=mT.normalizePrivateKey(this.privateKey)),this.serviceName=this.conn.serviceName,this.remoteAddress=this.conn.remoteAddress,this.setAuthMode(t)}setAuthMode(e){this.newPassword||(this.authMode=ce.TNS_AUTH_MODE_LOGON),e.privilege&ce.SYSDBA&&(this.authMode|=ce.TNS_AUTH_MODE_SYSDBA),e.privilege&ce.SYSOPER&&(this.authMode|=ce.TNS_AUTH_MODE_SYSOPER),e.privilege&ce.SYSASM&&(this.authMode|=ce.TNS_AUTH_MODE_SYSASM),e.privilege&ce.SYSBKP&&(this.authMode|=ce.TNS_AUTH_MODE_SYSBKP),e.privilege&ce.SYSDG&&(this.authMode|=ce.TNS_AUTH_MODE_SYSDGD),e.privilege&ce.SYSKM&&(this.authMode|=ce.TNS_AUTH_MODE_SYSKMT),e.privilege&ce.SYSRAC&&(this.authMode|=ce.TNS_AUTH_MODE_SYSRAC),this.privateKey&&(this.authMode|=ce.TNS_AUTH_MODE_IAM_TOKEN),this.newPassword&&(this.authMode|=ce.TNS_AUTH_MODE_CHANGE_PASSWORD),this.token||(this.authMode|=ce.TNS_AUTH_MODE_WITH_PASSWORD)}getAlterTimezoneStatement(){let e,t;if(gd.env.ORA_SDTZ)t=gd.env.ORA_SDTZ;else{let n=new Date().getTimezoneOffset(),i=Math.trunc(n/60),a=Math.abs((n-i*60)%60);i<0?(e="+",i=-i):e="-",i=i.toLocaleString("en-US",{minimumIntegerDigits:2}),t=`${e}${i}:${a}`}return`ALTER SESSION SET TIME_ZONE ='${t}'\0`}encode(e){let t=!1;if(this.writeFunctionHeader(e),this.userByteLen>0?e.writeUInt8(1):e.writeUInt8(0),e.writeUB4(this.userByteLen),e.writeUB4(this.authMode),this.functionCode===ce.TNS_FUNC_AUTH_PHASE_ONE)e.writeUInt8(1),e.writeUB4(5),e.writeUInt8(0),e.writeUInt8(1),this.userByteLen>0&&e.writeBytesWithLength(pT.from(this.username)),e.writeKeyValue("AUTH_TERMINAL",sn.terminal),e.writeKeyValue("AUTH_PROGRAM_NM",sn.program),e.writeKeyValue("AUTH_MACHINE",sn.hostName),e.writeKeyValue("AUTH_PID",sn.pid),e.writeKeyValue("AUTH_SID",sn.userName);else{let s=0;if(this.changePassword?(fT.updatePasswordsWithComboKey(this.password,this.newPassword,this.conn.comboKey,this),s=2):(s=4,this.token?s+=1:(s+=2,this.verifierType===ce.TNS_VERIFIER_TYPE_11G_1||this.verifierType===ce.TNS_VERIFIER_TYPE_11G_2?t=!0:this.verifierType!==ce.TNS_VERIFIER_TYPE_12C?Od.throwErr(Od.ERR_UNSUPPORTED_VERIFIER_TYPE,this.verifierType.toString(16)):s+=1,fT.updateVerifierData(this.sessionData,this.password,this.newPassword,t,this),this.conn.comboKey=this.comboKey,this.newPassword&&(s+=1)),this.privateKey&&(s+=2),this.conn.connectionClass&&(s+=1),this.conn.purity&&(s+=1),this.conn.jdwpData&&(this.encryptedJDWPData=fT.getEncryptedJSWPData(this.sessionKey,this.conn.jdwpData),s+=1),this.schemaUser.length!==0&&(s+=1)),e.writeUInt8(1),e.writeUB4(s),e.writeUInt8(1),e.writeUInt8(1),this.userByteLen>0&&e.writeBytesWithLength(pT.from(this.username)),this.token?e.writeKeyValue("AUTH_TOKEN",this.token):this.changePassword||(e.writeKeyValue("AUTH_SESSKEY",this.sessionKey,1),t||e.writeKeyValue("AUTH_PBKDF2_SPEEDY_KEY",this.speedyKey)),this.changePassword||(e.writeKeyValue("SESSION_CLIENT_CHARSET","873"),e.writeKeyValue("SESSION_CLIENT_DRIVER_NAME",ce.DRIVER_NAME),e.writeKeyValue("SESSION_CLIENT_VERSION",ce.CLIENT_VERSION.toString()),e.writeKeyValue("AUTH_ALTER_SESSION",this.getAlterTimezoneStatement(),1)),this.encodedPassword&&e.writeKeyValue("AUTH_PASSWORD",this.encodedPassword),this.proxyStatus===0&&e.writeKeyValue("PROXY_CLIENT_NAME",this.schemaUser),this.encodedNewPassword&&e.writeKeyValue("AUTH_NEWPASSWORD",this.encodedNewPassword),this.conn.connectionClass&&e.writeKeyValue("AUTH_KPPL_CONN_CLASS",this.conn.connectionClass),this.conn.purity&&e.writeKeyValue("AUTH_KPPL_PURITY",""+this.conn.purity),this.privateKey){let a="date: "+new Date().toGMTString()+`
(request-target): `+this.serviceName+`
host: `+this.remoteAddress,c=oO.createSign("RSA-SHA256").update(a).sign(this.privateKey,"base64");e.writeKeyValue("AUTH_HEADER",a),e.writeKeyValue("AUTH_SIGNATURE",c)}this.conn.jdwpData&&e.writeKeyValue("AUTH_ORA_DEBUG_JDWP",this.encryptedJDWPData)}}processReturnParameter(e){let t=e.readUB2();for(let s=0;s<t;s++){e.skipUB4();let n=e.readStr(ce.CSFRM_IMPLICIT),i="";e.readUB4()>0&&(i=e.readStr(ce.CSFRM_IMPLICIT));let c=e.readUB4();n==="AUTH_VFR_DATA"&&(this.verifierType=c),this.sessionData[n]=i}if(this.functionCode===ce.TNS_FUNC_AUTH_PHASE_ONE)this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO;else{let s,n,i,a;this.conn.dbDomain=this.sessionData.AUTH_SC_DB_DOMAIN,this.conn.dbName=this.sessionData.AUTH_SC_DBUNIQUE_NAME,this.conn.maxOpenCursors=Number(this.sessionData.AUTH_MAX_OPEN_CURSORS||0),this.conn.serviceName=this.sessionData.AUTH_SC_SERVICE_NAME,this.conn.instanceName=this.sessionData.AUTH_INSTANCENAME;let c=Number(this.sessionData.AUTH_VERSION_NO),T=c>>24&255;this.conn.warning=this.warning,e.caps.ttcFieldVersion>=ce.TNS_CCAP_FIELD_VERSION_18_1_EXT_1?(s=c>>16&255,n=c>>12&15,i=c>>4&255,a=c&15):(s=c>>20&15,n=c>>12&255,i=c>>8&15,a=c&255),this.conn.serverVersionString=T+"."+s+"."+n+"."+i+"."+a,this.conn.serverVersion=T*1e8+s*1e6+n*1e4+i*100+a*1}}};_(RT,"AuthMessage");var PT=RT;yd.exports=PT});var Bd=m((UY,wd)=>{"use strict";var aO=Ct(),_O=Ue(),DT=class DT extends aO{constructor(e){super(e),this.functionCode=_O.TNS_FUNC_COMMIT}encode(e){this.writeFunctionHeader(e)}};_(DT,"CommitMessage");var IT=DT;wd.exports=IT});var Yd=m((MY,Ud)=>{"use strict";var o=Ue(),cO=Ct(),OT=class OT extends cO{processMessage(e,t){if(t===o.TNS_MSG_TYPE_DATA_TYPES){for(;e.readUInt16BE()!==0;)e.readUInt16BE()!==0&&e.skipBytes(4);this.endOfResponse=!this.connection.nscon.endOfRequestSupport}else super.processMessage(e,t)}encode(e){e.writeUInt8(o.TNS_MSG_TYPE_DATA_TYPES),e.writeUInt16LE(o.TNS_CHARSET_UTF8),e.writeUInt16LE(o.TNS_CHARSET_UTF8),e.writeUInt8(o.TNS_ENCODING_MULTI_BYTE|o.TNS_ENCODING_CONV_LENGTH),e.writeBytesWithLength(e.caps.compileCaps),e.writeBytesWithLength(e.caps.runtimeCaps);for(let t of TO)e.writeUInt16BE(t[0]),e.writeUInt16BE(t[1]),e.writeUInt16BE(t[2]),e.writeUInt16BE(0);e.writeUInt16BE(0)}};_(OT,"DataTypeMessage");var CT=OT,TO=[[o.TNS_DATA_TYPE_VARCHAR,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NUMBER,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_LONG,o.TNS_DATA_TYPE_LONG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DATE,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_RAW,o.TNS_DATA_TYPE_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LONG_RAW,o.TNS_DATA_TYPE_LONG_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB2,o.TNS_DATA_TYPE_UB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB4,o.TNS_DATA_TYPE_UB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SB1,o.TNS_DATA_TYPE_SB1,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_SB2,o.TNS_DATA_TYPE_SB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SB4,o.TNS_DATA_TYPE_SB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SWORD,o.TNS_DATA_TYPE_SWORD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UWORD,o.TNS_DATA_TYPE_UWORD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTRB,o.TNS_DATA_TYPE_PTRB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTRW,o.TNS_DATA_TYPE_PTRW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIDDEF,o.TNS_DATA_TYPE_TIDDEF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ROWID,o.TNS_DATA_TYPE_ROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AMS,o.TNS_DATA_TYPE_AMS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRN,o.TNS_DATA_TYPE_BRN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CWD,o.TNS_DATA_TYPE_CWD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC122,o.TNS_DATA_TYPE_OAC122,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER8,o.TNS_DATA_TYPE_OER8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FUN,o.TNS_DATA_TYPE_FUN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AUA,o.TNS_DATA_TYPE_AUA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH7,o.TNS_DATA_TYPE_RXH7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NA6,o.TNS_DATA_TYPE_NA6,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRP,o.TNS_DATA_TYPE_BRP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRV,o.TNS_DATA_TYPE_BRV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVA,o.TNS_DATA_TYPE_KVA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLS,o.TNS_DATA_TYPE_CLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CUI,o.TNS_DATA_TYPE_CUI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DFN,o.TNS_DATA_TYPE_DFN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DQR,o.TNS_DATA_TYPE_DQR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSC,o.TNS_DATA_TYPE_DSC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXE,o.TNS_DATA_TYPE_EXE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FCH,o.TNS_DATA_TYPE_FCH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GBV,o.TNS_DATA_TYPE_GBV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GEM,o.TNS_DATA_TYPE_GEM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GIV,o.TNS_DATA_TYPE_GIV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKG,o.TNS_DATA_TYPE_OKG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_HMI,o.TNS_DATA_TYPE_HMI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INO,o.TNS_DATA_TYPE_INO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LNF,o.TNS_DATA_TYPE_LNF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ONT,o.TNS_DATA_TYPE_ONT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OPE,o.TNS_DATA_TYPE_OPE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OSQ,o.TNS_DATA_TYPE_OSQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SFE,o.TNS_DATA_TYPE_SFE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SPF,o.TNS_DATA_TYPE_SPF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VSN,o.TNS_DATA_TYPE_VSN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD7,o.TNS_DATA_TYPE_UD7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSA,o.TNS_DATA_TYPE_DSA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PIN,o.TNS_DATA_TYPE_PIN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PFN,o.TNS_DATA_TYPE_PFN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PPT,o.TNS_DATA_TYPE_PPT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_STO,o.TNS_DATA_TYPE_STO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ARC,o.TNS_DATA_TYPE_ARC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRS,o.TNS_DATA_TYPE_MRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRT,o.TNS_DATA_TYPE_MRT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRG,o.TNS_DATA_TYPE_MRG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRR,o.TNS_DATA_TYPE_MRR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRC,o.TNS_DATA_TYPE_MRC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VER,o.TNS_DATA_TYPE_VER,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LON2,o.TNS_DATA_TYPE_LON2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INO2,o.TNS_DATA_TYPE_INO2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ALL,o.TNS_DATA_TYPE_ALL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UDB,o.TNS_DATA_TYPE_UDB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQI,o.TNS_DATA_TYPE_AQI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ULB,o.TNS_DATA_TYPE_ULB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ULD,o.TNS_DATA_TYPE_ULD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SID,o.TNS_DATA_TYPE_SID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NA7,o.TNS_DATA_TYPE_NA7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AL7,o.TNS_DATA_TYPE_AL7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_K2RPC,o.TNS_DATA_TYPE_K2RPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XDP,o.TNS_DATA_TYPE_XDP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKO8,o.TNS_DATA_TYPE_OKO8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD12,o.TNS_DATA_TYPE_UD12,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AL8,o.TNS_DATA_TYPE_AL8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LFOP,o.TNS_DATA_TYPE_LFOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FCRT,o.TNS_DATA_TYPE_FCRT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DNY,o.TNS_DATA_TYPE_DNY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OPR,o.TNS_DATA_TYPE_OPR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PLS,o.TNS_DATA_TYPE_PLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XID,o.TNS_DATA_TYPE_XID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TXN,o.TNS_DATA_TYPE_TXN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DCB,o.TNS_DATA_TYPE_DCB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CCA,o.TNS_DATA_TYPE_CCA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_WRN,o.TNS_DATA_TYPE_WRN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TLH,o.TNS_DATA_TYPE_TLH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TOH,o.TNS_DATA_TYPE_TOH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FOI,o.TNS_DATA_TYPE_FOI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SID2,o.TNS_DATA_TYPE_SID2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TCH,o.TNS_DATA_TYPE_TCH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PII,o.TNS_DATA_TYPE_PII,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PFI,o.TNS_DATA_TYPE_PFI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PPU,o.TNS_DATA_TYPE_PPU,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTE,o.TNS_DATA_TYPE_PTE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH8,o.TNS_DATA_TYPE_RXH8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_N12,o.TNS_DATA_TYPE_N12,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AUTH,o.TNS_DATA_TYPE_AUTH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVAL,o.TNS_DATA_TYPE_KVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FGI,o.TNS_DATA_TYPE_FGI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSY,o.TNS_DATA_TYPE_DSY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYR8,o.TNS_DATA_TYPE_DSYR8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYH8,o.TNS_DATA_TYPE_DSYH8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYL,o.TNS_DATA_TYPE_DSYL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYT8,o.TNS_DATA_TYPE_DSYT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYV8,o.TNS_DATA_TYPE_DSYV8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYP,o.TNS_DATA_TYPE_DSYP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYF,o.TNS_DATA_TYPE_DSYF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYK,o.TNS_DATA_TYPE_DSYK,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYY,o.TNS_DATA_TYPE_DSYY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYQ,o.TNS_DATA_TYPE_DSYQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYC,o.TNS_DATA_TYPE_DSYC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYA,o.TNS_DATA_TYPE_DSYA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OT8,o.TNS_DATA_TYPE_OT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYTY,o.TNS_DATA_TYPE_DSYTY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQE,o.TNS_DATA_TYPE_AQE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KV,o.TNS_DATA_TYPE_KV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQD,o.TNS_DATA_TYPE_AQD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQ8,o.TNS_DATA_TYPE_AQ8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RFS,o.TNS_DATA_TYPE_RFS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH10,o.TNS_DATA_TYPE_RXH10,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPN,o.TNS_DATA_TYPE_KPN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNR,o.TNS_DATA_TYPE_KPDNR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYD,o.TNS_DATA_TYPE_DSYD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYS,o.TNS_DATA_TYPE_DSYS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYR,o.TNS_DATA_TYPE_DSYR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYH,o.TNS_DATA_TYPE_DSYH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYT,o.TNS_DATA_TYPE_DSYT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYV,o.TNS_DATA_TYPE_DSYV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQM,o.TNS_DATA_TYPE_AQM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER11,o.TNS_DATA_TYPE_OER11,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQL,o.TNS_DATA_TYPE_AQL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OTC,o.TNS_DATA_TYPE_OTC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KFNO,o.TNS_DATA_TYPE_KFNO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KFNP,o.TNS_DATA_TYPE_KFNP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KGT8,o.TNS_DATA_TYPE_KGT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RASB4,o.TNS_DATA_TYPE_RASB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RAUB2,o.TNS_DATA_TYPE_RAUB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RAUB1,o.TNS_DATA_TYPE_RAUB1,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RATXT,o.TNS_DATA_TYPE_RATXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSSB4,o.TNS_DATA_TYPE_RSSB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSUB2,o.TNS_DATA_TYPE_RSUB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSUB1,o.TNS_DATA_TYPE_RSUB1,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSTXT,o.TNS_DATA_TYPE_RSTXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RIDL,o.TNS_DATA_TYPE_RIDL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDD,o.TNS_DATA_TYPE_GLRDD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDG,o.TNS_DATA_TYPE_GLRDG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDC,o.TNS_DATA_TYPE_GLRDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKO,o.TNS_DATA_TYPE_OKO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPP,o.TNS_DATA_TYPE_DPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPLS,o.TNS_DATA_TYPE_DPLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPMOP,o.TNS_DATA_TYPE_DPMOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_STAT,o.TNS_DATA_TYPE_STAT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RFX,o.TNS_DATA_TYPE_RFX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FAL,o.TNS_DATA_TYPE_FAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CKV,o.TNS_DATA_TYPE_CKV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DRCX,o.TNS_DATA_TYPE_DRCX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KGH,o.TNS_DATA_TYPE_KGH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQO,o.TNS_DATA_TYPE_AQO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKGT,o.TNS_DATA_TYPE_OKGT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPFC,o.TNS_DATA_TYPE_KPFC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FE2,o.TNS_DATA_TYPE_FE2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SPFP,o.TNS_DATA_TYPE_SPFP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPULS,o.TNS_DATA_TYPE_DPULS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQA,o.TNS_DATA_TYPE_AQA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPBF,o.TNS_DATA_TYPE_KPBF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TSM,o.TNS_DATA_TYPE_TSM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MSS,o.TNS_DATA_TYPE_MSS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPC,o.TNS_DATA_TYPE_KPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CRS,o.TNS_DATA_TYPE_CRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KKS,o.TNS_DATA_TYPE_KKS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSP,o.TNS_DATA_TYPE_KSP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSPTOP,o.TNS_DATA_TYPE_KSPTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSPVAL,o.TNS_DATA_TYPE_KSPVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PSS,o.TNS_DATA_TYPE_PSS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NLS,o.TNS_DATA_TYPE_NLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ALS,o.TNS_DATA_TYPE_ALS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSDEVTVAL,o.TNS_DATA_TYPE_KSDEVTVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSDEVTTOP,o.TNS_DATA_TYPE_KSDEVTTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPSPP,o.TNS_DATA_TYPE_KPSPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KOL,o.TNS_DATA_TYPE_KOL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LST,o.TNS_DATA_TYPE_LST,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ACX,o.TNS_DATA_TYPE_ACX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCS,o.TNS_DATA_TYPE_SCS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH,o.TNS_DATA_TYPE_RXH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNS,o.TNS_DATA_TYPE_KPDNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDCN,o.TNS_DATA_TYPE_KPDCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNNS,o.TNS_DATA_TYPE_KPNNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNCN,o.TNS_DATA_TYPE_KPNCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPS,o.TNS_DATA_TYPE_KPS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_APINF,o.TNS_DATA_TYPE_APINF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TEN,o.TNS_DATA_TYPE_TEN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSCS,o.TNS_DATA_TYPE_XSSCS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSSO,o.TNS_DATA_TYPE_XSSSO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSAO,o.TNS_DATA_TYPE_XSSAO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSRPC,o.TNS_DATA_TYPE_KSRPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVL,o.TNS_DATA_TYPE_KVL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSDEF,o.TNS_DATA_TYPE_XSSDEF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PDQCINV,o.TNS_DATA_TYPE_PDQCINV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PDQIDC,o.TNS_DATA_TYPE_PDQIDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDQCSTA,o.TNS_DATA_TYPE_KPDQCSTA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPRS,o.TNS_DATA_TYPE_KPRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDQIDC,o.TNS_DATA_TYPE_KPDQIDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RTSTRM,o.TNS_DATA_TYPE_RTSTRM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSGET,o.TNS_DATA_TYPE_SESSGET,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSREL,o.TNS_DATA_TYPE_SESSREL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSRET,o.TNS_DATA_TYPE_SESSRET,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN6,o.TNS_DATA_TYPE_SCN6,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KECPA,o.TNS_DATA_TYPE_KECPA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KECPP,o.TNS_DATA_TYPE_KECPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SXA,o.TNS_DATA_TYPE_SXA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVARR,o.TNS_DATA_TYPE_KVARR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNGN,o.TNS_DATA_TYPE_KPNGN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_INTEGER,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_FLOAT,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_STR,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VNU,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_PDN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_VCS,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VBI,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC9,o.TNS_DATA_TYPE_OAC9,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UIN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_SLS,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_LVC,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LVB,o.TNS_DATA_TYPE_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CHAR,o.TNS_DATA_TYPE_CHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AVC,o.TNS_DATA_TYPE_CHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_FLOAT,o.TNS_DATA_TYPE_BINARY_FLOAT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_DOUBLE,o.TNS_DATA_TYPE_BINARY_DOUBLE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CURSOR,o.TNS_DATA_TYPE_CURSOR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RDD,o.TNS_DATA_TYPE_ROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OSL,o.TNS_DATA_TYPE_OSL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXT_NAMED,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INT_NAMED,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXT_REF,o.TNS_DATA_TYPE_INT_REF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INT_REF,o.TNS_DATA_TYPE_INT_REF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLOB,o.TNS_DATA_TYPE_CLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BLOB,o.TNS_DATA_TYPE_BLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BFILE,o.TNS_DATA_TYPE_BFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CFILE,o.TNS_DATA_TYPE_CFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSET,o.TNS_DATA_TYPE_CURSOR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_JSON,o.TNS_DATA_TYPE_JSON,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DJSON,o.TNS_DATA_TYPE_DJSON,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLV,o.TNS_DATA_TYPE_CLV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DTR,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DUN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DOP,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_VST,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ODT,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DOL,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_TIME,o.TNS_DATA_TYPE_TIME,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIME_TZ,o.TNS_DATA_TYPE_TIME_TZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP,o.TNS_DATA_TYPE_TIMESTAMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP_TZ,o.TNS_DATA_TYPE_TIMESTAMP_TZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INTERVAL_YM,o.TNS_DATA_TYPE_INTERVAL_YM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INTERVAL_DS,o.TNS_DATA_TYPE_INTERVAL_DS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EDATE,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_ETIME,o.TNS_DATA_TYPE_ETIME,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ETTZ,o.TNS_DATA_TYPE_ETTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESTAMP,o.TNS_DATA_TYPE_ESTAMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESTZ,o.TNS_DATA_TYPE_ESTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EIYM,o.TNS_DATA_TYPE_EIYM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EIDS,o.TNS_DATA_TYPE_EIDS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DCLOB,o.TNS_DATA_TYPE_CLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DBLOB,o.TNS_DATA_TYPE_BLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DBFILE,o.TNS_DATA_TYPE_BFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UROWID,o.TNS_DATA_TYPE_UROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESITZ,o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB8,o.TNS_DATA_TYPE_UB8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PNTY,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BOOLEAN,o.TNS_DATA_TYPE_BOOLEAN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNSOP,o.TNS_DATA_TYPE_XSNSOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSATTR,o.TNS_DATA_TYPE_XSATTR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNS,o.TNS_DATA_TYPE_XSNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB1ARRAY,o.TNS_DATA_TYPE_UB1ARRAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSSTATE,o.TNS_DATA_TYPE_SESSSTATE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AC_REPLAY,o.TNS_DATA_TYPE_AC_REPLAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AC_CONT,o.TNS_DATA_TYPE_AC_CONT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_IMPLRES,o.TNS_DATA_TYPE_IMPLRES,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER19,o.TNS_DATA_TYPE_OER19,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TXT,o.TNS_DATA_TYPE_TXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSESSNS,o.TNS_DATA_TYPE_XSSESSNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSATTOP,o.TNS_DATA_TYPE_XSATTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSCREOP,o.TNS_DATA_TYPE_XSCREOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSDETOP,o.TNS_DATA_TYPE_XSDETOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSDESOP,o.TNS_DATA_TYPE_XSDESOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSETSP,o.TNS_DATA_TYPE_XSSETSP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSIDP,o.TNS_DATA_TYPE_XSSIDP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSPRIN,o.TNS_DATA_TYPE_XSPRIN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSKVL,o.TNS_DATA_TYPE_XSKVL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSSDEF2,o.TNS_DATA_TYPE_XSSSDEF2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNSOP2,o.TNS_DATA_TYPE_XSNSOP2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNS2,o.TNS_DATA_TYPE_XSNS2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNREQ,o.TNS_DATA_TYPE_KPDNREQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRNF,o.TNS_DATA_TYPE_KPDNRNF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNGNC,o.TNS_DATA_TYPE_KPNGNC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNRI,o.TNS_DATA_TYPE_KPNRI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQENQ,o.TNS_DATA_TYPE_AQENQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQDEQ,o.TNS_DATA_TYPE_AQDEQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQJMS,o.TNS_DATA_TYPE_AQJMS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRPAY,o.TNS_DATA_TYPE_KPDNRPAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRACK,o.TNS_DATA_TYPE_KPDNRACK,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRMP,o.TNS_DATA_TYPE_KPDNRMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRDQ,o.TNS_DATA_TYPE_KPDNRDQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN,o.TNS_DATA_TYPE_SCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN8,o.TNS_DATA_TYPE_SCN8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CHUNKINFO,o.TNS_DATA_TYPE_CHUNKINFO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD21,o.TNS_DATA_TYPE_UD21,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UDS,o.TNS_DATA_TYPE_UDS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TNP,o.TNS_DATA_TYPE_TNP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER,o.TNS_DATA_TYPE_OER,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC,o.TNS_DATA_TYPE_OAC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VECTOR,o.TNS_DATA_TYPE_VECTOR,o.TNS_TYPE_REP_UNIVERSAL]];Ud.exports=CT});var Vd=m((FY,Md)=>{"use strict";var lO=Ct(),EO=Ue(),yT=class yT extends lO{constructor(e){super(e),this.functionCode=EO.TNS_FUNC_LOGOFF}encode(e){this.writePiggybacks(e),this.writeFunctionHeader(e)}};_(yT,"LogOffMessage");var gT=yT;Md.exports=gT});var xd=m((bY,Fd)=>{"use strict";var uO=Ct(),hO=Ue(),wT=class wT extends uO{constructor(e){super(e),this.functionCode=hO.TNS_FUNC_PING}encode(e){this.writeFunctionHeader(e)}};_(wT,"PingMessage");var LT=wT;Fd.exports=LT});var kd=m((qY,bd)=>{"use strict";var BT=Ue(),NO=Ct(),YT=class YT extends NO{encode(e){e.writeUInt8(BT.TNS_MSG_TYPE_PROTOCOL),e.writeUInt8(6),e.writeUInt8(0),e.writeStr("node-oracledb"),e.writeUInt8(0)}processMessage(e,t){t===BT.TNS_MSG_TYPE_PROTOCOL?(this.processProtocolInfo(e),this.endOfResponse=!this.connection.nscon.endOfRequestSupport):super.processMessage(e,t)}processProtocolInfo(e){this.serverVersion=e.readUInt8(),e.skipUB1(),this.serverBanner=e.readNullTerminatedBytes(48),e.caps.charSetID=e.readUInt16LE(),this.serverFlags=e.readUInt8();let t=e.readUInt16LE();t>0&&e.skipBytes(t*5);let s=e.readUInt16BE(),n=e.readBytes(s),i=6+n[5]+n[6];e.caps.nCharsetId=(n[i+3]<<8)+n[i+4];let a=e.readBytesWithLength();a&&(this.serverCompileCaps=Buffer.from(a),e.caps.adjustForServerCompileCaps(this.serverCompileCaps,this.connection.nscon),e.caps.ttcFieldVersion>=BT.TNS_CCAP_FIELD_VERSION_23_1?this.connection._osonMaxFieldNameSize=65535:this.connection._osonMaxFieldNameSize=255);let c=e.readBytesWithLength();c&&(this.serverRunTimeCaps=Buffer.from(c),e.caps.adjustForServerRuntimeCaps(this.serverRunTimeCaps))}};_(YT,"ProtocolMessage");var UT=YT;bd.exports=UT});var Gd=m((vY,qd)=>{"use strict";var SO=Ct(),AO=Ue(),VT=class VT extends SO{constructor(e){super(e),this.functionCode=AO.TNS_FUNC_ROLLBACK}encode(e){this.writeFunctionHeader(e)}};_(VT,"RollbackMessage");var MT=VT;qd.exports=MT});var Kd=m((KY,Hd)=>{"use strict";var dO=Ct(),vd=Ue(),xT=class xT extends dO{constructor(e){super(e),this.functionCode=vd.TNS_FUNC_SESSION_RELEASE,this.messageType=vd.TNS_MSG_TYPE_ONEWAY_FN,this.sessReleaseMode=0}encode(e){this.writeFunctionHeader(e),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(this.sessReleaseMode)}decode(){}};_(xT,"SessionReleaseMessage");var FT=xT;Hd.exports=FT});var Xd=m((XY,Wd)=>{"use strict";var Ws=Ue(),pO=Ct(),kT=class kT extends pO{encode(e){e.writeUInt8(Ws.TNS_MSG_TYPE_FAST_AUTH),e.writeUInt8(1),e.writeUInt8(Ws.TNS_SERVER_CONVERTS_CHARS),e.writeUInt8(0),this.protocolMessage.encode(e),e.writeUInt16BE(0),e.writeUInt8(0),e.writeUInt16BE(0),e.caps.ttcFieldVersion=Ws.TNS_CCAP_FIELD_VERSION_19_1_EXT_1,e.writeUInt8(e.caps.ttcFieldVersion),this.dataTypeMessage.encode(e),this.authMessage.encode(e),e.caps.ttcFieldVersion=Ws.TNS_CCAP_FIELD_VERSION_MAX}processMessage(e,t){t===Ws.TNS_MSG_TYPE_RENEGOTIATE?this.reNegotiate=!0:t===Ws.TNS_MSG_TYPE_PROTOCOL?this.protocolMessage.processMessage(e,t):t===Ws.TNS_MSG_TYPE_DATA_TYPES?this.dataTypeMessage.processMessage(e,t):(this.authMessage.processMessage(e,t),this.endOfResponse=this.authMessage.endOfResponse)}};_(kT,"FastAuthMessage");var bT=kT;Wd.exports=bT});var $d=m(($Y,zd)=>{"use strict";var fO=Ct(),mO=Ue(),GT=class GT extends fO{constructor(e){super(e),this.functionCode=mO.TNS_FUNC_TPC_TXN_CHANGE_STATE}processReturnParameter(e){this.state=e.readUB4()}encode(e){let t;this.xid&&(t=Buffer.alloc(128),this.xid.globalTransactionId.copy(t),this.xid.branchQualifier.copy(t,this.xid.globalTransactionId.length)),this.writeFunctionHeader(e),e.writeUB4(this.operation),this.context?(e.writeUInt8(1),e.writeUB4(this.context.length)):(e.writeUInt8(0),e.writeUB4(0)),this.xid?(e.writeUB4(this.xid.formatId),e.writeUB4(this.xid.globalTransactionId.length),e.writeUB4(this.xid.branchQualifier.length),e.writeUInt8(1),e.writeUB4(t.length)):(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(0),e.writeUB4(this.state),e.writeUInt8(1),e.writeUB4(this.flags),this.context&&e.writeBytes(this.context),this.xid&&e.writeBytes(t)}};_(GT,"TransactionChangeStateMessage");var qT=GT;zd.exports=qT});var jd=m((jY,Qd)=>{"use strict";var PO=Ct(),RO=Ue(),HT=class HT extends PO{constructor(e){super(e),this.functionCode=RO.TNS_FUNC_TPC_TXN_SWITCH,this.applicationValue=0,this.internalName=e.internalName,this.internalName&&(this.internalName=Buffer.from(this.internalName)),this.externalName=e.externalName,this.externalName&&(this.externalName=Buffer.from(this.externalName))}processReturnParameter(e){this.applicationValue=e.readUB4(),this.contextLen=e.readUB2(),this.contextLen>0&&(this.context=Buffer.from(e.readBytes(this.contextLen)))}encode(e){let t;this.xid&&(t=Buffer.alloc(128),this.xid.globalTransactionId.copy(t),this.xid.branchQualifier.copy(t,this.xid.globalTransactionId.length)),this.writeFunctionHeader(e),e.writeUB4(this.operation),this.context?(e.writeUInt8(1),e.writeUB4(this.context.length)):(e.writeUInt8(0),e.writeUB4(0)),this.xid?(e.writeUB4(this.xid.formatId),e.writeUB4(this.xid.globalTransactionId.length),e.writeUB4(this.xid.branchQualifier.length),e.writeUInt8(1),e.writeUB4(t.length)):(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(this.flags),e.writeUB4(this.timeout),e.writeUInt8(1),e.writeUInt8(1),e.writeUInt8(1),this.internalName?(e.writeUInt8(1),e.writeUB4(this.internalName.length)):(e.writeUInt8(0),e.writeUB4(0)),this.externalName?(e.writeUInt8(1),e.writeUB4(this.externalName.length)):(e.writeUInt8(0),e.writeUB4(0)),this.context&&e.writeBytes(this.context),this.xid&&e.writeBytes(t),e.writeUB4(this.applicationValue),this.internalName&&e.writeBytes(this.internalName),this.externalName&&e.writeBytes(this.externalName)}};_(HT,"TransactionSwitchMessage");var vT=HT;Qd.exports=vT});var Zd=m((ZY,Jd)=>{"use strict";var IO=Ld(),DO=Bd(),CO=Yd(),OO=ec(),gO=rc(),yO=v_(),LO=Vd(),wO=xd(),BO=kd(),UO=Gd(),YO=Kd(),MO=Xd(),VO=$d(),FO=jd();Jd.exports={AuthMessage:IO,CommitMessage:DO,FastAuthMessage:MO,DataTypeMessage:CO,ExecuteMessage:OO,FetchMessage:gO,LobOpMessage:yO,LogOffMessage:LO,PingMessage:wO,ProtocolMessage:BO,RollbackMessage:UO,SessionReleaseMessage:YO,TransactionChangeStateMessage:VO,TransactionSwitchMessage:FO}});var sp=m((eM,tp)=>{var ep=W(),{Statement:xO}=ST(),WT=class WT{constructor(e){this._cachedStatements=new Map,this._maxSize=e,this._cursorsToClose=new Set,this._openCursors=new Set}_addCursorToClose(e){if(this._cursorsToClose.has(e.cursorId)){let t=`attempt to close cursor ${e.cursorId} twice`;ep.throwErr(ep.ERR_INTERNAL,t)}e.cursorId!=0&&this._cursorsToClose.add(e.cursorId),this._openCursors.delete(e)}_adjustCache(){for(;this._cachedStatements.size>this._maxSize;){let e=this._cachedStatements.keys().next().value,t=this._cachedStatements.get(e);this._cachedStatements.delete(e),t.inUse?t.returnToCache=!1:t.cursorId!==0&&this._addCursorToClose(t)}}clearCursors(){let e=new Set;for(let t of this._openCursors)(t.inUse||t.returnToCache)&&(t.pendingClear=!0,e.add(t)),t._clearState();this._openCursors=e,this._cursorsToClose.clear()}clearPendingStatus(){for(let e of this._openCursors)e.pendingClear&&!e.inUse&&(e._clearAllState(),e.pendingClear=!1)}getStatement(e,t=!1,s=!1){let n=null;return e&&(n=this._cachedStatements.get(e)),n?s||n.inUse?(t||(this._addCursorToClose(n),this._cachedStatements.delete(e)),n=n._copy(),this._openCursors.add(n)):t?(this._cachedStatements.delete(e),this._cachedStatements.set(e,n)):(this._cachedStatements.delete(e),n.returnToCache=!1):(n=new xO,e&&n._prepare(e),t&&!n.isDdl&&this._maxSize>0&&(n.returnToCache=!0,this._cachedStatements.set(e,n),this._adjustCache()),this._openCursors.add(n)),this._openCursors.add(n),n.inUse=!0,n}clearCursor(e){this._addCursorToClose(e),e.cursorId=0}returnStatement(e){e.bindInfoList&&e.bindInfoList.forEach(t=>{t.bindVar=null}),e.queryVars&&e.queryVars.forEach(t=>{t.values.fill(null)}),e.returnToCache?e.inUse=!1:this._addCursorToClose(e),this.clearPendingStatus()}writeCursorsToClose(e){e.writeUB4(this._cursorsToClose.size);for(let t of this._cursorsToClose.keys())e.writeUB4(t);this._cursorsToClose.clear()}};_(WT,"StatementCache");var KT=WT;tp.exports=KT});var JT=m((sM,ip)=>{"use strict";var{Buffer:rp}=require("buffer"),bO=xn(),kO=oc(),XT=Wr(),qO=bA(),{BaseBuffer:GO}=ar(),{NetworkSession:vO}=TT(),{Statement:HO}=ST(),Di=Qr(),Cr=mr(),X=Ue(),np=require("process"),se=Tt(),Ke=W(),ot=Zd(),KO=sp(),WO=new global.FinalizationRegistry(r=>{r.disconnect()}),QT=class QT extends GO{};_(QT,"TDSBuffer");var zT=QT,jT=class jT extends bO{async close(){try{if(this._protocol.txnInProgress){if(this.tpcContext){let e=this.createTpcRollbackMessage();await this._protocol._processMessage(e)}else await this.rollback();this.tpcContext=null}if(this._drcpEnabled&&(await this._sessRelease(),this._drcpEstablishSession=!0),this._pool&&!this._dropSess)await this._pool.release(this);else{if(!this._drcpEnabled){let e=new ot.LogOffMessage(this);await this._protocol._processMessage(e)}this.nscon.disconnect()}}catch{this.nscon.disconnect(Cr.NSFIMM)}}async _sessRelease(){let e=new ot.SessionReleaseMessage(this);this.isPooled()||(e.sessReleaseMode=X.DRCP_DEAUTHENTICATE),await this._protocol._processMessage(e)}async _getElementTypeObj(e){let t=[{name:"owner",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.schema]},{name:"name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.name]},{name:"package_name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.packageName]}],s;e.packageName?s=`
        select
            elem_type_owner,
            elem_type_name,
            elem_type_package
        from all_plsql_coll_types
        where owner = :owner
          and type_name = :name
          and package_name = :package_name`:(t.pop(),s=`
        select
            elem_type_owner,
            elem_type_name
        from all_coll_types
        where owner = :owner
          and type_name = :name`);let n={connection:{_impl:this},prefetchRows:2},i=await this.execute(s,1,t,n,!1),a=await i.resultSet.getRows(1,n);await i.resultSet.close();let c=a[0];e.elementTypeClass=this._getDbObjectType(c[0],c[1],c[2]),e.elementTypeClass.partial&&this._partialDbObjectTypes.push(e.elementTypeClass)}async _execute(e,t,s,n,i){let a=e.bindInfoList.length,c=s.length;a!==c&&(c===0||!s[0].name)&&Ke.throwErr(Ke.ERR_WRONG_NUMBER_OF_POSITIONAL_BINDS,a,c);for(let E=0;E<s.length;E++)await this._bind(e,s[E],E+1);e.isPlSql&&(n.batchErrors||n.dmlRowCounts)&&Ke.throwErr(Ke.ERR_EXEC_MODE_ONLY_FOR_DML);let T=new ot.ExecuteMessage(this,e,n);T.numExecs=t,T.arrayDmlRowCounts=n.dmlRowCounts,T.batchErrors=n.batchErrors,e.isPlSql&&(e.cursorId===0||e.requiresFullExecute)&&(T.numExecs=1,T.noImplicitRelease=!0,await this._protocol._processMessage(T),e.requiresFullExecute=!1,T.numExecs=t-1,T.offset=1,T.noImplicitRelease=!1),T.numExecs>0&&(await this._protocol._processMessage(T),e.requiresFullExecute=!1),e.requiresDefine&&e.sql&&(e.requiresFullExecute=!0,await this._protocol._processMessage(T),e.requiresFullExecute=!1,e.requiresDefine=!1);let l={};if(T.warning&&(l.warning=T.warning),e.numQueryVars>0)l.resultSet=T.resultSet;else{e.bufferRowIndex=0;let E=Di.getOutBinds(e,t,i);E&&(l.outBinds=E),i?(e.isPlSql||(l.rowsAffected=e.rowCount,delete e.rowCount),n.dmlRowCounts&&(l.dmlRowCounts=n.dmlRowCounts),n.batchErrors&&(l.batchErrors=n.batchErrors)):(e.isPlSql&&n.implicitResultSet&&(l.implicitResults=n.implicitResultSet),e.lastRowid&&(l.lastRowid=e.lastRowid,delete e.lastRowid),e.isPlSql?e.rowCount&&(l.rowsAffected=e.rowCount):l.rowsAffected=e.rowCount||0,e.rowCount&&delete e.rowCount),this._returnStatement(e)}return l}_parseTDSAttr(e,t){let s,n,i;for(;;)if(i=e.readUInt8(),i===X.TNS_OBJ_TDS_TYPE_EMBED_ADT_INFO)e.skipBytes(1);else if(i!==X.TNS_OBJ_TDS_TYPE_SUBTYPE_MARKER)break;switch(i){case X.TNS_OBJ_TDS_TYPE_NUMBER:return t.precision=e.readInt8(),t.scale=e.readInt8(),se.DB_TYPE_NUMBER;case X.TNS_OBJ_TDS_TYPE_FLOAT:return t.precision=e.readInt8(),se.DB_TYPE_NUMBER;case X.TNS_OBJ_TDS_TYPE_VARCHAR:case X.TNS_OBJ_TDS_TYPE_CHAR:return t.maxSize=e.readUInt16BE(),s=i===X.TNS_OBJ_TDS_TYPE_VARCHAR?X.TNS_DATA_TYPE_VARCHAR:X.TNS_DATA_TYPE_CHAR,n=e.readUInt8(),n=n&127,e.skipBytes(2),se.getTypeByOraTypeNum(s,n);case X.TNS_OBJ_TDS_TYPE_RAW:return t.maxSize=e.readUInt16BE(),se.DB_TYPE_RAW;case X.TNS_OBJ_TDS_TYPE_BINARY_FLOAT:return se.DB_TYPE_BINARY_FLOAT;case X.TNS_OBJ_TDS_TYPE_BINARY_DOUBLE:return se.DB_TYPE_BINARY_DOUBLE;case X.TNS_OBJ_TDS_TYPE_DATE:return se.DB_TYPE_DATE;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP_LTZ:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP_LTZ;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP_TZ:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP_TZ;case X.TNS_OBJ_TDS_TYPE_BOOLEAN:return se.DB_TYPE_BOOLEAN;case X.TNS_OBJ_TDS_TYPE_CLOB:return se.DB_TYPE_CLOB;case X.TNS_OBJ_TDS_TYPE_BLOB:return se.DB_TYPE_BLOB;case X.TNS_OBJ_TDS_TYPE_OBJ:return e.skipBytes(5),se.DB_TYPE_OBJECT;case X.TNS_OBJ_TDS_TYPE_START_EMBED_ADT:for(;this._parseTDSAttr(e,{})!==0;);return se.DB_TYPE_OBJECT;case X.TNS_OBJ_TDS_TYPE_END_EMBED_ADT:return 0;default:Ke.throwErr(Ke.ERR_TDS_TYPE_NOT_SUPPORTED,i)}}async _parseTDS(e,t){let s=new zT(e);s.skipBytes(4),s.skipBytes(2),s.skipBytes(2);let n=s.readUInt16BE();if(s.skipBytes(1),s.skipBytes(1),s.skipBytes(2),s.skipBytes(4),t.isCollection=!1,n===1){let i=s.pos;s.readUInt8()===X.TNS_OBJ_TDS_TYPE_COLL?t.isCollection=!0:s.pos=i}if(t.isCollection){let i=s.readUInt32BE();t.maxNumElements=s.readUInt32BE(),t.collectionType=s.readUInt8(),t.collectionType===X.TNS_OBJ_PLSQL_INDEX_TABLE&&(t.collectionFlags=X.TNS_OBJ_HAS_INDEXES),s.pos=i,t.elementTypeInfo={},t.elementType=this._parseTDSAttr(s,t.elementTypeInfo),t.elementType===se.DB_TYPE_OBJECT&&(await this._getElementTypeObj(t),t.elementTypeClass.isXmlType&&(t.elementType=se.DB_TYPE_XMLTYPE))}else if(t.attributes)for(let i of t.attributes)this._parseTDSAttr(s,i)}async _populateDbObjectTypeInfo(e){let t=`
      declare
          t_Instantiable              varchar2(3);
          t_SuperTypeOwner            varchar2(128);
          t_SuperTypeName             varchar2(128);
          t_SubTypeRefCursor          sys_refcursor;
          t_Pos                       pls_integer;
      begin
          :ret_val := dbms_pickler.get_type_shape(:full_name, :oid,
              :version, :tds, t_Instantiable, t_SuperTypeOwner,
              t_SuperTypeName, :attrs_rc, t_SubTypeRefCursor);
          :package_name := null;
          if substr(:full_name, length(:full_name) - 7) = '%ROWTYPE' then
              t_Pos := instr(:full_name, '.');
              :schema := substr(:full_name, 1, t_Pos - 1);
              :name := substr(:full_name, t_Pos + 1);
          else
              begin
                  select owner, type_name
                  into :schema, :name
                  from all_types
                  where type_oid = :oid;
              exception
              when no_data_found then
                  begin
                      select owner, package_name, type_name
                      into :schema, :package_name, :name
                      from all_plsql_types
                      where type_oid = :oid;
                  exception
                  when no_data_found then
                      null;
                  end;
              end;
          end if;
      end;`,s=`
      SELECT
        column_name,
        data_type,
        data_type_owner,
        case
          when data_type in
            ('CHAR', 'NCHAR', 'VARCHAR2', 'NVARCHAR2', 'RAW')
          then data_length
          else 0
        end,
        nvl(data_precision, 0),
        nvl(data_scale, 0)
      from all_tab_cols
      where owner = :owner
        and table_name = :name
        and hidden_column != 'YES'
      order by column_id`,n=[{name:"full_name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_INOUT,maxSize:500,values:[e]},{name:"ret_val",type:se.DB_TYPE_BINARY_INTEGER,dir:X.BIND_OUT,values:[]},{name:"oid",type:se.DB_TYPE_RAW,maxSize:16,dir:X.BIND_OUT,values:[]},{name:"version",type:se.DB_TYPE_BINARY_INTEGER,dir:X.BIND_OUT,values:[]},{name:"tds",type:se.DB_TYPE_RAW,maxSize:2e3,dir:X.BIND_OUT,values:[]},{name:"attrs_rc",type:se.DB_TYPE_CURSOR,dir:X.BIND_OUT,values:[]},{name:"package_name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]},{name:"schema",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]},{name:"name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]}],i={connection:{_impl:this},nullifyInvalidCursor:!0},a=await this.execute(t,1,n,i,!1);a.outBinds.ret_val!==0&&Ke.throwErr(Ke.ERR_INVALID_OBJECT_TYPE_NAME,e);let c=this._getDbObjectType(a.outBinds.schema,a.outBinds.name,a.outBinds.package_name,a.outBinds.oid);if(!c.partial)return c;if(c.name.endsWith("%ROWTYPE")){let T=[{name:"owner",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_IN,values:[a.outBinds.schema]},{name:"name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_IN,values:[c.name.substring(0,c.name.length-8)]}],E=await(await this.execute(s,1,T,i,!1)).resultSet._getAllRows();c.attributes=[];for(let u of E){let p={name:u[0],dataType:u[1],dataTypeOwner:u[2],maxSize:u[3],dataPrecision:u[4],dataScale:u[5]};if(!p.dataTypeOwner){let A=u[1].indexOf("("),h=u[1].indexOf(")");h>A&&(p.dataType=p.dataType.substring(0,A)+p.dataType.substring(h+1,p.dataType.length))}this._addAttr(c.attributes,p)}}else{c.version=a.outBinds.version;let T=await a.outBinds.attrs_rc._getAllRows();if(T.length>0){c.attributes=[];for(let l of T){let E={name:l[1],dataType:l[3],dataTypeOwner:l[4],packageName:l[5],oid:l[6]};this._addAttr(c.attributes,E)}}await this._parseTDS(a.outBinds.tds,c)}return c.partial=!1,c}_addAttr(e,t){let s={name:t.name};t.dataTypeOwner?(s.type=se.DB_TYPE_OBJECT,s.typeClass=this._getDbObjectType(t.dataTypeOwner,t.dataType,t.packageName,t.oid),s.typeClass.isXmlType&&(s.type=se.DB_TYPE_XMLTYPE),s.typeClass.partial&&this._partialDbObjectTypes.push(s.typeClass)):(s.type=se.getTypeByColumnTypeName(t.dataType),s.maxSize=t.maxSize,s.precision=t.dataPrecision,s.scale=t.dataScale),e.push(s)}async _populatePartialDbObjectTypes(){for(;this._partialDbObjectTypes.length>0;){let e=this._partialDbObjectTypes.pop(),t="%ROWTYPE",s=e.name;s.endsWith(t)?s=s.substring(0,s.length-t.length):t="";let n;e.packageName?n=`"${e.schema}"."${e.packageName}"."${s}"${t}`:n=`"${e.schema}"."${s}"${t}`,await this._populateDbObjectTypeInfo(n)}}async commit(){let e=new ot.CommitMessage(this);await this._protocol._processMessage(e)}async breakExecution(){await this._protocol.breakMessage()}isHealthy(){try{return this.nscon.recvInbandNotif()===0}catch{return!1}}isPooled(){return!!this._pool}async connect(e){e.connectString||Ke.throwErr(Ke.ERR_EMPTY_CONNECT_STRING),Di.checkCredentials(e),this.sessionID=0,this.serialNum=0,this.autoCommit=!1,this.serverVersion="",this.statementCache=null,this.currentSchema="",this.invokeSessionCallback=!0,this.statementCacheSize=e.stmtCacheSize,this._currentSchemaModified=!1,this._tempLobsToClose=[],this._tempLobsTotalSize=0,this._drcpEstablishSession=!1,this._cclass=null,this._clientIdentifier="",this._clientIdentifierModified=!1,this._action="",this._actionModified=!1,this._dbOp="",this._dbOpModified=!1,this._clientInfo="",this._clientInfoModified=!1,this._module="",this._moduleModified=!1,this._drcpEnabled=!1,this.serviceName="",this.remoteAddress="",this.comboKey=null,this.tpcContext=null,this.nscon=new vO,WO.register(this,this.nscon),await this.nscon.connect(e);let t;this.isPooled()?(t=e._connInfo[0],this.serviceName=e._connInfo[2],this.purity=e._connInfo[3]|X.PURITY_DEFAULT,this.sid=e._connInfo[4]):(t=this.nscon.getOption(Cr.SERVERTYPE),this.serviceName=this.nscon.getOption(Cr.SVCNAME),this.sid=this.nscon.getOption(Cr.SID),this.purity=this.nscon.getOption(Cr.PURITY)|X.PURITY_DEFAULT),t&&(this._drcpEnabled=t.toLowerCase()==="pooled"),this.remoteAddress=this.nscon.getOption(Cr.REMOTEADDR),this.connectionClass=e.connectionClass,this.purity===X.PURITY_DEFAULT&&this._drcpEnabled&&(this.isPooled()?this.purity=X.PURITY_SELF:this.purity=X.PURITY_NEW),this._protocol=new qO(this),this._protocol.caps.protocolVersion<X.TNS_VERSION_MIN_ACCEPTED&&Ke.throwErr(Ke.ERR_SERVER_VERSION_NOT_SUPPORTED);try{let s=new ot.ProtocolMessage(this),n=new ot.DataTypeMessage(this),i=new ot.AuthMessage(this,e);if(this.nscon.supportsFastAuth){let a=new ot.FastAuthMessage(this);a.protocolMessage=s,a.dataTypeMessage=n,a.authMessage=i,await this._protocol._processMessage(a),a.reNegotiate&&(await this._protocol._processMessage(n),await this._protocol._processMessage(i))}else await this._protocol._processMessage(s),await this._protocol._processMessage(n),await this._protocol._processMessage(i);e.token||await this._protocol._processMessage(i)}catch(s){throw this.nscon.disconnect(),s}this.statementCache=new KO(this.statementCacheSize),this._partialDbObjectTypes=[],e.debugJDWP?this.jdwpData=rp.from(e.debugJDWP):np.env.ORA_DEBUG_JDWP&&(this.jdwpData=rp.from(np.env.ORA_DEBUG_JDWP)),this._protocol.connInProgress=!1}_returnStatement(e){this.statementCache.returnStatement(e)}_prepare(e,t){let s=this._getStatement(e,t.keepInStmtCache);return s.bufferRowIndex=0,s.bufferRowCount=0,s.lastRowIndex=0,s.moreRowsToFetch=!0,s}async _bind(e,t,s=0){let n=e.bindInfoDict,i=e.bindInfoList;if(e.isPlSql&&t.maxSize>32767){t.type===se.DB_TYPE_RAW||t.type===se.DB_TYPE_LONG_RAW?t.type=se.DB_TYPE_BLOB:t.type._csfrm===X.CSFRM_NCHAR?t.type=se.DB_TYPE_NCLOB:t.type=se.DB_TYPE_CLOB;let a=t.maxSize;delete t.maxSize,t.outConverter=async function(c){if(c===null)return null;let T=await c.getData(),l=c._length;return T&&l>a&&Ke.throwErr(Ke.ERR_INSUFFICIENT_BUFFER_FOR_BINDS),T}}if(t.type===se.DB_TYPE_CLOB||t.type===se.DB_TYPE_NCLOB||t.type===se.DB_TYPE_BLOB){for(let[a,c]of t.values.entries())if(!(c instanceof XT))if(c&&c.length>0){let T=new XT;await T.create(this,t.type),await T.write(1,c),t.values[a]=T}else t.values[a]=null}if(t.name){let a;t.name.startsWith('"')&&t.name.endsWith('"')?a=t.name.substring(1,t.name.length-1):a=t.name.toUpperCase(),a.startsWith(":")&&(a=t.name.substring(1)),n.has(a)||Ke.throwErr(Ke.ERR_INVALID_BIND_NAME,a),n.get(a).forEach(c=>{e._setVariable(c,t)})}else{let a=i[s-1];e._setVariable(a,t)}}_createResultSet(e,t){let s=new kO;if(t||(t=new HO),s._resultSetNew(this,t,e),t.queryVars.length>0){let n=Di.getMetadataMany(t.queryVars);s._setup(e,n)}return s}async getDbObjectClass(e){let t=await this._populateDbObjectTypeInfo(e);return await this._populatePartialDbObjectTypes(),t}async getStatementInfo(e){let t={},s={},n=this._prepare(e,t);t.connection=this;try{if(!n.isDdl){let i=new ot.ExecuteMessage(this,n,t);i.parseOnly=!0,await this._protocol._processMessage(i)}return n.numQueryVars>0&&(s.metaData=Di.getMetadataMany(n.queryVars)),s.bindNames=Array.from(n.bindInfoDict.keys()),s.statementType=n.statementType,s}finally{this._returnStatement(n)}}async execute(e,t,s,n,i){let a=this._prepare(e,n);try{return await this._execute(a,t,s,n,i)}catch(c){throw this._returnStatement(a),c}}_getStatement(e,t=!1){return this.statementCache.getStatement(e,t,this._drcpEstablishSession)}async ping(){let e=new ot.PingMessage(this);await this._protocol._processMessage(e)}async rollback(){let e=new ot.RollbackMessage(this);await this._protocol._processMessage(e)}getOracleServerVersion(){return this.serverVersion}getOracleServerVersionString(){return this.serverVersionString}setCurrentSchema(e){this._currentSchemaModified=!0,this.currentSchema=e}getCurrentSchema(){return this.currentSchema}setClientId(e){this._clientIdentifierModified=!0,this._clientIdentifier=e}setDbOp(e){this._dbOpModified=!0,this._dbOp=e}setExternalName(e){this.externalName=e}setInternalName(e){this.internalName=e}setClientInfo(e){this._clientInfoModified=!0,this._clientInfo=e}setModule(e){this._moduleModified=!0,this._module=e,this._actionModified=!0}setAction(e){this._actionModified=!0,this._action=e}async changePassword(e,t,s){let n={user:e,newPassword:s,password:t,changePassword:!0},i=new ot.AuthMessage(this,n);await this._protocol._processMessage(i)}async createLob(e){let t=new XT;return await t.create(this,e),t}checkTpcCommitState(e,t){(t&&e!==X.TNS_TPC_TXN_STATE_READ_ONLY&&e!==X.TNS_TPC_TXN_STATE_COMMITTED||!t&&e!==X.TNS_TPC_TXN_STATE_FORGOTTEN)&&Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,e)}createTpcCommitMessage(e,t){let s=new ot.TransactionChangeStateMessage(this);return s.operation=X.TNS_TPC_TXN_COMMIT,s.state=t==0?X.TNS_TPC_TXN_STATE_COMMITTED:X.TNS_TPC_TXN_STATE_READ_ONLY,s.xid=e,s.context=this.tpcContext,s}createTpcRollbackMessage(e=null){let t=new ot.TransactionChangeStateMessage(this);return t.operation=X.TNS_TPC_TXN_ABORT,t.state=X.TNS_TPC_TXN_STATE_ABORTED,t.xid=e,t.context=this.tpcContext,t}async tpcBegin(e,t,s){let n=new ot.TransactionSwitchMessage(this);n.operation=X.TNS_TPC_TXN_START,n.xid=e,n.flags=t,n.timeout=s,await this._protocol._processMessage(n),this.tpcContext=n.context}async tpcCommit(e,t){let s=this.createTpcCommitMessage(e,t);await this._protocol._processMessage(s),this.checkTpcCommitState(s.state,t)}async tpcEnd(e,t){let s=new ot.TransactionSwitchMessage(this);s.operation=X.TNS_TPC_TXN_DETACH,s.xid=e,s.context=this.tpcContext,s.flags=t,await this._protocol._processMessage(s),this.tpcContext=null}async tpcPrepare(e){let t=new ot.TransactionChangeStateMessage(this);if(t.operation=X.TNS_TPC_TXN_PREPARE,t.xid=e,t.context=this.tpcContext,await this._protocol._processMessage(t),t.state===X.TNS_TPC_TXN_STATE_REQUIRES_COMMIT)return!0;if(t.state===X.TNS_TPC_TXN_STATE_READ_ONLY)return!1;Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,t.state)}async tpcRollback(e){let t=this.createTpcRollbackMessage(e);await this._protocol._processMessage(t),t.state!==X.TNS_TPC_TXN_STATE_ABORTED&&Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,t.state)}getStmtCacheSize(){return this.statementCache._maxSize}setCallTimeout(e){this._protocol.callTimeout=e}getCallTimeout(){return this._protocol.callTimeout}getTag(){return""}getExternalName(){return this.externalName}getInstanceName(){return this.instanceName}getInternalName(){return this.internalName}getDbDomain(){return this.dbDomain}getDbName(){return this.dbName}getMaxOpenCursors(){return this.maxOpenCursors}getServiceName(){return this.serviceName}getTransactionInProgress(){return this._protocol.txnInProgress}getWarning(){return this.warning}};_(jT,"ThinConnectionImpl");var $T=jT;ip.exports=$T});var ap=m((nM,op)=>{"use strict";var XO=pa(),zO=JT(),ft=Hr(),Bs=W(),$O=Ft(),ZT=et(),QO=Qr(),{getConnectionInfo:jO}=TT(),JO=require("crypto"),ZO=require("events"),eg=require("timers"),tl=class tl extends XO{_init(e){if(e.homogeneous||Bs.throwErr(Bs.ERR_NOT_IMPLEMENTED,"Heterogeneous Pooling"),QO.checkCredentials(e),this._availableObjects=[],this._name="node-thin",this._poolMin=e.poolMin,this._poolMax=e.poolMax,this._poolIncrement=e.poolIncrement,this._poolTimeout=e.poolTimeout,this._poolPingInterval=e.poolPingInterval,this._poolPingTimeout=e.poolPingTimeout,this._stmtCacheSize=e.stmtCacheSize,this._userConfig=e,this._freeConnectionList=[],this._usedConnectionList=new Set,this._password=e.password,this._walletPassword=e.walletPassword,this._walletContent=e.walletContent,this._obfuscatedPassword=[],this._obfuscatedWalletPassword=[],this._token=e.token,this._obfuscatedToken=[],this._privateKey=e.privateKey,this._obfuscatedPrivateKey=[],this._schedulerJob=null,this._poolCloseWaiter=null,this._pendingRequests=[],this._password!==void 0){let t=ft.setObfuscatedValue(this._password);this._password=t.value,this._obfuscatedPassword=t.obfuscatedValue,this._userConfig.password=null}if(this._walletPassword!==void 0){let t=ft.setObfuscatedValue(this._walletPassword);this._walletPassword=t.value,this._obfuscatedWalletPassword=t.obfuscatedValue,this._userConfig.walletPassword=null}if(this._walletContent!==void 0){let t=ft.setObfuscatedValue(this._walletContent);this._walletContent=t.value,this._obfuscatedWalletContent=t.obfuscatedValue,this._userConfig.walletConent=null}if(this._token!==void 0){let t=ft.setObfuscatedValue(this._token);this._token=t.value,this._obfuscatedToken=t.obfuscatedValue,this._userConfig.token=null}if(this._privateKey!==void 0){let t=ft.setObfuscatedValue(this._privateKey);this._privateKey=t.value,this._obfuscatedPrivateKey=t.obfuscatedValue,this._userConfig.privateKey=null}this._accessTokenFn=e.accessTokenFn,this._accessTokenConfig=e.accessTokenConfig,this._isDRCPEnabled=!1,this._implicitPool=null,this.eventEmitter=new ZO,this.eventEmitter.on("_removePoolConnection",async t=>{await this._destroy(t)})}async create(e){this._init(e),this._userConfig._connInfo=await jO(e),this._isDRCPEnabled=String(this._userConfig._connInfo[0]).toLowerCase()==="pooled",this._isDRCPEnabled&&$O.connectionClass===""&&this._generateConnectionClass(),this.bgThreadFunc()}setAccessToken(e){if(e.token){this._token=e.token;let t=ft.setObfuscatedValue(this._token);this._token=t.value,this._obfuscatedToken=t.obfuscatedValue}if(e.privateKey){this._privateKey=e.privateKey;let t=ft.setObfuscatedValue(this._privateKey);this._privateKey=t.value,this._obfuscatedPrivateKey=t.obfuscatedValue}}async _getConnAttrs(){let e,t=Object.assign({},this._userConfig);if(t.password===null&&(t.password=ft.getDeobfuscatedValue(this._password,this._obfuscatedPassword)),t.walletPassword===null&&(t.walletPassword=ft.getDeobfuscatedValue(this._walletPassword,this._obfuscatedWalletPassword)),t.walletContent===null&&(t.walletContent=ft.getDeobfuscatedValue(this._walletContent,this._obfuscatedWalletContent)),t.token===null&&(t.token=ft.getDeobfuscatedValue(this._token,this._obfuscatedToken),ZT.isTokenExpired(t.token)))if(typeof this._accessTokenFn=="function"){if(e=await this._accessTokenFn(!0,this._accessTokenConfig),typeof e=="string")if(t.token=e,ZT.isTokenExpired(t.token))Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);else{let s=ft.setObfuscatedValue(t.token);this._token=s.value,this._obfuscatedToken=s.obfuscatedValue}else if(typeof e=="object")if(t.token=e.token,t.privateKey=e.privateKey,ZT.isTokenExpired(t.token))Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);else{let s=ft.setObfuscatedValue(t.token);this._token=s.value,this._obfuscatedToken=s.obfuscatedValue;let n=ft.setObfuscatedValue(t.privateKey);this._privateKey=n.value,this._obfuscatedPrivateKey=n.obfuscatedValue}}else Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);return t.privateKey===null&&(t.privateKey=ft.getDeobfuscatedValue(this._privateKey,this._obfuscatedPrivateKey)),t}async getConnection(){return await this.acquire()}async _destroy(e){e.nscon.ntAdapter.connected&&(e._dropSess=!0,await e.close())}async close(){await new Promise(e=>{this._poolCloseWaiter=e,this.bgWaiter&&this.bgWaiter()}),this._schedulerJob&&(clearTimeout(this._schedulerJob),this._schedulerJob=null);for(let e of this._freeConnectionList)await this._destroy(e);for(let e of this._usedConnectionList)await this._destroy(e);this.eventEmitter.removeAllListeners()}getPoolMax(){return this._poolMax}getPoolMin(){return this._poolMin}getConnectionsInUse(){return this._usedConnectionList.size}getConnectionsOpen(){return this._freeConnectionList.length+this._usedConnectionList.size}getPoolIncrement(){return this._poolIncrement}getPoolMaxPerShard(){}getPoolPingInterval(){return this._poolPingInterval}getPoolPingTimeout(){return this._poolPingTimeout}getPoolTimeout(){return this._poolTimeout}getSodaMetaDataCache(){}getStmtCacheSize(){return this._stmtCacheSize}_setScheduler(){!this._schedulerJob&&this._poolTimeout>0&&this._freeConnectionList.length>0&&this._freeConnectionList.length+this._usedConnectionList.size>this._poolMin&&(this._schedulerJob=setTimeout(()=>{this._scanIdleConnection()},this._poolTimeout*1e3))}_scanIdleConnection(){for(;this._usedConnectionList.size+this._freeConnectionList.length>this._poolMin&&this._freeConnectionList.length>0;){let e=this._freeConnectionList[0];if(Date.now()-e._lastTimeUsed<this._poolTimeout*1e3)break;this.eventEmitter.emit("_removePoolConnection",e),this._freeConnectionList.shift()}this._schedulerJob=null,this._setScheduler()}_getNumConnsToCreate(){let e=this._freeConnectionList.length+this._usedConnectionList.size;return e<this._poolMin?this._poolMin-e:this._pendingRequests.length>0?Math.min(this._poolIncrement,this._poolMax-e):0}async bgThreadFunc(){for(;!this._poolCloseWaiter;){let e=this._poolMax-this.getConnectionsOpen();for(;e>0&&this._freeConnectionList.length>0;){let s=this._freeConnectionList.shift();this.eventEmitter.emit("_removePoolConnection",s),e--}let t=this._getNumConnsToCreate();for(let s=0;s<t;s++){try{let n=await this._getConnAttrs(),i=new zO;i._pool=this,await i.connect(n),i._newSession=!0,i._dropSess=!1,i._lastTimeUsed=Date.now(),this._freeConnectionList.push(i)}catch(n){this._bgErr=n}if(this._poolIncrement>1&&this._poolMax-this._usedConnectionList.size-this._freeConnectionList.length>1&&this._setScheduler(),this._pendingRequests.length>0&&this._pendingRequests.shift().resolve(),await new Promise(n=>eg.setImmediate(n)),this._poolCloseWaiter)break}if(this._poolCloseWaiter)break;(this._pendingRequests.length==0||this._bgErr)&&(await new Promise(s=>{this.bgWaiter=s}),this.bgWaiter=null)}this._poolCloseWaiter()}async acquire(){for(;this._freeConnectionList.length>0;){let t=this._freeConnectionList.pop();if(!t.isHealthy()){this.eventEmitter.emit("_removePoolConnection",t);continue}let s=!1;if((this._poolPingInterval===0||this._poolPingInterval>0&&Date.now()-t._lastTimeUsed>this._poolPingInterval*1e3)&&(s=!0),s){let n;try{this._poolPingTimeout&&(n=setTimeout(()=>{t.nscon.forceDisconnect()},this._poolPingTimeout)),await t.ping()}catch{t.nscon.forceDisconnect();continue}finally{clearTimeout(n)}}return this._usedConnectionList.add(t),t}if(await new Promise(t=>{this._pendingRequests.push({resolve:t}),this.bgWaiter&&this.bgWaiter()}),this._bgErr){let t=this._bgErr;throw this._bgErr=null,this._pendingRequests.length>0&&this.bgWaiter&&this.bgWaiter(),t}let e=this._freeConnectionList.pop();return this._usedConnectionList.add(e),e}release(e){e.warning=void 0,this._usedConnectionList.delete(e),e.nscon.connected&&(e._lastTimeUsed=Date.now(),e._newSession=!1,this._freeConnectionList.length+this._usedConnectionList.size<this._poolMax?this._freeConnectionList.push(e):this.eventEmitter.emit("_removePoolConnection",e)),this._setScheduler()}_generateConnectionClass(){this._userConfig.connectionClass=JO.randomBytes(16).toString("base64"),this._userConfig.connectionClass="NJS:"+this._userConfig.connectionClass}reconfigure(e){e.poolIncrement!==void 0&&(this._poolIncrement=e.poolIncrement),e.poolTimeout!==void 0&&this._poolTimeout!==e.poolTimeout&&(this._poolTimeout=e.poolTimeout,this._schedulerJob&&(clearTimeout(this._schedulerJob),this._schedulerJob=null)),e.poolPingInterval!==void 0&&(this._poolPingInterval=e.poolPingInterval),e.stmtCacheSize!==void 0&&(this._stmtCacheSize=e.stmtCacheSize),e.poolMax!==void 0&&(this._poolMax=e.poolMax),e.poolMin!==void 0&&(this._poolMin=e.poolMin),this.bgWaiter&&this.bgWaiter()}};_(tl,"ThinPoolImpl");var el=tl;op.exports=el});var _p=m(()=>{"use strict";var tg=JT(),sg=oc(),rg=ap(),ng=Wr(),{ThinDbObjectImpl:ig}=z_(),rn=ur();rn.ConnectionImpl=tg;rn.ResultSetImpl=sg;rn.PoolImpl=rg;rn.LobImpl=ng;rn.DbObjectImpl=ig});var Np=m((_M,hp)=>{"use strict";ta();var B=nt(),Pe=et(),g=W(),oe=Tt(),cp=ur(),ag=require("process"),_g=require("util"),sl=ag.version.substring(1).split(".").map(Number);g.assert(sl[0]>14||sl[0]===14&&sl[1]>=6,g.ERR_NODE_TOO_OLD,Pe.PACKAGE_JSON_VERSION,"14.6");var cg=Qa(),Tg=e_(),lg=r_(),Eg=N_(),ug=Pa(),hg=hr(),Tp=L_(),Ng=ks(),lp=aA(),Sg=U_(),Ag=Xn(),v=Ft(),dg=C_(),pg=R_(),fg=d_(),mg=Sr(),Pg=m_(),Or={},Ci={},nn="default",Xs;function Rg(r){let e=typeof __non_webpack_require__=="function"?__non_webpack_require__:require,t=["../"+Pe.RELEASE_DIR+"/"+Pe.BINARY_FILE,"../"+Pe.RELEASE_DIR+"/"+Pe.BUILD_FILE,"../build/Debug/"+Pe.BUILD_FILE,"./node_modules/oracledb/"+Pe.RELEASE_DIR+"/"+Pe.BINARY_FILE,"./node_modules/oracledb/"+Pe.RELEASE_DIR+"/"+Pe.BUILD_FILE];r.binaryDir!==void 0&&t.splice(0,0,r.binaryDir+"/"+Pe.BINARY_FILE,r.binaryDir+"/"+Pe.BUILD_FILE);let s;for(let n=0;n<t.length;n++)try{s=e(t[n]);break}catch(i){if(i.code!=="MODULE_NOT_FOUND"||n==t.length-1){let a;i.code==="MODULE_NOT_FOUND"?a=`
  Looked for ${t.map(c=>require("path").resolve(__dirname,c)).join(", ")}
  ${Pe.getInstallURL()}
`:a=`
  Node.js require('oracledb') error was:
  ${i.message}
  ${Pe.getInstallHelp()}
`,g.throwErr(g.ERR_CANNOT_LOAD_BINARY,a)}}return s}_(Rg,"_initCLib");function Ep(){_p()}_(Ep,"_initializeThinDriver");async function up(r,e){let t={};if(r=await yg(r),r.user!==void 0&&(g.assertParamPropValue(typeof r.user=="string",1,"user"),t.user=r.user),r.username!==void 0&&(g.assert(t.user===void 0,g.ERR_DBL_USER),g.assertParamPropValue(typeof r.username=="string",1,"username"),t.user=r.username),r.password!==void 0&&(g.assertParamPropValue(typeof r.password=="string",1,"password"),t.password=r.password),r.connectString!==void 0&&(g.assertParamPropValue(typeof r.connectString=="string",1,"connectString"),t.connectString=r.connectString),r.connectionString!==void 0&&(g.assert(t.connectString===void 0,g.ERR_DBL_CONNECT_STRING),g.assertParamPropValue(typeof r.connectionString=="string",1,"connectionString"),t.connectString=r.connectionString),r.walletPassword!==void 0&&(g.assertParamPropValue(typeof r.walletPassword=="string",1,"walletPassword"),t.walletPassword=r.walletPassword),r.walletLocation!==void 0&&(g.assertParamPropValue(typeof r.walletLocation=="string",1,"walletLocation"),t.walletLocation=r.walletLocation),r.walletContent!==void 0&&(g.assertParamPropValue(typeof r.walletContent=="string",1,"walletContent"),t.walletContent=r.walletContent),r.edition!==void 0&&(g.assertParamPropValue(typeof r.edition=="string",1,"edition"),t.edition=r.edition),r.stmtCacheSize!==void 0&&(g.assertParamPropValue(Number.isInteger(r.stmtCacheSize)&&r.stmtCacheSize>=0,1,"stmtCacheSize"),t.stmtCacheSize=r.stmtCacheSize),t.externalAuth=v.externalAuth,r.externalAuth!==void 0&&(g.assertParamPropValue(typeof r.externalAuth=="boolean",1,"externalAuth"),t.externalAuth=r.externalAuth),r.events!==void 0&&(g.assertParamPropValue(typeof r.events=="boolean",1,"events"),t.events=r.events),r.poolAlias!==void 0&&(g.assertParamPropValue(typeof r.poolAlias=="string"&&r.poolAlias.length>0,1,"poolAlias"),t.poolAlias=r.poolAlias),r.configDir!==void 0&&(g.assertParamPropValue(typeof r.configDir=="string",1,"configDir"),t.configDir=r.configDir),r.sslServerCertDN!==void 0&&(g.assertParamPropValue(typeof r.sslServerCertDN=="string",1,"sslServerCertDN"),t.sslServerCertDN=r.sslServerCertDN),r.sslServerDNMatch!==void 0&&(g.assertParamPropValue(typeof r.sslServerDNMatch=="boolean",1,"sslServerDNMatch"),t.sslServerDNMatch=r.sslServerDNMatch),r.sslAllowWeakDNMatch!==void 0&&(g.assertParamPropValue(typeof r.sslAllowWeakDNMatch=="boolean",1,"sslAllowWeakDNMatch"),t.sslAllowWeakDNMatch=r.sslAllowWeakDNMatch),r.httpsProxy!==void 0&&(g.assertParamPropValue(typeof r.httpsProxy=="string",1,"httpsProxy"),t.httpsProxy=r.httpsProxy),r.httpsProxyPort!==void 0&&(g.assertParamPropValue(Number.isInteger(r.httpsProxyPort)&&r.httpsProxyPort>=0,1,"httpsProxyPort"),t.httpsProxyPort=r.httpsProxyPort),r.retryCount!==void 0&&(g.assertParamPropValue(Number.isInteger(r.retryCount)&&r.retryCount>=0,1,"retryCount"),t.retryCount=r.retryCount),r.retryDelay!==void 0&&(g.assertParamPropValue(Number.isInteger(r.retryDelay)&&r.retryDelay>=0,1,"retryDelay"),t.retryDelay=r.retryDelay),r.connectTimeout!==void 0&&(g.assertParamPropValue(Number.isInteger(r.connectTimeout)&&r.connectTimeout>=0,1,"connectTimeout"),t.connectTimeout=r.connectTimeout),r.transportConnectTimeout!==void 0&&(g.assertParamPropValue(Number.isInteger(r.transportConnectTimeout)&&r.transportConnectTimeout>=0,1,"transportConnectTimeout"),t.transportConnectTimeout=r.transportConnectTimeout),r.expireTime!==void 0&&(g.assertParamPropValue(Number.isInteger(r.expireTime)&&r.expireTime>=0,1,"expireTime"),t.expireTime=r.expireTime),r.sdu!==void 0&&(g.assertParamPropValue(Number.isInteger(r.sdu)&&r.sdu>0,1,"sdu"),t.sdu=r.sdu),r.connectionIdPrefix!==void 0&&(g.assertParamPropValue(typeof r.connectionIdPrefix=="string",1,"connectionIdPrefix"),t.connectionIdPrefix=r.connectionIdPrefix),r.privilege!==void 0&&(g.assertParamPropValue(Pe.isPrivilege(r.privilege),1,"privilege"),t.privilege=r.privilege),e)r.poolMax!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolMax)&&r.poolMax>0,1,"poolMax"),t.poolMax=r.poolMax),r.poolMaxPerShard!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolMaxPerShard)&&r.poolMaxPerShard>=0,1,"poolMaxPerShard"),t.poolMaxPerShard=r.poolMaxPerShard),r.poolMin!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolMin)&&r.poolMin>=0,1,"poolMin"),t.poolMin=r.poolMin),r.poolIncrement!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolIncrement)&&r.poolIncrement>=0,1,"poolIncrement"),t.poolIncrement=r.poolIncrement),r.poolTimeout!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolTimeout)&&r.poolTimeout>=0,1,"poolTimeout"),t.poolTimeout=r.poolTimeout),r.poolPingInterval!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolPingInterval)&&r.poolPingInterval>=-2147483648&&r.poolPingInterval<=2147483647,1,"poolPingInterval"),t.poolPingInterval=r.poolPingInterval),r.poolPingTimeout!==void 0&&(g.assertParamPropValue(Number.isInteger(r.poolPingTimeout)&&r.poolPingTimeout>=0,1,"poolPingTimeout"),t.poolPingTimeout=r.poolPingTimeout),t.homogeneous=!0,r.homogeneous!==void 0&&(g.assertParamPropValue(typeof r.homogeneous=="boolean",1,"homogeneous"),t.homogeneous=r.homogeneous),r.queueTimeout!==void 0&&(g.assertParamPropValue(Number.isInteger(r.queueTimeout)&&r.queueTimeout>=0,1,"queueTimeout"),t.queueTimeout=r.queueTimeout),r.queueMax!==void 0&&(g.assertParamPropValue(Number.isInteger(r.queueMax),1,"queueMax"),t.queueMax=r.queueMax),t.sodaMetaDataCache=!1,r.sodaMetaDataCache!==void 0&&(g.assertParamPropValue(typeof r.sodaMetaDataCache=="boolean",1,"sodaMetaDataCache"),t.sodaMetaDataCache=r.sodaMetaDataCache),r.sessionCallback!==void 0&&(g.assertParamPropValue(typeof r.sessionCallback=="string"||typeof r.sessionCallback=="function",1,"sessionCallback"),t.sessionCallback=r.sessionCallback),t.enableStatistics=!1,r.enableStatistics!==void 0&&(g.assertParamPropValue(typeof r.enableStatistics=="boolean",1,"enableStatistics"),t.enableStatistics=r.enableStatistics),!t.enableStatistics&&r._enableStats!==void 0&&(g.assertParamPropValue(typeof r._enableStats=="boolean",1,"_enableStats"),t.enableStatistics=r._enableStats);else{if(r.newPassword!==void 0&&(g.assertParamPropValue(typeof r.newPassword=="string",1,"newPassword"),t.newPassword=r.newPassword),r.shardingKey!==void 0){let s=r.shardingKey;g.assertParamPropValue(Pe.isShardingKey(s),1,"shardingKey"),t.shardingKey=r.shardingKey}if(r.superShardingKey!==void 0){let s=r.superShardingKey;g.assertParamPropValue(Pe.isShardingKey(s),1,"superShardingKey"),t.superShardingKey=r.superShardingKey}}if(r.accessToken!==void 0){g.assert(t.user===void 0&&t.password===void 0,g.ERR_TOKEN_BASED_AUTH),e?g.assert(t.homogeneous&&t.externalAuth,g.ERR_POOL_TOKEN_BASED_AUTH):g.assert(t.externalAuth,g.ERR_CONN_TOKEN_BASED_AUTH);let s;typeof r.accessToken=="function"?(t.accessTokenFn=r.accessToken,t.accessTokenConfig=r.accessTokenConfig,s=await r.accessToken(!1,r.accessTokenConfig),Pe.isTokenValid(s)||(s=await r.accessToken(!0,r.accessTokenConfig))):s=r.accessToken,g.assert(Pe.isTokenValid(s),g.ERR_TOKEN_HAS_EXPIRED),s.privateKey!==void 0&&(g.assert(typeof s.privateKey=="string",g.ERR_TOKEN_BASED_AUTH),s.privateKey=Pe.denormalizePrivateKey(s.privateKey)),typeof s=="string"?t.token=s:(t.token=s.token,t.privateKey=s.privateKey)}return t.token===void 0&&t.externalAuth&&(t.password&&g.throwErr(g.ERR_WRONG_CRED_FOR_EXTAUTH),t.user&&(e?g.throwErr(g.ERR_WRONG_CRED_FOR_EXTAUTH):(t.user[0]!=="["||t.user.slice(-1)!=="]")&&g.throwErr(g.ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY))),t}_(up,"_verifyOptions");async function Ig(r){let e;g.assertArgCount(arguments,1,1),g.assertParamValue(Pe.isObject(r),1),r=await up(r,!0);let t=r.sessionCallback;typeof t=="function"&&delete r.sessionCallback,r.poolAlias!==void 0?e=r.poolAlias:r.poolAlias===void 0&&!Or[nn]&&!Ci[nn]&&(e=nn),(Or[e]||Ci[e])&&g.throwErr(g.ERR_POOL_WITH_ALIAS_ALREADY_EXISTS,e),v.addToOptions(r,"connectionClass","edition","events","externalAuth","stmtCacheSize","poolMax","poolMaxPerShard","poolMin","poolIncrement","poolTimeout","poolPingInterval","poolPingTimeout","queueMax","queueTimeout"),r.poolMin>r.poolMax&&g.throwErr(g.ERR_INVALID_NUMBER_OF_CONNECTIONS,r.poolMax,r.poolMin),Xs===void 0&&!v.thinDriverInitialized&&Ep(),e&&(Ci[e]=!0);let s=new lp;try{await s._impl.create(r)}finally{e&&delete Ci[e]}return e&&(Or[e]=s),s._setup(r,e),s._sessionCallback=t,s.on("_afterPoolClose",()=>{s.poolAlias&&delete Or[s.poolAlias]}),Xs===void 0&&(v.thinDriverInitialized=!0),s}_(Ig,"createPool");async function Dg(r){let e={},t;if(g.assertArgCount(arguments,0,1),arguments.length==0?t=nn:typeof r=="string"?t=r:(e=r,g.assertParamValue(Pe.isObject(e),1),t=e.poolAlias),t){let n=Or[t];return g.assert(n,g.ERR_POOL_WITH_ALIAS_NOT_FOUND,t),await n.getConnection(e)}e=await up(e,!1),v.addToOptions(e,"connectionClass","edition","events","externalAuth","stmtCacheSize"),Xs===void 0&&!v.thinDriverInitialized&&Ep();let s=new Tp;return s._impl=new cp.ConnectionImpl,await s._impl.connect(e),Xs===void 0&&(v.thinDriverInitialized=!0),s}_(Dg,"getConnection");function Cg(r){g.assertArgCount(arguments,0,1),r&&g.assertParamValue(typeof r=="string"||typeof r=="number",1),r=r||nn;let e=Or[r];return e||g.throwErr(g.ERR_POOL_WITH_ALIAS_NOT_FOUND,r),e}_(Cg,"getPool");function Og(r){let e={};if(g.assertArgCount(arguments,0,1),r!==void 0&&(g.assertParamValue(Pe.isObject(r),1),e={...r},g.assertParamPropString(e,1,"libDir"),g.assertParamPropString(e,1,"configDir"),g.assertParamPropString(e,1,"errorUrl"),g.assertParamPropString(e,1,"driverName"),g.assertParamPropString(e,1,"binaryDir")),v.thinDriverInitialized&&g.throwErr(g.ERR_THIN_CONNECTION_ALREADY_CREATED),Xs===void 0){let t=Rg(e);e.driverName===void 0&&(e.driverName=B.DEFAULT_DRIVER_NAME+" thk"),e.errorUrl===void 0&&(e.errorUrl=B.DEFAULT_ERROR_URL);try{t.initOracleClient(e,cp,v)}catch(s){let n=g.transformErr(s);throw n.code==="DPI-1047"&&(n.message+=`
`+Pe.getInstallHelp()),n}Xs=r||{}}else _g.isDeepStrictEqual(Xs,e)||g.throwErr(g.ERR_INIT_ORACLE_CLIENT_ARGS);v.thin=!1}_(Og,"initOracleClient");async function gg(r,e){let t={},s=B.SHUTDOWN_MODE_DEFAULT;g.assertArgCount(arguments,0,2),arguments.length==2?(g.assertParamValue(typeof r=="object",1),g.assertParamValue(typeof e=="number",2),t=r,s=e):arguments.length==1&&(g.assertParamValue(typeof r=="object",1),t=r);let n={user:t.user,password:t.password,connectString:t.connectString,connectionString:t.connectionString,externalAuth:t.externalAuth,privilege:B.SYSOPER},i=await this.getConnection(n);await i.shutdown(s),s!=this.SHUTDOWN_MODE_ABORT&&(await i.execute("ALTER DATABASE CLOSE"),await i.execute("ALTER DATABASE DISMOUNT"),await i.shutdown(this.SHUTDOWN_MODE_FINAL)),await i.close()}_(gg,"shutdown");async function yg(r){let e=r.connectString||r.connectionString;if(!e)return r;let t=e,s,n=new RegExp("^config-(?<provider>[A-Za-z0-9]+)(://)(?<provider_arg>[^?]+)");e.indexOf("?")!=-1&&(t=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?"),e.length));let i=t.match(n);if(i){let a=i.groups.provider,c=i.groups.provider_arg,T;try{T=og("./configProviders/"+a)}catch{g.throwErr(g.ERR_CONFIG_PROVIDER_NOT_SUPPORTED,a)}let l=new T(c,s);try{l.init()}catch(u){g.throwErr(g.ERR_CONFIG_PROVIDER_LOAD_FAILED,u.message)}let E;try{E=await l.returnConfig()}catch(u){g.throwErr(g.ERR_CONFIG_PROVIDER_FAILED_TO_RETRIEVE_CONFIG,u.message)}r=l.modifyOptionsPrecedence(E,r)}return r}_(yg,"_checkConfigProvider");async function Lg(r,e){let t={},s={};g.assertArgCount(arguments,0,2),arguments.length==2?(g.assertParamValue(typeof r=="object",1),g.assertParamValue(typeof e=="object",2),t=r,s=e):arguments.length==1&&(g.assertParamValue(typeof r=="object",1),t=r);let n={user:t.user,password:t.password,connectString:t.connectString,connectionString:t.connectionString,externalAuth:t.externalAuth,privilege:this.SYSOPER|this.SYSPRELIM},i=await this.getConnection(n);await i.startup(s),await i.close(),n.privilege=this.SYSOPER,i=await this.getConnection(n),await i.execute("ALTER DATABASE MOUNT"),await i.execute("ALTER DATABASE OPEN"),await i.close()}_(Lg,"startup");hp.exports={AqDeqOptions:cg,AqEnqOptions:Tg,AqMessage:lg,AqQueue:Eg,BaseDbObject:hg,Connection:Tp,JsonId:oe.JsonId,Lob:Ng,Pool:lp,PoolStatistics:Sg,ResultSet:Ag,SodaDatabase:dg,SodaCollection:pg,SodaDocCursor:fg,SodaDocument:mg,SodaOperation:Pg,getConnection:Pe.callbackify(Dg),createPool:Pe.callbackify(Ig),getPool:Cg,initOracleClient:Og,shutdown:Pe.callbackify(gg),startup:Pe.callbackify(Lg),CQN_OPCODE_ALL_OPS:B.CQN_OPCODE_ALL_OPS,CQN_OPCODE_ALL_ROWS:B.CQN_OPCODE_ALL_ROWS,CQN_OPCODE_ALTER:B.CQN_OPCODE_ALTER,CQN_OPCODE_DELETE:B.CQN_OPCODE_DELETE,CQN_OPCODE_DROP:B.CQN_OPCODE_DROP,CQN_OPCODE_INSERT:B.CQN_OPCODE_INSERT,CQN_OPCODE_UPDATE:B.CQN_OPCODE_UPDATE,DB_TYPE_BFILE:oe.DB_TYPE_BFILE,DB_TYPE_BINARY_DOUBLE:oe.DB_TYPE_BINARY_DOUBLE,DB_TYPE_BINARY_FLOAT:oe.DB_TYPE_BINARY_FLOAT,DB_TYPE_BINARY_INTEGER:oe.DB_TYPE_BINARY_INTEGER,DB_TYPE_BLOB:oe.DB_TYPE_BLOB,DB_TYPE_BOOLEAN:oe.DB_TYPE_BOOLEAN,DB_TYPE_CHAR:oe.DB_TYPE_CHAR,DB_TYPE_CLOB:oe.DB_TYPE_CLOB,DB_TYPE_CURSOR:oe.DB_TYPE_CURSOR,DB_TYPE_DATE:oe.DB_TYPE_DATE,DB_TYPE_INTERVAL_DS:oe.DB_TYPE_INTERVAL_DS,DB_TYPE_INTERVAL_YM:oe.DB_TYPE_INTERVAL_YM,DB_TYPE_JSON:oe.DB_TYPE_JSON,DB_TYPE_LONG:oe.DB_TYPE_LONG,DB_TYPE_LONG_NVARCHAR:oe.DB_TYPE_LONG_NVARCHAR,DB_TYPE_LONG_RAW:oe.DB_TYPE_LONG_RAW,DB_TYPE_NCHAR:oe.DB_TYPE_NCHAR,DB_TYPE_NCLOB:oe.DB_TYPE_NCLOB,DB_TYPE_NUMBER:oe.DB_TYPE_NUMBER,DB_TYPE_NVARCHAR:oe.DB_TYPE_NVARCHAR,DB_TYPE_OBJECT:oe.DB_TYPE_OBJECT,DB_TYPE_RAW:oe.DB_TYPE_RAW,DB_TYPE_ROWID:oe.DB_TYPE_ROWID,DB_TYPE_TIMESTAMP:oe.DB_TYPE_TIMESTAMP,DB_TYPE_TIMESTAMP_LTZ:oe.DB_TYPE_TIMESTAMP_LTZ,DB_TYPE_TIMESTAMP_TZ:oe.DB_TYPE_TIMESTAMP_TZ,DB_TYPE_VARCHAR:oe.DB_TYPE_VARCHAR,DB_TYPE_XMLTYPE:oe.DB_TYPE_XMLTYPE,DB_TYPE_VECTOR:oe.DB_TYPE_VECTOR,DEFAULT:B.DEFAULT,STMT_TYPE_UNKNOWN:B.STMT_TYPE_UNKNOWN,STMT_TYPE_SELECT:B.STMT_TYPE_SELECT,STMT_TYPE_UPDATE:B.STMT_TYPE_UPDATE,STMT_TYPE_DELETE:B.STMT_TYPE_DELETE,STMT_TYPE_INSERT:B.STMT_TYPE_INSERT,STMT_TYPE_CREATE:B.STMT_TYPE_CREATE,STMT_TYPE_DROP:B.STMT_TYPE_DROP,STMT_TYPE_ALTER:B.STMT_TYPE_ALTER,STMT_TYPE_BEGIN:B.STMT_TYPE_BEGIN,STMT_TYPE_DECLARE:B.STMT_TYPE_DECLARE,STMT_TYPE_CALL:B.STMT_TYPE_CALL,STMT_TYPE_EXPLAIN_PLAN:B.STMT_TYPE_EXPLAIN_PLAN,STMT_TYPE_MERGE:B.STMT_TYPE_MERGE,STMT_TYPE_ROLLBACK:B.STMT_TYPE_ROLLBACK,STMT_TYPE_COMMIT:B.STMT_TYPE_COMMIT,SHUTDOWN_MODE_DEFAULT:B.SHUTDOWN_MODE_DEFAULT,SHUTDOWN_MODE_TRANSACTIONAL:B.SHUTDOWN_MODE_TRANSACTIONAL,SHUTDOWN_MODE_TRANSACTIONAL_LOCAL:B.SHUTDOWN_MODE_TRANSACTIONAL_LOCAL,SHUTDOWN_MODE_IMMEDIATE:B.SHUTDOWN_MODE_IMMEDIATE,SHUTDOWN_MODE_ABORT:B.SHUTDOWN_MODE_ABORT,SHUTDOWN_MODE_FINAL:B.SHUTDOWN_MODE_FINAL,STARTUP_MODE_DEFAULT:B.STARTUP_MODE_DEFAULT,STARTUP_MODE_FORCE:B.STARTUP_MODE_FORCE,STARTUP_MODE_RESTRICT:B.STARTUP_MODE_RESTRICT,SUBSCR_EVENT_TYPE_SHUTDOWN:B.SUBSCR_EVENT_TYPE_SHUTDOWN,SUBSCR_EVENT_TYPE_SHUTDOWN_ANY:B.SUBSCR_EVENT_TYPE_SHUTDOWN_ANY,SUBSCR_EVENT_TYPE_STARTUP:B.SUBSCR_EVENT_TYPE_STARTUP,SUBSCR_EVENT_TYPE_DEREG:B.SUBSCR_EVENT_TYPE_DEREG,SUBSCR_EVENT_TYPE_OBJ_CHANGE:B.SUBSCR_EVENT_TYPE_OBJ_CHANGE,SUBSCR_EVENT_TYPE_QUERY_CHANGE:B.SUBSCR_EVENT_TYPE_QUERY_CHANGE,SUBSCR_EVENT_TYPE_AQ:B.SUBSCR_EVENT_TYPE_AQ,SUBSCR_GROUPING_CLASS_TIME:B.SUBSCR_GROUPING_CLASS_TIME,SUBSCR_GROUPING_TYPE_SUMMARY:B.SUBSCR_GROUPING_TYPE_SUMMARY,SUBSCR_GROUPING_TYPE_LAST:B.SUBSCR_GROUPING_TYPE_LAST,SUBSCR_NAMESPACE_AQ:B.SUBSCR_NAMESPACE_AQ,SUBSCR_NAMESPACE_DBCHANGE:B.SUBSCR_NAMESPACE_DBCHANGE,SUBSCR_QOS_BEST_EFFORT:B.SUBSCR_QOS_BEST_EFFORT,SUBSCR_QOS_DEREG_NFY:B.SUBSCR_QOS_DEREG_NFY,SUBSCR_QOS_QUERY:B.SUBSCR_QOS_QUERY,SUBSCR_QOS_RELIABLE:B.SUBSCR_QOS_RELIABLE,SUBSCR_QOS_ROWIDS:B.SUBSCR_QOS_ROWIDS,SYSASM:B.SYSASM,SYSBACKUP:B.SYSBACKUP,SYSDBA:B.SYSDBA,SYSDG:B.SYSDG,SYSKM:B.SYSKM,SYSOPER:B.SYSOPER,SYSPRELIM:B.SYSPRELIM,SYSRAC:B.SYSRAC,BIND_IN:B.BIND_IN,BIND_INOUT:B.BIND_INOUT,BIND_OUT:B.BIND_OUT,OUT_FORMAT_ARRAY:B.OUT_FORMAT_ARRAY,OUT_FORMAT_OBJECT:B.OUT_FORMAT_OBJECT,SODA_COLL_MAP_MODE:B.SODA_COLL_MAP_MODE,POOL_STATUS_OPEN:B.POOL_STATUS_OPEN,POOL_STATUS_DRAINING:B.POOL_STATUS_DRAINING,POOL_STATUS_CLOSED:B.POOL_STATUS_CLOSED,POOL_STATUS_RECONFIGURING:B.POOL_STATUS_RECONFIGURING,AQ_DEQ_NO_WAIT:B.AQ_DEQ_NO_WAIT,AQ_DEQ_WAIT_FOREVER:B.AQ_DEQ_WAIT_FOREVER,AQ_DEQ_MODE_BROWSE:B.AQ_DEQ_MODE_BROWSE,AQ_DEQ_MODE_LOCKED:B.AQ_DEQ_MODE_LOCKED,AQ_DEQ_MODE_REMOVE:B.AQ_DEQ_MODE_REMOVE,AQ_DEQ_MODE_REMOVE_NO_DATA:B.AQ_DEQ_MODE_REMOVE_NO_DATA,AQ_DEQ_NAV_FIRST_MSG:B.AQ_DEQ_NAV_FIRST_MSG,AQ_DEQ_NAV_NEXT_TRANSACTION:B.AQ_DEQ_NAV_NEXT_TRANSACTION,AQ_DEQ_NAV_NEXT_MSG:B.AQ_DEQ_NAV_NEXT_MSG,AQ_MSG_DELIV_MODE_PERSISTENT:B.AQ_MSG_DELIV_MODE_PERSISTENT,AQ_MSG_DELIV_MODE_BUFFERED:B.AQ_MSG_DELIV_MODE_BUFFERED,AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED:B.AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED,AQ_MSG_STATE_READY:B.AQ_MSG_STATE_READY,AQ_MSG_STATE_WAITING:B.AQ_MSG_STATE_WAITING,AQ_MSG_STATE_PROCESSED:B.AQ_MSG_STATE_PROCESSED,AQ_MSG_STATE_EXPIRED:B.AQ_MSG_STATE_EXPIRED,AQ_VISIBILITY_IMMEDIATE:B.AQ_VISIBILITY_IMMEDIATE,AQ_VISIBILITY_ON_COMMIT:B.AQ_VISIBILITY_ON_COMMIT,TPC_BEGIN_JOIN:B.TPC_BEGIN_JOIN,TPC_BEGIN_NEW:B.TPC_BEGIN_NEW,TPC_BEGIN_PROMOTE:B.TPC_BEGIN_PROMOTE,TPC_BEGIN_RESUME:B.TPC_BEGIN_RESUME,TPC_END_NORMAL:B.TPC_END_NORMAL,TPC_END_SUSPEND:B.TPC_END_SUSPEND,VECTOR_FORMAT_FLOAT32:B.VECTOR_FORMAT_FLOAT32,VECTOR_FORMAT_FLOAT64:B.VECTOR_FORMAT_FLOAT64,VECTOR_FORMAT_INT8:B.VECTOR_FORMAT_INT8,VECTOR_FORMAT_BINARY:B.VECTOR_FORMAT_BINARY,BLOB:oe.DB_TYPE_BLOB,BUFFER:oe.DB_TYPE_RAW,CLOB:oe.DB_TYPE_CLOB,CURSOR:oe.DB_TYPE_CURSOR,DATE:oe.DB_TYPE_TIMESTAMP,NCLOB:oe.DB_TYPE_NCLOB,NUMBER:oe.DB_TYPE_NUMBER,STRING:oe.DB_TYPE_VARCHAR,ARRAY:B.OUT_FORMAT_ARRAY,OBJECT:B.OUT_FORMAT_OBJECT,future:ug,get autoCommit(){return v.autoCommit},get connectionClass(){return v.connectionClass},get dbObjectAsPojo(){return v.dbObjectAsPojo},get edition(){return v.edition},get errorOnConcurrentExecute(){return v.errorOnConcurrentExecute},get events(){return v.events},get externalAuth(){return v.externalAuth},get fetchArraySize(){return v.fetchArraySize},get fetchAsBuffer(){return v.fetchAsBuffer},get fetchAsString(){return v.fetchAsString},get fetchTypeHandler(){return v.fetchTypeHandler},get lobPrefetchSize(){return v.lobPrefetchSize},get maxRows(){return v.maxRows},get oracleClientVersion(){return v.oracleClientVersion},get oracleClientVersionString(){return v.oracleClientVersionString},get outFormat(){return v.outFormat},get poolIncrement(){return v.poolIncrement},get poolMax(){return v.poolMax},get poolMaxPerShard(){return v.poolMaxPerShard},get poolMin(){return v.poolMin},get poolPingInterval(){return v.poolPingInterval},get poolPingTimeout(){return v.poolPingTimeout},get poolTimeout(){return v.poolTimeout},get prefetchRows(){return v.prefetchRows},get stmtCacheSize(){return v.stmtCacheSize},get thin(){return v.thin},get version(){return B.VERSION_MAJOR*1e4+B.VERSION_MINOR*100+B.VERSION_PATCH},get versionString(){return B.VERSION_STRING},get versionSuffix(){return B.VERSION_SUFFIX},set autoCommit(r){g.assertPropValue(typeof r=="boolean","autoCommit"),v.autoCommit=r},set connectionClass(r){g.assertPropValue(typeof r=="string","connectionClass"),v.connectionClass=r},set dbObjectAsPojo(r){g.assertPropValue(typeof r=="boolean","dbObjectAsPojo"),v.dbObjectAsPojo=r},set edition(r){g.assertPropValue(typeof r=="string","edition"),v.edition=r},set errorOnConcurrentExecute(r){g.assertPropValue(typeof r=="boolean","errorOnConcurrentExecute"),v.errorOnConcurrentExecute=r},set events(r){g.assertPropValue(typeof r=="boolean","events"),v.events=r},set externalAuth(r){g.assertPropValue(typeof r=="boolean","externalAuth"),v.externalAuth=r},set fetchArraySize(r){g.assertPropValue(Number.isInteger(r)&&r>0,"fetchArraySize"),v.fetchArraySize=r},set fetchAsBuffer(r){g.assertPropValue(Array.isArray(r),"fetchAsBuffer"),v.createFetchTypeMap(v.fetchAsString,r),v.fetchAsBuffer=r},set fetchAsString(r){g.assertPropValue(Array.isArray(r),"fetchAsString"),v.createFetchTypeMap(r,v.fetchAsBuffer),v.fetchAsString=r},set fetchTypeHandler(r){r!==void 0&&g.assertPropValue(typeof r=="function","fetchTypeHandler"),v.fetchTypeHandler=r},set lobPrefetchSize(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"lobPrefetchSize"),v.lobPrefetchSize=r},set maxRows(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"maxRows"),v.maxRows=r},set outFormat(r){r!==B.OUT_FORMAT_ARRAY&&r!==B.OUT_FORMAT_OBJECT&&g.throwErr(g.ERR_INVALID_PROPERTY_VALUE,"outFormat"),v.outFormat=r},set poolIncrement(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolIncrement"),v.poolIncrement=r},set poolMax(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolMax"),v.poolMax=r},set poolMaxPerShard(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolMaxPerShard"),v.poolMaxPerShard=r},set poolMin(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolMin"),v.poolMin=r},set poolPingInterval(r){g.assertPropValue(Number.isInteger(r)&&r<2**31&&r>=(-2)**31,"poolPingInterval"),v.poolPingInterval=r},set poolPingTimeout(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolPingTimeout"),v.poolPingTimeout=r},set poolTimeout(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"poolTimeout"),v.poolTimeout=r},set prefetchRows(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"prefetchRows"),v.prefetchRows=r},set stmtCacheSize(r){g.assertPropValue(Number.isInteger(r)&&r>=0,"stmtCacheSize"),v.stmtCacheSize=r}}});var Ap=m((lM,Sp)=>{Sp.exports=Np()});var rl=m(dp=>{dp.require=function(){if(typeof process=="object"&&process.versions&&process.versions.electron)try{let r=require("original-fs");if(Object.keys(r).length>0)return r}catch{}return require("fs")}});var nl=m((uM,pp)=>{pp.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var Rp=m((hM,Pp)=>{var wg=rl().require(),mt=require("path"),fp=nl(),Bg=typeof process=="object"&&process.platform==="win32",mp=_(r=>r&&typeof r=="object","is_Obj"),il=new Uint32Array(256).map((r,e)=>{for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e>>>=1;return e>>>0});function at(r){this.sep=mt.sep,this.fs=wg,mp(r)&&mp(r.fs)&&typeof r.fs.statSync=="function"&&(this.fs=r.fs)}_(at,"Utils");Pp.exports=at;at.prototype.makeDir=function(r){let e=this;function t(s){let n=s.split(e.sep)[0];s.split(e.sep).forEach(function(i){if(!(!i||i.substr(-1,1)===":")){n+=e.sep+i;var a;try{a=e.fs.statSync(n)}catch{e.fs.mkdirSync(n)}if(a&&a.isFile())throw Errors.FILE_IN_THE_WAY.replace("%s",n)}})}_(t,"mkdirSync"),t(r)};at.prototype.writeFileTo=function(r,e,t,s){let n=this;if(n.fs.existsSync(r)){if(!t)return!1;var i=n.fs.statSync(r);if(i.isDirectory())return!1}var a=mt.dirname(r);n.fs.existsSync(a)||n.makeDir(a);var c;try{c=n.fs.openSync(r,"w",438)}catch{n.fs.chmodSync(r,438),c=n.fs.openSync(r,"w",438)}if(c)try{n.fs.writeSync(c,e,0,e.length,0)}finally{n.fs.closeSync(c)}return n.fs.chmodSync(r,s||438),!0};at.prototype.writeFileToAsync=function(r,e,t,s,n){typeof s=="function"&&(n=s,s=void 0);let i=this;i.fs.exists(r,function(a){if(a&&!t)return n(!1);i.fs.stat(r,function(c,T){if(a&&T.isDirectory())return n(!1);var l=mt.dirname(r);i.fs.exists(l,function(E){E||i.makeDir(l),i.fs.open(r,"w",438,function(u,p){u?i.fs.chmod(r,438,function(){i.fs.open(r,"w",438,function(A,h){i.fs.write(h,e,0,e.length,0,function(){i.fs.close(h,function(){i.fs.chmod(r,s||438,function(){n(!0)})})})})}):p?i.fs.write(p,e,0,e.length,0,function(){i.fs.close(p,function(){i.fs.chmod(r,s||438,function(){n(!0)})})}):i.fs.chmod(r,s||438,function(){n(!0)})})})})})};at.prototype.findFiles=function(r){let e=this;function t(s,n,i){typeof n=="boolean"&&(i=n,n=void 0);let a=[];return e.fs.readdirSync(s).forEach(function(c){var T=mt.join(s,c);e.fs.statSync(T).isDirectory()&&i&&(a=a.concat(t(T,n,i))),(!n||n.test(T))&&a.push(mt.normalize(T)+(e.fs.statSync(T).isDirectory()?e.sep:""))}),a}return _(t,"findSync"),t(r,void 0,!0)};at.prototype.getAttributes=function(){};at.prototype.setAttributes=function(){};at.crc32update=function(r,e){return il[(r^e)&255]^r>>>8};at.crc32=function(r){typeof r=="string"&&(r=Buffer.from(r,"utf8")),il.length||genCRCTable();let e=r.length,t=-1;for(let s=0;s<e;)t=at.crc32update(t,r[s++]);return~t>>>0};at.methodToString=function(r){switch(r){case fp.STORED:return"STORED ("+r+")";case fp.DEFLATED:return"DEFLATED ("+r+")";default:return"UNSUPPORTED ("+r+")"}};at.canonical=function(r){if(!r)return"";var e=mt.posix.normalize("/"+r.split("\\").join("/"));return mt.join(".",e)};at.sanitize=function(r,e){r=mt.resolve(mt.normalize(r));for(var t=e.split("/"),s=0,n=t.length;s<n;s++){var i=mt.normalize(mt.join(r,t.slice(s,n).join(mt.sep)));if(i.indexOf(r)===0)return i}return mt.normalize(mt.join(r,mt.basename(e)))};at.toBuffer=_(function(e){return Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e):typeof e=="string"?Buffer.from(e,"utf8"):Buffer.alloc(0)},"toBuffer");at.readBigUInt64LE=function(r,e){var t=Buffer.from(r.slice(e,e+8));return t.swap64(),parseInt(`0x${t.toString("hex")}`)};at.isWin=Bg;at.crcTable=il});var Dp=m((SM,Ip)=>{Ip.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}});var gp=m((AM,Op)=>{var Oi=rl().require(),Cp=require("path");Oi.existsSync=Oi.existsSync||Cp.existsSync;Op.exports=function(r){var e=r||"",t=n(),s=null;function n(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return _(n,"newAttr"),e&&Oi.existsSync(e)?(s=Oi.statSync(e),t.directory=s.isDirectory(),t.mtime=s.mtime,t.atime=s.atime,t.executable=(73&s.mode)!==0,t.readonly=(128&s.mode)===0,t.hidden=Cp.basename(e)[0]==="."):console.warn("Invalid path: "+e),{get directory(){return t.directory},get readOnly(){return t.readonly},get hidden(){return t.hidden},get mtime(){return t.mtime},get atime(){return t.atime},get executable(){return t.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:e,isDirectory:t.directory,isReadOnly:t.readonly,isHidden:t.hidden,isExecutable:t.executable,mTime:t.mtime,aTime:t.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var gr=m((pM,on)=>{on.exports=Rp();on.exports.Constants=nl();on.exports.Errors=Dp();on.exports.FileAttr=gp()});var Lp=m((fM,yp)=>{var an=gr(),H=an.Constants;yp.exports=function(){var r=20,e=10,t=0,s=0,n=0,i=0,a=0,c=0,T=0,l=0,E=0,u=0,p=0,A=0,h=0;r|=an.isWin?2560:768,t|=H.FLG_EFS;var N={};function d(S){S=new Date(S),n=(S.getFullYear()-1980&127)<<25|S.getMonth()+1<<21|S.getDate()<<16|S.getHours()<<11|S.getMinutes()<<5|S.getSeconds()>>1}return _(d,"setTime"),d(+new Date),{get made(){return r},set made(S){r=S},get version(){return e},set version(S){e=S},get flags(){return t},set flags(S){t=S},get method(){return s},set method(S){switch(S){case H.STORED:this.version=10;case H.DEFLATED:default:this.version=20}s=S},get time(){return new Date((n>>25&127)+1980,(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(n&31)<<1)},set time(S){d(S)},get crc(){return i},set crc(S){i=Math.max(0,S)>>>0},get compressedSize(){return a},set compressedSize(S){a=Math.max(0,S)>>>0},get size(){return c},set size(S){c=Math.max(0,S)>>>0},get fileNameLength(){return T},set fileNameLength(S){T=S},get extraLength(){return l},set extraLength(S){l=S},get commentLength(){return E},set commentLength(S){E=S},get diskNumStart(){return u},set diskNumStart(S){u=Math.max(0,S)>>>0},get inAttr(){return p},set inAttr(S){p=Math.max(0,S)>>>0},get attr(){return A},set attr(S){A=Math.max(0,S)>>>0},get fileAttr(){return A?(A>>>0|0)>>16&4095:0},get offset(){return h},set offset(S){h=Math.max(0,S)>>>0},get encripted(){return(t&1)===1},get entryHeaderSize(){return H.CENHDR+T+l+E},get realDataOffset(){return h+H.LOCHDR+N.fnameLen+N.extraLen},get dataHeader(){return N},loadDataHeaderFromBinary:function(S){var D=S.slice(h,h+H.LOCHDR);if(D.readUInt32LE(0)!==H.LOCSIG)throw new Error(an.Errors.INVALID_LOC);N={version:D.readUInt16LE(H.LOCVER),flags:D.readUInt16LE(H.LOCFLG),method:D.readUInt16LE(H.LOCHOW),time:D.readUInt32LE(H.LOCTIM),crc:D.readUInt32LE(H.LOCCRC),compressedSize:D.readUInt32LE(H.LOCSIZ),size:D.readUInt32LE(H.LOCLEN),fnameLen:D.readUInt16LE(H.LOCNAM),extraLen:D.readUInt16LE(H.LOCEXT)}},loadFromBinary:function(S){if(S.length!==H.CENHDR||S.readUInt32LE(0)!==H.CENSIG)throw new Error(an.Errors.INVALID_CEN);r=S.readUInt16LE(H.CENVEM),e=S.readUInt16LE(H.CENVER),t=S.readUInt16LE(H.CENFLG),s=S.readUInt16LE(H.CENHOW),n=S.readUInt32LE(H.CENTIM),i=S.readUInt32LE(H.CENCRC),a=S.readUInt32LE(H.CENSIZ),c=S.readUInt32LE(H.CENLEN),T=S.readUInt16LE(H.CENNAM),l=S.readUInt16LE(H.CENEXT),E=S.readUInt16LE(H.CENCOM),u=S.readUInt16LE(H.CENDSK),p=S.readUInt16LE(H.CENATT),A=S.readUInt32LE(H.CENATX),h=S.readUInt32LE(H.CENOFF)},dataHeaderToBinary:function(){var S=Buffer.alloc(H.LOCHDR);return S.writeUInt32LE(H.LOCSIG,0),S.writeUInt16LE(e,H.LOCVER),S.writeUInt16LE(t,H.LOCFLG),S.writeUInt16LE(s,H.LOCHOW),S.writeUInt32LE(n,H.LOCTIM),S.writeUInt32LE(i,H.LOCCRC),S.writeUInt32LE(a,H.LOCSIZ),S.writeUInt32LE(c,H.LOCLEN),S.writeUInt16LE(T,H.LOCNAM),S.writeUInt16LE(l,H.LOCEXT),S},entryHeaderToBinary:function(){var S=Buffer.alloc(H.CENHDR+T+l+E);return S.writeUInt32LE(H.CENSIG,0),S.writeUInt16LE(r,H.CENVEM),S.writeUInt16LE(e,H.CENVER),S.writeUInt16LE(t,H.CENFLG),S.writeUInt16LE(s,H.CENHOW),S.writeUInt32LE(n,H.CENTIM),S.writeUInt32LE(i,H.CENCRC),S.writeUInt32LE(a,H.CENSIZ),S.writeUInt32LE(c,H.CENLEN),S.writeUInt16LE(T,H.CENNAM),S.writeUInt16LE(l,H.CENEXT),S.writeUInt16LE(E,H.CENCOM),S.writeUInt16LE(u,H.CENDSK),S.writeUInt16LE(p,H.CENATT),S.writeUInt32LE(A,H.CENATX),S.writeUInt32LE(h,H.CENOFF),S.fill(0,H.CENHDR),S},toJSON:function(){let S=_(function(D){return D+" bytes"},"bytes");return{made:r,version:e,flags:t,method:an.methodToString(s),time:this.time,crc:"0x"+i.toString(16).toUpperCase(),compressedSize:S(a),size:S(c),fileNameLength:S(T),extraLength:S(l),commentLength:S(E),diskNumStart:u,inAttr:p,attr:A,offset:h,entryHeaderSize:S(H.CENHDR+T+l+E)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var Bp=m((PM,wp)=>{var yr=gr(),be=yr.Constants;wp.exports=function(){var r=0,e=0,t=0,s=0,n=0;return{get diskEntries(){return r},set diskEntries(i){r=e=i},get totalEntries(){return e},set totalEntries(i){e=r=i},get size(){return t},set size(i){t=i},get offset(){return s},set offset(i){s=i},get commentLength(){return n},set commentLength(i){n=i},get mainHeaderSize(){return be.ENDHDR+n},loadFromBinary:function(i){if((i.length!==be.ENDHDR||i.readUInt32LE(0)!==be.ENDSIG)&&(i.length<be.ZIP64HDR||i.readUInt32LE(0)!==be.ZIP64SIG))throw new Error(yr.Errors.INVALID_END);i.readUInt32LE(0)===be.ENDSIG?(r=i.readUInt16LE(be.ENDSUB),e=i.readUInt16LE(be.ENDTOT),t=i.readUInt32LE(be.ENDSIZ),s=i.readUInt32LE(be.ENDOFF),n=i.readUInt16LE(be.ENDCOM)):(r=yr.readBigUInt64LE(i,be.ZIP64SUB),e=yr.readBigUInt64LE(i,be.ZIP64TOT),t=yr.readBigUInt64LE(i,be.ZIP64SIZ),s=yr.readBigUInt64LE(i,be.ZIP64OFF),n=0)},toBinary:function(){var i=Buffer.alloc(be.ENDHDR+n);return i.writeUInt32LE(be.ENDSIG,0),i.writeUInt32LE(0,4),i.writeUInt16LE(r,be.ENDSUB),i.writeUInt16LE(e,be.ENDTOT),i.writeUInt32LE(t,be.ENDSIZ),i.writeUInt32LE(s,be.ENDOFF),i.writeUInt16LE(n,be.ENDCOM),i.fill(" ",be.ENDHDR),i},toJSON:function(){let i=_(function(a,c){let T=a.toString(16).toUpperCase();for(;T.length<c;)T="0"+T;return"0x"+T},"offset");return{diskEntries:r,totalEntries:e,size:t+" bytes",offset:i(s,4),commentLength:n}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var al=m(ol=>{ol.EntryHeader=Lp();ol.MainHeader=Bp()});var Yp=m((DM,Up)=>{Up.exports=function(r){var e=require("zlib"),t={chunkSize:(parseInt(r.length/1024)+1)*1024};return{deflate:function(){return e.deflateRawSync(r,t)},deflateAsync:function(s){var n=e.createDeflateRaw(t),i=[],a=0;n.on("data",function(c){i.push(c),a+=c.length}),n.on("end",function(){var c=Buffer.alloc(a),T=0;c.fill(0);for(var l=0;l<i.length;l++){var E=i[l];E.copy(c,T),T+=E.length}s&&s(c)}),n.end(r)}}}});var Vp=m((CM,Mp)=>{Mp.exports=function(r){var e=require("zlib");return{inflate:function(){return e.inflateRawSync(r)},inflateAsync:function(t){var s=e.createInflateRaw(),n=[],i=0;s.on("data",function(a){n.push(a),i+=a.length}),s.on("end",function(){var a=Buffer.alloc(i),c=0;a.fill(0);for(var T=0;T<n.length;T++){var l=n[T];l.copy(a,c),c+=l.length}t&&t(a)}),s.end(r)}}}});var qp=m((OM,kp)=>{"use strict";var{randomFillSync:Fp}=require("crypto"),Ug=new Uint32Array(256).map((r,e)=>{for(let t=0;t<8;t++)e&1?e=e>>>1^3988292384:e>>>=1;return e>>>0}),bp=_((r,e)=>Math.imul(r,e)>>>0,"uMul"),xp=_((r,e)=>Ug[(r^e)&255]^r>>>8,"crc32update"),_n=_(()=>typeof Fp=="function"?Fp(Buffer.alloc(12)):_n.node(),"genSalt");_n.node=()=>{let r=Buffer.alloc(12),e=r.length;for(let t=0;t<e;t++)r[t]=Math.random()*256&255;return r};var gi={genSalt:_n};function yi(r){let e=Buffer.isBuffer(r)?r:Buffer.from(r);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let t=0;t<e.length;t++)this.updateKeys(e[t])}_(yi,"Initkeys");yi.prototype.updateKeys=function(r){let e=this.keys;return e[0]=xp(e[0],r),e[1]+=e[0]&255,e[1]=bp(e[1],134775813)+1,e[2]=xp(e[2],e[1]>>>24),r};yi.prototype.next=function(){let r=(this.keys[2]|2)>>>0;return bp(r,r^1)>>8&255};function Yg(r){let e=new yi(r);return function(t){let s=Buffer.alloc(t.length),n=0;for(let i of t)s[n++]=e.updateKeys(i^e.next());return s}}_(Yg,"make_decrypter");function Mg(r){let e=new yi(r);return function(t,s,n=0){s||(s=Buffer.alloc(t.length));for(let i of t){let a=e.next();s[n++]=i^a,e.updateKeys(i)}return s}}_(Mg,"make_encrypter");function Vg(r,e,t){if(!r||!Buffer.isBuffer(r)||r.length<12)return Buffer.alloc(0);let s=Yg(t);if(s(r.slice(0,12))[11]!==e.crc>>>24)throw"ADM-ZIP: Wrong Password";return s(r.slice(12))}_(Vg,"decrypt");function Fg(r){Buffer.isBuffer(r)&&r.length>=12?gi.genSalt=function(){return r.slice(0,12)}:r==="node"?gi.genSalt=_n.node:gi.genSalt=_n}_(Fg,"_salter");function xg(r,e,t,s=!1){r==null&&(r=Buffer.alloc(0)),Buffer.isBuffer(r)||(r=Buffer.from(r.toString()));let n=Mg(t),i=gi.genSalt();i[11]=e.crc>>>24&255,s&&(i[10]=e.crc>>>16&255);let a=Buffer.alloc(r.length+12);return n(i,a),n(r,a,12)}_(xg,"encrypt");kp.exports={decrypt:Vg,encrypt:xg,_salter:Fg}});var Gp=m(Li=>{Li.Deflater=Yp();Li.Inflater=Vp();Li.ZipCrypto=qp()});var cl=m((LM,vp)=>{var Qe=gr(),bg=al(),Bt=Qe.Constants,_l=Gp();vp.exports=function(r){var e=new bg.EntryHeader,t=Buffer.alloc(0),s=Buffer.alloc(0),n=!1,i=null,a=Buffer.alloc(0);function c(){return!r||!Buffer.isBuffer(r)?Buffer.alloc(0):(e.loadDataHeaderFromBinary(r),r.slice(e.realDataOffset,e.realDataOffset+e.compressedSize))}_(c,"getCompressedDataFromZip");function T(h){return!((e.flags&8)!==8&&Qe.crc32(h)!==e.dataHeader.crc)}_(T,"crc32OK");function l(h,N,d){if(typeof N>"u"&&typeof h=="string"&&(d=h,h=void 0),n)return h&&N&&N(Buffer.alloc(0),Qe.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var S=c();if(S.length===0)return h&&N&&N(S),S;if(e.encripted){if(typeof d!="string"&&!Buffer.isBuffer(d))throw new Error("ADM-ZIP: Incompatible password parameter");S=_l.ZipCrypto.decrypt(S,e,d)}var D=Buffer.alloc(e.size);switch(e.method){case Qe.Constants.STORED:if(S.copy(D),T(D))return h&&N&&N(D),D;throw h&&N&&N(D,Qe.Errors.BAD_CRC),new Error(Qe.Errors.BAD_CRC);case Qe.Constants.DEFLATED:var P=new _l.Inflater(S);if(h)P.inflateAsync(function(y){y.copy(y,0),N&&(T(y)?N(y):N(y,Qe.Errors.BAD_CRC))});else{if(P.inflate(D).copy(D,0),!T(D))throw new Error(Qe.Errors.BAD_CRC+" "+t.toString());return D}break;default:throw h&&N&&N(Buffer.alloc(0),Qe.Errors.UNKNOWN_METHOD),new Error(Qe.Errors.UNKNOWN_METHOD)}}_(l,"decompress");function E(h,N){if((!i||!i.length)&&Buffer.isBuffer(r))return h&&N&&N(c()),c();if(i.length&&!n){var d;switch(e.method){case Qe.Constants.STORED:return e.compressedSize=e.size,d=Buffer.alloc(i.length),i.copy(d),h&&N&&N(d),d;default:case Qe.Constants.DEFLATED:var S=new _l.Deflater(i);if(h)S.deflateAsync(function(P){d=Buffer.alloc(P.length),e.compressedSize=P.length,P.copy(d),N&&N(d)});else{var D=S.deflate();return e.compressedSize=D.length,D}S=null;break}}else if(h&&N)N(Buffer.alloc(0));else return Buffer.alloc(0)}_(E,"compress");function u(h,N){return(h.readUInt32LE(N+4)<<4)+h.readUInt32LE(N)}_(u,"readUInt64LE");function p(h){for(var N=0,d,S,D;N<h.length;)d=h.readUInt16LE(N),N+=2,S=h.readUInt16LE(N),N+=2,D=h.slice(N,N+S),N+=S,Bt.ID_ZIP64===d&&A(D)}_(p,"parseExtra");function A(h){var N,d,S,D;h.length>=Bt.EF_ZIP64_SCOMP&&(N=u(h,Bt.EF_ZIP64_SUNCOMP),e.size===Bt.EF_ZIP64_OR_32&&(e.size=N)),h.length>=Bt.EF_ZIP64_RHO&&(d=u(h,Bt.EF_ZIP64_SCOMP),e.compressedSize===Bt.EF_ZIP64_OR_32&&(e.compressedSize=d)),h.length>=Bt.EF_ZIP64_DSN&&(S=u(h,Bt.EF_ZIP64_RHO),e.offset===Bt.EF_ZIP64_OR_32&&(e.offset=S)),h.length>=Bt.EF_ZIP64_DSN+4&&(D=h.readUInt32LE(Bt.EF_ZIP64_DSN),e.diskNumStart===Bt.EF_ZIP64_OR_16&&(e.diskNumStart=D))}return _(A,"parseZip64ExtendedInformation"),{get entryName(){return t.toString()},get rawEntryName(){return t},set entryName(h){t=Qe.toBuffer(h);var N=t[t.length-1];n=N===47||N===92,e.fileNameLength=t.length},get extra(){return a},set extra(h){a=h,e.extraLength=h.length,p(h)},get comment(){return s.toString()},set comment(h){s=Qe.toBuffer(h),e.commentLength=s.length},get name(){var h=t.toString();return n?h.substr(h.length-1).split("/").pop():h.split("/").pop()},get isDirectory(){return n},getCompressedData:function(){return E(!1,null)},getCompressedDataAsync:function(h){E(!0,h)},setData:function(h){i=Qe.toBuffer(h),!n&&i.length?(e.size=i.length,e.method=Qe.Constants.DEFLATED,e.crc=Qe.crc32(h),e.changed=!0):e.method=Qe.Constants.STORED},getData:function(h){return e.changed?i:l(!1,null,h)},getDataAsync:function(h,N){e.changed?h(i):l(!0,h,N)},set attr(h){e.attr=h},get attr(){return e.attr},set header(h){e.loadFromBinary(h)},get header(){return e},packHeader:function(){var h=e.entryHeaderToBinary(),N=Qe.Constants.CENHDR;return t.copy(h,N),N+=t.length,e.extraLength&&(a.copy(h,N),N+=e.extraLength),e.commentLength&&s.copy(h,N),h},toJSON:function(){let h=_(function(N){return"<"+(N&&N.length+" bytes buffer"||"null")+">"},"bytes");return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:e.toJSON(),compressedData:h(r),data:h(i)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var Wp=m((BM,Kp)=>{var Hp=cl(),kg=al(),ht=gr();Kp.exports=function(r,e){var t=[],s={},n=Buffer.alloc(0),i=new kg.MainHeader,a=!1;let c=Object.assign(Object.create(null),e),{noSort:T}=c;r?u(c.readEntries):a=!0;function l(A){let h=i.diskEntries,N=i.offset;for(let d=0;d<h;d++){let S=N,D=new Hp(r);D.header=r.slice(S,S+=ht.Constants.CENHDR),D.entryName=r.slice(S,S+=D.header.fileNameLength),N+=D.header.entryHeaderSize,A(D)}}_(l,"iterateEntries");function E(){a=!0,s={},t=new Array(i.diskEntries);for(var A=i.offset,h=0;h<t.length;h++){var N=A,d=new Hp(r);d.header=r.slice(N,N+=ht.Constants.CENHDR),d.entryName=r.slice(N,N+=d.header.fileNameLength),d.header.extraLength&&(d.extra=r.slice(N,N+=d.header.extraLength)),d.header.commentLength&&(d.comment=r.slice(N,N+d.header.commentLength)),A+=d.header.entryHeaderSize,t[h]=d,s[d.entryName]=d}}_(E,"readEntries");function u(A){var h=r.length-ht.Constants.ENDHDR,N=Math.max(0,h-65535),d=N,S=r.length,D=-1,P=0;for(h;h>=d;h--)if(r[h]===80){if(r.readUInt32LE(h)===ht.Constants.ENDSIG){D=h,P=h,S=h+ht.Constants.ENDHDR,d=h-ht.Constants.END64HDR;continue}if(r.readUInt32LE(h)===ht.Constants.END64SIG){d=N;continue}if(r.readUInt32LE(h)===ht.Constants.ZIP64SIG){D=h,S=h+ht.readBigUInt64LE(r,h+ht.Constants.ZIP64SIZE)+ht.Constants.ZIP64LEAD;break}}if(!~D)throw new Error(ht.Errors.INVALID_FORMAT);i.loadFromBinary(r.slice(D,S)),i.commentLength&&(n=r.slice(P+ht.Constants.ENDHDR)),A&&E()}_(u,"readMainHeader");function p(){t.length>1&&!T&&t.sort((A,h)=>A.entryName.toLowerCase().localeCompare(h.entryName.toLowerCase()))}return _(p,"sortEntries"),{get entries(){return a||E(),t},get comment(){return n.toString()},set comment(A){n=ht.toBuffer(A),i.commentLength=n.length},getEntryCount:function(){return a?t.length:i.diskEntries},forEach:function(A){if(!a){l(A);return}t.forEach(A)},getEntry:function(A){return a||E(),s[A]||null},setEntry:function(A){a||E(),t.push(A),s[A.entryName]=A,i.totalEntries=t.length},deleteEntry:function(A){a||E();var h=s[A];if(h&&h.isDirectory){var N=this;this.getEntryChildren(h).forEach(function(d){d.entryName!==A&&N.deleteEntry(d.entryName)})}t.splice(t.indexOf(h),1),delete s[A],i.totalEntries=t.length},getEntryChildren:function(A){if(a||E(),A&&A.isDirectory){let h=[],N=A.entryName,d=N.length;return t.forEach(function(S){S.entryName.substr(0,d)===N&&h.push(S)}),h}return[]},compressToBuffer:function(){a||E(),p();let A=[],h=[],N=0,d=0;i.size=0,i.offset=0;for(let P of t){let y=P.getCompressedData();P.header.offset=d;let Y=P.header.dataHeaderToBinary(),V=P.rawEntryName.length,k=Buffer.alloc(V+P.extra.length);P.rawEntryName.copy(k,0),k.copy(P.extra,V);let $=Y.length+k.length+y.length;d+=$,A.push(Y),A.push(k),A.push(y);let C=P.packHeader();h.push(C),i.size+=C.length,N+=$+C.length}N+=i.mainHeaderSize,i.offset=d,d=0;let S=Buffer.alloc(N);for(let P of A)P.copy(S,d),d+=P.length;for(let P of h)P.copy(S,d),d+=P.length;let D=i.toBinary();return n&&n.copy(D,ht.Constants.ENDHDR),D.copy(S,d),S},toAsyncBuffer:function(A,h,N,d){try{a||E(),p();let S=[],D=[],P=0,y=0;i.size=0,i.offset=0;let Y=_(function(V){if(V.length){let k=V.pop(),$=k.entryName+k.extra.toString();N&&N($),k.getCompressedDataAsync(function(C){d&&d($),k.header.offset=y;let G=k.header.dataHeaderToBinary(),R=Buffer.alloc($.length,$),w=G.length+R.length+C.length;y+=w,S.push(G),S.push(R),S.push(C);let x=k.packHeader();D.push(x),i.size+=x.length,P+=w+x.length,Y(V)})}else{P+=i.mainHeaderSize,i.offset=y,y=0;let k=Buffer.alloc(P);S.forEach(function(C){C.copy(k,y),y+=C.length}),D.forEach(function(C){C.copy(k,y),y+=C.length});let $=i.toBinary();n&&n.copy($,ht.Constants.ENDHDR),$.copy(k,y),A(k)}},"compress2Buffer");Y(t)}catch(S){h(S)}}}}});var zp=m((YM,Xp)=>{var Je=gr(),ts=require("path"),qg=cl(),Gg=Wp(),zs=_((r,e)=>typeof r=="boolean"?r:e,"get_Bool"),Tl=_((r,e)=>typeof r=="string"?r:e,"get_Str"),vg={noSort:!1,readEntries:!1,method:Je.Constants.NONE,fs:null};Xp.exports=function(r,e){let t=null,s=Object.assign(Object.create(null),vg);r&&typeof r=="object"&&(r instanceof Uint8Array||(Object.assign(s,r),r=s.input?s.input:void 0,s.input&&delete s.input),Buffer.isBuffer(r)&&(t=r,s.method=Je.Constants.BUFFER,r=void 0)),Object.assign(s,e);let n=new Je(s);if(r&&typeof r=="string")if(n.fs.existsSync(r))s.method=Je.Constants.FILE,s.filename=r,t=n.fs.readFileSync(r);else throw new Error(Je.Errors.INVALID_FILENAME);let i=new Gg(t,s),{canonical:a,sanitize:c}=Je;function T(E){if(E&&i){var u;if(typeof E=="string"&&(u=i.getEntry(E)),typeof E=="object"&&typeof E.entryName<"u"&&typeof E.header<"u"&&(u=i.getEntry(E.entryName)),u)return u}return null}_(T,"getEntry");function l(E){let{join:u,normalize:p,sep:A}=ts.posix;return u(".",p(A+E.split("\\").join(A)+A))}return _(l,"fixPath"),{readFile:function(E,u){var p=T(E);return p&&p.getData(u)||null},readFileAsync:function(E,u){var p=T(E);p?p.getDataAsync(u):u(null,"getEntry failed for:"+E)},readAsText:function(E,u){var p=T(E);if(p){var A=p.getData();if(A&&A.length)return A.toString(u||"utf8")}return""},readAsTextAsync:function(E,u,p){var A=T(E);A?A.getDataAsync(function(h,N){if(N){u(h,N);return}h&&h.length?u(h.toString(p||"utf8")):u("")}):u("")},deleteFile:function(E){var u=T(E);u&&i.deleteEntry(u.entryName)},addZipComment:function(E){i.comment=E},getZipComment:function(){return i.comment||""},addZipEntryComment:function(E,u){var p=T(E);p&&(p.comment=u)},getZipEntryComment:function(E){var u=T(E);return u&&u.comment||""},updateFile:function(E,u){var p=T(E);p&&p.setData(u)},addLocalFile:function(E,u,p,A){if(n.fs.existsSync(E)){u=u?l(u):"";var h=E.split("\\").join("/").split("/").pop();u+=p||h;let N=n.fs.statSync(E);this.addFile(u,n.fs.readFileSync(E),A,N)}else throw new Error(Je.Errors.FILE_NOT_FOUND.replace("%s",E))},addLocalFolder:function(E,u,p){if(p instanceof RegExp?p=function(A){return function(h){return A.test(h)}}(p):typeof p!="function"&&(p=_(function(){return!0},"filter")),u=u?l(u):"",E=ts.normalize(E),n.fs.existsSync(E)){let A=n.findFiles(E),h=this;A.length&&A.forEach(function(N){var d=ts.relative(E,N).split("\\").join("/");if(p(d)){var S=n.fs.statSync(N);S.isFile()?h.addFile(u+d,n.fs.readFileSync(N),"",S):h.addFile(u+d+"/",Buffer.alloc(0),"",S)}})}else throw new Error(Je.Errors.FILE_NOT_FOUND.replace("%s",E))},addLocalFolderAsync:function(E,u,p,A){A instanceof RegExp?A=function(N){return function(d){return N.test(d)}}(A):typeof A!="function"&&(A=_(function(){return!0},"filter")),p=p?l(p):"",E=ts.normalize(E);var h=this;n.fs.open(E,"r",function(N){if(N&&N.code==="ENOENT")u(void 0,Je.Errors.FILE_NOT_FOUND.replace("%s",E));else if(N)u(void 0,N);else{var d=n.findFiles(E),S=-1,D=_(function(){if(S+=1,S<d.length){var P=d[S],y=ts.relative(E,P).split("\\").join("/");y=y.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),A(y)?n.fs.stat(P,function(Y,V){Y&&u(void 0,Y),V.isFile()?n.fs.readFile(P,function(k,$){k?u(void 0,k):(h.addFile(p+y,$,"",V),D())}):(h.addFile(p+y+"/",Buffer.alloc(0),"",V),D())}):D()}else u(!0,void 0)},"next");D()}})},addLocalFolderPromise:function(E,u){return new Promise((p,A)=>{let{filter:h,zipPath:N}=Object.assign({},u);this.addLocalFolderAsync(E,(d,S)=>{S&&A(S),d&&p(this)},N,h)})},addFile:function(E,u,p,A){let h=T(E),N=h!=null;N||(h=new qg,h.entryName=E),h.comment=p||"";let d=typeof A=="object"&&A instanceof n.fs.Stats;d&&(h.header.time=A.mtime);var S=h.isDirectory?16:0;if(!Je.isWin){let D=h.isDirectory?16384:32768;d?D|=4095&A.mode:typeof A=="number"?D|=4095&A:D|=h.isDirectory?493:420,S=(S|D<<16)>>>0}h.attr=S,h.setData(u),N||i.setEntry(h)},getEntries:function(){return i?i.entries:[]},getEntry:function(E){return T(E)},getEntryCount:function(){return i.getEntryCount()},forEach:function(E){return i.forEach(E)},extractEntryTo:function(E,u,p,A,h,N){A=zs(A,!1),h=zs(h,!1),p=zs(p,!0),N=Tl(N,Tl(h,void 0));var d=T(E);if(!d)throw new Error(Je.Errors.NO_ENTRY);var S=a(d.entryName),D=c(u,N&&!d.isDirectory?N:p?S:ts.basename(S));if(d.isDirectory){var P=i.getEntryChildren(d);return P.forEach(function(V){if(V.isDirectory)return;var k=V.getData();if(!k)throw new Error(Je.Errors.CANT_EXTRACT_FILE);var $=a(V.entryName),C=c(u,p?$:ts.basename($));let G=h?V.header.fileAttr:void 0;n.writeFileTo(C,k,A,G)}),!0}var y=d.getData();if(!y)throw new Error(Je.Errors.CANT_EXTRACT_FILE);if(n.fs.existsSync(D)&&!A)throw new Error(Je.Errors.CANT_OVERRIDE);let Y=h?E.header.fileAttr:void 0;return n.writeFileTo(D,y,A,Y),!0},test:function(E){if(!i)return!1;for(var u in i.entries)try{if(u.isDirectory)continue;var p=i.entries[u].getData(E);if(!p)return!1}catch{return!1}return!0},extractAllTo:function(E,u,p,A){if(u=zs(u,!1),A=Tl(p,A),p=zs(p,!1),!i)throw new Error(Je.Errors.NO_ZIP);i.entries.forEach(function(h){var N=c(E,a(h.entryName.toString()));if(h.isDirectory){n.makeDir(N);return}var d=h.getData(A);if(!d)throw new Error(Je.Errors.CANT_EXTRACT_FILE);let S=p?h.header.fileAttr:void 0;n.writeFileTo(N,d,u,S);try{n.fs.utimesSync(N,h.header.time,h.header.time)}catch{throw new Error(Je.Errors.CANT_EXTRACT_FILE)}})},extractAllToAsync:function(E,u,p,A){if(A||(A=_(function(){},"callback")),u=zs(u,!1),typeof p=="function"&&!A&&(A=p),p=zs(p,!1),!i){A(new Error(Je.Errors.NO_ZIP));return}E=ts.resolve(E);let h=_(P=>c(E,ts.normalize(a(P.entryName.toString()))),"getPath"),N=_((P,y)=>new Error(P+': "'+y+'"'),"getError"),d=[],S=new Set;i.entries.forEach(P=>{P.isDirectory?d.push(P):S.add(P)});for(let P of d){let y=h(P),Y=p?P.header.fileAttr:void 0;try{n.makeDir(y),Y&&n.fs.chmodSync(y,Y),n.fs.utimesSync(y,P.header.time,P.header.time)}catch{A(N("Unable to create folder",y))}}let D=_(()=>{S.size===0&&A()},"done");for(let P of S.values()){let y=ts.normalize(a(P.entryName.toString())),Y=c(E,y);P.getDataAsync(function(V,k){if(k){A(new Error(k));return}if(!V)A(new Error(Je.Errors.CANT_EXTRACT_FILE));else{let $=p?P.header.fileAttr:void 0;n.writeFileToAsync(Y,V,u,$,function(C){if(!C){A(N("Unable to write file",Y));return}n.fs.utimes(Y,P.header.time,P.header.time,function(G){if(G){A(N("Unable to set times",Y));return}S.delete(P),D()})})}})}D()},writeZip:function(E,u){if(arguments.length===1&&typeof E=="function"&&(u=E,E=""),!E&&s.filename&&(E=s.filename),!!E){var p=i.compressToBuffer();if(p){var A=n.writeFileTo(E,p,!0);typeof u=="function"&&u(A?null:new Error("failed"),"")}}},writeZipPromise:function(E,u){let{overwrite:p,perm:A}=Object.assign({overwrite:!0},u);return new Promise((h,N)=>{!E&&s.filename&&(E=s.filename),E||N("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(d=>{let S=_(D=>D?h(D):N("ADM-ZIP: Wasn't able to write zip file"),"ret");n.writeFileToAsync(E,d,p,A,S)},N)})},toBufferPromise:function(){return new Promise((E,u)=>{i.toAsyncBuffer(E,u)})},toBuffer:function(E,u,p,A){return this.valueOf=2,typeof E=="function"?(i.toAsyncBuffer(E,u,p,A),null):i.compressToBuffer()}}}});var jp=m((VM,Qp)=>{"use strict";var Hg=require("crypto"),Lr=require("fs"),$p=require("path"),Kg=zp(),Wg=_((r,e)=>new Promise((t,s)=>{try{let n=new Kg(r);if(!n)return s(new Error("Link to zip file is broken or system has no permissions to "+r+" folder"));let i=n.getEntries();return Object.keys(i).length===0?s(new Error("Zip file is empty")):(n.extractAllTo(e,!0),t(e))}catch(n){s(n)}}),"extractZip"),Xg=_((r,e)=>{if(!Lr.existsSync(r))return;let t=/DIRECTORY\=\".+?\"/i,s=Lr.readFileSync(r).toString();t.test(s)&&(s=s.replace(t,`DIRECTORY="${e}"`),Lr.writeFileSync(r,s))},"replaceSqlNetOraDirectoryPath"),zg=_(r=>new Promise((e,t)=>{let s=_(a=>Hg.createHash("md5").update(a,"utf-8").digest("hex"),"getHash"),n=Lr.createReadStream(r),i="";n.on("data",a=>{i+=a}),n.on("error",a=>{t(a)}),n.on("end",function(){e(s(i))})}),"getHashByFile"),$g=_(async({walletFile:r,tempFolder:e,name:t})=>{if(!Lr.existsSync(r))return;let s=await zg(r),n=$p.join(e,t+"_"+s);if(Lr.existsSync(n))return n;await Wg(r,n);let i=$p.join(n,"sqlnet.ora");return Xg(i,n),n},"extractWallet");Qp.exports=$g});var Jp=m(ll=>{"use strict";Object.defineProperty(ll,"__esModule",{value:!0});var Qg=function(){function r(e,t){t===void 0&&(t=0),this.source=e,this.position=t}return _(r,"LexerState"),r.prototype.copy=function(){return new r(this.source,this.position)},r}();ll.default=Qg});var tf=m($s=>{"use strict";var jg=$s&&$s.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){r(e,t);function s(){this.constructor=e}_(s,"__"),e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}}();Object.defineProperty($s,"__esModule",{value:!0});var Zp=function(){function r(e,t,s,n,i,a){this.type=e,this.match=t,this.groups=s,this.start=n,this.end=i,this.lexer=a}return _(r,"Token"),r.prototype.strpos=function(){var e=this.lexer.strpos(this.start),t=this.lexer.strpos(this.end);return{start:e,end:t}},r.prototype.isEof=function(){return!1},r}();$s.default=Zp;var ef=function(r){jg(e,r);function e(t){var s=this,n=t.source.length;return s=r.call(this,null,"(eof)",[],n,n,t)||this,s}return _(e,"EOFToken"),e.prototype.isEof=function(){return!0},e}(Zp);$s.EOFToken=ef;$s.EOF=function(r){return new ef(r)}});var sf=m(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});function Jg(r){return new RegExp(r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"))}_(Jg,"toRegExp");function Zg(r){return typeof r=="string"&&(r=Jg(r)),r.source.startsWith("^")?r:new RegExp("^"+r.source,r.flags)}_(Zg,"normalize");function ey(r,e){for(var t=0,s=0,n=r;s<n.length;s++){var i=n[s],a=e(i,t++);if(a)return{item:i,result:a}}}_(ey,"first");var ty=function(){function r(){this.tokenTypes=[]}return _(r,"TokenTypes"),r.prototype.disable=function(e){return this.enable(e,!1)},r.prototype.enable=function(e,t){return t===void 0&&(t=!0),this.tokenTypes.filter(function(s){return s.type==e}).forEach(function(s){return s.enabled=t}),this},r.prototype.isEnabled=function(e){var t=this.tokenTypes.filter(function(s){return s.type==e});if(t.length==0)throw new Error("Token of type "+e+" does not exists");return t[0].enabled},r.prototype.peek=function(e,t){var s=e.substr(t);return ey(this.tokenTypes.filter(function(n){return n.enabled}),function(n){return n.regex.lastIndex=0,n.regex.exec(s)})},r.prototype.token=function(e,t,s){return s===void 0&&(s=!1),this.tokenTypes.push({type:e,regex:Zg(t),enabled:!0,skip:s}),this},r}();El.default=ty});var nf=m(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});var ul=Jp();Qs.LexerState=ul.default;var wi=tf();Qs.Token=wi.default;Qs.EOF=wi.EOF;var rf=sf();Qs.TokenTypes=rf.default;var sy=function(){function r(e){e===void 0&&(e=""),this._state=new ul.default(e),this._tokenTypes=new rf.default}return _(r,"Lexer"),Object.defineProperty(r.prototype,"position",{get:function(){return this._state.position},set:function(e){this._state.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"source",{get:function(){return this._state.source},set:function(e){this._state=new ul.default(e)},enumerable:!0,configurable:!0}),r.prototype.attachTo=function(e){this._state=e._state},r.prototype.disable=function(e){return this._tokenTypes.disable(e),this},r.prototype.enable=function(e,t){return this._tokenTypes.enable(e,t),this},r.prototype.expect=function(e){var t=this.next();if(t.type!=e){var s=t.strpos();throw new Error("Expected "+e+(t?", got "+t.type:"")+" at "+s.start.line+":"+s.start.column)}return t},r.prototype.isEnabled=function(e){return this._tokenTypes.isEnabled(e)},r.prototype.next=function(){try{var e=this.peek();return this._state.position=e.end,e}catch(t){throw this._state.position=t.end,t}},r.prototype.peek=function(e){var t=this;e===void 0&&(e=this._state.position);var s=_(function(E){if(E===void 0&&(E=e),E>=t._state.source.length)return wi.EOF(t);var u=t._tokenTypes.peek(t._state.source,E);return u?u.item.skip?s(E+u.result[0].length):new wi.default(u.item.type,u.result[0],u.result.map(function(p){return p}),E,E+u.result[0].length,t):null},"read"),n=s();if(n)return n;var i=this._state.source.substring(e,e+1);try{this.peek(e+1)}catch(E){i+=E.unexpected}var a=this.strpos(e),c=a.line,T=a.column,l=new Error("Unexpected input: "+i+" at ("+c+":"+T+")");throw l.unexpected=i,l.end=e+i.length,l},r.prototype.strpos=function(e){var t=this._state.source.substring(0,e).split(/\r?\n/);Array.isArray(t)||(t=[t]);var s=t.length,n=t[t.length-1].length+1;return{line:s,column:n}},r.prototype.toArray=function(){var e=this._state.copy();this._state.position=0;for(var t=[],s;!(s=this.next()).isEof();)t.push(s);return this._state=e,t},r.prototype.token=function(e,t,s){return this._tokenTypes.token(e,t,s),this},r.prototype.keyword=function(e){return this.token(e,new RegExp(e+"(?=\\W|$)"))},r.prototype.operator=function(e){var t=new String(e).valueOf();return this.token(e,t)},r}();Qs.default=sy});var af=m((WM,of)=>{of.exports=nf()});var Tf=m((XM,cf)=>{"use strict";var ry=af().default;function _f(r,e={}){r.expect("(");let t=r.expect("WORD").match;r.expect("=");let s;if(r.peek().type==="("){s={};do Object.assign(s,_f(r,e));while(r.peek().type==="(")}else s=r.expect("WORD").match;return r.expect(")"),{...e,[t]:s}}_(_f,"parseObject");var ny=_(r=>{let e=r.expect("WORD").match;return r.expect("="),{name:e,data:_f(r)}},"parseConnection"),iy=_(r=>{let e=new ry(r).token("$SKIP_COMMENT",/#[^\n]*/,!0).token("$SKIP_WS",/\s+/,!0).token("WORD",/([a-z0-9._-]+|["'][\s\S]*?["'])/i).token("(",/\(/).token(")",/\)/).token("=",/=/),t={};for(;e.peek().type!==null;){let s=ny(e);t[s.name]=s}return t},"parseTns");cf.exports=iy});var Bi=m(($M,lf)=>{"use strict";var Sl=class Sl{cache;cacheValue;cycle;ifNotExist;increment;maxValue;minValue;sequenceName;start;sharing;order;keep;scale;scaleExtend;shard;shardExtend;type};_(Sl,"Sequence");var hl=Sl,Al=class Al{sharing;ddlScript;sequenceName;minValue;maxValue;increment;cycle;order;cacheValue;scale;extend;shard;type;keep};_(Al,"SequenceDto");var Nl=Al;lf.exports={Sequence:hl,SequenceDto:Nl}});var uf=m((Ui,Ef)=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.default=function(r){return function(...e){var t=e.pop();return r.call(this,e,t)}};Ef.exports=Ui.default});var Sf=m(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.fallback=hf;Us.wrap=Nf;var oy=Us.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,ay=Us.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,_y=Us.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function hf(r){setTimeout(r,0)}_(hf,"fallback");function Nf(r){return(e,...t)=>r(()=>e(...t))}_(Nf,"wrap");var cn;oy?cn=queueMicrotask:ay?cn=setImmediate:_y?cn=process.nextTick:cn=hf;Us.default=Nf(cn)});var mf=m((Yi,ff)=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.default=hy;var cy=uf(),Ty=pf(cy),ly=Sf(),Ey=pf(ly),uy=Mi();function pf(r){return r&&r.__esModule?r:{default:r}}_(pf,"_interopRequireDefault");function hy(r){return(0,uy.isAsync)(r)?function(...e){let t=e.pop(),s=r.apply(this,e);return Af(s,t)}:(0,Ty.default)(function(e,t){var s;try{s=r.apply(this,e)}catch(n){return t(n)}if(s&&typeof s.then=="function")return Af(s,t);t(null,s)})}_(hy,"asyncify");function Af(r,e){return r.then(t=>{df(e,null,t)},t=>{df(e,t&&(t instanceof Error||t.message)?t:new Error(t))})}_(Af,"handlePromise");function df(r,e,t){try{r(e,t)}catch(s){(0,Ey.default)(n=>{throw n},s)}}_(df,"invokeCallback");ff.exports=Yi.default});var Mi=m(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.isAsyncIterable=Ns.isAsyncGenerator=Ns.isAsync=void 0;var Ny=mf(),Sy=Ay(Ny);function Ay(r){return r&&r.__esModule?r:{default:r}}_(Ay,"_interopRequireDefault");function Pf(r){return r[Symbol.toStringTag]==="AsyncFunction"}_(Pf,"isAsync");function dy(r){return r[Symbol.toStringTag]==="AsyncGenerator"}_(dy,"isAsyncGenerator");function py(r){return typeof r[Symbol.asyncIterator]=="function"}_(py,"isAsyncIterable");function fy(r){if(typeof r!="function")throw new Error("expected a function");return Pf(r)?(0,Sy.default)(r):r}_(fy,"wrapAsync");Ns.default=fy;Ns.isAsync=Pf;Ns.isAsyncGenerator=dy;Ns.isAsyncIterable=py});var If=m((Vi,Rf)=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.default=Iy;var my=Mi(),Py=Ry(my);function Ry(r){return r&&r.__esModule?r:{default:r}}_(Ry,"_interopRequireDefault");function Iy(r,e,t,s){e=e||[];var n=[],i=0,a=(0,Py.default)(t);return r(e,(c,T,l)=>{var E=i++;a(c,(u,p)=>{n[E]=p,l(u)})},c=>{s(c,n)})}_(Iy,"_asyncMap");Rf.exports=Vi.default});var Cf=m((Fi,Df)=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.default=Dy;function Dy(r){function e(...t){if(r!==null){var s=r;r=null,s.apply(this,t)}}return _(e,"wrapper"),Object.assign(e,r),e}_(Dy,"once");Df.exports=Fi.default});var gf=m((xi,Of)=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});xi.default=Cy;function Cy(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}_(Cy,"isArrayLike");Of.exports=xi.default});var Lf=m((bi,yf)=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()};yf.exports=bi.default});var Uf=m((ki,Bf)=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.default=Yy;var Oy=gf(),gy=wf(Oy),yy=Lf(),Ly=wf(yy);function wf(r){return r&&r.__esModule?r:{default:r}}_(wf,"_interopRequireDefault");function wy(r){var e=-1,t=r.length;return _(function(){return++e<t?{value:r[e],key:e}:null},"next")}_(wy,"createArrayIterator");function By(r){var e=-1;return _(function(){var s=r.next();return s.done?null:(e++,{value:s.value,key:e})},"next")}_(By,"createES2015Iterator");function Uy(r){var e=r?Object.keys(r):[],t=-1,s=e.length;return _(function n(){var i=e[++t];return i==="__proto__"?n():t<s?{value:r[i],key:i}:null},"next")}_(Uy,"createObjectIterator");function Yy(r){if((0,gy.default)(r))return wy(r);var e=(0,Ly.default)(r);return e?By(e):Uy(r)}_(Yy,"createIterator");Bf.exports=ki.default});var Mf=m((qi,Yf)=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.default=My;function My(r){return function(...e){if(r===null)throw new Error("Callback was already called.");var t=r;r=null,t.apply(this,e)}}_(My,"onlyOnce");Yf.exports=qi.default});var dl=m((Gi,Vf)=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});var Vy={};Gi.default=Vy;Vf.exports=Gi.default});var xf=m((vi,Ff)=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.default=ky;var Fy=dl(),xy=by(Fy);function by(r){return r&&r.__esModule?r:{default:r}}_(by,"_interopRequireDefault");function ky(r,e,t,s){let n=!1,i=!1,a=!1,c=0,T=0;function l(){c>=e||a||n||(a=!0,r.next().then(({value:p,done:A})=>{if(!(i||n)){if(a=!1,A){n=!0,c<=0&&s(null);return}c++,t(p,T,E),T++,l()}}).catch(u))}_(l,"replenish");function E(p,A){if(c-=1,!i){if(p)return u(p);if(p===!1){n=!0,i=!0;return}if(A===xy.default||n&&c<=0)return n=!0,s(null);l()}}_(E,"iterateeCallback");function u(p){i||(a=!1,n=!0,s(p))}_(u,"handleError"),l()}_(ky,"asyncEachOfLimit");Ff.exports=vi.default});var Gf=m((Hi,qf)=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});var qy=Cf(),Gy=Tn(qy),vy=Uf(),Hy=Tn(vy),Ky=Mf(),Wy=Tn(Ky),bf=Mi(),Xy=xf(),kf=Tn(Xy),zy=dl(),$y=Tn(zy);function Tn(r){return r&&r.__esModule?r:{default:r}}_(Tn,"_interopRequireDefault");Hi.default=r=>(e,t,s)=>{if(s=(0,Gy.default)(s),r<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return s(null);if((0,bf.isAsyncGenerator)(e))return(0,kf.default)(e,r,t,s);if((0,bf.isAsyncIterable)(e))return(0,kf.default)(e[Symbol.asyncIterator](),r,t,s);var n=(0,Hy.default)(e),i=!1,a=!1,c=0,T=!1;function l(u,p){if(!a)if(c-=1,u)i=!0,s(u);else if(u===!1)i=!0,a=!0;else{if(p===$y.default||i&&c<=0)return i=!0,s(null);T||E()}}_(l,"iterateeCallback");function E(){for(T=!0;c<r&&!i;){var u=n();if(u===null){i=!0,c<=0&&s(null);return}c+=1,t(u.value,u.key,(0,Wy.default)(l))}T=!1}_(E,"replenish"),E()};qf.exports=Hi.default});var Hf=m((Ki,vf)=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.default=Qy;function Qy(r,e){if(e||(e=r.length),!e)throw new Error("arity is undefined");function t(...s){return typeof s[e-1]=="function"?r.apply(this,s):new Promise((n,i)=>{s[e-1]=(a,...c)=>{if(a)return i(a);n(c.length>1?c:c[0])},r.apply(this,s)})}return _(t,"awaitable"),t}_(Qy,"awaitify");vf.exports=Ki.default});var Wf=m((Wi,Kf)=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});var jy=If(),Jy=pl(jy),Zy=Gf(),eL=pl(Zy),tL=Hf(),sL=pl(tL);function pl(r){return r&&r.__esModule?r:{default:r}}_(pl,"_interopRequireDefault");function rL(r,e,t,s){return(0,Jy.default)((0,eL.default)(e),r,t,s)}_(rL,"mapLimit");Wi.default=(0,sL.default)(rL,4);Kf.exports=Wi.default});var $f=m((uV,zf)=>{"use strict";var{Sequence:lV,SequenceDto:EV}=Bi(),nL=Wf(),iL=/(?<=START WITH)(\s+)([\w]+)(?=\s+)?/,oL=/\s+LINK$/,Nt={true:"Y",false:"N"},Oe={cache:"cache",cycle:"cycle",extend:"extend",global:"global",keep:"keep",noCache:"nocache",noCycle:"nocycle",noExtend:"noextend",noKeep:"nokeep",noOrder:"noorder",noScale:"noscale",noShard:"noshard",order:"order",scale:"scale",scaleExtend:"scaleExtend",session:"session",shard:"shard",sharing:"sharing",type:"type"},Xf={[Oe.cycle]:{[Nt.true]:Oe.cycle,[Nt.false]:Oe.noCycle},[Oe.order]:{[Nt.true]:Oe.order,[Nt.false]:Oe.noOrder},[Oe.shard]:{[Nt.true]:Oe.shard,[Nt.false]:""},[Oe.scale]:{[Nt.true]:Oe.scale,[Nt.false]:Oe.noScale},[Oe.type]:{[Nt.true]:Oe.session,[Nt.false]:Oe.global},[Oe.keep]:{[Nt.true]:Oe.keep,[Nt.false]:Oe.noKeep},[Oe.extend]:{[Nt.true]:Oe.extend,[Nt.false]:Oe.noExtend}},aL=_(async({schema:r,allDDLs:e,execute:t,logger:s})=>{try{s.log("info",{message:"Start getting sequences"},"Getting sequences");let n=(await t(`
				SELECT JSON_OBJECT(
				    'sharing'      VALUE ALL_OBJECTS.SHARING,
				    'sequenceName' VALUE ALL_SEQUENCES.SEQUENCE_NAME,
				    'minValue'     VALUE ALL_SEQUENCES.MIN_VALUE,
				    'maxValue'     VALUE ALL_SEQUENCES.MAX_VALUE,
				    'increment'    VALUE ALL_SEQUENCES.INCREMENT_BY,
				    'cycle'        VALUE ALL_SEQUENCES.CYCLE_FLAG,
				    'order'        VALUE ALL_SEQUENCES.ORDER_FLAG,
				    'cacheValue'   VALUE ALL_SEQUENCES.CACHE_SIZE,
				    'scale'        VALUE ALL_SEQUENCES.SCALE_FLAG,
				    'extend'       VALUE ALL_SEQUENCES.EXTEND_FLAG,
				    'shard'        VALUE ALL_SEQUENCES.SHARDED_FLAG,
				    'type'         VALUE ALL_SEQUENCES.SESSION_FLAG,
				    'keep'         VALUE ALL_SEQUENCES.KEEP_VALUE
				)
				FROM ALL_OBJECTS
				LEFT JOIN ALL_SEQUENCES
				  ON ALL_SEQUENCES.SEQUENCE_OWNER = ALL_OBJECTS.OWNER
				  AND ALL_SEQUENCES.SEQUENCE_NAME = ALL_OBJECTS.OBJECT_NAME
				LEFT JOIN ALL_TAB_IDENTITY_COLS
				  ON ALL_TAB_IDENTITY_COLS.SEQUENCE_NAME = ALL_SEQUENCES.SEQUENCE_NAME
				  AND ALL_TAB_IDENTITY_COLS.OWNER = ALL_OBJECTS.OWNER
				-- take only sequences that are not associated with identity columns
				WHERE ALL_OBJECTS.OBJECT_TYPE = 'SEQUENCE' AND ALL_TAB_IDENTITY_COLS.COLUMN_NAME IS NULL
				AND ALL_OBJECTS.OWNER = '${r}'
     		 `)).map(([c])=>JSON.parse(c));if(s.log("info",{message:"Finish getting sequences",count:(n==null?void 0:n.length)||0},"Getting sequences"),!(n!=null&&n.length))return[];let i=SL({sequenceDtos:n,allDDLs:e});s.log("info",{message:"Filtering of sequences used in tables and views finished",usedSequencesCount:(i==null?void 0:i.length)||0},"Getting sequences");let a=await _L({schema:r,namesOfSequences:i.map(c=>c.sequenceName),execute:t,logger:s});return i.map(c=>{let T=a[c.sequenceName]||"";return{...c,ddlScript:T}})}catch(n){s.progress({message:"Warning: Getting sequences failed: sequences are not reverse-engineered.",containerName:r,entityName:""});let{message:i,stack:a,...c}=n;return s.log("error",{message:"Cannot get sequences",error:{message:i,stack:a,err:c}},"Getting sequences"),[]}},"getSchemaSequenceDtos"),_L=_(async({schema:r,namesOfSequences:e,execute:t,logger:s})=>{try{s.log("info",{message:"Start getting sequences DDL"},"Getting DDL of sequences");let n=nL(e,50,async a=>{var c,T;try{let l=await t(`SELECT JSON_OBJECT('ddl' VALUE DBMS_METADATA.GET_DDL('SEQUENCE', '${a}', '${r}')) FROM DUAL`);return[a,((T=JSON.parse(((c=l==null?void 0:l[0])==null?void 0:c[0])||"{}"))==null?void 0:T.ddl)||""]}catch(l){let{message:E,stack:u,...p}=l;return s.log("error",{sequenceName:a,schema:r,message:E,stack:u,err:p},"Getting sequence DDL ERROR"),[a,""]}}),i=await Promise.race([n,NL(3e4,"Timeout error on getting sequences DDL.")]);return s.log("info",{message:"Finish getting sequences DDL",count:(i==null?void 0:i.length)||0},"Getting DDL of sequences"),i!=null&&i.length?Object.fromEntries(i):{}}catch(n){s.progress({message:"Warning: Getting DDL of sequences failed: sequences are created but the \u201Cstart with\u201D property is defaulted to its \u201Cmin/max\u201D value.",containerName:r,entityName:""});let{message:i,stack:a,...c}=n;return s.log("error",{message:"Cannot get sequences DDL",error:{message:i,stack:a,err:c}},"Getting DDL of sequences"),{}}},"getSchemaSequenceDdl"),cL=_(({execute:r})=>async({schema:e,allDDLs:t,logger:s})=>(await aL({schema:e,allDDLs:t,execute:r,logger:s})).map(i=>{let a=TL({sequenceDto:i}),c=EL({sequenceDto:i}),T=uL({sequenceDto:i}),l=lL({sequenceDto:i}),E=i.cacheValue?Oe.cache:Oe.noCache;return{sequenceName:i.sequenceName,minValue:i.minValue,maxValue:i.maxValue,increment:i.increment,cacheValue:i.cacheValue,cache:E,sharing:a,...c,...T,...l}}),"getSchemaSequences"),TL=_(({sequenceDto:r})=>{var e,t;return(t=(e=r.sharing)==null?void 0:e.replace(oL,""))==null?void 0:t.toLowerCase()},"getSequenceSharing"),lL=_(({sequenceDto:r})=>{let e=r[Oe.scale],t=r[Oe.shard],s=r[Oe.extend],n=Xf[Oe.extend][s],i=e===Nt.true?n:"",a=t===Nt.true?n:"";return{scaleExtend:i,shardExtend:a}},"getExtendOptions"),EL=_(({sequenceDto:r})=>Object.entries(Xf).reduce((e,[t,s])=>({...e,[t]:s[r[t]]}),{}),"getBooleanOptions"),uL=_(({sequenceDto:r})=>({start:hL({sequenceDto:r})}),"getOptionsFromDdl"),hL=_(({sequenceDto:r})=>{var s;let e=r.ddlScript;if(!e.includes("START WITH"))return r.minValue<r.maxValue?r.minValue:r.maxValue;let t=(s=e.match(iL))==null?void 0:s[2];return isNaN(Number(t))?t:Number(t)},"getStartOptionFromDdl"),NL=_((r,e)=>new Promise((t,s)=>setTimeout(()=>s(new Error(e+" TIMEOUT: "+r)),r)),"throwErrorOnTimeout"),SL=_(({sequenceDtos:r,allDDLs:e})=>{let t=[];for(let s of r)new RegExp("\\b"+s.sequenceName+"\\b","i").test(e)&&t.push(s);return t},"filterUsedSequences");zf.exports={getSchemaSequences:cL}});var Rl=m((NV,tm)=>{"use strict";var En=Ap(),AL=jp(),ln=require("path"),zi=require("fs"),dL=Tf(),{getSchemaSequences:pL}=$f(),Ie=require("lodash"),jf={message:"Connection error"},Ss,fl,fL=_((r="")=>{let e=r.match(/http:\/\/(?:.*?:.*?@)?(.*?):(\d+)/i);return e?{httpsProxy:e[1],httpsProxyPort:e[2]}:{}},"parseProxyOptions"),Jf=_(r=>[r,process.env.TNS_ADMIN,ln.join(process.env.ORACLE_HOME||"","network","admin"),ln.join(process.env.LD_LIBRARY_PATH||"","network","admin")].reduce((t,s)=>{if(t)return t;let n=ln.join(s,"tnsnames.ora");return zi.existsSync(n)?n:t},""),"getTnsNamesOraFile"),Zf=_(r=>{let e=zi.readFileSync(r).toString();return dL(e)},"parseTnsNamesOra"),mL=_((r,e,t,s)=>{var p,A,h,N,d,S,D,P;let n=Jf(r);if(!zi.existsSync(n))return e;s({message:"Found tnsnames.ora file: "+n});let i=Zf(n);s({message:"tnsnames.ora successfully parsed"});let a=Object.keys(i);if(!i[e]&&a.length===0)return s({message:`Cannot find '${e}' in tnsnames.ora and no fallback found`}),e;let[c]=a,T=i[e]||i[c];i[e]?s({message:`Connect using TNS service ${e}' from ${ln.join(r,"tnsnames.ora")}.`}):s({message:`Connect using first TNS service ${c}' from ${ln.join(r,"tnsnames.ora")}.`});let l=(A=(p=T==null?void 0:T.data)==null?void 0:p.description)==null?void 0:A.address,E=(d=(N=(h=T==null?void 0:T.data)==null?void 0:h.description)==null?void 0:N.connect_data)==null?void 0:d.service_name,u=(P=(D=(S=T==null?void 0:T.data)==null?void 0:S.description)==null?void 0:D.connect_data)==null?void 0:P.sid;return s({message:"tnsnames.ora",address:l,service:E}),ml(Ie.omitBy({...l,...t,protocol:(l==null?void 0:l.protocol)||"tcps",service:E||e,sid:u},Ie.isUndefined),s)},"getConnectionStringByTnsNames"),Xi=_((r,e)=>r?e:"","combine"),ml=_(({protocol:r,host:e,port:t,sid:s,service:n,httpsProxy:i,httpsProxyPort:a},c)=>{let T=`(DESCRIPTION=
		(ADDRESS=
			(PROTOCOL=${r||"tcp"})
			(HOST=${e})
			(PORT=${t}))
			${Xi(i,`(HTTPS_PROXY=${i})`)}
			${Xi(a,`(HTTPS_PROXY_PORT=${a})`)}
		(CONNECT_DATA=
					${Xi(s,`(SID=${s})`)}
					${Xi(n,`(SERVICE_NAME=${n})`)}
		)
	)`;return c({message:"connectionString",connectionString:T}),T},"getConnectionDescription"),PL=_(async(r,e,t)=>{var i,a,c,T,l,E,u,p,A,h,N;let s={protocol:"",host:"",port:"",service:""};if(["Wallet","TNS"].includes(r.connectionMethod)){let d=Jf(r.configDir);if(!zi.existsSync(d))throw new Error("Cannot find tnsnames.ora file. Please, specify tnsnames folder or use Base connection method.");t({message:"Found tnsnames.ora file: "+d});let S=Zf(d);if(!S[r.serviceName])throw new Error('Cannot find "'+r.serviceName+'" in tnsnames.ora');let D=(c=(a=(i=S[r.serviceName])==null?void 0:i.data)==null?void 0:a.description)==null?void 0:c.address,P=(u=(E=(l=(T=S[r.serviceName])==null?void 0:T.data)==null?void 0:l.description)==null?void 0:E.connect_data)==null?void 0:u.service_name,y=(N=(h=(A=(p=S[r.serviceName])==null?void 0:p.data)==null?void 0:A.description)==null?void 0:h.connect_data)==null?void 0:N.sid;t({message:"tnsnames.ora",address:D,service:P}),s.protocol=D==null?void 0:D.protocol,s.host=D==null?void 0:D.host,s.port=D==null?void 0:D.port,s.service=P||r.serviceName,s.sid=y}else s.host=r.host,s.port=r.port,s.service=r.serviceName,s.sid=r.sid;let{options:n}=await e.openTunnel({sshAuthMethod:r.sshConfig.ssh_method==="privateKey"?"IDENTITY_FILE":"USER_PASSWORD",sshTunnelHostname:r.sshConfig.ssh_host,sshTunnelPort:r.sshConfig.ssh_port,sshTunnelUsername:r.sshConfig.ssh_user,sshTunnelPassword:r.sshConfig.ssh_password,sshTunnelIdentityFile:r.sshConfig.ssh_key_file,sshTunnelPassphrase:r.sshConfig.ssh_key_passphrase,host:s.host,port:s.port});return ml({...s,host:n.host,port:n.port.toString()},t)},"getSshConnectionString"),RL=_(async({walletFile:r,walletPassword:e,tempFolder:t,name:s,connectionMethod:n,TNSpath:i,host:a,port:c,userName:T,userPassword:l,serviceName:E,clientPath:u,clientType:p,queryRequestTimeout:A,authMethod:h,options:N,sid:d,ssh:S,ssh_user:D,ssh_host:P,ssh_port:y,ssh_method:Y,ssh_key_file:V,ssh_key_passphrase:k,ssh_password:$,authRole:C,mode:G},R,w)=>{if(Ss)return Ss;let x={thin:"thin",thick:"thick"},j,re,q={},Ee="";n==="Wallet"&&(j=await AL({walletFile:r,tempFolder:t,name:s}),process.env.TNS_ADMIN=j),n==="TNS"&&(j=i),p==="InstantClient"&&(re=u),N!=null&&N.proxy&&(Ee=fL(N==null?void 0:N.proxy)),G!==x.thin&&En.initOracleClient({libDir:re,configDir:j});let M="";return["Wallet","TNS"].includes(n)?M=mL(j,E,Ee,w):M=ml({host:a,port:c,sid:d,service:E},w),S&&(fl=!0,M=await PL({host:a,port:c,configDir:j,serviceName:E,sid:d,connectionMethod:n,sshConfig:{ssh_user:D,ssh_host:P,ssh_port:y,ssh_method:Y,ssh_key_file:V,ssh_password:$,ssh_key_passphrase:k}},R,w)),h==="OS"?q.externalAuth=!0:h==="Kerberos"?(q.username=T,q.password=l,q.externalAuth=!0):(q.username=T,q.password=l),DL({connectString:M,username:T,password:l,queryRequestTimeout:A,authRole:C,walletLocation:j,walletPassword:e})},"connect"),IL=_(async r=>Ss?(fl&&(fl=!1,await r.closeConsumer()),new Promise((e,t)=>{Ss.close(s=>{if(Ss=null,s)return t(s);e()})})):Promise.reject(jf),"disconnect"),DL=_(({connectString:r,username:e,password:t,queryRequestTimeout:s,authRole:n,walletPassword:i,walletLocation:a})=>new Promise((c,T)=>{let l={username:e,password:t,connectString:r,privilege:n==="default"?void 0:En[n],walletLocation:a,walletPassword:i};En.getConnection(l,(E,u)=>{if(E)return Ss=null,T(E);try{u.callTimeout=Number(s||0),Ss=u,c()}catch(p){T(p)}})}),"authByCredentials"),CL=_(async({includeSystemCollection:r,schemaName:e},t)=>{let s="SELECT USERNAME FROM ALL_USERS",n,i="";return e&&(i=`USERNAME = '${e}'`),r?n=`${s}${i?` WHERE ${i}`:""}`:n=`${s} WHERE ORACLE_MAINTAINED = 'N'${i?` AND ${i}`:""}`,await Pt(n).catch(a=>(t.info({message:"Cannot retrieve schema names"}),t.error(a),[]))},"getSchemaNames"),OL=_(r=>Ie.reduce(r,(e,t)=>({...e,[t[0]]:[...e[t[0]]||[],t[1]]}),{}),"pairToObj"),$i=_((r,e,t)=>{let s="";return t&&(s=`T.OWNER = '${t}'`),Pt(e?`${r}${s?` WHERE ${s}`:""}`:`${r} INNER JOIN ALL_USERS U ON T.OWNER = U.USERNAME WHERE U.ORACLE_MAINTAINED = 'N'${s?` AND ${s}`:""}`)},"selectEntities"),gL=_(({includeSystemCollection:r,schemaName:e})=>$i("SELECT T.OWNER, T.TABLE_NAME FROM ALL_TABLES T",r,e),"tableNamesByUser"),yL=_(({includeSystemCollection:r,schemaName:e})=>$i("SELECT T.OWNER, T.TABLE_NAME FROM ALL_EXTERNAL_TABLES T",r,e),"externalTableNamesByUser"),LL=_(({includeSystemCollection:r,schemaName:e})=>$i("SELECT T.OWNER, T.VIEW_NAME || ' (v)' FROM ALL_VIEWS T",r,e),"viewNamesByUser"),wL=_(({includeSystemCollection:r,schemaName:e})=>$i("SELECT T.OWNER, T.MVIEW_NAME || ' (v)' FROM ALL_MVIEWS T",r,e),"materializedViewNamesByUser"),BL=_(async(r,e)=>{let t=await wL(r).catch(T=>(e.info({message:"Cannot retrieve materialized views"}),e.error(T),[]));e.info({materializedViews:t});let s=t.map(T=>Ie.join(T,".").slice(0,-4)),n=await gL(r).then(T=>Ie.reject(T,l=>s.includes(Ie.join(l,".")))).catch(T=>(e.info({message:"Cannot retrieve tables"}),e.error(T),[]));e.info({tables:n});let i=await yL(r).catch(T=>(e.info({message:"Cannot retrieve external tables"}),e.error(T),[]));e.info({externalTables:i});let a=await LL(r).catch(T=>(e.info({message:"Cannot retrieve views"}),e.error(T),[]));e.info({views:a});let c=OL([...n,...i,...a,...t]);return Object.keys(c).reduce((T,l)=>[...T,{dbName:l,dbCollections:c[l],isEmpty:!c[l].length}],[])},"getEntitiesNames"),Pt=_((r,e={},t=[])=>Ss?new Promise((s,n)=>{Ss.execute(r,t,e,(i,a)=>{if(i)return n(i);s(a.rows)})}):Promise.reject(jf),"execute"),UL=_(async r=>{var s,n;let e=["12c","18c","19c","21c","23ai"],t="21c";try{let i=await Pt("SELECT VERSION FROM PRODUCT_COMPONENT_VERSION WHERE product LIKE 'Oracle Database%'");r.log("info",i,"DB Version");let a=(n=(s=i==null?void 0:i[0])==null?void 0:s[0])==null?void 0:n.split(".").shift();return a&&e.find(T=>T.startsWith(a))||t}catch(i){return r.log("error",{message:i.message,stack:i.stack},"Error of getting DB Version"),t}},"getDbVersion"),YL=_(r=>r.slice(-4)===" (v)","isView"),ML=_(r=>{let e=Ie.partition(r,YL);return{views:e[0].map(t=>t.slice(0,-4)),tables:e[1]}},"splitEntityNames"),Pl=_(()=>Pt(`BEGIN
		DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM,'SQLTERMINATOR', TRUE);
	END;`),"setSQLTerminator"),VL=_(async(r,e,t)=>{var s;try{await Pl();let n=await Pt(`
			SELECT JSON_OBJECT(
			'tableDDL' VALUE DBMS_METADATA.GET_DDL('TABLE', T.TABLE_NAME, T.OWNER),
			'countOfRecords' VALUE (SELECT COUNT(*) FROM ALL_TABLES WHERE TABLE_NAME='${r}'),
			'indexDDLs' VALUE (
				SELECT JSON_ARRAYAGG(DBMS_METADATA.GET_DDL('INDEX', INDEX_NAME, OWNER) RETURNING CLOB)
				FROM ALL_INDEXES
				WHERE TABLE_OWNER=T.OWNER
					AND TABLE_NAME=T.TABLE_NAME
					AND INDEX_NAME NOT IN (
						SELECT CONSTRAINT_NAME
						FROM ALL_CONSTRAINTS
						WHERE CONSTRAINT_TYPE='P'
						AND OWNER=T.OWNER
						AND TABLE_NAME=T.TABLE_NAME
					)
				),
			'jsonColumns' VALUE (
				SELECT JSON_ARRAYAGG(JSON_OBJECT('name' VALUE COLUMN_NAME, 'datatype' VALUE DATA_TYPE) RETURNING CLOB)
				FROM ALL_TAB_COLUMNS
				WHERE TABLE_NAME=T.TABLE_NAME
				AND OWNER=T.OWNER
				AND DATA_TYPE IN ('CLOB', 'BLOB', 'NVARCHAR2', 'JSON')
			),
			'tableComment' VALUE (
				SELECT COMMENTS
				FROM ALL_TAB_COMMENTS
				WHERE OWNER = T.OWNER AND TABLE_NAME = T.TABLE_NAME AND COMMENTS IS NOT NULL
			),
			'columnComments' VALUE (
				SELECT JSON_ARRAYAGG(JSON_OBJECT('name' VALUE COLUMN_NAME, 'comment' VALUE COMMENTS) RETURNING CLOB)
				FROM ALL_COL_COMMENTS
				WHERE OWNER = T.OWNER AND TABLE_NAME = T.TABLE_NAME  AND COMMENTS IS NOT NULL
			) RETURNING CLOB
			)
			FROM ALL_TABLES T
			WHERE T.OWNER='${e}' AND T.TABLE_NAME='${r}'
		`),i=await((s=Ie.first(Ie.first(n)))==null?void 0:s.getData());try{let a=JSON.parse(i);t.log("info",a,`Getting DDL from "${e}"."${r}"`);let c=a.tableComment?`COMMENT ON TABLE ${Ys(e)}.${Ys(r)} IS ${Qf(a.tableComment)};`:"",T=Ie.map(a.columnComments,E=>`COMMENT ON COLUMN ${Ys(e)}.${Ys(r)}.${Ys(E.name)}  IS ${Qf(E.comment)};`);return{ddl:`${a.tableDDL}
				${Ie.join(a.indexDDLs,`
`)}
				${c}

				${Ie.join(T,`
`)}`,jsonColumns:a.jsonColumns,countOfRecords:a.countOfRecords}}catch(a){return t.log("error",{message:`Cannot parse query result: 

`+i,error:{message:a.message,stack:a.stack,err:Ie.omit(a,["message","stack"])}},`Getting DDL from "${e}"."${r}"`),{ddl:"",jsonColumns:[],countOfRecords:0}}}catch(n){if((n==null?void 0:n.errorNum)===31603&&!await em(t))throw n;return t.log("error",{message:"Cannot get DDL for table: "+r,error:{message:n.message,stack:n.stack,err:Ie.omit(n,["message","stack"])}},`Getting DDL from "${e}"."${r}"`),{ddl:"",jsonColumns:[],countOfRecords:0}}},"getDDL"),FL=_(r=>Object.keys(r).reduce(async(e,t)=>{let s=await e,n=r[t];return n instanceof En.Lob&&(n=await n.getData()),n instanceof Buffer&&(n=n.toString()),s[t]=n,s},Promise.resolve({})),"readLobs"),xL=_(async r=>await r.reduce(async(e,t)=>{let s=await e,n=await FL(t);return s.concat(n)},Promise.resolve([])),"readRecordsValues"),Ys=_(r=>/[\s\da-z]/.test(r)?`"${r}"`:r,"escapeName"),Qf=_(r=>`'${r.replaceAll("'","''")}'`,"escapeComment"),bL=_((r,e)=>e.map(t=>r.reduce((s,n)=>(s[n]=t[n],s),{})),"replaceNames"),kL=_(async({tableName:r,limit:e,jsonColumns:t,schema:s})=>{let n=Ie.map(t,c=>c.name),i=await Pt(`SELECT ${n.map(c=>Ys(c)).join(", ")} FROM ${Ys(s)}.${Ys(r)} FETCH NEXT ${e} ROWS ONLY`,{outFormat:En.OBJECT});return await xL(bL(n,i))},"selectRecords"),qL=_((r,e)=>{let t={number:"number",boolean:"boolean",string:"string"};return r.reduce((s,n)=>{if(s)return s;let i=n[e];return Array.isArray(i)?"array":typeof i=="object"?i?"object":"null":t[typeof i]??s},"")},"getJsonType"),GL=_(r=>`json${r.charAt(0).toUpperCase()}${r.slice(1)}`,"getJsonTypeName"),vL=_(async(r,e)=>{let t={CLOB:{type:"lobs",mode:"clob"},BLOB:{type:"lobs",mode:"blob"},NVARCHAR2:{type:"char",mode:"nvarchar2"},JSON:{type:"json"}};return{properties:r.reduce((n,i)=>{let a=i.name,c=i.datatype,T=t[c];if(!T)return n;let l=qL(e,a);if(!l)return n;let E=GL(l);return{...n,[a]:{...T,subtype:l,childType:"json",type:E}}},{})}},"getJsonSchema"),HL=_(async(r,e,t)=>{try{let s=await KL(r);if(await Pl(),s){t.log("info",{viewName:r,schema:e},'Is materialized view"');let a=await Pt(`SELECT JSON_OBJECT(
					'viewDDL' VALUE DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW', MV.MVIEW_NAME, MV.OWNER),
					'indexDDLs' VALUE (
						SELECT JSON_ARRAYAGG(DBMS_METADATA.GET_DDL('INDEX', INDEX_NAME, OWNER) RETURNING CLOB)
						FROM ALL_INDEXES
						WHERE TABLE_OWNER=MV.OWNER
							AND TABLE_NAME=MV.MVIEW_NAME
							AND INDEX_NAME NOT IN (
								SELECT CONSTRAINT_NAME
								FROM ALL_CONSTRAINTS
								WHERE CONSTRAINT_TYPE='P'
								AND OWNER=MV.OWNER
								AND TABLE_NAME=MV.MVIEW_NAME
							)
						)
					)
					FROM ALL_MVIEWS MV
					WHERE MV.OWNER='${e}' AND MV.MVIEW_NAME='${r}'`),c=Ie.first(Ie.first(a)),T=JSON.parse(c);return t.log("info",{viewName:r,schema:e},`Getting DDL from "${e}"."${r}"`),`${T.viewDDL}
${Ie.join(T.indexDDLs,`
`)}`}let n=await Pt(`SELECT DBMS_METADATA.GET_DDL('VIEW', VIEW_NAME, OWNER) FROM ALL_VIEWS WHERE VIEW_NAME='${r}'`);return await Ie.first(Ie.first(n)).getData()}catch(s){if((s==null?void 0:s.errorNum)===31603&&!await em(t))throw s;return t.log("error",{message:"Cannot get DDL for view: "+r,error:{message:s.message,stack:s.stack,err:Ie.omit(s,["message","stack"])}},"Getting DDL"),""}},"getViewDDL"),KL=_(async r=>{await Pl();let e=await Pt(`SELECT * FROM ALL_MVIEWS WHERE MVIEW_NAME = '${r}'`);return!Ie.isEmpty(e)},"checkEntityMaterializedView"),em=_(async r=>{var e;try{let t=await Pt("SELECT sys_context('USERENV', 'CURRENT_USER') FROM dual"),s=Ie.first(Ie.first(t));return((e=await Pt(`SELECT GRANTED_ROLE FROM USER_ROLE_PRIVS WHERE USERNAME = '${s}'`))==null?void 0:e.map(([i])=>i)).includes("SELECT_CATALOG_ROLE")}catch(t){return r.log("error",{message:"Checking user privileges error",error:{message:t.message,stack:t.stack,err:Ie.omit(t,["message","stack"])}},"Getting DDL"),!1}},"checkUserHaveRequiredRole"),WL=_(r=>{r.log("info",{TNS_ADMIN:process.env.TNS_ADMIN??"",ORACLE_HOME:process.env.ORACLE_HOME??"",LD_LIBRARY_PATH:process.env.LD_LIBRARY_PATH??"",ORACLE_BASE:process.env.ORACLE_BASE??""},"Environment variables")},"logEnvironment"),XL=_(async({schema:r,allDDLs:e,logger:t})=>{try{t.log("info",{message:"Start getting synonyms"},"Getting synonyms");let s=await Pt(`
			SELECT ALL_SYNONYMS.OWNER,
			    ALL_SYNONYMS.SYNONYM_NAME,
			    ALL_SYNONYMS.TABLE_NAME,
			    ALL_OBJECTS.EDITIONABLE 
			  FROM ALL_SYNONYMS
			  LEFT JOIN ALL_OBJECTS
			    ON ALL_OBJECTS.OWNER = ALL_SYNONYMS.OWNER
			    AND ALL_OBJECTS.OBJECT_NAME = ALL_SYNONYMS.SYNONYM_NAME
			  WHERE ORIGIN_CON_ID > 1 AND ALL_SYNONYMS.TABLE_OWNER = '${r}'
			`);if(t.log("info",{message:"Finish getting synonyms",count:(s==null?void 0:s.length)||0},"Getting synonyms"),Ie.isEmpty(s))return[];let n=s.map(([i,a,c,T])=>({synonymPublic:i==="PUBLIC",synonymName:a,synonymEntityId:c,synonymEditionable:T===null||T==="N"?"NONEDITIONABLE":"EDITIONABLE"}));return zL({synonyms:n,allDDLs:e})}catch(s){t.log("error",{message:"Cannot get synonyms",error:{message:s.message,stack:s.stack,err:Ie.omit(s,["message","stack"])}},"Getting synonyms")}},"getSchemaSynonyms"),zL=_(({synonyms:r,allDDLs:e})=>{let t=[];for(let s of r)new RegExp("\\b"+s.synonymName+"\\b","i").test(e)&&t.push(s);return t},"filterUsedSynonyms");tm.exports={connect:RL,disconnect:IL,getEntitiesNames:BL,getSchemaNames:CL,splitEntityNames:ML,getDDL:VL,getJsonSchema:vL,getViewDDL:HL,getDbVersion:UL,selectRecords:kL,logEnvironment:WL,execute:Pt,getSchemaSynonyms:XL,getSchemaSequences:pL({execute:Pt})}});var im=m((AV,nm)=>{"use strict";var Qi=require("lodash"),sm=eu(),Ut=Rl();nm.exports={async connect(r,e,t,s){let n=s.require("@hackolade/ssh-service");sm("Connect to instance",r,e),Ut.logEnvironment(e);try{await Ut.connect(r,n,i=>{e.log("info",i,"Connection")}),t()}catch(i){throw rm(e,i,t),i}},async disconnect(r,e,t,s){try{let n=s.require("@hackolade/ssh-service");await Ut.disconnect(n),t(null)}catch(n){rm(e,n,t)}},async testConnection(r,e,t,s){try{await this.connect(r,e,()=>{},s),t(null)}catch(n){e.log("error",{message:n.message,stack:n.stack,error:n},"Test connection"),t({message:n.message,stack:n.stack})}},async getSchemaNames(r,e,t,s){try{sm("Get schemas",r,e),await this.connect(r,e,()=>{},s);let n=await Ut.getSchemaNames();return e.log("info",n,"All schemas list",r.hiddenKeys),t(null,n)}catch(n){return e.log("error",{message:n.message,stack:n.stack,error:n},"Get schemas"),t({message:n.message,stack:n.stack})}},async getDbCollectionsNames(r,e,t,s){try{await this.connect(r,e,()=>{},s);let n=await Ut.getEntitiesNames(r,{info:i=>{e.log("info",i,"Retrieving table and view names")},error:i=>{e.log("error",{message:i.message,stack:i.stack,error:i},"Retrieving databases and tables information")}});t(null,n)}catch(n){e.log("error",{message:n.message,stack:n.stack,error:n},"Retrieving databases and tables information"),t({message:n.message,stack:n.stack})}},async getDbCollectionsData(r,e,t,s){try{let n=_(({message:E,containerName:u="",entityName:p=""})=>{e.log("info",{message:E,schema:u,table:p},"Retrieving schema"),e.progress({message:E,containerName:u,entityName:p})},"progress");e.log("info",r,"Retrieving schema",r.hiddenKeys),n({message:"Start reverse-engineering process",containerName:"",entityName:""});let i=r.collectionData,a=i.collections,c=i.dataBaseNames,T=await Ut.getDbVersion(e),l=await c.reduce(async(E,u)=>{let p=await E,A=Ut.splitEntityNames(a[u]),h=await A.tables.reduce(async(V,k)=>{let $=await V;n({message:"Start getting data from table",containerName:u,entityName:k});let{ddl:C,countOfRecords:G,jsonColumns:R}=await Ut.getDDL(k,u,e),w=[],x={};if(!Qi.isEmpty(R)){let j=$L(G,r.recordSamplingSettings);n({message:`Fetching columns for JSON schema inference: ${JSON.stringify(R)}`,containerName:u,entityName:k}),w=await Ut.selectRecords({tableName:k,limit:j,jsonColumns:R,schema:u}),x=await Ut.getJsonSchema(R,w)}return n({message:"Data retrieved successfully",containerName:u,entityName:k}),$.concat({dbName:u,collectionName:k,entityLevel:{},documents:w,views:[],ddl:{script:C,type:"oracle",takeAllDdlProperties:!0},emptyBucket:!1,validation:{jsonSchema:x},bucketInfo:{database:u}})},Promise.resolve([])),N=await A.views.reduce(async(V,k)=>{let $=await V;n({message:"Start getting data from view",containerName:u,entityName:k});let C=await Ut.getViewDDL(k,u,e);return n({message:"Data retrieved successfully",containerName:u,entityName:k}),$.concat({name:k,data:{},ddl:{script:C,type:"oracle",takeAllDdlProperties:!0}})},Promise.resolve([]));if(Qi.isEmpty(N))return[...p,...h];let d=h.map(V=>V.ddl.script).join(""),S=N.map(V=>V.ddl.script).join(""),D=[d,S].join("").toLowerCase(),P=await Ut.getSchemaSequences({schema:u,allDDLs:D,logger:e}),y=await Ut.getSchemaSynonyms({schema:u,allDDLs:D,logger:e}),Y={dbName:u,entityLevel:{},views:N,emptyBucket:!1,bucketInfo:{indexes:[],database:u,synonyms:y,sequences:P}};return[...p,...h.map(V=>({...V,bucketInfo:{...V.bucketInfo,synonyms:y,sequences:P}})),Y]},Promise.resolve([]));n({message:"Start processing the retrieved data in the application ..."}),t(null,l.filter(Boolean),{version:T})}catch(n){if((n==null?void 0:n.errorNum)===31603)return e.log("error",{message:"Missing required role \u201CSELECT_CATALOG_ROLE\u201D to perform this operation",stack:n.stack,error:n},"Reverse-engineering process failed"),t({message:"Missing required role \u201CSELECT_CATALOG_ROLE\u201D to perform this operation",type:"simpleError"});e.log("error",{message:n.message,stack:n.stack,error:n},"Reverse-engineering process failed"),t({message:n.message,stack:n.stack})}}};var rm=_((r,e,t)=>{let s=Qi.isString(e)?e:Qi.get(e,"message","Reverse Engineering error");r.log("error",{error:e},"Reverse Engineering error"),t(s)},"handleError"),$L=_((r,e)=>{if(e.active==="absolute")return Number(e.absolute.value);let t=Math.ceil(r*e.relative.value/100);return Math.min(t,e.maxValue)},"getSampleDocSize")});var am=m((pV,om)=>{"use strict";var Il=Rl(),Dl=require("lodash"),QL=_(async(r,e,t)=>{let s=t.require("async"),n=t.require("@hackolade/ssh-service");Il.logEnvironment(e),await Il.connect(r,n,c=>{e.log("info",c,"Connection")});let i=r.script.split(`

`).filter(Boolean).map(c=>Dl.trim(Dl.trim(Dl.trim(c),"/"),";")),a;if(await s.mapSeries(i,async c=>{try{c.endsWith("END")&&(c+=";");let T="Query: "+c.split(`
`).shift().substr(0,150);e.progress({message:T}),e.log("info",{message:T},"Apply to instance"),await Il.execute(c)}catch(T){let l=T.errorNum===955,E=T.errorNum===1920;if(l||E)return;a=T,e.progress({message:"[color:red]Not executed..."}),e.log("error",{message:T.message,stack:T.stack,query:c},"Error applying to instance")}}),a)throw new Error(`Not all statements executed successfully.
Please, see HackoladeFE.log for more details.`)},"applyToInstance");om.exports={applyToInstance:QL}});var xt=m((mV,_m)=>{"use strict";var gl=class gl{script;isDropScript};_(gl,"ModificationScript");var Cl=gl,yl=class yl{isActivated;scripts;static getInstances(e,t,s){return(e||[]).filter(Boolean).map(n=>({isActivated:t,scripts:[{isDropScript:s,script:n}]}))}static getInstance(e,t,s){var n;if((n=e==null?void 0:e.filter(Boolean))!=null&&n.length)return{isActivated:t,scripts:e.filter(Boolean).map(i=>({isDropScript:s,script:i}))}}static getDropAndRecreateInstance(e,t,s){let n=[];if(e&&n.push({isDropScript:!0,script:e}),t&&n.push({isDropScript:!1,script:t}),!!(n!=null&&n.length))return{isActivated:s,scripts:n}}};_(yl,"AlterScriptDto");var Ol=yl;_m.exports={ModificationScript:Cl,AlterScriptDto:Ol}});var le=m((IV,cm)=>{"use strict";var RV=require("lodash");cm.exports=r=>{let e=_(R=>r.get(R,"[0].code")||r.get(R,"[0].name",""),"getDbName"),t=_(R=>R&&(R.code||R.collectionName)||"","getEntityName"),s=_(R=>R&&(R.code||R.name)||"","getViewName"),n=_(R=>R&&(R.code||R.name)||"","getBucketName"),i=_(R=>({...r.get(R,"[0]",{}),name:e(R)}),"getDbData"),a=_(R=>r.get(R,"[0].viewOn"),"getViewOn"),c=_(R=>w=>w.primaryTableId===R&&w.primaryTableId!==w.foreignTableId,"isRecursiveRelationship"),T=_(R=>Object.keys(R).reduce((w,x)=>{let j=R[x].filter(re=>{let q=R[re.primaryTableId];return Array.isArray(q)?!q.some(c(x)):!0});return r.isEmpty(j)?w:{...w,[x]:j}},{}),"rejectRecursiveRelationships"),l=_(R=>Object.keys(R).reduce((w,x)=>{let j=R[x].filter(re=>{let q=R[re.primaryTableId];return Array.isArray(q)?q.some(c(x)):!1});return w.concat(j)},[]),"filterRecursiveRelationships"),E=_((R,w="	")=>R.split(`
`).map(x=>w+x).join(`
`),"tab"),u=_((R,w)=>Object.keys(R).map(r.toLower).includes(r.toLower(w)),"hasType"),p=_(R=>Object.entries(R).filter(([w,x])=>!r.isNil(x)).reduce((w,[x,j])=>({...w,[x]:j}),{}),"clean"),A=_(R=>R.every(w=>r.get(w,"isActivated",!0)),"checkAllKeysActivated"),h=_(R=>R.length?R.every(w=>!r.get(w,"isActivated",!0)):!1,"checkAllKeysDeactivated"),N=_((R,w)=>{let x=R.filter(re=>r.get(re,"isActivated",!0)).map(w),j=R.filter(re=>!r.get(re,"isActivated",!0)).map(w);return{activatedItems:x,deactivatedItems:j}},"divideIntoActivatedAndDeactivated"),d=_((R,{isActivated:w,isPartOfLine:x,inlineComment:j="--"})=>w!==!1?R:x?"/* "+R+" */":R.includes(`
`)?`/*
`+R+` */
`:j+" "+R,"commentIfDeactivated"),S=_((R,w="'",x="'")=>{let j=R[0];return R[R.length-1]===w&&j===x?R:`${w}${R}${x}`},"wrap"),D=_(R=>`"${R}"`,"wrapInQuotes"),P=_(R=>w=>R==="nonquotedIdentifier"?w:D(w),"prepareNameForScriptFormat"),y=_(R=>`'${R}'`,"wrapComment"),Y=_(R=>(w,x)=>x?`${P(R)(x)}.${P(R)(w)}`:P(R)(w),"getNamePrefixedWithSchemaNameForScriptFormat"),V=_((R,w)=>w.some(x=>(R==null?void 0:R.oldField[x])!==(R==null?void 0:R.newField[x])),"checkFieldPropertiesChanged"),k=_(({name:R})=>D(R),"columnMapToString");return{getDbName:e,getBucketName:n,getDbData:i,getEntityName:t,getViewName:s,getViewOn:a,rejectRecursiveRelationships:T,filterRecursiveRelationships:l,tab:E,hasType:u,clean:p,checkAllKeysActivated:A,checkAllKeysDeactivated:h,divideIntoActivatedAndDeactivated:N,commentIfDeactivated:d,wrap:S,wrapComment:y,wrapInQuotes:D,getNamePrefixedWithSchemaNameForScriptFormat:Y,checkFieldPropertiesChanged:V,getColumnsList:_((R,w,x,j=k)=>{var Ee;let re=N(R,j),q=(Ee=re==null?void 0:re.deactivatedItems)!=null&&Ee.length?d(re.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!w&&x?" ("+re.activatedItems.join(", ")+q+")":" ("+R.map(j).join(", ")+")"},"getColumnsList"),escapeSingleQuote:_(R=>R.replaceAll("'","''"),"escapeSingleQuote"),getGroupItemsByCompMode:_(({newItems:R=[],oldItems:w=[]})=>{let x=R.filter(q=>!w.some(Ee=>Ee.id===q.id)),j=[],re=[];return w.forEach(q=>{let Ee=R.find(M=>M.id===q.id);Ee?r.isEqual(Ee,q)||re.push(Ee):j.push(q)}),{added:x,removed:j,modified:re}},"getGroupItemsByCompMode"),prepareNameForScriptFormat:P}}});var um=m((CV,Em)=>{"use strict";var{AlterScriptDto:Tm}=xt(),lm=require("lodash"),jL=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(lm),i=`CREATE USER ${s(e)(t)} NO AUTHENTICATION;`;return Tm.getInstance([i],!0,!1)},"getAddContainerScriptDto"),JL=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(lm),i=`DROP USER ${s(e)(t)};`;return Tm.getInstance([i],!0,!0)},"getDeleteContainerScriptDto");Em.exports={getAddContainerScriptDto:jL,getDeleteContainerScriptDto:JL}});var Nm=m((gV,hm)=>{"use strict";var{AlterScriptDto:ZL}=xt(),ew=_((r,e,t)=>s=>{var p;let{checkFieldPropertiesChanged:n,prepareNameForScriptFormat:i,getNamePrefixedWithSchemaNameForScriptFormat:a,getEntityName:c}=le()(r),T={...s,...r.omit(s==null?void 0:s.role,"properties")||{}},l=c(T),E=(p=T.compMod)==null?void 0:p.keyspaceName,u=a(t)(l,E);return r.toPairs(s.properties).filter(([A,h])=>n(h.compMod,["type","mode"])).map(([A,h])=>`ALTER TABLE ${u} MODIFY (${i(t)(A)} ${r.toUpper(h.compMod.newField.mode||h.compMod.newField.type)});`).map(A=>ZL.getInstance([A],!0,!1))},"getUpdateTypesScriptDtos");hm.exports={getUpdateTypesScriptDtos:ew}});var Am=m((LV,Sm)=>{"use strict";var{AlterScriptDto:tw}=xt(),sw=_((r,e,t)=>s=>{var p;let{checkFieldPropertiesChanged:n,getEntityName:i,getNamePrefixedWithSchemaNameForScriptFormat:a,prepareNameForScriptFormat:c}=le()(r),T={...s,...r.omit(s==null?void 0:s.role,"properties")||{}},l=i(T),E=(p=T.compMod)==null?void 0:p.keyspaceName,u=a(t)(l,E);return r.values(s.properties).filter(A=>n(A.compMod,["name"])).map(A=>{let h=c(t)(A.compMod.oldField.name),N=c(t)(A.compMod.newField.name);return e.renameColumn(u,h,N)}).map(A=>tw.getInstance([A],!0,!1))},"getRenameColumnScriptDtos");Sm.exports={getRenameColumnScriptDtos:sw}});var ji=m((BV,dm)=>{"use strict";var Bl=class Bl{type;keyId};_(Bl,"AlterIndexKeyDto");var Ll=Bl,Ul=class Ul{id;indxName;isActivated;ifNotExist;indxType;indxKey;column_expression;tablespace;index_properties;index_attributes;index_compression;logging_clause;indxComments};_(Ul,"AlterIndexDto");var wl=Ul;dm.exports={AlterIndexDto:wl,AlterIndexKeyDto:Ll}});var fm=m((MV,pm)=>{"use strict";var{AlterIndexDto:YV}=ji(),kl=class kl{id;constraintName;indexStorageParameters;indexTablespace;indexInclude};_(kl,"AlterCollectionColumnPrimaryKeyOptionDto");var Yl=kl,ql=class ql{type;isActivated;primaryKey;unique;mode;length;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;primaryKeyOptions;triggerUpdateColumns;compMod;GUID};_(ql,"AlterCollectionColumnDto");var Ml=ql,Gl=class Gl extends Yl{compositePrimaryKey};_(Gl,"AlterCollectionRoleCompModPKDto");var Vl=Gl,vl=class vl{new;old};_(vl,"AlterCollectionRoleCompModPrimaryKey");var Fl=vl,Hl=class Hl{id;type;collectionName;properties;definitions;isActivated;additionalProperties;memory_optimized;collectionUsers;ifNotExist;on_commit;table_tablespace_name;bucketId;compMod;name;roleType;patternProperties};_(Hl,"AlterCollectionRoleDto");var xl=Hl,Kl=class Kl{type;isActivated;unique;subtype;properties;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};_(Kl,"AlterCollectionDto");var bl=Kl;pm.exports={AlterCollectionDto:bl,AlterCollectionRoleDto:xl,AlterCollectionColumnDto:Ml,AlterCollectionRoleCompModPrimaryKey:Fl,AlterCollectionRoleCompModPKDto:Vl}});var Im=m((bV,Rm)=>{"use strict";var{AlterScriptDto:wr}=xt(),{AlterCollectionDto:FV}=fm(),{AlterIndexDto:xV}=ji(),{prepareNameForScriptFormat:Wl}=le()(),rw=["index_compression","tablespace","logging_clause"],nw=["indxType","indxKey","column_expression","index_properties","index_attributes"],iw=_(({_:r})=>({oldIndex:e,newIndex:t})=>nw.some(s=>!r.isEqual(e[s],t[s])),"shouldDropAndRecreateIndex"),ow=_(({oldIndex:r,newIndex:e})=>rw.some(t=>r[t]!==e[t]),"shouldAlterIndexRebuild"),Xl=_(({oldIndex:r,newIndex:e})=>r.id===e.id||r.indxName===e.indxName,"areOldIndexDtoAndNewIndexDtoDescribingSameDatabaseIndex"),mm=_(({index:r,collection:e})=>{var t;return(t=r==null?void 0:r.indxKey)!=null&&t.length?{...r,indxKey:r.indxKey.map(s=>{var T,l,E,u,p,A;if(!(s!=null&&s.keyId))return s;let n=Object.entries(((T=e==null?void 0:e.role)==null?void 0:T.properties)||(e==null?void 0:e.properties)||{}).map(([h,N])=>({...N,name:h})),i=(((E=(l=e==null?void 0:e.role)==null?void 0:l.compMod)==null?void 0:E.oldProperties)||[]).map(h=>({...h,GUID:h.id})),c=(n.length>0?n:i).find(h=>(h==null?void 0:h.GUID)===(s==null?void 0:s.keyId));return c?(u=c==null?void 0:c.compMod)!=null&&u.newField?{...s,name:((A=(p=c==null?void 0:c.compMod)==null?void 0:p.newField)==null?void 0:A.name)||null}:{...s,name:c.name}:s})}:r},"addNameToIndexKey"),aw=_(({_:r,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{var c,T,l,E,u,p;let n=((l=(T=(c=s==null?void 0:s.role)==null?void 0:c.compMod)==null?void 0:T.Indxs)==null?void 0:l.new)||[];return(((p=(u=(E=s==null?void 0:s.role)==null?void 0:E.compMod)==null?void 0:u.Indxs)==null?void 0:p.old)||[]).filter(A=>!n.find(N=>Xl({oldIndex:A,newIndex:N}))).map(A=>_w({ddlProvider:e,scriptFormat:t})({index:A,collection:s}))},"getDeletedIndexesScriptDtos"),_w=_(({ddlProvider:r,scriptFormat:e})=>({index:t})=>{let s=Wl(e)(t.indxName),n=r.dropIndex({name:s});return wr.getInstance([n],t.isActivated,!0)},"getDeleteIndexScriptDto"),Pm=_(({_:r,ddlProvider:e})=>({collection:t})=>{var a,c,T,l;let s=((a=t==null?void 0:t.role)==null?void 0:a.Indxs)||[],n=((l=(T=(c=t==null?void 0:t.role)==null?void 0:c.compMod)==null?void 0:T.Indxs)==null?void 0:l.old)||[];return s.filter(E=>!n.find(p=>Xl({oldIndex:p,newIndex:E}))).map(E=>cw({ddlProvider:e})({index:E,collection:t}))},"getAddedIndexesScriptDtos"),cw=_(({ddlProvider:r})=>({index:e,collection:t})=>{var a,c,T,l,E,u,p;let s=mm({index:e,collection:t}),n=((T=(c=(a=t==null?void 0:t.role)==null?void 0:a.compMod)==null?void 0:c.collectionName)==null?void 0:T.new)||((l=t==null?void 0:t.role)==null?void 0:l.name),i=r.createIndex(n,{...s,schemaName:(p=(u=(E=t==null?void 0:t.role)==null?void 0:E.compMod)==null?void 0:u.bucketProperties)==null?void 0:p.name});return wr.getInstance([i],e.isActivated,!1)},"getAddIndexScriptDto"),Tw=_(({_:r,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{var c,T,l,E,u,p;let n=((l=(T=(c=s==null?void 0:s.role)==null?void 0:c.compMod)==null?void 0:T.Indxs)==null?void 0:l.new)||[],i=((p=(u=(E=s==null?void 0:s.role)==null?void 0:E.compMod)==null?void 0:u.Indxs)==null?void 0:p.old)||[];return n.map(A=>{let h=i.find(N=>Xl({oldIndex:N,newIndex:A}));if(h)return{newIndex:A,oldIndex:h}}).filter(Boolean).flatMap(A=>lw({_:r,ddlProvider:e,scriptFormat:t})({modifiedIndex:A,collection:s}))},"getModifiedIndexesScriptDtos"),lw=_(({_:r,ddlProvider:e,scriptFormat:t})=>({modifiedIndex:{oldIndex:s,newIndex:n},collection:i})=>{var E,u,p,A,h,N;let a=Wl(t)(s.indxName),c=Wl(t)(n.indxName),T=[];if(iw({_:r})({oldIndex:s,newIndex:n})){let d=wr.getInstance([e.dropIndex({name:a})],n.isActivated,!0),S=mm({index:n,collection:i}),D=wr.getInstance([e.createIndex((p=(u=(E=i==null?void 0:i.role)==null?void 0:E.compMod)==null?void 0:u.collectionName)==null?void 0:p.new,{...S,schemaName:(N=(h=(A=i==null?void 0:i.role)==null?void 0:A.compMod)==null?void 0:h.bucketProperties)==null?void 0:N.name})],n.isActivated,!1);return T.push(d,D),T}if(s.indxName!==n.indxName){let d=wr.getInstance([e.alterIndexRename({oldName:a,newName:c})],n.isActivated,!1);T.push(d)}if(ow({oldIndex:s,newIndex:n})){let d=wr.getInstance([e.alterIndexRebuild({name:c,indexData:n})],n.isActivated,!1);T.push(d)}return T},"getModifyIndexScriptDto"),Ew=_(({_:r,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{let n=aw({_:r,ddlProvider:e,scriptFormat:t})({collection:s}),i=Pm({_:r,ddlProvider:e})({collection:s}),a=Tw({_:r,ddlProvider:e,scriptFormat:t})({collection:s});return[...n,...i,...a].filter(Boolean)},"getModifyIndexesScriptDtos");Rm.exports={getModifyIndexesScriptDtos:Ew,getAddedIndexesScriptDtos:Pm}});var un=m((qV,Dm)=>{"use strict";Dm.exports=r=>{let e=require("lodash"),{createColumnDefinition:t}=r.require("@hackolade/ddl-fe-utils"),s=_(i=>i.$ref?i.$ref.split("/").pop():e.toUpper(i.mode||i.childType||i.type),"getType");return{createColumnDefinitionBySchema:_(({name:i,jsonSchema:a,parentJsonSchema:c,ddlProvider:T,schemaData:l,definitionJsonSchema:E})=>t({name:i,jsonSchema:a,parentJsonSchema:c,ddlProvider:T,schemaData:l,definitionJsonSchema:E,getType:s}),"createColumnDefinitionBySchema")}}});var Om=m((vV,Cm)=>{"use strict";Cm.exports={number:"numeric",string:"nvarchar2",date:"date",timestamp:"timestamp",binary:"raw",boolean:"numeric",document:"bfile",array:"json",objectId:"char",default:"nvarchar2"}});var ym=m((HV,gm)=>{"use strict";gm.exports={character:{type:"char"},"character varying":{type:"varchar"},"char varying":{type:"varchar"},"national char":{type:"nchar"},"national character":{type:"nchar"},"national char varying":{type:"nvarchar2"},"national character varying":{type:"nvarchar2"},"nchar varying":{type:"nvarchar2"},tinyint:{type:"number",precision:5},"small int":{type:"number",precision:5},shortinteger:{type:"number",precision:5},shortint:{type:"number",precision:5},smallint:{type:"number",precision:5},int:{type:"number",precision:10},integer:{type:"number",precision:10},shortdecimal:{type:"number",precision:5,scale:0},decimal:{type:"number",precision:5,scale:0},longinteger:{type:"number",precision:20},bigint:{type:"number",precision:20},int8:{type:"number",precision:20},bit:{type:"number",precision:1},real:{type:"float",length:23},"double precision":{type:"number"},"small money":{type:"float",precision:16,scale:2},money:{type:"float",precision:16,scale:2},"long varchar":{type:"long"},text:{type:"long"},ntext:{type:"long"},uniqueidentifier:{type:"char",length:36},uuid:{type:"char",length:36},datetime:{type:"date"},"small datetime":{type:"date"},image:{type:"long raw"},binary:{type:"raw"},varbinary:{type:"raw"},string:{type:"nvarchar2"}}});var zl=m((KV,Lm)=>{"use strict";Lm.exports={createSchema:"CREATE USER${ifNotExists} ${schemaName} NO AUTHENTICATION",comment:"\nCOMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${tableType} TABLE${ifNotExists} ${name}${tableProps}\n${options}",createTableProps:"${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}",columnDefinition:"${name}${type}${default}${encrypt}${constraints}",createKeyConstraint:"${constraintName}${keyType}${columns}${options}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete}",checkConstraint:"${name}CHECK (${expression})",createForeignKey:"ALTER TABLE ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",createIndex:"CREATE${indexType} INDEX${ifNotExists}${name} ON ${tableName}${keys}${options};\n",dropIndex:"DROP INDEX ${name};",alterIndexRename:"ALTER INDEX ${oldName} RENAME TO ${newName};",alterIndexRebuild:"ALTER INDEX ${name} REBUILD ${options};",createView:"CREATE${orReplace}${force}${viewType}${materialized} VIEW${ifNotExists} ${name} ${sharing}${viewProperties}\n	AS ${selectStatement}",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createObjectType:`CREATE OR REPLACE TYPE \${name} AS OBJECT 
(
	\${properties}
);
`,objectTypeColumnDefinition:"${name} ${type}",createCollectionType:"CREATE OR REPLACE TYPE ${name} IS ${collectionType}${size} OF (${datatype})${notPersistable};\n",ifNotExists:`DECLARE
BEGIN
	EXECUTE IMMEDIATE '\${statement}';
	EXCEPTION WHEN OTHERS THEN
		IF SQLCODE = -\${errorCode} THEN NULL; ELSE RAISE; END IF;
END;
/
`,createSynonym:"CREATE${orReplace}${editionable}${public} SYNONYM ${name}\n	FOR ${objectName};\n",renameColumn:"ALTER TABLE ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",createSequence:"CREATE SEQUENCE${ifNotExists} ${name}${sharing}${options}",dropSequence:"DROP SEQUENCE${ifExists} ${name};\n",renameSequence:"RENAME ${name} TO ${newName};\n",alterSequence:"ALTER SEQUENCE${ifExists} ${name}${options};\n",dualityView:{createJsonRelationalDualityViewHeading:"CREATE${orReplaceStatement}${forceStatement}${editionableStatement} JSON RELATIONAL DUALITY VIEW ${viewName} AS",sql:{tableTagsStatement:"WITH${checkStatement}${etagStatement}${insertStatement}${updateStatement}${deleteStatement}",columnTagsStatement:"WITH${checkStatement}${etagStatement}${updateStatement}",fromTableStatement:"FROM ${tableName}${tableAlias}${tableTagsStatement}${whereClauseStatement}"}},alterSession:"ALTER SESSION SET CURRENT_SCHEMA=${schemaName};\n"}});var $l=m((WV,wm)=>{"use strict";var uw=Object.freeze({SQL:"SQL",GRAPHQL:"GRAPHQL"});wm.exports={DualityViewSyntaxType:uw}});var Ql=m((XV,Bm)=>{"use strict";var hw=Object.freeze({JOIN_SUBQUERY_TYPE:"joinSubquery",COLLECTION_REFERENCE:"collectionReference"});Bm.exports={DualityViewPropertiesType:hw}});var Mm=m((zV,Ym)=>{"use strict";var{DualityViewPropertiesType:Um}=Ql(),Wt=class Wt{constructor(e,t,s,n,i){if(this.constructor===Wt)throw new Error("Abstract classes can't be instantiated.");this._ddlTemplates=e,this._assignTemplates=t,this._lodash=s,this._prepareName=n,this._getNamePrefixedWithSchemaName=i}static padInFront(e){return` ${e}`}static padInFrontAndUppercaseIfExists(e){return e?Wt.padInFront(e).toUpperCase():""}static isDualityView(e={}){return e.viewOn&&e.duality}static isJoinSubquery(e={}){return(e==null?void 0:e.type)===Um.JOIN_SUBQUERY_TYPE}static isFlexColumn(e={}){return e.flexColumn}static isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e={}){let{ref:t,refIdPath:s,refType:n}=e;return t&&(s||[]).length===2&&n===Um.COLLECTION_REFERENCE}static isRegularDualityViewFieldInArraySubquery(e={}){let{ref:t,refId:s}=e;return t&&s}static isRegularDualityViewField(e={}){return Wt.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)||Wt.isRegularDualityViewFieldInArraySubquery(e)}static getPathToReferencedColumn(e,t){let s=[];return Wt.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)?s=e.refIdPath:Wt.isRegularDualityViewFieldInArraySubquery(e)&&(s=[...t.joinedCollectionRefIdPath||[],e.ref]),s}static getRegularFieldNameFromCollection(e,t){if(e.length<2)throw new Error("Cannot extract referenced column name");let s=e[0],n=e[1],i=t[s],a=(i==null?void 0:i.properties)||{};for(let c of Object.keys(a))if(a[c].GUID===n)return c;return""}static getKeyValueFrontPadding(e){return"	".repeat(e)}_getForceStatement(e){return Wt.padInFrontAndUppercaseIfExists(e.force)}_getOrReplaceStatement(e){return e.orReplace?" OR REPLACE":""}_getEditionableStatement(e){return Wt.padInFrontAndUppercaseIfExists(e.editionable)}static getRegularFieldName(e,t){return t.code||e||t.referencedColumnName}getCreateJsonRelationalDualityViewHeadingDdl(e){var p,A;let{jsonSchema:t,view:s}=e,{getViewName:n}=le()(this._lodash),i=((A=(p=this._ddlTemplates)==null?void 0:p.dualityView)==null?void 0:A.createJsonRelationalDualityViewHeading)||"",a=this._getOrReplaceStatement(s),c=this._getForceStatement(t),T=this._getEditionableStatement(t),l=n(s),E=this._getNamePrefixedWithSchemaName(l,s.schemaName),u={orReplaceStatement:a,forceStatement:c,editionableStatement:T,viewName:E};return this._assignTemplates(i,u)}getDualityViewBodyDdl(e){throw new Error("Not implemented")}convertDualityViewToDdl(e){let t=this.getCreateJsonRelationalDualityViewHeadingDdl(e),s=this.getDualityViewBodyDdl(e);return t+`
`+s+`
`}};_(Wt,"AbstractDualityViewFeDdlCreator");var jl=Wt;Ym.exports={AbstractDualityViewFeDdlCreator:jl}});var Fm=m((QV,Vm)=>{"use strict";var{AbstractDualityViewFeDdlCreator:ge}=Mm(),Zl=class Zl extends ge{_getFromRootTableAliasStatement(e){if(e.rootTableAlias){let t=this._prepareName(e.rootTableAlias);return ge.padInFront(t)}return""}_getFromChildTableAliasStatement(e){if(e.childTableAlias){let t=this._prepareName(e.childTableAlias);return ge.padInFront(t)}return""}_getCheckStatement(e){return ge.padInFrontAndUppercaseIfExists(e.check)}_getEtagStatement(e){let t=e.etag?"etag":"";return ge.padInFrontAndUppercaseIfExists(t)}_getDeleteStatement(e){return ge.padInFrontAndUppercaseIfExists(e.delete)}_getInsertStatement(e){return ge.padInFrontAndUppercaseIfExists(e.insert)}_getUpdateStatement(e){return ge.padInFrontAndUppercaseIfExists(e.update)}_getTableTagsStatement(e){let t=e.tableTagsClause||{},s=this._getCheckStatement(t),n="";s&&(n=this._getEtagStatement(t));let i=this._getInsertStatement(t),a=this._getUpdateStatement(t),c=this._getDeleteStatement(t),T={checkStatement:s,etagStatement:n,insertStatement:i,updateStatement:a,deleteStatement:c};if(Object.values(T).some(E=>E==null?void 0:E.length)){let E=this._ddlTemplates.dualityView.sql.tableTagsStatement,u=this._assignTemplates(E,T);return ge.padInFront(u)}return""}_getColumnTagsStatement(e){let t=e.columnTagsClause||{},s=this._getCheckStatement(t),n="";s&&(n=this._getEtagStatement(t));let i=this._getUpdateStatement(t),a={checkStatement:s,etagStatement:n,updateStatement:i};if(Object.values(a).some(T=>T==null?void 0:T.length)){let T=this._ddlTemplates.dualityView.sql.columnTagsStatement,l=this._assignTemplates(T,a);return ge.padInFront(l)}return""}_getFromRootTableStatement(e){var T;let t=this._getNamePrefixedWithSchemaName(e.tableName,e.schemaName),s=this._getFromRootTableAliasStatement(e),n=this._getTableTagsStatement(e),i=(T=e.whereClause)==null?void 0:T.trim(),a=i?`
WHERE ${i} WITH CHECK OPTION`:"",c=this._ddlTemplates.dualityView.sql.fromTableStatement;return this._assignTemplates(c,{tableName:t,tableAlias:s,tableTagsStatement:n,whereClauseStatement:a})}_getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:t,bodyPadding:s}){let n=this._lodash.first(e.joinedCollectionRefIdPath);if(!n)throw new Error("Specify child table for all join subqueries");let i=t[n],{getEntityName:a}=le()(this._lodash),c=a(i),T=i.bucketName,l=this._getNamePrefixedWithSchemaName(c,T),E=this._getFromChildTableAliasStatement(e),u=this._getTableTagsStatement(e),p=this._ddlTemplates.dualityView.sql.fromTableStatement,h=[this._assignTemplates(p,{tableName:l,tableAlias:E,tableTagsStatement:u})];return e.whereClause&&h.push(`WHERE ${e.whereClause}`),h.map(N=>`${s}${N}`).join(`
`)}_getNameOfReferencedColumnForDdl(e,t,s){let{getEntityName:n}=le()(this._lodash);if(ge.isDualityView(e)){let i=e.rootTableAlias||e.tableName;return this._getNamePrefixedWithSchemaName(t,i)}if(ge.isJoinSubquery(e)){if(e.childTableAlias){let a=e.childTableAlias;return this._getNamePrefixedWithSchemaName(t,a)}let i=this._lodash.first(e.joinedCollectionRefIdPath);if(i){let a=s[i],c=n(a);return this._getNamePrefixedWithSchemaName(t,c)}}return""}_getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:n,relatedSchemas:i}){let{wrap:a}=le()(this._lodash),c=ge.getKeyValueFrontPadding(n),T=ge.getRegularFieldName(e,t),l=a(T,"'","'"),E=ge.getPathToReferencedColumn(t,s),u=ge.getRegularFieldNameFromCollection(E,i),p=this._getNameOfReferencedColumnForDdl(s,u,i),A=this._getColumnTagsStatement(t);return`${c}${l}: ${p}${A}`}_getJoinSubqueryValueStatement({propertyJsonSchema:e,paddingFactor:t,relatedSchemas:s}){let n=t+1,i=t+2,a=this._getObjectGenStatement({paddingFactor:i,relatedSchemas:s,jsonSchema:e}),c=ge.getKeyValueFrontPadding(n),l=[`${c}SELECT${a}`],E=this._getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:s,bodyPadding:c});return l.push(E),l.join(`
`)}_shouldUnnestJoinSubquery(e){let t=this._lodash.toUpper(e.sqlJsonFunction),s=this._lodash.toLower(e.subtype);return t==="JSON_OBJECT"||s==="object"?!!e.unnestSubquery:!1}_getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:s,relatedSchemas:n}){let{wrap:i}=le()(this._lodash),a=this._getJoinSubqueryValueStatement({relatedSchemas:n,paddingFactor:s,propertyJsonSchema:t}),c=ge.getKeyValueFrontPadding(s),T=this._getObjectGenStatementJsonKeywordConfig(t),l=T.surroundingBrackets[0],E=T.surroundingBrackets[1];if(this._shouldUnnestJoinSubquery(t))return`${c}UNNEST ${l}
${a}
${c}${E}`;let p=this._getJoinSubqueryName(e,t),A=i(p,"'","'");return`${c}${A} : ${l}
${a}
${c}${E}`}_getJoinSubqueryName(e,t){return t.name||e}_buildKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:n,relatedSchemas:i}){return ge.isFlexColumn(t)?this._getFlexColumnStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:n}):ge.isRegularDualityViewField(t)?this._getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:n,relatedSchemas:i}):ge.isJoinSubquery(t)?this._getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:n,relatedSchemas:i}):""}_getKeyValueStatement({jsonSchema:e,relatedSchemas:t,paddingFactor:s}){var T;let n=[],i=e.properties||((T=e.items)==null?void 0:T.properties)||{},a=this._lodash.toPairs(i);for(let[l,E]of a){let u=this._buildKeyValueStatement({propertyName:l,propertyJsonSchema:E,parent:e,paddingFactor:s,relatedSchemas:t});n.push(u)}return`
${n.join(`,
`)}
`}_getObjectGenStatementJsonKeywordConfig(e){if(!ge.isJoinSubquery(e))return{jsonKeyword:"JSON",surroundingBrackets:["",""],jsonKeywordBrackets:["{","}"]};let t=this._lodash.toUpper(e.sqlJsonFunction);return t==="JSON_OBJECT"?{jsonKeyword:t,surroundingBrackets:["(",")"],jsonKeywordBrackets:["(",")"]}:t==="JSON_ARRAYAGG"?{jsonKeyword:t,surroundingBrackets:["(",")"],jsonKeywordBrackets:["( JSON {","})"]}:this._lodash.toLower(e.subtype)==="array"?{jsonKeyword:"JSON",surroundingBrackets:["[","]"],jsonKeywordBrackets:["{","}"]}:{jsonKeyword:"JSON",surroundingBrackets:["(",")"],jsonKeywordBrackets:["{","}"]}}_getObjectGenStatement({relatedSchemas:e,paddingFactor:t,jsonSchema:s}){let n=this._getKeyValueStatement({relatedSchemas:e,paddingFactor:t,jsonSchema:s}),i=ge.getKeyValueFrontPadding(t-1),a=this._getObjectGenStatementJsonKeywordConfig(s),c=a.jsonKeywordBrackets[0],T=a.jsonKeywordBrackets[1],l=`${a.jsonKeyword} ${c}\${keyValueStatement}${i}${T}`,E=this._assignTemplates(l,{keyValueStatement:n});return ge.padInFront(E)}getDualityViewBodyDdl(e){let{view:t,jsonSchema:s,relatedSchemas:n}=e,c=[`SELECT${this._getObjectGenStatement({jsonSchema:s,paddingFactor:1,relatedSchemas:n})}`],T=this._getFromRootTableStatement(t);return c.push(T+";"),c.join(`
`)}_getFlexColumnStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:s}){let{wrap:n}=le()(this._lodash),i=ge.getKeyValueFrontPadding(s),a=ge.getRegularFieldName(e,t),c=n(a,'"','"');return`${i}${c} AS FLEX COLUMN`}};_(Zl,"SqlDualityViewDdlCreator");var Jl=Zl;Vm.exports={SqlDualityViewDdlCreator:Jl}});var bm=m((JV,xm)=>{"use strict";var{DualityViewSyntaxType:Nw}=$l(),{SqlDualityViewDdlCreator:Sw}=Fm(),tE=class tE{static getCreatorInstance(e,{ddlTemplates:t,assignTemplates:s,lodash:n,prepareName:i,getNamePrefixedWithSchemaName:a}){switch(e==null?void 0:e.toUpperCase()){case Nw.SQL:return new Sw(t,s,n,i,a);default:throw new Error(`Unknown syntax config: ${e}`)}}};_(tE,"DualityViewDdlCreatorFactory");var eE=tE;xm.exports={DualityViewDdlCreatorFactory:eE}});var sE=m((e1,km)=>{"use strict";var Aw=Object.freeze({IF_NOT_EXISTS_SINCE:23,JSON_TYPE_SINCE:21});km.exports={DbVersion:Aw}});var vm=m((t1,Gm)=>{"use strict";var qm=_((r="")=>new RegExp("\\$\\{(.*?)\\}",r),"template"),dw=_(r=>r.match(qm("gi"))||[],"getAllTemplates"),pw=_(r=>(r.match(qm("i"))||[])[1],"parseTemplate");Gm.exports=({_:r})=>({assignTemplates:_((t,s)=>dw(t).reduce((n,i)=>{let a=pw(i);return n.replace(i,()=>s[a]||s[a]===0?s[a]:"")},t),"assignTemplates")})});var Km=m((n1,Hm)=>{"use strict";var r1=require("lodash");Hm.exports=(r,e)=>{let t=_((N,d)=>Object.entries(N.properties).map(d),"mapProperties"),s=_(N=>N.compositeUniqueKey?!1:!!N.unique,"isUniqueKey"),n=_(N=>{var d;return s(N)&&!((d=N.uniqueKeyOptions)!=null&&d.constraintName)},"isInlineUnique"),i=_(N=>N.compositeUniqueKey||N.compositePrimaryKey?!1:!!N.primaryKey,"isPrimaryKey"),a=_(N=>{var d;return i(N)&&!((d=N.primaryKeyOptions)!=null&&d.constraintName)},"isInlinePrimaryKey"),c=_((N,d,S)=>e({keyType:"UNIQUE",columns:[{name:d,isActivated:S}],...N}),"hydrateUniqueOptions"),T=_((N,d,S)=>e({keyType:"PRIMARY KEY",columns:[{name:d,isActivated:S}],...N}),"hydratePrimaryKeyOptions"),l=_((N,d)=>Object.keys(d).find(S=>d[S].GUID===N),"findName"),E=_((N,d)=>r.get(Object.values(d).find(S=>S.GUID===N),"isActivated",!0),"checkIfActivated"),u=_((N,d)=>r.map(N,S=>({name:l(S.keyId,d.properties),isActivated:E(S.keyId,d.properties)})),"getKeys"),p=_(N=>Array.isArray(N.primaryKey)?N.primaryKey.filter(d=>!r.isEmpty(d.compositePrimaryKey)).map(d=>({...T(d,null,null),columns:u(d.compositePrimaryKey,N)})):[],"getCompositePrimaryKeys"),A=_(N=>Array.isArray(N.uniqueKey)?N.uniqueKey.filter(d=>!r.isEmpty(d.compositeUniqueKey)).map(d=>({...c(d,null,null),columns:u(d.compositeUniqueKey,N)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:_(N=>{if(!N.properties)return[];let d=t(N,([D,P])=>{if(!(!s(P)||n(P)))return c(P.uniqueKeyOptions,D,P.isActivated)}).filter(Boolean);return[...t(N,([D,P])=>{if(!(!i(P)||a(P)))return T(P.primaryKeyOptions,D,P.isActivated)}).filter(Boolean),...p(N),...d,...A(N)]},"getTableKeyConstraints"),isInlineUnique:n,isInlinePrimaryKey:a,getKeys:u}}});var rE=m((a1,Wm)=>{"use strict";var o1=require("lodash");Wm.exports=({prepareName:r,_:e})=>({getOptionsString:_(({constraintName:s,deferClause:n,rely:i,validate:a,indexClause:c,exceptionClause:T})=>{let l=s?` CONSTRAINT ${r(e.trim(s))}`:"",E=[n,i,c,a,T].filter(Boolean).join(" ");return{constraintString:l,statement:E&&` ${E}`}},"getOptionsString")})});var zm=m((T1,Xm)=>{"use strict";var c1=require("lodash"),{DbVersion:fw}=sE(),mw=_(r=>Number.parseInt(r,10)<fw.JSON_TYPE_SINCE,"shouldUseClobForJsonColumns");Xm.exports=({_:r,wrap:e,assignTemplates:t,templates:s,commentIfDeactivated:n,wrapComment:i,prepareName:a})=>{let{getOptionsString:c}=rE()({_:r,prepareName:a}),T=_((M,te)=>r.chain(te).filter("comment").map(ae=>{let Le=t(s.comment,{object:"COLUMN",objectName:`${M}.${a(ae.name)}`,comment:i(ae.comment)});return n(Le,ae)}).join(`
`).value(),"getColumnComments"),l=_(({nullable:M,unique:te,primaryKey:ae,primaryKeyOptions:Le,uniqueKeyOptions:At})=>{let{constraintString:Ze,statement:gt}=c(E({primaryKey:ae,unique:te,primaryKeyOptions:Le,uniqueKeyOptions:At}));return`${M?"":" NOT NULL"}${Ze}${ae?" PRIMARY KEY":""}${te?" UNIQUE":""}${gt}`},"getColumnConstraints"),E=_(({primaryKey:M,unique:te,primaryKeyOptions:ae,uniqueKeyOptions:Le})=>M?ae||{}:te?Le||{}:{},"getOptions"),u=_((M,te)=>M==="JSON"&&mw(te)?"CLOB":M,"replaceTypeByVersion"),p=_(({default:M,defaultOnNull:te,identity:ae})=>{if(!r.isEmpty(ae)&&ae.generated){let Le=_(({generated:Ze,generatedOnNull:gt})=>Ze==="BY DEFAULT"?` ${Ze} ${gt?" ON NULL":""}`:" ALWAYS","getGenerated"),At=_(({identityStart:Ze,identityIncrement:gt,numberToCache:bt})=>{let As=Ze?` START WITH ${Ze}`:"",Zs=gt?` INCREMENT BY ${gt}`:"",Ur=bt?` CACHE ${bt}`:" NOCACHE";return`${As}${Zs}${Ur}`},"getOptions");return` GENERATED${Le(ae)} AS IDENTITY (${r.trim(At(ae))})`}else if(M||M===0)return` DEFAULT${te?" ON NULL":""} ${M}`;return""},"getColumnDefault"),A=_(({encryption:M})=>{if(r.isPlainObject(M)&&!r.isEmpty(r.omit(M,"id"))){let{ENCRYPTION_ALGORITHM:te,INTEGRITY_ALGORITHM:ae,noSalt:Le}=M,At=te?` USING '${te}'`:"",Ze=ae?` '${ae}'`:"";return` ENCRYPT${At}${Ze}${Le?" NO SALT":""}`}return""},"getColumnEncrypt"),h=_((M,te,ae)=>` ${M}(${te} ${r.toUpper(ae)})`,"addByteLength"),N=_((M,te)=>` ${M}(${te})`,"addLength"),d=_((M,te,ae)=>r.isNumber(ae)?` ${M}(${te||"*"},${ae})`:r.isNumber(te)?` ${M}(${te})`:` ${M}`,"addScalePrecision"),S=_((M,te)=>r.isNumber(te)?` ${M}(${te})`:` ${M}`,"addPrecision"),D=_((M,te,ae)=>` TIMESTAMP${r.isNumber(M)?`(${M})`:""}${te?` WITH${ae?" LOCAL":""} TIME ZONE`:""}`,"timestamp"),P=_(M=>` INTERVAL YEAR${r.isNumber(M)?`(${M})`:""} TO MONTH`,"intervalYear"),y=_((M,te)=>{let ae=r.isNumber(M)?`(${M})`:"",Le=r.isNumber(te)?`(${te})`:"";return` INTERVAL DAY${ae} TO SECOND${Le}`},"intervalDay"),Y=_((M,te,ae)=>{let Le={"vector<int8>":"int8","vector<float32>":"float32","vector<float64>":"float64"}[ae],At=te||"*",Ze=r.toUpper(Le||"*");return` ${M}(${At}, ${Ze})`},"decorateVector"),V=_((M,te)=>["object","array"].includes(te)?" "+M+"("+r.toUpper(te)+")":" "+M,"decorateJson"),k=_(M=>["CHAR","VARCHAR2"].includes(M),"canHaveByte"),$=_(M=>["CHAR","VARCHAR2","NCHAR","NVARCHAR2","RAW","UROWID"].includes(M),"canHaveLength"),C=_(M=>["NUMBER","FLOAT"].includes(M),"canHavePrecision"),G=_(M=>M==="NUMBER","canHaveScale"),R=_(M=>M==="INTERVAL YEAR","isIntervalYear"),w=_(M=>M==="INTERVAL DAY","isIntervalDay"),x=_(M=>M==="TIMESTAMP","isTimezone"),j=_((M,te,ae)=>M==="VECTOR"&&(te||ae),"canDecorateVector"),re=_(M=>M==="JSON","isJson");return{getColumnComments:T,getColumnConstraints:l,replaceTypeByVersion:u,getColumnDefault:p,getColumnEncrypt:A,decorateType:_((M,te)=>{let{lengthSemantics:ae,length:Le,precision:At,scale:Ze,fractSecPrecision:gt,withTimeZone:bt,localTimeZone:As,yearPrecision:Zs,dayPrecision:Ur,isUDTRef:ro,schemaName:Nn,dimension:Yr,subtype:er}=te;return ae&&k(M)&&$(M)&&r.isNumber(Le)?h(M,Le,ae):$(M)&&r.isNumber(Le)?N(M,Le):C(M)&&G(M)?d(M,At,Ze):C(M)&&r.isNumber(At)?S(M,At):x(M)?D(gt,bt,As):R(M)?P(Zs):w(M)?y(Ur,gt):ro&&Nn?` "${Nn}"."${M}"`:j(M,Yr,er)?Y(M,Yr,er):re(M)?V(M,er):` ${M}`},"decorateType"),canHaveIdentity:_(M=>["number"].includes(M),"canHaveIdentity")}}});var Qm=m((u1,$m)=>{"use strict";var E1=require("lodash");$m.exports=({_:r,getColumnsList:e,checkAllKeysDeactivated:t,commentIfDeactivated:s,prepareName:n,assignTemplates:i})=>{let{getOptionsString:a}=rE()({_:r,prepareName:n}),c=_(({duplicated:C,external:G,immutable:R,sharded:w,temporary:x,temporaryType:j,blockchain_table_clauses:re})=>{let q=!r.isEmpty(re);switch(!0){case x:return` ${r.toUpper(j)} TEMPORARY`;case w:return" SHARDED";case C:return" DUPLICATED";case R:return" IMMUTABLE";case q:return`${re.immutable?" IMMUTABLE":""} BLOCKCHAIN`;default:return""}},"getTableType"),T=_(C=>{let G=_(w=>w?`${w}
`:"","wrap"),R=[{key:"blockchain_table_clauses",getValue:l(C==null?void 0:C.tableProperties)},{key:"storage",getValue:E(C==null?void 0:C.tableProperties)},{key:"external_table_clause",getValue:u},{key:"partitioning",getValue:p},{key:"selectStatement",getValue:P("AS")},{key:"tableProperties",getValue:w=>w}].map(w=>C[w.key]?G(w.getValue(C[w.key],C)):"").filter(Boolean).join("");return r.trim(R)?` ${r.trim(R)}`:""},"getTableOptions"),l=_(C=>({blockchain_table_retention_clause:G,blockchain_row_retention_clause:R,blockchain_hash_and_data_format_clause:w})=>r.includes(C,G)||r.includes(C,R)||r.includes(C,w)?"":r.trim(` ${G||""} ${R||""} ${w||""}`),"getBlockChainClause"),E=_(C=>({organization:G,tablespace:R,logging:w})=>r.includes(C,"TABLESPACE")?"":G==="external"?"ORGANIZATION EXTERNAL":`ORGANIZATION ${r.toUpper(G)||"HEAP"}${R?` TABLESPACE ${n(R)}`:""} ${w?"LOGGING":"NOLOGGING"}`,"getStorage"),u=_(C=>{if(!(C!=null&&C.access_driver_type))return"";let{access_driver_type:G,default_directory:R,access_parameter_type:w,opaque_format_spec:x,clob_subquery:j,reject_limit:re,location:q}=C,Ee=`(${r.map(q,({location_directory:ae,location_specifier:Le})=>`${ae?`${ae}:`:""}'${Le}'`).join(", ")})`,M=w==="NONE"?"":`ACCESS PARAMETERS ${j?`USING CLOB ${j}`:x}`,te=`${R&&!r.isEmpty(R)?` DEFAULT DIRECTORY ${R}`:""}`+M+`${q&&!r.isEmpty(q)?` LOCATION ${Ee}`:""}`;return` (TYPE ${r.toUpper(G)} ${te}) REJECT LIMIT ${re||"UNLIMITED"} `},"getExternalTableClause"),p=_((C,{isActivated:G})=>{if(C!=null&&C.partitionBy){let R=A(C,G),w=h(C,G);return`PARTITION BY ${r.toUpper(r.startsWith(C.partitionBy,"composite")?r.last(C.partitionBy.split(" ")):C.partitionBy)} ${R}${w}`}return""},"getPartitioning"),A=_((C,G)=>{let R=t(C.partitionKey);return r.isEmpty(C.partitionKey)?"":e(C.partitionKey,R,G,({name:w})=>n(w))},"getPartitionKeys"),h=_((C,G)=>{switch(C.partitionBy){case"range":return`${C.interval?`
INTERVAL (${C.interval})`:""}`+S(C.store_in_tablespaces)+N(C.range_partitions,"range_partition_clause");case"list":return`${C.automatic?" AUTOMATIC":""}`+S(C.store_in_tablespaces)+N(C.list_partitions,"list_partition_clause");case"hash":return D(C);case"reference":return`${C.constraint?` (${C.constraint})`:""}`+N(C.reference_partition_descs,"reference_partition_desc");case"system":return C.system_partitioning_quantity?` PARTITIONS ${C.system_partitioning_quantity}`:N(C.system_partition_descs,"system_partition_desc");case"composite range":{let R=d(C,G);return`${C.interval?` INTERVAL (${C.interval})`:""}`+S(C.store_in_tablespaces)+R+N(C.range_subpartition_descs,"range_subpartition_desc")}case"composite list":{let R=d(C,G);return S(C.store_in_tablespaces,"AUTOMATIC")+R+N(C.list_subpartition_descs,"list_subpartition_description")}case"composite hash":{let R=d(C,G),w=D(C);return`${R}${w}`}default:return""}},"getPartitionClause"),N=_((C,G)=>C&&r.isArray(C)&&!r.isEmpty(C)?`
(
	${(G?r.map(C,R=>R[G]):C).join(`,
	`)}
)
`:"","partitionsToString"),d=_(({subpartitionType:C,subpartitionDescription:G,compositePartitionKey:R},w)=>{if(C){let x=t(R),j=G?`
${G}`:"";return` SUBPARTITION BY ${r.toUpper(C)} ${e(R,x,w,({name:re})=>n(re))} ${j}`}return""},"getSubpartition"),S=_((C,G,R="store_in_tablespace")=>r.isEmpty(C)?"":`${G?` ${G}`:""} STORE IN (${r.map(C,w=>w[R]).join(", ")})`,"getTablespaceList"),D=_(({hash_partition_quantity:C,store_in_tablespaces:G,overflow_store_in_tablespaces:R,individual_hash_partitions:w})=>C?` PARTITIONS ${C}`+S(G)+S(R,"OVERFLOW","overflow_store_in_tablespace"):N(w,"individual_hash_partition"),"getHashPartition"),P=_(C=>G=>{if(G)return`${C} ${G}`},"getBasicValue");return{getTableOptions:T,getTableType:c,generateConstraintsString:_((C,G)=>{var j,re;let R=s(((C==null?void 0:C.deactivatedItems)||[]).join(`,
	`),{isActivated:!G,isPartOfLine:!0}),w=(j=C==null?void 0:C.activatedItems)!=null&&j.length?`,
	`+C.activatedItems.join(`,
	`):"",x=(re=C==null?void 0:C.deactivatedItems)!=null&&re.length?`
	`+R:"";return w+x},"generateConstraintsString"),foreignKeysToString:_(C=>{if(Array.isArray(C)){let G=C.filter(x=>r.get(x,"isActivated",!0)).map(x=>n(r.trim(x.name))),R=C.filter(x=>!r.get(x,"isActivated",!0)).map(x=>n(r.trim(x.name))),w=R.length?s(R,{isActivated:!1,isPartOfLine:!0}):"";return G.join(", ")+w}return C},"foreignKeysToString"),foreignActiveKeysToString:_(C=>C.map(G=>r.trim(G.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:_((C,G)=>R=>{let w=t(R.columns),x=e(R.columns,w,G,({name:re})=>n(re)),j=a(R).statement;return{statement:i(C.createKeyConstraint,{constraintName:R.constraintName?`CONSTRAINT ${n(R.constraintName)} `:"",keyType:R.keyType,columns:x,options:j}),isActivated:!w}},"createKeyConstraint"),customPropertiesForForeignKey:_(C=>({foreignOnDelete:r.get(C,"relationshipOnDelete","")}),"customPropertiesForForeignKey")}}});var Jm=m((S1,jm)=>{"use strict";var N1=require("lodash");jm.exports=({_:r,assignTemplates:e,templates:t,getNamePrefixedWithSchemaName:s})=>{let n=["OBJECT_UDT","VARRAY","TABLE","COLLECTION_UDT"],i=_((T,l)=>{let E=s(T.name,T.schemaName);switch(T.type){case"OBJECT_UDT":return e(t.createObjectType,{name:E,properties:r.map(T.properties,u=>l(u,t.objectTypeColumnDefinition)).join(`,
	`)});case"VARRAY":case"TABLE":{let u=T.type==="VARRAY"?"(64)":"";return e(t.createCollectionType,{name:E,collectionType:T.type,size:r.isNumber(T.size)?`(${T.size})`:u,datatype:`${T.ofType}${T.nullable?"":" NOT NULL"}`,notPersistable:`${T.notPersistable?" NOT PERSISTABLE":""}`})}default:return""}},"getPlainUdt");return{getUserDefinedType:_((T,l)=>i(T,l),"getUserDefinedType"),isNotPlainType:_(T=>{let l=r.toUpper(T.mode||T.type);return n.includes(l)},"isNotPlainType")}}});var eP=m((d1,Zm)=>{"use strict";Zm.exports=({_:r,prepareName:e})=>{let t=_(({editioning:i,editionable:a})=>`${a?" EDITIONABLE":""}${i?" EDITIONING":""}`,"getViewType"),s=_(i=>i?i.alias?`${e(i.name)} as ${e(i.alias)}`:e(i.name):"","getKeyWithAlias");return{getViewType:t,getViewData:_(i=>Array.isArray(i)?i.reduce((a,c)=>{if(!c.tableName)return a.columns.push(s(c)),a;let T=`${e(c.dbName)}.${e(c.tableName)}`;return a.tables.includes(T)||a.tables.push(T),a.columns.push({statement:`${T}.${s(c)}`,isActivated:c.isActivated}),a},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData")}}});var sP=m((m1,tP)=>{"use strict";var f1=require("lodash");tP.exports=({_:r,prepareName:e})=>({getIndexType:_(a=>a?` ${r.toUpper(a)}`:"","getIndexType"),getIndexKeys:_(({indxKey:a,column_expression:c})=>{let{escapeSingleQuote:T}=le()();return c?`
(
	${T(c)}
)
	`:r.isArray(a)&&!r.isEmpty(a)?`
(
	${r.map(a,({name:E,type:u})=>`${e(E)} ${r.toUpper(u)}`).join(`,
	`)}
)
	`:""},"getIndexKeys"),getIndexOptions:_(({indxDescription:a,comments:c,tablespace:T,index_properties:l,index_attributes:E,index_compression:u,logging_clause:p,indxKey:A,column_expression:h})=>{let N=p?` ${r.toUpper(p)}`:"",d=T?` TABLESPACE ${T}`:"",S=u?` ${u}`:"",D=`${N}${d}${S}`;return l?D=` ${l}`:E&&(D=` ${E}`),r.isEmpty(A)&&r.isEmpty(h)?D:r.trim(D)},"getIndexOptions"),getIndexName:_(a=>a?` ${e(a)}`:"","getIndexName")})});var nP=m((R1,rP)=>{"use strict";rP.exports=({prepareName:r,templates:e,assignTemplates:t,getNamePrefixedWithSchemaName:s})=>{let n=_(a=>{let c=s(a.synonymName,a.schemaName);return t(e.createSynonym,{name:a.synonymPublic?r(a.synonymName):c,orReplace:a.synonymOrReplace?" OR REPLACE":"",editionable:a.synonymEditionable?" "+a.synonymEditionable:"",public:a.synonymPublic?" PUBLIC":"",objectName:a.synonymEntityName})},"generateSynonymCreateStatement");return{generateSynonymStatements:_((a,c,T)=>a!=null&&a.length?`
`+a.map(l=>n({...l,synonymEntityName:c,schemaName:T})).join(`
`):"","generateSynonymStatements")}}});var oP=m((O1,iP)=>{"use strict";var D1=require("lodash"),{Sequence:C1}=Bi();iP.exports=({_:r,templates:e,assignTemplates:t,getNamePrefixedWithSchemaName:s,wrapIfNotExists:n})=>{let i=_(({schemaName:P,sequences:y,usingTryCatchWrapper:Y})=>r.map(y,V=>a({schemaName:P,sequence:V,usingTryCatchWrapper:Y})).join(`

`),"getSequencesScript"),a=_(({schemaName:P,sequence:y,usingTryCatchWrapper:Y})=>{let V=D({schemaName:P,sequence:y}),k=s(y.sequenceName,V),$=Y?"":h({sequence:y}),C=l({sequence:y,schemaName:P}),G=d({sequence:y}),R=t(e.createSequence,{name:k,ifNotExists:$,sharing:G,options:C});return Y?n(R,y.ifNotExist):R+";"},"createSequenceScript"),c=_(({schemaName:P,sequence:y,oldSequence:Y,usingTryCatchWrapper:V})=>{let k=Y.sequenceName||y.sequenceName,$=D({schemaName:P,sequence:y}),C=s(k),G=s(k,$),R=S({sequence:y,oldSequence:Y}),w=l({schemaName:P,sequence:R}),x=R.sequenceName?s(R.sequenceName):"",j=N({usingTryCatchWrapper:V});if(R.hasOwnProperty("sharing")){let Ee=T({schemaName:P,sequence:Y,usingTryCatchWrapper:V}),M=a({schemaName:P,sequence:y,usingTryCatchWrapper:V});return Ee+`
`+M+`
`}return[{key:"options",value:w,name:G,template:e.alterSequence},{key:"newName",value:x,name:C,template:e.renameSequence}].filter(Ee=>Ee.value).map(Ee=>t(Ee.template,{[Ee.key]:Ee.value,name:Ee.name,ifExists:j})).join(`
`)},"alterSequenceScript"),T=_(({schemaName:P,sequence:y,usingTryCatchWrapper:Y})=>{let V=D({schemaName:P,sequence:y}),k=s(y.sequenceName,V),$=N({usingTryCatchWrapper:Y});return t(e.dropSequence,{name:k,ifExists:$})},"dropSequenceScript"),l=_(({schemaName:P,sequence:y})=>{let V=[{getOption:E,key:"increment",clause:"INCREMENT BY"},{getOption:E,key:"start",clause:"START WITH"},{getOption:E,key:"restart",clause:"RESTART WITH"},{getOption:E,key:"minValue",clause:"MINVALUE"},{getOption:E,key:"maxValue",clause:"MAXVALUE"},{getOption:u,key:"cache",extendedKey:"cacheValue"},{getOption:u,key:"cycle",extendedKey:""},{getOption:u,key:"order",extendedKey:""},{getOption:u,key:"keep",extendedKey:""},{getOption:u,key:"scale",extendedKey:"scaleExtend"},{getOption:u,key:"shard",extendedKey:"shardExtend"},{getOption:u,key:"type",extendedKey:""}].map(k=>{let $=k.getOption({sequence:y,schemaName:P,config:k});return p({option:$})}).filter(Boolean).join("");return V&&A({options:V})},"getSequenceOptions"),E=_(({sequence:P,config:y})=>{let Y=Number(P[y.key]);return isNaN(Y)?"":`${y.clause} ${Y}`},"getNumberOption"),u=_(({sequence:P,config:y})=>{let Y=r.toUpper(P[y.key]);return Y?Y.startsWith("NO")||!P[y.extendedKey]?Y:Y+" "+u({sequence:P,config:{key:y.extendedKey}}):""},"getLiteralOption"),p=_(({option:P})=>P?`	${P}
`:"","wrapOption"),A=_(({options:P})=>`
`+P.replace(/\n$/,""),"wrapOptionsBlock"),h=_(({sequence:P})=>P.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),N=_(({usingTryCatchWrapper:P})=>P?"":" IF EXISTS","getIfExists"),d=_(({sequence:P})=>P.sharing?" SHARING="+r.toUpper(P.sharing):"","getSharing"),S=_(({sequence:P,oldSequence:y})=>{let Y=r.omitBy(P,(V,k)=>r.isEqual(V,y[k]));return P.minValue>y.minValue?{...Y,restart:P.start}:Y},"getModifiedSequence"),D=_(({schemaName:P,sequence:y})=>y.type==="session"?"":P,"getSequenceSchemaName");return{getSequencesScript:i,createSequenceScript:a,alterSequenceScript:c,dropSequenceScript:T}}});var Xt=m((w1,_P)=>{"use strict";var he=require("lodash"),Pw=Om(),aP=ym(),ye=zl(),{DualityViewDdlCreatorFactory:Rw}=bm(),{DualityViewSyntaxType:Iw}=$l(),{DbVersion:Dw}=sE(),{AlterIndexDto:y1}=ji(),{Sequence:L1}=Bi(),js=_(r=>Number.parseInt(r,10)<Dw.IF_NOT_EXISTS_SINCE,"shouldUseTryCatchIfNotExistsWrapper");_P.exports=(r,e,t)=>{var Yr,er;let s=_(O=>he.isArray(O)?O:[O],"toArray"),{tab:n,commentIfDeactivated:i,checkAllKeysDeactivated:a,divideIntoActivatedAndDeactivated:c,hasType:T,wrap:l,clean:E,getNamePrefixedWithSchemaNameForScriptFormat:u,wrapComment:p,getColumnsList:A,prepareNameForScriptFormat:h}=le()(he),N=h((Yr=e==null?void 0:e.targetScriptOptions)==null?void 0:Yr.keyword),d=u((er=e==null?void 0:e.targetScriptOptions)==null?void 0:er.keyword),{assignTemplates:S}=vm()({_:he}),D=Km()(he,E),{getColumnComments:P,getColumnConstraints:y,replaceTypeByVersion:Y,getColumnDefault:V,getColumnEncrypt:k,decorateType:$,canHaveIdentity:C}=zm()({_:he,wrap:l,assignTemplates:S,templates:ye,commentIfDeactivated:i,wrapComment:p,prepareName:N}),{getTableType:G,getTableOptions:R,generateConstraintsString:w,foreignKeysToString:x,foreignActiveKeysToString:j,createKeyConstraint:re,customPropertiesForForeignKey:q}=Qm()({_:he,checkAllKeysDeactivated:a,getColumnsList:A,commentIfDeactivated:i,prepareName:N,assignTemplates:S}),{getUserDefinedType:Ee,isNotPlainType:M}=Jm()({_:he,commentIfDeactivated:i,assignTemplates:S,templates:ye,getNamePrefixedWithSchemaName:d}),{getViewType:te,getViewData:ae}=eP()({_:he,prepareName:N}),{getIndexType:Le,getIndexKeys:At,getIndexOptions:Ze,getIndexName:gt}=sP()({_:he,prepareName:N}),bt=_((O,U,J=955)=>{if(U){let ee=n(n(O)),xe=he.trim(ee).replace(/;$/,"");return S(ye.ifNotExists,{statement:xe,errorCode:J})}return O+";"},"wrapIfNotExists"),{generateSynonymStatements:As}=nP()({prepareName:N,templates:ye,assignTemplates:S,getNamePrefixedWithSchemaName:d}),{getSequencesScript:Zs,createSequenceScript:Ur,dropSequenceScript:ro,alterSequenceScript:Nn}=oP()({_:he,templates:ye,assignTemplates:S,getNamePrefixedWithSchemaName:d,wrapIfNotExists:bt});return{getDefaultType(O){return Pw[O]},getTypesDescriptors(){return aP},hasType(O){return T(aP,O)},hydrateSchema(O,U){let J=he.get(U,"modelData.0.dbVersion");return{schemaName:O.name,ifNotExist:O.ifNotExist,dbVersion:J,synonyms:U.synonyms,sequences:U.sequences}},createSchema({schemaName:O,ifNotExist:U,dbVersion:J,sequences:ee}){let Me=`

`,xe=";",ze=N(O),We=js(J),_t=S(ye.createSchema,{schemaName:ze,ifNotExists:!We&&U?" IF NOT EXISTS":""}),yt=Zs({schemaName:O,sequences:ee,usingTryCatchWrapper:We}),kt=yt?Me+yt:"",ct=S(ye.alterSession,{schemaName:ze});return We?bt(_t,U,1920)+kt:_t+xe+Me+ct+kt},hydrateColumn({columnDefinition:O,jsonSchema:U,schemaData:J,definitionJsonSchema:ee={}}){var We;let Me=J.dbVersion,xe=!!U.$ref,ze=xe?O.type:he.toUpper(U.mode||U.type);return{name:O.name,type:ze,ofType:U.ofType,notPersistable:U.notPersistable,size:U.size,primaryKey:D.isInlinePrimaryKey(U),primaryKeyOptions:U.primaryKeyOptions,unique:D.isInlineUnique(U),uniqueKeyOptions:U.uniqueKeyOptions,nullable:O.nullable,default:O.default,comment:U.refDescription||U.description||ee.description,isActivated:O.isActivated,scale:O.scale,precision:O.precision,length:O.length,schemaName:J.schemaName,checkConstraints:U.checkConstraints,dbVersion:Me,fractSecPrecision:U.fractSecPrecision,withTimeZone:U.withTimeZone,localTimeZone:U.localTimeZone,yearPrecision:U.yearPrecision,dayPrecision:U.dayPrecision,lengthSemantics:U.lengthSemantics,encryption:U.encryption,synonyms:((We=J==null?void 0:J.synonyms)==null?void 0:We.filter(_t=>_t.synonymEntityId===U.GUID))||[],isUDTRef:xe,dimension:U.dimension,subtype:U.subtype,defaultOnNull:U.defaultOnNull,...C(U.mode)&&{identity:U.identity}}},hydrateJsonSchemaColumn(O,U){return!O.$ref||he.isEmpty(U)||M(U)?O:(O=he.omit(O,"$ref"),{...U,...O})},convertColumnDefinition(O,U=ye.columnDefinition){let J=Y(O.type,O.dbVersion);return i(S(U,{name:N(O.name),type:$(J,O),default:V(O),encrypt:k(O),constraints:y(O)}),{isActivated:O.isActivated})},hydrateCheckConstraint(O){return{name:O.chkConstrName,expression:O.constrExpression,comments:O.constrComments,description:O.constrDescription}},createCheckConstraint({name:O,expression:U,comments:J,description:ee}){return S(ye.checkConstraint,{name:O?`CONSTRAINT ${N(O)} `:"",expression:he.trim(U).replace(/^\(([\s\S]*)\)$/,"$1")})},createForeignKeyConstraint({name:O,foreignKey:U,primaryTable:J,primaryKey:ee,primaryTableActivated:Me,foreignTableActivated:xe,foreignSchemaName:ze,primarySchemaName:We,customProperties:_t},yt,kt){let ct=a(ee),Lt=a(U),rs=!ct&&!Lt&&Me&&xe,ds=s(U),Vs=s(ee),{foreignOnDelete:Fs}=q(_t),tr=S(ye.createForeignKeyConstraint,{primaryTable:d(J,We||kt.schemaName),name:O?`CONSTRAINT ${N(O)}`:"",foreignKey:rs?x(ds):j(ds),primaryKey:rs?x(Vs):j(Vs),onDelete:Fs?` ON DELETE ${Fs}`:""});return{statement:he.trim(tr),isActivated:rs}},createForeignKey({name:O,foreignTable:U,foreignKey:J,primaryTable:ee,primaryKey:Me,primaryTableActivated:xe,foreignTableActivated:ze,foreignSchemaName:We,primarySchemaName:_t,customProperties:yt},kt,ct){let Lt=a(Me),rs=a(J),ds=!Lt&&!rs&&xe&&ze,Vs=s(J),Fs=s(Me),{foreignOnDelete:tr}=q(yt),Sn=S(ye.createForeignKey,{primaryTable:d(ee,_t||ct.schemaName),foreignTable:d(U,We||ct.schemaName),name:O?N(O):"",foreignKey:ds?x(Vs):j(Vs),primaryKey:ds?x(Fs):j(Fs),onDelete:tr?` ON DELETE ${tr}`:""});return{statement:he.trim(Sn)+`
`,isActivated:ds}},dropForeignKey(O,U){let J={tableName:O,fkConstraintName:U};return S(ye.dropForeignKey,J)},hydrateTable({tableData:O,entityData:U,jsonSchema:J}){var ze,We;let ee=U[0],Me=he.first(ee.partitioning)||{},xe=D.getKeys(Me.compositePartitionKey,J);return{...O,keyConstraints:D.getTableKeyConstraints(J),selectStatement:he.trim(ee.selectStatement),partitioning:he.assign({},Me,{compositePartitionKey:xe}),...he.pick(ee,"blockchain_table_clauses","duplicated","external","external_table_clause","immutable","sharded","storage","temporary","temporaryType","description","ifNotExist","tableProperties"),synonyms:((We=(ze=O==null?void 0:O.schemaData)==null?void 0:ze.synonyms)==null?void 0:We.filter(_t=>_t.synonymEntityId===J.GUID))||[]}},createTable({blockchain_table_clauses:O,checkConstraints:U,columnDefinitions:J,columns:ee,duplicated:Me,external:xe,external_table_clause:ze,foreignKeyConstraints:We,keyConstraints:_t,immutable:yt,name:kt,partitioning:ct,schemaData:Lt,selectStatement:rs,sharded:ds,storage:Vs,temporary:Fs,temporaryType:tr,description:Sn,ifNotExist:WE,tableProperties:GP,synonyms:vP},An){let dn=d(kt,Lt.schemaName),XE=Sn?S(ye.comment,{object:"TABLE",objectName:dn,comment:p(Sn)}):"",HP=c(_t.map(re(ye,An)),no=>no.statement),KP=w(HP,An),WP=c(We,no=>no.statement),XP=w(WP,An),zE=P(dn,J),$E=S(ye.createTableProps,{columnDefinitions:he.join(ee,`,
	`),foreignKeyConstraints:XP,keyConstraints:KP,checkConstraints:he.isEmpty(U)?"":`,
	`+he.join(U,`,
	`)}),zP=As(vP,dn,Lt.schemaName),$P=XE||zE?`
`+XE+zE:"",QP=Lt.dbVersion||"",QE=js(QP),pn=S(ye.createTable,{name:dn,ifNotExists:!QE&&WE?" IF NOT EXISTS":"",tableProps:$E?`
(
	${$E}
)`:"",tableType:G({duplicated:Me,external:xe,immutable:yt,sharded:ds,temporary:Fs,temporaryType:tr,blockchain_table_clauses:O}),options:R({blockchain_table_clauses:O,external_table_clause:ze,storage:Vs,partitioning:ct,selectStatement:rs,tableProperties:GP})});return QE?pn=bt(pn,WE):pn+=";",i(pn+`${$P}
`+zP,{isActivated:An})},hydrateIndex(O,U,J){return{...O,schemaName:J.schemaName}},createIndex(O,U,J,ee=!0){let Me=gt(U.indxName),xe=Le(U.indxType),ze=At(U),We=Ze(U),_t=e.dbVersion||"",yt=js(_t),kt=U.ifNotExist&&!yt,ct=S(ye.createIndex,{indexType:xe,ifNotExists:kt?" IF NOT EXISTS":"",name:Me,keys:ze,options:We,tableName:d(O,U.schemaName)});return U.ifNotExist&&yt&&(ct=bt(ct,!0)),yt?i(ct,{isActivated:U.isActivated}):i(ct,{isActivated:U.isActivated})},dropIndex({name:O}){return S(ye.dropIndex,{name:O})},alterIndexRename({oldName:O,newName:U}){return S(ye.alterIndexRename,{oldName:O,newName:U})},alterIndexRebuild({name:O,indexData:U}){let J=Ze(U);return S(ye.alterIndexRebuild,{name:O,options:J})},hydrateViewColumn(O){return{name:O.name,tableName:O.entityName,alias:O.alias,isActivated:O.isActivated,dbName:O.dbName}},hydrateView({viewData:O,entityData:U,jsonSchema:J}){var Me,xe;let ee=U[0];return{name:O.name,keys:O.keys,orReplace:ee.or_replace,editionable:ee.editionable,editioning:ee.editioning,force:ee.force,selectStatement:ee.selectStatement,tableName:O.tableName,schemaName:O.schemaData.schemaName,description:ee.description,ifNotExist:ee.ifNotExist,materialized:ee.materialized,sharing:ee.sharing,duality:ee.duality,rootTableAlias:ee.rootTableAlias,tableTagsClause:ee.tableTagsClause,viewProperties:ee.materialized?ee.mviewProperties:ee.viewProperties,synonyms:((xe=(Me=O.schemaData)==null?void 0:Me.synonyms)==null?void 0:xe.filter(ze=>ze.synonymEntityId===J.GUID))||[],modelInfo:{dbVersion:he.get(O,"schemaData.dbVersion")},whereClause:ee.whereClause}},hydrateViewIndex(O,U,J){var ee;return{...O,schemaName:U.schemaName,materialized:(ee=he.first(J))==null?void 0:ee.materialized}},createViewIndex(O,U,J,ee){let Me=gt(U.indxName),xe=Le(U.indxType),ze=At(U),We=Ze(U,ee);if(U.materialized)return i(S(ye.createIndex,{indexType:xe,name:Me,keys:ze,options:We,tableName:d(O,U.schemaName)}),{isActivated:U.isActivated})},createView(O,U,J){let ee=d(O.name,O.schemaName),{columns:Me,tables:xe}=ae(O.keys),ze=Me.map(rs=>rs.statement).join(`,
		`),We=O.description?`
`+S(ye.comment,{object:"TABLE",objectName:ee,comment:p(O.description)})+`
`:`
`,_t=he.trim(O.selectStatement)?he.trim(n(O.selectStatement)):S(ye.viewSelectStatement,{tableName:xe.join(", "),keys:ze}),yt=As(O.synonyms,ee,O.schemaName),kt=he.get(O,"modelInfo.dbVersion",""),ct=js(kt),Lt=S(ye.createView,{name:ee,ifNotExists:!ct&&O.ifNotExist?" IF NOT EXISTS":"",orReplace:O.orReplace&&!O.materialized?" OR REPLACE":"",force:O.force&&!O.materialized?" FORCE":"",materialized:O.materialized?" MATERIALIZED":"",viewType:O.materialized?"":te(O),viewProperties:O.viewProperties?` 
`+n(O.viewProperties):"",sharing:O.sharing&&!O.materialized?` SHARING=${O.sharing}`:"",selectStatement:_t});return ct?Lt=bt(Lt,O.ifNotExist):Lt+=";",i(Lt+We+yt,{isActivated:J})},createDualityView({jsonSchema:O,view:U,relatedSchemas:J}){return Rw.getCreatorInstance(Iw.SQL,{ddlTemplates:ye,assignTemplates:S,lodash:he,prepareName:N,getNamePrefixedWithSchemaName:d}).convertDualityViewToDdl({view:U,jsonSchema:O,relatedSchemas:J})},createUdt(O){let U=As(O.synonyms,d(O.name,O.schemaName),O.schemaName);return i(Ee(O,this.convertColumnDefinition)+U,{isActivated:O.isActivated})},commentIfDeactivated(O,U,J){return O},renameColumn(O,U,J){return S(ye.renameColumn,{tableName:O,oldColumnName:U,newColumnName:J})},createSchemaSequence({schemaName:O,sequence:U}){let J=js(e==null?void 0:e.dbVersion);return Ur({schemaName:O,sequence:U,usingTryCatchWrapper:J})},dropSchemaSequence({schemaName:O,sequence:U}){let J=js(e==null?void 0:e.dbVersion);return ro({schemaName:O,sequence:U,usingTryCatchWrapper:J})},alterSchemaSequence({schemaName:O,sequence:U,oldSequence:J}){let ee=js(e==null?void 0:e.dbVersion);return Nn({schemaName:O,sequence:U,oldSequence:J,usingTryCatchWrapper:ee})}}}});var lP=m((U1,TP)=>{"use strict";var{AlterScriptDto:Ji}=xt(),{getUpdateTypesScriptDtos:Cw}=Nm(),{getRenameColumnScriptDtos:Ow}=Am(),{getModifyIndexesScriptDtos:gw,getAddedIndexesScriptDtos:yw}=Im(),St=require("lodash"),Lw=_(({app:r,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n,scriptFormat:i})=>a=>{let{getEntityName:c}=le()(St),{createColumnDefinitionBySchema:T}=un()(r),l=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:i}},r),{getDefinitionByReference:E}=r.require("@hackolade/ddl-fe-utils"),p={schemaName:a.compMod.keyspaceName,dbVersion:e},A={...a,...St.omit(a==null?void 0:a.role,"properties")||{}},h=St.toPairs(A.properties).map(([y,Y])=>{let V=E({propertySchema:Y,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n});return T({name:y,jsonSchema:Y,parentJsonSchema:A,ddlProvider:l,schemaData:p,definitionJsonSchema:V})}),N=(A.chkConstr||[]).map(y=>l.createCheckConstraint(l.hydrateCheckConstraint(y))),d={name:c(A),columns:h.map(y=>l.convertColumnDefinition(y)),checkConstraints:N,foreignKeyConstraints:[],schemaData:p,columnDefinitions:h},S=l.hydrateTable({tableData:d,entityData:[A],jsonSchema:A}),D=cP({_:St,ddlProvider:l,collection:a,dbVersion:e}).flatMap(({scripts:y})=>y.map(({script:Y})=>Y)),P=l.createTable(S,A.isActivated);return Ji.getInstance([P,...D],!0,!1)},"getAddCollectionScriptDto"),ww=_((r,e)=>t=>{let{getEntityName:s,getNamePrefixedWithSchemaNameForScriptFormat:n}=le()(St),i={...t,...St.omit(t==null?void 0:t.role,"properties")||{}},a=s(i),c=t.compMod.keyspaceName,l=`DROP TABLE ${n(e)(a,c)};`;return Ji.getInstance([l],!0,!0)},"getDeleteCollectionScriptDto"),Bw=_(({app:r,dbVersion:e,scriptFormat:t})=>s=>{let n=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:t}},r);return[...gw({_:St,ddlProvider:n,scriptFormat:t})({collection:s})].filter(Boolean)},"getModifyCollectionScriptDtos"),Uw=_(({app:r,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n,scriptFormat:i})=>a=>{var P;let{getEntityName:c,getNamePrefixedWithSchemaNameForScriptFormat:T}=le()(St),{createColumnDefinitionBySchema:l}=un()(r),E=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:i}},r),{getDefinitionByReference:u}=r.require("@hackolade/ddl-fe-utils"),p={...a,...St.omit(a==null?void 0:a.role,"properties")||{}},A=c(p),h=(P=p.compMod)==null?void 0:P.keyspaceName,N=T(i)(A,h),d={schemaName:h,dbVersion:e},S=St.toPairs(a.properties).filter(([y,Y])=>!Y.compMod).map(([y,Y])=>{let V=u({propertySchema:Y,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n});return l({name:y,jsonSchema:Y,parentJsonSchema:p,ddlProvider:E,schemaData:d,definitionJsonSchema:V})}).map(y=>E.convertColumnDefinition(y)).map(y=>`ALTER TABLE ${N} ADD (${y});`).map(y=>Ji.getInstance([y],!0,!1)).filter(Boolean),D=cP({_:St,ddlProvider:E,collection:a});return S.concat(D).filter(Boolean)},"getAddColumnScriptDtos"),cP=_(({_:r,ddlProvider:e,collection:t})=>{var c,T;let s=((c=t==null?void 0:t.role)==null?void 0:c.Indxs)||[],n={...t==null?void 0:t.properties,...(T=t==null?void 0:t.role)==null?void 0:T.properties},i=Object.values(n).map(({GUID:l})=>l);return s.length===0||i.length===0?[]:s.some(({indxKey:l})=>l.find(({keyId:E})=>i.includes(E)))?yw({_:r,ddlProvider:e})({collection:t}):[]},"getNewlyCreatedIndexesScripts"),Yw=_((r,e)=>t=>{var E;let{getEntityName:s,getNamePrefixedWithSchemaNameForScriptFormat:n,prepareNameForScriptFormat:i}=le()(St),a={...t,...St.omit(t==null?void 0:t.role,"properties")||{}},c=s(a),T=(E=a.compMod)==null?void 0:E.keyspaceName,l=n(e)(c,T);return St.toPairs(t.properties).filter(([u,p])=>!p.compMod).map(([u])=>`ALTER TABLE ${l} DROP COLUMN ${i(e)(u)};`).map(u=>Ji.getInstance([u],!0,!0)).filter(Boolean)},"getDeleteColumnScriptDtos"),Mw=_((r,e,t)=>s=>{let n=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:t}},r),i=Ow(St,n,t)(s),a=Cw(St,n,t)(s);return[...i,...a].filter(Boolean)},"getModifyColumnScriptDtos");TP.exports={getAddCollectionScriptDto:Lw,getDeleteCollectionScriptDto:ww,getModifyCollectionScriptDtos:Bw,getAddColumnScriptDtos:Uw,getDeleteColumnScriptDtos:Yw,getModifyColumnScriptDtos:Mw}});var hP=m((M1,uP)=>{"use strict";var{checkFieldPropertiesChanged:EP}=le()(),Vw=zl(),{AlterScriptDto:Js}=xt(),ss=require("lodash"),Fw=_(({app:r,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n,scriptFormat:i})=>a=>{let{createColumnDefinitionBySchema:c}=un()(r),T=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:i}},r),{getDefinitionByReference:l}=r.require("@hackolade/ddl-fe-utils"),E={dbVersion:e},u=ss.toPairs(a.properties||{}).map(([N,d])=>{let S=l({propertySchema:d,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n});return c({name:N,jsonSchema:d,parentJsonSchema:a,ddlProvider:T,schemaData:E,definitionJsonSchema:S})}),A={...c({name:a.code||a.name,jsonSchema:a,parentJsonSchema:{required:[]},definitionJsonSchema:{},ddlProvider:T,schemaData:E}),properties:u},h=T.createUdt(A);return Js.getInstance([h],!0,!1)},"getCreateUdtScriptDto"),xw=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),i=`DROP TYPE ${s(e)(t.code||t.name)};`;return Js.getInstance([i],!0,!0)},"getDeleteUdtScriptDto"),bw=_(({app:r,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n,scriptFormat:i})=>a=>{let{createColumnDefinitionBySchema:c}=un()(r),{prepareNameForScriptFormat:T}=le()(ss),l=Xt()(null,{dbVersion:e,targetScriptOptions:{keyword:i}},r),{getDefinitionByReference:E}=r.require("@hackolade/ddl-fe-utils"),u=T(i)(a.code||a.name),p={dbVersion:e};return ss.toPairs(a.properties).filter(([A,h])=>!h.compMod).map(([A,h])=>{let N=E({propertySchema:h,modelDefinitions:t,internalDefinitions:s,externalDefinitions:n});return c({name:A,jsonSchema:h,parentJsonSchema:{required:[]},ddlProvider:l,schemaData:p,definitionJsonSchema:N})}).map(A=>l.convertColumnDefinition(A,Vw.objectTypeColumnDefinition)).map(A=>`ALTER TYPE ${u} ADD ATTRIBUTE ${A};`).map(A=>Js.getInstance([A],!0,!1))},"getAddColumnToTypeScriptDtos"),kw=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),n=s(e)(t.code||t.name);return ss.toPairs(t.properties).filter(([i,a])=>!a.compMod).map(([i])=>`ALTER TYPE ${n} DROP ATTRIBUTE ${s(e)(i)};`).map(i=>Js.getInstance([i],!0,!0))},"getDeleteColumnFromTypeScriptDtos"),qw=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),n=s(e)(t.code||t.name),i=ss.values(t.properties).filter(c=>EP(c.compMod,["name"])).flatMap(c=>{let T=s(e)(c.compMod.oldField.name),l=`ALTER TYPE ${n} DROP ATTRIBUTE ${T};`,E=s(e)(c.compMod.newField.name),u=`ALTER TYPE ${n} ADD ATTRIBUTE ${E};`;return[Js.getInstance([l],!0,!0),Js.getInstance([u],!0,!1)]}),a=ss.toPairs(t.properties).filter(([c,T])=>EP(T.compMod,["type","mode"])).map(([c,T])=>{let l=s(e)(c),E=ss.toUpper(T.compMod.newField.mode||T.compMod.newField.type),u=`ALTER TYPE ${n} MODIFY ATTRIBUTE ${l} ${E};`;return Js.getInstance([u],!0,!1)});return[...i,...a]},"getModifyColumnOfTypeScriptDtos");uP.exports={getCreateUdtScriptDto:Fw,getDeleteUdtScriptDto:xw,getAddColumnToTypeScriptDtos:bw,getDeleteColumnFromTypeScriptDtos:kw,getModifyColumnOfTypeScriptDtos:qw}});var AP=m((F1,SP)=>{"use strict";var{DualityViewPropertiesType:NP}=Ql(),Gw=_(r=>e=>{let{getEntityName:t,getBucketName:s}=le()(r),n=r.get(e,"role",{}),i=r.get(n,"compMod.bucketProperties",{}),a=r.get(n,"compMod.collectionData.entityData[0]",{}),c=t(a),T=s(i);return{code:n.code,tableName:c,name:n.name,tableTagsClause:n.tableTagsClause,schemaName:T,rootTableAlias:n.rootTableAlias,orReplace:n.or_replace}},"mapToFeView"),vw=_(r=>(e,t,s)=>{let n=s==null?void 0:s[t.refId],i=(n==null?void 0:n.definition)||{},a=i.code||i.name||"";return{code:e,ref:t.ref,refId:t.refId,refIdPath:[t.refId,t.ref],refType:NP.COLLECTION_REFERENCE,columnTagsClause:t.columnTagsClause,referencedColumnName:a}},"mapRegularField"),Hw=_((r,e,t)=>{if(!t[e.GUID]){let s=r||e.title;throw s?s=`<u>${s}</u>`:s="a",new Error(`Could not find referenced collection for ${s} subquery. Check if all the subqueries have the "child table" property set`)}},"assertSubqueryIsValid"),Kw=_(r=>(e,t,s)=>{Hw(e,t,s);let n={code:e,type:t.type,name:t.title,subtype:t.subtype,sqlJsonFunction:t.sqlJsonFunction,whereClause:t.whereClause,joinedCollectionRefIdPath:[t.GUID],childTableAlias:t.childTableAlias,tableTagsClause:t.tableTagsClause,items:void 0,properties:void 0,unnestSubquery:void 0};if(t.subtype==="array"){let i=r.get(t,"items.properties",{});n.items={properties:nE(r)(i,s)}}else if(t.subtype==="object"){n.unnestSubquery=t.unnestSubquery;let i=r.get(t,"properties",{});n.properties=nE(r)(i,s)}return n},"mapSubquery"),nE=_(r=>(e,t)=>{let n=r.toPairs(e).map(([i,a])=>{if(a.type===NP.JOIN_SUBQUERY_TYPE){let T=Kw(r)(i,a,t);return[i,T]}let c=vw(r)(i,a,t);return[i,c]});return r.fromPairs(n)},"recursivelyParseProperties"),Ww=_(r=>e=>{let t=r.get(e,"role.properties",{}),s=r.get(e,"role.compMod.collectionData.collectionRefsDefinitionsMap",{});return nE(r)(t,s)},"parseProperties"),Xw=_(r=>e=>{let{getEntityName:t}=le()(r),s=r.get(e,"role",{}),n=r.get(s,"compMod.collectionData.entityData[0]",{}),i=t(n),a=Ww(r)(e);return{rootTableAlias:s.rootTableAlias,tableName:i,properties:a,duality:s.duality,editionable:s.editionable,force:s.force,viewOn:s.viewOn}},"mapToFeJsonSchema"),zw=_(r=>e=>{let t=r.get(e,"role.compMod.collectionData.collectionRefsDefinitionsMap",{}),n=r.toPairs(t).map(([i,a])=>{let c=r.get(a,"bucket[0].name",""),T=r.get(a,"collection[0]",""),l=a.definition||{},u={properties:{[l.code||l.name]:{GUID:a.definitionId}},bucketName:c,code:T.code,collectionName:T.collectionName};return[i,u]});return r.fromPairs(n)},"mapToFeRelatedSchemas"),$w=_(r=>e=>{let t=Gw(r)(e),s=Xw(r)(e),n=zw(r)(e);return{view:t,jsonSchema:s,relatedSchemas:n}},"mapDeltaDualityViewToFeDualityView");SP.exports={mapDeltaDualityViewToFeDualityView:$w}});var pP=m((b1,dP)=>{"use strict";var{AlterScriptDto:iE}=xt(),{mapDeltaDualityViewToFeDualityView:Qw}=AP(),Br=require("lodash"),jw=_((r,e)=>t=>{var c,T;let s=Xt()(null,{targetScriptOptions:{keyword:e}},r),n={name:t.code||t.name,keys:tB({view:t,collectionRefsDefinitionsMap:((T=(c=t.compMod)==null?void 0:c.collectionData)==null?void 0:T.collectionRefsDefinitionsMap)??{},ddlProvider:s,app:r}),schemaData:{schemaName:""}},i=s.hydrateView({viewData:n,entityData:[t]}),a=s.createView(i,{},t.isActivated);return iE.getInstance([a],!0,!1)},"getAddRegularViewScriptDto"),Jw=_((r,e)=>t=>{let s=Xt()(null,{targetScriptOptions:{keyword:e}},r),n=Qw(Br)(t),i=s.createDualityView(n);return iE.getInstance([i],!0,!1)},"getDualityViewScriptDto"),Zw=_((r,e)=>t=>t.duality?Jw(r,e)(t):jw(r,e)(t),"getAddViewScriptDto"),eB=_((r,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(Br),i=`DROP VIEW ${s(e)(t.code||t.name)};`;return iE.getInstance([i],!0,!0)},"getDeleteViewScriptDto"),tB=_(({view:r,collectionRefsDefinitionsMap:e,ddlProvider:t,app:s})=>{let{mapProperties:n}=s.require("@hackolade/ddl-fe-utils");return n(r,(i,a)=>{let c=e[a.refId];if(!c)return t.hydrateViewColumn({name:i,isActivated:a.isActivated});let T=Br.get(c.collection,"[0].code","")||Br.get(c.collection,"[0].collectionName","")||"",l=Br.get(c.bucket,"[0].code")||Br.get(c.bucket,"[0].name",""),E=c.name;return E===i?t.hydrateViewColumn({name:E,dbName:l,entityName:T,isActivated:a.isActivated}):t.hydrateViewColumn({name:E,dbName:l,entityName:T,alias:i,isActivated:a.isActivated})})},"getKeys");dP.exports={getAddViewScriptDto:Zw,getDeleteViewScriptDto:eB}});var mP=m((q1,fP)=>{"use strict";var uE=class uE{isActivated;name};_(uE,"AlterRelationshipFKField");var oE=uE,hE=class hE{bucket;collection};_(hE,"AlterRelationshipParentDto");var aE=hE,NE=class NE{bucket;collection};_(NE,"AlterRelationshipChildDto");var _E=NE,SE=class SE{relationshipOnDelete;relationshipOnUpdate;relationshipMatch};_(SE,"AlterRelationshipCustomProperties");var cE=SE,AE=class AE{created;deleted;modified;parent;child;name;description;customProperties;isActivated};_(AE,"AlterRelationshipRoleCompModDto");var TE=AE,dE=class dE{id;name;relationshipType;parentField;parentCardinality;childField;isActivated;childCardinality;parentCollection;childCollection;hackoladeStyles;compMod;roleType};_(dE,"AlterRelationshipRoleDto");var lE=dE,pE=class pE{type;isActivated;unique;subtype;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};_(pE,"AlterRelationshipDto");var EE=pE;fP.exports={AlterRelationshipRoleCompModDto:TE,AlterRelationshipRoleDto:lE,AlterRelationshipDto:EE,AlterRelationshipFKField:oE,AlterRelationshipParentDto:aE,AlterRelationshipChildDto:_E,AlterRelationshipCustomProperties:cE}});var OP=m((H1,CP)=>{"use strict";var{AlterScriptDto:fE}=xt(),{AlterRelationshipDto:v1}=mP(),Zi=_(r=>r.role.name,"getRelationshipName"),sB=_((r,e)=>t=>{let{getNamePrefixedWithSchemaNameForScriptFormat:s}=le()(r),n=t.role.compMod,i=n.child.bucket.name,a=n.child.collection.name;return s(e)(a,i)},"getFullChildTableName"),PP=_((r,e)=>t=>{var i,a;let s=t.role.compMod,n=((i=s.name)==null?void 0:i.new)||Zi(t)||"";return r.createForeignKey({name:n,foreignKey:s.child.collection.fkFields,primaryKey:s.parent.collection.fkFields,customProperties:(a=s.customProperties)==null?void 0:a.new,foreignTable:s.child.collection.name,foreignSchemaName:s.child.bucket.name,foreignTableActivated:s.child.collection.isActivated,primaryTable:s.parent.collection.name,primarySchemaName:s.parent.bucket.name,primaryTableActivated:s.parent.collection.isActivated})},"getAddSingleForeignKeyStatementDto"),RP=_(r=>{var t,s,n,i,a,c,T,l,E,u,p;let e=r.role.compMod;return e?[((t=e.name)==null?void 0:t.new)||Zi(r),(s=e.parent)==null?void 0:s.bucket,(n=e.parent)==null?void 0:n.collection,(c=(a=(i=e.parent)==null?void 0:i.collection)==null?void 0:a.fkFields)==null?void 0:c.length,(T=e.child)==null?void 0:T.bucket,(l=e.child)==null?void 0:l.collection,(p=(u=(E=e.child)==null?void 0:E.collection)==null?void 0:u.fkFields)==null?void 0:p.length].every(A=>!!A):!1},"canRelationshipBeAdded"),rB=_((r,e)=>t=>t.filter(s=>RP(s)).map(s=>{let n=PP(r,e)(s);return fE.getInstance([n.statement],n.isActivated,!1)}).filter(Boolean).filter(s=>s.scripts.some(n=>!!n.script)),"getAddForeignKeyScriptDtos"),IP=_((r,e,t)=>s=>{var p,A,h,N;let{prepareNameForScriptFormat:n}=le()(e),i=s.role.compMod,a=sB(e,t)(s),c=((p=i.name)==null?void 0:p.old)||Zi(s)||"",T=n(t)(c),l=r.dropForeignKey(a,T),E=!!((N=(h=(A=s.role)==null?void 0:A.compMod)==null?void 0:h.isActivated)!=null&&N.new),u=i.child.collection.isActivated;return{statement:l,isActivated:E&&u}},"getDeleteSingleForeignKeyStatementDto"),DP=_(r=>{var t,s,n;let e=r.role.compMod;return e?[((t=e.name)==null?void 0:t.old)||Zi(r),(s=e.child)==null?void 0:s.bucket,(n=e.child)==null?void 0:n.collection].every(i=>!!i):!1},"canRelationshipBeDeleted"),nB=_((r,e,t)=>s=>s.filter(n=>DP(n)).map(n=>{let i=IP(r,e,t)(n);return fE.getInstance([i.statement],i.isActivated,!0)}).filter(Boolean).filter(n=>n.scripts.some(i=>!!i.script)),"getDeleteForeignKeyScriptDtos"),iB=_((r,e,t)=>s=>s.filter(n=>RP(n)&&DP(n)).map(n=>{let i=IP(r,e,t)(n),a=PP(r,e)(n),c=a.isActivated&&i.isActivated;return fE.getDropAndRecreateInstance(i.statement,a.statement,c)}).filter(Boolean).filter(n=>n.scripts.some(i=>!!i.script)),"getModifyForeignKeyScriptDtos");CP.exports={getDeleteForeignKeyScriptDtos:nB,getModifyForeignKeyScriptDtos:iB,getAddForeignKeyScriptDtos:rB}});var yE=m((W1,gP)=>{"use strict";var DE=class DE{message;stack};_(DE,"PluginError");var mE=DE,CE=class CE{require};_(CE,"App");var PE=CE,OE=class OE{log;clear};_(OE,"Logger");var RE=OE,gE=class gE{jsonSchema;modelDefinitions;internalDefinitions;externalDefinitions;containerData;entityData;entities;views;viewData;relationships;collectionRefsDefinitionsMap;isUpdateScript;level;host;clusterId;accessToken;applyToInstanceQueryRequestTimeout;script;hiddenKeys;options;modelData};_(gE,"CoreData");var IE=gE;gP.exports={App:PE,CoreData:IE,Logger:RE,PluginError:mE}});var LP=m((z1,yP)=>{"use strict";var xE=class xE{name;isActivated};_(xE,"ContainerJsonSchema");var LE=xE,bE=class bE{backgroundColor};_(bE,"ContainerStyles");var wE=bE,kE=class kE{collectionName;isActivated;bucketId;additionalProperties;tableIfNotExists};_(kE,"EntityData");var BE=kE,qE=class qE{$schema;type;GUID};_(qE,"InternalDefinitions");var UE=qE,GE=class GE{$schema;type;GUID};_(GE,"ModelDefinitions");var YE=GE,vE=class vE{$schema;type;GUID};_(vE,"ExternalDefinitions");var ME=vE,HE=class HE{type;isActivated;mode;subtype;compositeKey;compositePartitionKey;compositeClusteringKey;compositePrimaryKey;compositeUniqueKey;GUID};_(HE,"FieldJsonSchema");var VE=HE,KE=class KE{$schema;type;title;properties;isActivated;additionalProperties;tableIfNotExists;GUID};_(KE,"EntityJsonSchema");var FE=KE;yP.exports={ContainerJsonSchema:LE,ContainerStyles:wE,EntityData:BE,InternalDefinitions:UE,ModelDefinitions:YE,ExternalDefinitions:ME,FieldJsonSchema:VE,EntityJsonSchema:FE}});var eo=m((Q1,wP)=>{"use strict";wP.exports=Xt()});var UP=m((J1,BP)=>{"use strict";var{AlterScriptDto:hn}=xt(),{App:j1}=yE(),oB="sequences",to=require("lodash"),aB=_(({app:r})=>({container:e,dbVersion:t})=>{var a;let s=eo()(null,{dbVersion:t},r),{getDbName:n}=le()(to),i=n([e.role]);return(((a=e.role)==null?void 0:a.sequences)||[]).map(c=>{let T=s.createSchemaSequence({schemaName:i,sequence:c});return hn.getInstance([T],!0,!1)}).filter(Boolean)},"getAddContainerSequencesScriptDtos"),_B=_(({app:r})=>({container:e,dbVersion:t})=>{var d,S;let s=eo()(null,{dbVersion:t},r),{getDbName:n,getGroupItemsByCompMode:i}=le()(to),a=n([e.role]),c=((S=(d=e.role)==null?void 0:d.compMod)==null?void 0:S[oB])||{},{new:T=[],old:l=[]}=c,{removed:E,added:u,modified:p}=i({newItems:T,oldItems:l}),A=E.map(D=>{let P=s.dropSchemaSequence({schemaName:a,sequence:D});return hn.getInstance([P],!0,!0)}),h=u.map(D=>{let P=s.createSchemaSequence({schemaName:a,sequence:D});return hn.getInstance([P],!0,!1)});return[...p.map(D=>{let P=to.find(l,{id:D.id})||{},y=s.alterSchemaSequence({schemaName:a,sequence:D,oldSequence:P}),Y=y.startsWith("DROP");return hn.getInstance([y],!0,Y)}),...A,...h].filter(Boolean)},"getModifyContainerSequencesScriptDtos"),cB=_(({app:r})=>({container:e,dbVersion:t})=>{var a;let s=eo()(null,{dbVersion:t},r),{getDbName:n}=le()(to),i=n([e.role]);return(((a=e.role)==null?void 0:a.sequences)||[]).map(c=>{let T=s.dropSchemaSequence({schemaName:i,sequence:c});return hn.getInstance([T],!0,!0)}).filter(Boolean)},"getDeleteContainerSequencesScriptDtos");BP.exports={getAddContainerSequencesScriptDtos:aB,getModifyContainerSequencesScriptDtos:_B,getDeleteContainerSequencesScriptDtos:cB}});var MP=m((aF,YP)=>{"use strict";var{getAddContainerScriptDto:TB,getDeleteContainerScriptDto:lB}=um(),{getAddCollectionScriptDto:EB,getDeleteCollectionScriptDto:uB,getModifyCollectionScriptDtos:hB,getAddColumnScriptDtos:NB,getDeleteColumnScriptDtos:SB,getModifyColumnScriptDtos:AB}=lP(),{getDeleteUdtScriptDto:dB,getCreateUdtScriptDto:pB,getAddColumnToTypeScriptDtos:fB,getDeleteColumnFromTypeScriptDtos:mB,getModifyColumnOfTypeScriptDtos:PB}=hP(),{getAddViewScriptDto:RB,getDeleteViewScriptDto:IB}=pP(),{getModifyForeignKeyScriptDtos:DB,getDeleteForeignKeyScriptDtos:CB,getAddForeignKeyScriptDtos:OB}=OP(),{AlterScriptDto:eF,ModificationScript:tF}=xt(),{App:sF,CoreData:rF}=yE(),{InternalDefinitions:nF,ModelDefinitions:iF,ExternalDefinitions:oF}=LP(),{getModifyContainerSequencesScriptDtos:gB,getDeleteContainerSequencesScriptDtos:yB,getAddContainerSequencesScriptDtos:LB}=UP(),Ms=require("lodash"),wB=_(({collection:r,app:e,scriptFormat:t})=>{var c,T,l,E,u,p,A,h;let s=(E=(l=(T=(c=r.properties)==null?void 0:c.containers)==null?void 0:T.properties)==null?void 0:l.added)==null?void 0:E.items,n=(h=(A=(p=(u=r.properties)==null?void 0:u.containers)==null?void 0:p.properties)==null?void 0:A.deleted)==null?void 0:h.items,i=[].concat(s).filter(Boolean).map(N=>TB(e,t)(Object.keys(N.properties)[0])),a=[].concat(n).filter(Boolean).map(N=>lB(e,t)(Object.keys(N.properties)[0]));return[...i,...a].filter(Boolean)},"getAlterContainersScriptDtos"),BB=_(({collection:r,app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})=>{var d,S,D,P,y,Y,V,k,$,C,G,R;let c=[].concat((P=(D=(S=(d=r.properties)==null?void 0:d.entities)==null?void 0:S.properties)==null?void 0:D.added)==null?void 0:P.items).filter(Boolean).map(w=>Object.values(w.properties)[0]),T=[].concat((k=(V=(Y=(y=r.properties)==null?void 0:y.entities)==null?void 0:Y.properties)==null?void 0:V.deleted)==null?void 0:k.items).filter(Boolean).map(w=>Object.values(w.properties)[0]),l=[].concat((R=(G=(C=($=r.properties)==null?void 0:$.entities)==null?void 0:C.properties)==null?void 0:G.modified)==null?void 0:R.items).filter(Boolean).map(w=>Object.values(w.properties)[0]),E=c.filter(w=>{var x;return(x=w.compMod)==null?void 0:x.created}).map(EB({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})),u=T.filter(w=>{var x;return(x=w.compMod)==null?void 0:x.deleted}).map(uB(e,a)),p=l.filter(w=>{var x;return(x=w.compMod)==null?void 0:x.modified}).flatMap(hB({app:e,dbVersion:t,scriptFormat:a})),A=c.filter(w=>{var x;return!((x=w==null?void 0:w.compMod)!=null&&x.created)}).flatMap(NB({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})),h=T.filter(w=>{var x;return!((x=w==null?void 0:w.compMod)!=null&&x.deleted)}).flatMap(SB(e,a)),N=l.flatMap(AB(e,t,a));return[...E,...u,...p,...A,...h,...N].filter(Boolean)},"getAlterCollectionsScriptDtos"),UB=_((r,e,t,s)=>{var a,c,T,l,E,u,p,A;let n=[].concat((l=(T=(c=(a=r.properties)==null?void 0:a.views)==null?void 0:c.properties)==null?void 0:T.added)==null?void 0:l.items).filter(Boolean).map(h=>Object.values(h.properties)[0]).map(h=>({...h,...h.role||{}})).filter(h=>{var N;return(N=h.compMod)==null?void 0:N.created}).map(RB(e,s));return[...[].concat((A=(p=(u=(E=r.properties)==null?void 0:E.views)==null?void 0:u.properties)==null?void 0:p.deleted)==null?void 0:A.items).filter(Boolean).map(h=>Object.values(h.properties)[0]).map(h=>({...h,...h.role||{}})).map(IB(e,s)),...n].filter(Boolean)},"getAlterViewScriptDtos"),YB=_(({collection:r,app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})=>{var p,A,h,N,d,S,D,P,y,Y,V,k,$,C,G,R,w,x,j,re;let c=[].concat((N=(h=(A=(p=r.properties)==null?void 0:p.modelDefinitions)==null?void 0:A.properties)==null?void 0:h.added)==null?void 0:N.items).filter(Boolean).map(q=>Object.values(q.properties)[0]).map(q=>({...q,...Ms.omit(q.role,"properties")||{}})).filter(q=>{var Ee;return(Ee=q.compMod)==null?void 0:Ee.created}).map(pB({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})),T=[].concat((P=(D=(S=(d=r.properties)==null?void 0:d.modelDefinitions)==null?void 0:S.properties)==null?void 0:D.deleted)==null?void 0:P.items).filter(Boolean).map(q=>Object.values(q.properties)[0]).map(q=>({...q,...Ms.omit(q.role,"properties")||{}})).filter(q=>{var Ee;return(Ee=q.compMod)==null?void 0:Ee.deleted}).map(dB(e,a)),l=[].concat((k=(V=(Y=(y=r.properties)==null?void 0:y.modelDefinitions)==null?void 0:Y.properties)==null?void 0:V.added)==null?void 0:k.items).filter(Boolean).map(q=>Object.values(q.properties)[0]).filter(q=>!q.compMod).map(q=>({...q,...Ms.omit(q.role,"properties")||{}})).filter(q=>q.childType==="object_udt").flatMap(fB({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:n,externalDefinitions:i,scriptFormat:a})),E=[].concat((R=(G=(C=($=r.properties)==null?void 0:$.modelDefinitions)==null?void 0:C.properties)==null?void 0:G.deleted)==null?void 0:R.items).filter(Boolean).map(q=>Object.values(q.properties)[0]).filter(q=>!q.compMod).map(q=>({...q,...Ms.omit(q.role,"properties")||{}})).filter(q=>q.childType==="object_udt").flatMap(mB(e,a)),u=[].concat((re=(j=(x=(w=r.properties)==null?void 0:w.modelDefinitions)==null?void 0:x.properties)==null?void 0:j.modified)==null?void 0:re.items).filter(Boolean).map(q=>Object.values(q.properties)[0]).filter(q=>!q.compMod).map(q=>({...q,...Ms.omit(q.role,"properties")||{}})).filter(q=>q.childType==="object_udt").flatMap(PB(e,a));return[...T,...c,...l,...E,...u].filter(Boolean)},"getAlterModelDefinitionsScriptDtos"),MB=_(({collection:r,app:e,scriptFormat:t})=>{var E,u,p,A,h,N,d,S,D,P,y,Y;let s=Xt()(null,{targetScriptOptions:{keyword:t}},e),n=[].concat((A=(p=(u=(E=r.properties)==null?void 0:E.relationships)==null?void 0:u.properties)==null?void 0:p.added)==null?void 0:A.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var k,$;return($=(k=V==null?void 0:V.role)==null?void 0:k.compMod)==null?void 0:$.created}),i=[].concat((S=(d=(N=(h=r.properties)==null?void 0:h.relationships)==null?void 0:N.properties)==null?void 0:d.deleted)==null?void 0:S.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var k,$;return($=(k=V==null?void 0:V.role)==null?void 0:k.compMod)==null?void 0:$.deleted}),a=[].concat((Y=(y=(P=(D=r.properties)==null?void 0:D.relationships)==null?void 0:P.properties)==null?void 0:y.modified)==null?void 0:Y.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var k,$;return($=(k=V==null?void 0:V.role)==null?void 0:k.compMod)==null?void 0:$.modified}),c=CB(s,Ms,t)(i),T=OB(s,Ms)(n),l=DB(s,Ms,t)(a);return[...c,...T,...l].filter(Boolean)},"getAlterRelationshipsScriptDtos"),VB=_(r=>{if(!r)return;let e=r.scripts.map(t=>({...t,script:(t.script||"").trim()})).filter(t=>!!t.script);if(e.length)return{...r,scripts:e}},"prettifyAlterScriptDto"),FB=_(({collection:r,app:e,dbVersion:t})=>{var l,E,u,p,A,h,N,d,S,D,P,y;let s=(p=(u=(E=(l=r.properties)==null?void 0:l.containers)==null?void 0:E.properties)==null?void 0:u.added)==null?void 0:p.items,n=(d=(N=(h=(A=r.properties)==null?void 0:A.containers)==null?void 0:h.properties)==null?void 0:N.deleted)==null?void 0:d.items,i=(y=(P=(D=(S=r.properties)==null?void 0:S.containers)==null?void 0:D.properties)==null?void 0:P.modified)==null?void 0:y.items,a=[].concat(s).filter(Boolean).map(Y=>Object.values(Y.properties)[0]).flatMap(Y=>LB({app:e})({container:Y,dbVersion:t})),c=[].concat(n).filter(Boolean).map(Y=>Object.values(Y.properties)[0]).flatMap(Y=>yB({app:e})({container:Y,dbVersion:t})),T=[].concat(i).filter(Boolean).map(Y=>Object.values(Y.properties)[0]).flatMap(Y=>gB({app:e})({container:Y,dbVersion:t}));return[...a,...c,...T].filter(Boolean)},"getAlterContainersSequencesScriptDtos"),xB=_((r,e)=>{var h,N,d;let t=JSON.parse(r.jsonSchema);if(!t)throw new Error('"comparisonModelCollection" is not found. Alter script can be generated only from Delta model');let s=(N=(h=r.options)==null?void 0:h.targetScriptOptions)==null?void 0:N.keyword,n=JSON.parse(r.modelDefinitions),i=JSON.parse(r.internalDefinitions),a=JSON.parse(r.externalDefinitions),c=(d=r.modelData[0])==null?void 0:d.dbVersion,T=wB({collection:t,app:e,scriptFormat:s}),l=BB({collection:t,app:e,dbVersion:c,modelDefinitions:n,internalDefinitions:i,externalDefinitions:a,scriptFormat:s}),E=UB(t,e,c,s),u=YB({collection:t,app:e,dbVersion:c,modelDefinitions:n,internalDefinitions:i,externalDefinitions:a,scriptFormat:s}),p=MB({collection:t,app:e,scriptFormat:s}),A=FB({collection:t,app:e,dbVersion:c});return[...T,...A,...u,...l,...E,...p].filter(Boolean).map(S=>VB(S)).filter(Boolean)},"getAlterScriptDtos");YP.exports={getAlterScriptDtos:xB}});var kP=m((TF,bP)=>{"use strict";var{getAlterScriptDtos:so}=MP(),{AlterScriptDto:cF}=xt(),VP=require("lodash"),FP=_(r=>(e,t)=>{let{commentIfDeactivated:s}=le()(r);return e.map(n=>n.isActivated===!1?n.scripts.map(i=>s(i.script,{isActivated:!1,isPartOfLine:!1})):t?n.scripts.map(i=>i.script):n.scripts.map(i=>s(i.script,{isActivated:!i.isDropScript,isPartOfLine:!1}))).flat().filter(Boolean).map(n=>n.trim()).filter(Boolean).join(`

`)},"joinAlterScriptDtosIntoScript"),bB=_((r,e)=>{var n,i;let t=so(r,e),s=(i=(n=r.options)==null?void 0:n.additionalOptions)==null?void 0:i.some(a=>a.id==="applyDropStatements"&&a.value);return FP(VP)(t,s)},"buildEntityLevelAlterScript"),kB=_((r,e)=>so(r,e).some(s=>s.isActivated&&s.scripts.some(n=>n.isDropScript)),"doesEntityLevelAlterScriptContainDropStatements"),xP=_(r=>({...r,jsonSchema:r.collections[0],internalDefinitions:Object.values(r.internalDefinitions)[0]}),"mapCoreDataForContainerLevelScripts"),qB=_((r,e)=>{var i,a;let t=xP(r),s=so(t,e),n=(a=(i=t.options)==null?void 0:i.additionalOptions)==null?void 0:a.some(c=>c.id==="applyDropStatements"&&c.value);return FP(VP)(s,n)},"buildContainerLevelAlterScript"),GB=_((r,e)=>{let t=xP(r);return so(t,e).some(n=>n.isActivated&&n.scripts.some(i=>i.isDropScript))},"doesContainerLevelAlterScriptContainDropStatements");bP.exports={buildEntityLevelAlterScript:bB,doesEntityLevelAlterScriptContainDropStatements:kB,buildContainerLevelAlterScript:qB,doesContainerLevelAlterScriptContainDropStatements:GB}});var qP=im(),vB=am(),{doesContainerLevelAlterScriptContainDropStatements:HB,doesEntityLevelAlterScriptContainDropStatements:KB,buildContainerLevelAlterScript:WB,buildEntityLevelAlterScript:XB}=kP();module.exports={generateScript(r,e,t,s){try{let n=XB(r,s);t(null,n)}catch(n){e.log("error",{message:n.message,stack:n.stack},"Oracle Forward-Engineering Error"),t({message:n.message,stack:n.stack})}},generateViewScript(r,e,t,s){t(new Error("Forward-Engineering of delta model on view level is not supported"))},generateContainerScript(r,e,t,s){try{let n=WB(r,s);t(null,n)}catch(n){e.log("error",{message:n.message,stack:n.stack},"Oracle Forward-Engineering Error"),t({message:n.message,stack:n.stack})}},getDatabases(r,e,t,s){e.progress({message:"Find all schemas"}),qP.getSchemaNames(r,e,t,s)},applyToInstance(r,e,t,s){e.clear(),e.log("info",r,"connectionInfo",r.hiddenKeys),vB.applyToInstance(r,e,s).then(n=>{t(null,n)}).catch(n=>{let i={message:n.message,stack:n.stack};e.log("error",i,"Error when applying to instance"),t(i)})},testConnection(r,e,t,s){qP.testConnection(r,e,t,s)},isDropInStatements(r,e,t,s){try{if(r.level==="container"){let n=HB(r,s);t(null,n)}else{let n=KB(r,s);t(null,n)}}catch(n){t({message:n.message,stack:n.stack})}}};
