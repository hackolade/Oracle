"use strict";var jm=Object.defineProperty;var c=(i,e)=>jm(i,"name",{value:e,configurable:!0});var LE=i=>e=>{var t=i[e];if(t)return t();throw new Error("Module not found in bundle: "+e)};var Jm=(i,e)=>()=>(i&&(e=i(i=0)),e);var P=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var BE=P((WL,Qm)=>{Qm.exports={name:"Oracle",version:"0.2.13",author:"hackolade",engines:{hackolade:"6.11.1",hackoladePlugin:"1.2.0"},contributes:{target:{applicationTarget:"Oracle",title:"Oracle",versions:["12c","18c","19c","21c","23ai"]},features:{nestedCollections:!1,disablePatternField:!0,disableMultipleTypes:!0,enableForwardEngineering:!0,disableReverseEngineering:!1,disableChoices:!0,enableJsonType:!0,useJsonTypesWithComplexTypes:!0,reverseSchemaIntoOneColumn:!0,disableDenormalization:!0,enableComplexTypesNormalization:!0,restrictNestedFieldsAsPrimaryKey:!1,views:{enabled:!0,viewLevel:"model",disablePipelines:!0},relationships:{compositeRelationships:!0},enableFetchSystemEntitiesCheckbox:!0,discoverRelationships:!0}},description:"Hackolade plugin for Oracle and Autonomous databases",disabled:!1,dependencies:{"adm-zip":"0.5.9",lodash:"4.17.21",oracledb:"6.6.0",perplex:"0.11.0"},"lint-staged":{"*.{js,json}":"prettier --write"},"simple-git-hooks":{"pre-commit":"npx lint-staged","pre-push":"npx eslint ."},scripts:{lint:"eslint . --max-warnings=0",package:"node esbuild.package.js"},devDependencies:{"@hackolade/hck-esbuild-plugins-pack":"0.0.1","@typescript-eslint/eslint-plugin":"7.11.0","@typescript-eslint/parser":"7.11.0",esbuild:"0.20.2","esbuild-plugin-clean":"1.0.1","esbuild-plugin-copy":"2.1.1",eslint:"8.57.0","eslint-config-prettier":"9.1.0","eslint-formatter-teamcity":"^1.0.0","eslint-plugin-import":"^2.26.0","eslint-plugin-prettier":"5.1.3","eslint-plugin-unused-imports":"3.2.0","lint-staged":"14.0.1",prettier:"3.2.5","simple-git-hooks":"2.11.1"}}});var UE=P((XL,wE)=>{"use strict";var is=require("os"),Zm=BE(),eP=c(i=>i<10?"0"+i:i,"prefixZero"),tP=c(i=>i.reduce((e,t)=>Math.max(e,t.speed),0),"maxClock"),sP=c(i=>Math.floor(i/3600)+":"+eP(parseInt((i/3600-Math.floor(i/3600))*60)),"toTime"),rP=c(()=>Zm.version,"getPluginVersion"),iP=c(i=>`Date: ${new Date}
Application version: ${i}
Plugin version: ${rP()}

System information:
 Hostname:  ${is.hostname()}
 Platform:  ${is.platform()} ${is.arch()}
 Release:   ${is.release()}
 Uptime:    ${sP(is.uptime())}
 Total RAM: ${(is.totalmem()/1073741824).toFixed(2)} GB
 CPU Model: ${is.cpus()[0].model}
 CPU Clock: ${tP(is.cpus())} MHZ
 CPU Cores: ${is.cpus().length} cores

`,"getSystemInfo"),nP=c((i,e,t)=>{t.clear(),t.log("info",iP(e.appVersion),i),t.log("info",e,"connectionInfo",e.hiddenKeys)},"logInfo");wE.exports=nP});var ME=P(($L,YE)=>{YE.exports={VERSION_MAJOR:6,VERSION_MINOR:6,VERSION_PATCH:0,VERSION_SUFFIX:""}});var nt=P((jL,FE)=>{"use strict";var ds=ME(),VE=ds.VERSION_MAJOR+"."+ds.VERSION_MINOR+"."+ds.VERSION_PATCH+ds.VERSION_SUFFIX;FE.exports={VERSION_MAJOR:ds.VERSION_MAJOR,VERSION_MINOR:ds.VERSION_MINOR,VERSION_PATCH:ds.VERSION_PATCH,VERSION_SUFFIX:ds.VERSION_SUFFIX,VERSION_STRING:VE,DEFAULT_DRIVER_NAME:"node-oracledb : "+VE,DEFAULT_ERROR_URL:"https://node-oracledb.readthedocs.io/en/latest/user_guide/installation.html",DEFAULT_MAX_SIZE_FOR_OUT_BINDS:200,CSFRM_IMPLICIT:1,CSFRM_NCHAR:2,CQN_OPCODE_ALL_OPS:0,CQN_OPCODE_ALL_ROWS:1,CQN_OPCODE_ALTER:16,CQN_OPCODE_DELETE:8,CQN_OPCODE_DROP:32,CQN_OPCODE_INSERT:2,CQN_OPCODE_UPDATE:4,DEFAULT:0,STMT_TYPE_UNKNOWN:0,STMT_TYPE_SELECT:1,STMT_TYPE_UPDATE:2,STMT_TYPE_DELETE:3,STMT_TYPE_INSERT:4,STMT_TYPE_CREATE:5,STMT_TYPE_DROP:6,STMT_TYPE_ALTER:7,STMT_TYPE_BEGIN:8,STMT_TYPE_DECLARE:9,STMT_TYPE_CALL:10,STMT_TYPE_EXPLAIN_PLAN:15,STMT_TYPE_MERGE:16,STMT_TYPE_ROLLBACK:17,STMT_TYPE_COMMIT:21,SHUTDOWN_MODE_DEFAULT:0,SHUTDOWN_MODE_TRANSACTIONAL:1,SHUTDOWN_MODE_TRANSACTIONAL_LOCAL:2,SHUTDOWN_MODE_IMMEDIATE:3,SHUTDOWN_MODE_ABORT:4,SHUTDOWN_MODE_FINAL:5,STARTUP_MODE_DEFAULT:0,STARTUP_MODE_FORCE:1,STARTUP_MODE_RESTRICT:2,SUBSCR_EVENT_TYPE_SHUTDOWN:2,SUBSCR_EVENT_TYPE_SHUTDOWN_ANY:3,SUBSCR_EVENT_TYPE_STARTUP:1,SUBSCR_EVENT_TYPE_DEREG:5,SUBSCR_EVENT_TYPE_OBJ_CHANGE:6,SUBSCR_EVENT_TYPE_QUERY_CHANGE:7,SUBSCR_EVENT_TYPE_AQ:100,SUBSCR_GROUPING_CLASS_TIME:1,SUBSCR_GROUPING_TYPE_SUMMARY:1,SUBSCR_GROUPING_TYPE_LAST:2,SUBSCR_NAMESPACE_AQ:1,SUBSCR_NAMESPACE_DBCHANGE:2,SUBSCR_QOS_BEST_EFFORT:16,SUBSCR_QOS_DEREG_NFY:2,SUBSCR_QOS_QUERY:8,SUBSCR_QOS_RELIABLE:1,SUBSCR_QOS_ROWIDS:4,SYSASM:32768,SYSBACKUP:131072,SYSDBA:2,SYSDG:262144,SYSKM:524288,SYSOPER:4,SYSPRELIM:8,SYSRAC:1048576,BIND_IN:3001,BIND_INOUT:3002,BIND_OUT:3003,OUT_FORMAT_ARRAY:4001,OUT_FORMAT_OBJECT:4002,SODA_COLL_MAP_MODE:5001,POOL_STATUS_OPEN:6e3,POOL_STATUS_DRAINING:6001,POOL_STATUS_CLOSED:6002,POOL_STATUS_RECONFIGURING:6003,PURITY_DEFAULT:0,PURITY_NEW:1,PURITY_SELF:2,AQ_DEQ_NO_WAIT:0,AQ_DEQ_WAIT_FOREVER:4294967295,AQ_DEQ_MODE_BROWSE:1,AQ_DEQ_MODE_LOCKED:2,AQ_DEQ_MODE_REMOVE:3,AQ_DEQ_MODE_REMOVE_NO_DATA:4,AQ_DEQ_NAV_FIRST_MSG:1,AQ_DEQ_NAV_NEXT_TRANSACTION:2,AQ_DEQ_NAV_NEXT_MSG:3,AQ_MSG_DELIV_MODE_PERSISTENT:1,AQ_MSG_DELIV_MODE_BUFFERED:2,AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED:3,AQ_MSG_STATE_READY:0,AQ_MSG_STATE_WAITING:1,AQ_MSG_STATE_PROCESSED:2,AQ_MSG_STATE_EXPIRED:3,AQ_VISIBILITY_IMMEDIATE:1,AQ_VISIBILITY_ON_COMMIT:2,TPC_BEGIN_JOIN:2,TPC_BEGIN_NEW:1,TPC_BEGIN_PROMOTE:8,TPC_BEGIN_RESUME:4,TPC_END_NORMAL:0,TPC_END_SUSPEND:1048576,VECTOR_FORMAT_FLOAT32:2,VECTOR_FORMAT_FLOAT64:3,VECTOR_FORMAT_INT8:4,VECTOR_FORMAT_BINARY:5}});var lt=P((JL,kE)=>{"use strict";var as=nt(),ir=W(),oP=require("util"),xE=new Map,bE=new Map,Yt=new Map,Xn=class Xn{constructor(e,t,s,r){this.num=e,this.name=t,this.columnTypeName=s,this._bufferSizeFactor=r.bufferSizeFactor||0,this._oraTypeNum=r.oraTypeNum||0,this._csfrm=r.csfrm||0,xE.set(e,this);let n=(r.csfrm||0)*256+r.oraTypeNum;bE.set(n,this),Yt.set(s,this)}[Symbol.toPrimitive](e){switch(e){case"number":return this.num;default:return this.toString()}}[oP.inspect.custom](){return this.toString()}toString(){return`[DbType ${this.name}]`}};c(Xn,"DbType");var _e=Xn;function aP(i){let e=Yt.get(i);return e||ir.throwErr(ir.ERR_UNKNOWN_COLUMN_TYPE_NAME,i),e}c(aP,"getTypeByColumnTypeName");function _P(i){let e=xE.get(i);return e||ir.throwErr(ir.ERR_INVALID_TYPE_NUM,i),e}c(_P,"getTypeByNum");function cP(i,e){let t=(e||0)*256+i,s=bE.get(t);return s||ir.throwErr(ir.ERR_INVALID_ORACLE_TYPE_NUM,i,e),s}c(cP,"getTypeByOraTypeNum");var kn=new _e(2020,"DB_TYPE_BFILE","BFILE",{oraTypeNum:114,bufferSizeFactor:4e3}),Ei=new _e(2008,"DB_TYPE_BINARY_DOUBLE","BINARY_DOUBLE",{oraTypeNum:101,bufferSizeFactor:8}),ui=new _e(2007,"DB_TYPE_BINARY_FLOAT","BINARY_FLOAT",{oraTypeNum:100,bufferSizeFactor:4}),Br=new _e(2009,"DB_TYPE_BINARY_INTEGER","BINARY_INTEGER",{oraTypeNum:3,bufferSizeFactor:22}),hi=new _e(2019,"DB_TYPE_BLOB","BLOB",{oraTypeNum:113,bufferSizeFactor:112}),Ni=new _e(2022,"DB_TYPE_BOOLEAN","BOOLEAN",{oraTypeNum:252,bufferSizeFactor:4}),er=new _e(2003,"DB_TYPE_CHAR","CHAR",{oraTypeNum:96,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:4}),tr=new _e(2017,"DB_TYPE_CLOB","CLOB",{oraTypeNum:112,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:112}),qn=new _e(2021,"DB_TYPE_CURSOR","CURSOR",{oraTypeNum:102,bufferSizeFactor:4}),Si=new _e(2011,"DB_TYPE_DATE","DATE",{oraTypeNum:12,bufferSizeFactor:7}),Gn=new _e(2015,"DB_TYPE_INTERVAL_DS","INTERVAL DAY TO SECOND",{oraTypeNum:183,bufferSizeFactor:11}),Hn=new _e(2016,"DB_TYPE_INTERVAL_YM","INTERVAL YEAR TO MONTH",{oraTypeNum:182}),Ai=new _e(2027,"DB_TYPE_JSON","JSON",{oraTypeNum:119}),Ut=new _e(2024,"DB_TYPE_LONG","LONG",{oraTypeNum:8,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:2**31-1}),ps=new _e(2031,"DB_TYPE_LONG_NVARCHAR","LONG",{oraTypeNum:8,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:2**31-1}),fs=new _e(2025,"DB_TYPE_LONG_RAW","LONG RAW",{oraTypeNum:24,bufferSizeFactor:2**31-1}),ms=new _e(2004,"DB_TYPE_NCHAR","NCHAR",{oraTypeNum:96,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:4}),di=new _e(2018,"DB_TYPE_NCLOB","NCLOB",{oraTypeNum:112,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:112}),os=new _e(2010,"DB_TYPE_NUMBER","NUMBER",{oraTypeNum:2,bufferSizeFactor:22}),ns=new _e(2002,"DB_TYPE_NVARCHAR","NVARCHAR2",{oraTypeNum:1,csfrm:as.CSFRM_NCHAR,bufferSizeFactor:4}),vn=new _e(2023,"DB_TYPE_OBJECT","OBJECT",{oraTypeNum:109}),sr=new _e(2006,"DB_TYPE_RAW","RAW",{oraTypeNum:23,bufferSizeFactor:1}),rr=new _e(2005,"DB_TYPE_ROWID","ROWID",{oraTypeNum:11,bufferSizeFactor:18}),pi=new _e(2012,"DB_TYPE_TIMESTAMP","TIMESTAMP",{oraTypeNum:180,bufferSizeFactor:11}),zt=new _e(2014,"DB_TYPE_TIMESTAMP_LTZ","TIMESTAMP WITH LOCAL TIME ZONE",{oraTypeNum:231,bufferSizeFactor:11}),Ps=new _e(2013,"DB_TYPE_TIMESTAMP_TZ","TIMESTAMP WITH TIME ZONE",{oraTypeNum:181,bufferSizeFactor:13}),fi=new _e(2030,"DB_TYPE_UROWID","UROWID",{oraTypeNum:208}),ue=new _e(2001,"DB_TYPE_VARCHAR","VARCHAR2",{oraTypeNum:1,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:4}),Kn=new _e(2032,"DB_TYPE_XMLTYPE","XMLTYPE",{oraTypeNum:109,csfrm:as.CSFRM_IMPLICIT,bufferSizeFactor:2147483647}),mi=new _e(2033,"DB_TYPE_VECTOR","VECTOR",{oraTypeNum:127}),TP=new Map([[Ei,new Map([[ue,ue]])],[ui,new Map([[ue,ue]])],[hi,new Map([[sr,fs],[fs,fs]])],[er,new Map([[ue,ue]])],[tr,new Map([[ue,Ut],[Ut,Ut]])],[Si,new Map([[ue,ue],[zt,zt]])],[Ai,new Map([[ue,ue]])],[Ut,new Map([[ue,Ut]])],[fs,new Map([[sr,fs]])],[ms,new Map([[er,ms],[ue,ns],[ns,ns]])],[di,new Map([[ue,ps],[ns,ps],[Ut,ps],[ps,ps]])],[os,new Map([[ue,ue]])],[ns,new Map([[er,ms],[ms,ms],[ue,ns]])],[sr,new Map([[ue,ue]])],[rr,new Map([[ue,rr]])],[pi,new Map([[ue,ue],[zt,zt]])],[zt,new Map([[ue,ue],[Ps,Ps]])],[Ps,new Map([[ue,ue],[zt,zt]])],[fi,new Map([[ue,rr]])],[mi,new Map([[ue,Ut],[Ut,Ut],[tr,tr]])]]),lP=new Map([[kn,kn],[Ei,Ei],[ui,ui],[Br,Br],[hi,hi],[Ni,Ni],[er,er],[tr,tr],[qn,qn],[Si,Si],[Gn,Gn],[Hn,Hn],[Ai,Ai],[Ut,Ut],[ps,ps],[fs,fs],[ms,ms],[di,di],[os,os],[ns,ns],[vn,vn],[sr,sr],[rr,rr],[pi,pi],[zt,Ps],[Ps,Ps],[fi,fi],[ue,ue],[Kn,Kn],[mi,mi]]);Yt.set("DOUBLE PRECISION",os);Yt.set("FLOAT",os);Yt.set("INTEGER",os);Yt.set("PL/SQL BOOLEAN",Ni);Yt.set("PL/SQL BINARY INTEGER",Br);Yt.set("PL/SQL PLS INTEGER",Br);Yt.set("REAL",os);Yt.set("SMALLINT",os);Yt.set("TIMESTAMP WITH LOCAL TZ",zt);Yt.set("TIMESTAMP WITH TZ",Ps);var zn=class zn extends Uint8Array{toJSON(){return Buffer.from(this.buffer).toString("hex")}};c(zn,"JsonId");var Wn=zn;kE.exports={DbType:_e,DB_TYPE_BFILE:kn,DB_TYPE_BINARY_DOUBLE:Ei,DB_TYPE_BINARY_FLOAT:ui,DB_TYPE_BINARY_INTEGER:Br,DB_TYPE_BLOB:hi,DB_TYPE_BOOLEAN:Ni,DB_TYPE_CHAR:er,DB_TYPE_CLOB:tr,DB_TYPE_CURSOR:qn,DB_TYPE_DATE:Si,DB_TYPE_INTERVAL_DS:Gn,DB_TYPE_INTERVAL_YM:Hn,DB_TYPE_JSON:Ai,DB_TYPE_LONG:Ut,DB_TYPE_LONG_NVARCHAR:ps,DB_TYPE_LONG_RAW:fs,DB_TYPE_NCHAR:ms,DB_TYPE_NCLOB:di,DB_TYPE_NUMBER:os,DB_TYPE_NVARCHAR:ns,DB_TYPE_OBJECT:vn,DB_TYPE_RAW:sr,DB_TYPE_ROWID:rr,DB_TYPE_TIMESTAMP:pi,DB_TYPE_TIMESTAMP_LTZ:zt,DB_TYPE_TIMESTAMP_TZ:Ps,DB_TYPE_UROWID:fi,DB_TYPE_VARCHAR:ue,DB_TYPE_VECTOR:mi,DB_TYPE_CONVERSION_MAP:TP,DB_TYPE_FETCH_TYPE_MAP:lP,DB_TYPE_XMLTYPE:Kn,getTypeByColumnTypeName:aP,getTypeByNum:_P,getTypeByOraTypeNum:cP,JsonId:Wn}});var qE=P((ZL,EP)=>{EP.exports={name:"oracledb",version:"6.6.0",description:"A Node.js module for Oracle Database access from JavaScript and TypeScript",license:"(Apache-2.0 OR UPL-1.0)",homepage:"http://oracle.github.io/node-oracledb/",keywords:["Oracle","Database","official","DB","SQL","JSON","PL/SQL","SODA","OCI","API","client","library","driver","add-on","extension","binding","interface","adapter","module"],repository:{type:"git",url:"git://github.com/oracle/node-oracledb.git"},scripts:{install:"node package/install.js",prune:"node package/prunebinaries.js"},engines:{node:">=14.6"},maintainers:[{name:"Oracle Corp."}],bugs:{url:"https://github.com/oracle/node-oracledb/issues"},main:"./index.js"}});var et=P((eB,XE)=>{"use strict";var{Buffer:cs}=require("buffer"),ke=W(),Rt=require("process"),uP=require("util"),hP=lt(),_s=nt(),GE;try{GE=qE()}catch{ke.throwErr(ke.ERR_MISSING_FILE,"package.json")}var HE=GE.version,NP="build/Release",SP="oracledb-"+HE+"-"+Rt.platform+"-"+Rt.arch+".node",AP="oracledb.node",dP="package/Staging";function vE(){return"Node-oracledb installation instructions: https://node-oracledb.readthedocs.io/en/latest/user_guide/installation.html"}c(vE,"getInstallURL");function pP(){let i,e,t=vE()+`
`;return Rt.platform==="linux"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html
`,i="64-bit"):Rt.arch==="x32"?(e=`https://www.oracle.com/database/technologies/instant-client/linux-x86-32-downloads.html
`,i="32-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,i=Rt.arch),t+="You must have Linux "+i+` Oracle Client libraries configured with ldconfig, or in LD_LIBRARY_PATH.
`,t+=`If you do not have Oracle Database on this computer, then install the Instant Client Basic or Basic Light package from 
`,t+=e):Rt.platform==="darwin"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/macos-intel-x86-downloads.html
`,i="64-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,i=Rt.arch),t+="You must have macOS "+i+` Oracle Instant Client Basic or Basic Light package libraries in
`,t+=`/usr/local/lib or set by calling oracledb.initOracleClient({libDir: "/my/instant_client_directory"}).
`,t+="Oracle Instant Client can be downloaded from "+e):Rt.platform==="win32"?(Rt.arch==="x64"?(e=`https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html
`,i="64-bit"):Rt.arch==="x32"?(e=`https://www.oracle.com/database/technologies/instant-client/microsoft-windows-32-downloads.html
`,i="32-bit"):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,i=Rt.arch),t+="You must have Windows "+i+` Oracle Client libraries in your PATH environment variable.
`,t+=`If you do not have Oracle Database on this computer, then install the Instant Client Basic or Basic Light package from
`,t+=e,t+=`A Microsoft Visual Studio Redistributable suitable for your Oracle client library version must be available.
`):(e=`https://www.oracle.com/database/technologies/instant-client.html
`,t+="You must have "+Rt.arch+` Oracle Client libraries in your operating system library search path.
`,t+=`If you do not have Oracle Database on this computer, then install an Instant Client Basic or Basic Light package from: 
`,t+=e),t}c(pP,"getInstallHelp");function $n(i){let e=c(function(){if(typeof arguments[arguments.length-1]!="function")return i.apply(this,arguments).catch(c(function r(n){throw ke.transformErr(n,r)},"stackCapture"));let t=Array.prototype.slice.call(arguments,0,arguments.length-1),s=arguments[arguments.length-1];i.apply(this,t).then(function(r){s(null,r)},c(function r(n){s(ke.transformErr(n,r))},"stackCapture"))},"wrapper");return i.name&&Object.defineProperty(e,"name",{value:i.name}),e}c($n,"callbackify");function jn(i){return async function(){let e;this._impl&&(e=this._impl._getConnImpl(),await e._acquireLock());try{return await i.apply(this,arguments)}finally{e&&e._releaseLock()}}}c(jn,"serialize");function KE(i,e){return async function(){this._isActive&&ke.throwErr(e),this._isActive=!0;try{return await i.apply(this,arguments)}finally{this._isActive=!1}}}c(KE,"preventConcurrent");function fP(i){let e=1,t;typeof arguments[1]=="number"&&(e=2,t=arguments[1]);for(let s=e;s<arguments.length;s++){let r=arguments[s],n=i[r];t?i[r]=$n(KE(jn(n),t)):i[r]=$n(jn(n))}}c(fP,"wrapFns");function mP(i){if(!Array.isArray(i))return!1;for(let e=0;e<i.length;e++)if(typeof i[e]!="string")return!1;return!0}c(mP,"isArrayOfStrings");function Qn(i){return i!==null&&typeof i=="object"}c(Qn,"isObject");function PP(i){return i!==null&&typeof i=="object"||Array.isArray(i)}c(PP,"isObjectOrArray");function RP(i){return i&_s.SYSPRELIM&&(i=i^_s.SYSPRELIM),i===_s.SYSASM||i===_s.SYSBACKUP||i===_s.SYSDBA||i===_s.SYSDG||i===_s.SYSKM||i===_s.SYSOPER||i===_s.SYSRAC}c(RP,"isPrivilege");function IP(i){if(!Array.isArray(i))return!1;for(let e=0;e<i.length;e++){let t=i[e];if(!(typeof t=="string"||typeof t=="number"||cs.isBuffer(t)||uP.types.isDate(t)))return!1}return!0}c(IP,"isShardingKey");function WE(i){return i!=null&&i._sodaDocumentMarker}c(WE,"isSodaDocument");function DP(i){return Qn(i)&&Number.isInteger(i.formatId)&&(cs.isBuffer(i.globalTransactionId)||typeof i.globalTransactionId=="string")&&(cs.isBuffer(i.branchQualifier)||typeof i.branchQualifier=="string")}c(DP,"isXid");function CP(i){let e;return cs.isBuffer(i.globalTransactionId)&&cs.isBuffer(i.branchQualifier)?e=i:(e={formatId:i.formatId,globalTransactionId:i.globalTransactionId,branchQualifier:i.branchQualifier},typeof i.globalTransactionId=="string"&&(e.globalTransactionId=cs.from(i.globalTransactionId)),typeof i.branchQualifier=="string"&&(e.branchQualifier=cs.from(i.branchQualifier))),e.globalTransactionId.length>64&&ke.throwErr(ke.ERR_INVALID_TRANSACTION_SIZE,e.globalTransactionId.length),e.branchQualifier.length>64&&ke.throwErr(ke.ERR_INVALID_BRANCH_SIZE,e.branchQualifier.length),e}c(CP,"normalizeXid");function OP(i){return WE(i)?i._impl:(ke.assertParamValue(Qn(i),1),cs.from(JSON.stringify(i)))}c(OP,"verifySodaDoc");function Jn(i){ke.assert(typeof i=="string",ke.ERR_TOKEN_BASED_AUTH),i.split(".")[1]===void 0&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH);let t=i.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=cs.from(t,"base64").toString("ascii"),n=JSON.parse(r).exp;return ke.assert(n!=null,ke.ERR_TOKEN_BASED_AUTH),n=n*1e3,new Date().getTime()>n}c(Jn,"isTokenExpired");function gP(i){switch(typeof i){case"string":return i===""&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH),!Jn(i);case"object":return(i.token===void 0||i.token===""||i.privateKey===void 0||i.privateKey==="")&&ke.throwErr(ke.ERR_TOKEN_BASED_AUTH),!Jn(i.token);default:ke.throwErr(ke.ERR_TOKEN_BASED_AUTH)}}c(gP,"isTokenValid");function yP(i){return i=i.replace(/\n/g,""),i=i.replace("-----BEGIN PRIVATE KEY-----",""),i=i.replace("-----END PRIVATE KEY-----",""),i}c(yP,"denormalizePrivateKey");function LP(i,e){let t=e+"Class",s=e+"Name",r=i[t],n=i[e];typeof n=="number"&&(n=i[e]=hP.getTypeByNum(n)),r?i[s]=r.prototype.fqn:n&&(i[s]=n.columnTypeName)}c(LP,"addTypeProperties");function BP(i){return i instanceof Float32Array||i instanceof Float64Array||i instanceof Int8Array||Object.getPrototypeOf(i)===Uint8Array.prototype}c(BP,"isVectorValue");function wP(i,e,t,s,r,n,a,_,T){return i?new Date(e,t-1,s,r,n,a,_):new Date(Date.UTC(e,t-1,s,r,n,a,_)-T*6e4)}c(wP,"makeDate");XE.exports={BINARY_FILE:SP,BUILD_FILE:AP,PACKAGE_JSON_VERSION:HE,RELEASE_DIR:NP,STAGING_DIR:dP,addTypeProperties:LP,callbackify:$n,denormalizePrivateKey:yP,getInstallURL:vE,getInstallHelp:pP,isArrayOfStrings:mP,isObject:Qn,isObjectOrArray:PP,isPrivilege:RP,isShardingKey:IP,isSodaDocument:WE,isTokenExpired:Jn,isTokenValid:gP,isVectorValue:BP,isXid:DP,normalizeXid:CP,makeDate:wP,preventConcurrent:KE,serialize:jn,verifySodaDoc:OP,wrapFns:fP}});var Ur=P((sB,zE)=>{"use strict";var wr=nt();zE.exports={TNS_VECTOR_MAGIC_BYTE:219,TNS_VECTOR_VERSION_BASE:0,TNS_VECTOR_VERSION_WITH_BINARY:1,TNS_VECTOR_FLAG_NORMSRC:16,TNS_VECTOR_FLAG_NORM:2,TNS_JSON_MAGIC_BYTE_1:255,TNS_JSON_MAGIC_BYTE_2:74,TNS_JSON_MAGIC_BYTE_3:90,TNS_JSON_VERSION_MAX_FNAME_255:1,TNS_JSON_VERSION_MAX_FNAME_65535:3,TNS_JSON_FLAG_HASH_ID_UINT8:256,TNS_JSON_FLAG_HASH_ID_UINT16:512,TNS_JSON_FLAG_NUM_FNAMES_UINT16:1024,TNS_JSON_FLAG_FNAMES_SEG_UINT32:2048,TNS_JSON_FLAG_TINY_NODES_STAT:8192,TNS_JSON_FLAG_TREE_SEG_UINT32:4096,TNS_JSON_FLAG_REL_OFFSET_MODE:1,TNS_JSON_FLAG_INLINE_LEAF:2,TNS_JSON_FLAG_LEN_IN_PCODE:4,TNS_JSON_FLAG_NUM_FNAMES_UINT32:8,TNS_JSON_FLAG_IS_SCALAR:16,TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16:256,TNS_JSON_TYPE_NULL:48,TNS_JSON_TYPE_TRUE:49,TNS_JSON_TYPE_FALSE:50,TNS_JSON_TYPE_STRING_LENGTH_UINT8:51,TNS_JSON_TYPE_NUMBER_LENGTH_UINT8:52,TNS_JSON_TYPE_BINARY_DOUBLE:54,TNS_JSON_TYPE_STRING_LENGTH_UINT16:55,TNS_JSON_TYPE_STRING_LENGTH_UINT32:56,TNS_JSON_TYPE_TIMESTAMP:57,TNS_JSON_TYPE_BINARY_LENGTH_UINT16:58,TNS_JSON_TYPE_BINARY_LENGTH_UINT32:59,TNS_JSON_TYPE_DATE:60,TNS_JSON_TYPE_INTERVAL_YM:61,TNS_JSON_TYPE_INTERVAL_DS:62,TNS_JSON_TYPE_TIMESTAMP_TZ:124,TNS_JSON_TYPE_TIMESTAMP7:125,TNS_JSON_TYPE_BINARY_FLOAT:127,TNS_JSON_TYPE_OBJECT:132,TNS_JSON_TYPE_ARRAY:192,TNS_JSON_TYPE_EXTENDED:123,TNS_JSON_TYPE_VECTOR:1,TNS_JSON_TYPE_ID:126,TZ_HOUR_OFFSET:20,TZ_MINUTE_OFFSET:60,TNS_MAX_SHORT_LENGTH:252,TNS_DURATION_MID:2147483648,TNS_DURATION_OFFSET:60,TNS_CHUNK_SIZE:32767,TNS_HAS_REGION_ID:128,NUMBER_MAX_DIGITS:40,BUFFER_CHUNK_SIZE:65536,CSFRM_IMPLICIT:wr.CSFRM_IMPLICIT,VECTOR_FORMAT_FLOAT32:wr.VECTOR_FORMAT_FLOAT32,VECTOR_FORMAT_FLOAT64:wr.VECTOR_FORMAT_FLOAT64,VECTOR_FORMAT_INT8:wr.VECTOR_FORMAT_INT8,VECTOR_FORMAT_BINARY:wr.VECTOR_FORMAT_BINARY,TNS_NULL_LENGTH_INDICATOR:255,TNS_LONG_LENGTH_INDICATOR:254}});var nr=P((rB,jE)=>{"use strict";var{Buffer:$t}=require("buffer"),Mt=Ur(),It=W(),$E=lt(),UP=et(),eo=class eo{constructor(e){typeof e=="number"?(this.buf=$t.alloc(e),this.size=0,this.maxSize=e):e&&(this.buf=e,this.size=this.maxSize=e.length),this.pos=0}_grow(e){It.throwErr(It.ERR_BUFFER_LENGTH_INSUFFICIENT,this.numBytesLeft(),e)}_readBytesWithLength(e){return this.readBytes(e)}_readInteger(e,t,s){let r=!1,n=this.readUInt8();if(n===0)return 0;if(n&128&&(t||It.throwErr(It.ERR_UNEXPECTED_NEGATIVE_INTEGER,this.pos,this.packetNum),r=!0,n=n&127),n>e&&It.throwErr(It.ERR_INTEGER_TOO_LARGE,n,e,this.pos,this.packetNum),s)this.skipBytes(n);else{let _=this.readBytes(n).readUIntBE(0,n);return r?-_:_}}numBytesLeft(){return this.size-this.pos}parseBinaryDouble(e){return e=$t.from(e),e[0]&128?e[0]&=127:(e[0]^=255,e[1]^=255,e[2]^=255,e[3]^=255,e[4]^=255,e[5]^=255,e[6]^=255,e[7]^=255),e.readDoubleBE()}parseBinaryFloat(e){return e=$t.from(e),e[0]&128?e[0]&=127:(e[0]^=255,e[1]^=255,e[2]^=255,e[3]^=255),e.readFloatBE()}parseOracleDate(e,t=!0){let s=0;e.length>=11&&(s=Math.floor(e.readUInt32BE(7)/(1e3*1e3)));let r=(e[0]-100)*100+e[1]-100;return UP.makeDate(t,r,e[2],e[3],e[4]-1,e[5]-1,e[6]-1,s,0)}parseOracleNumber(e){let t=e[0],s=!!(t&128);s||(t=t^255),t-=193;let r=t*2+2;if(e.length===1)return s?"0":"-1e126";let n=e.length;!s&&e[e.length-1]===102&&(n-=1);let a,_=[];for(let l=1;l<n;l++){s?a=e[l]-1:a=101-e[l];let E=Math.floor(a/10);E===0&&l===1?r-=1:E===10?(_.push("1"),_.push("0"),r+=1):(E!==0||l>1)&&_.push(E.toString()),E=a%10,(E!==0||l<n-1)&&_.push(E.toString())}let T=[];s||T.push("-"),r<=0&&(T.push("."),r<0&&T.push("0".repeat(-r)));for(let l=0;l<_.length;l++)l>0&&l===r&&T.push("."),T.push(_[l]);if(r>_.length)for(let l=_.length;l<r;l++)T.push("0");return T.join("")}readBinaryDouble(){let e=this.readBytesWithLength();return e?this.parseBinaryDouble(e):null}readBinaryFloat(){let e=this.readBytesWithLength();return e?this.parseBinaryFloat(e):null}readBinaryInteger(){let e=this.readBytesWithLength();return e?(e.length>4&&It.throwErr(It.ERR_INTEGER_TOO_LARGE,e.length,4,this.pos,this.packetNum),e.readIntBE(0,e.length)):0}readBool(){let e=this.readBytesWithLength();return e?e[e.length-1]===1:null}readBytes(e){let t=this.numBytesLeft();e>t&&It.throwErr(It.ERR_UNEXPECTED_END_OF_DATA,e,t);let s=this.buf.subarray(this.pos,this.pos+e);return this.pos+=e,s}readBytesWithLength(){let e=this.readUInt8();return e===0||e===Mt.TNS_NULL_LENGTH_INDICATOR?null:this._readBytesWithLength(e)}readDbObject(){let e={},t=this.readUB4();return t>0&&(e.toid=$t.from(this.readBytesWithLength())),t=this.readUB4(),t>0&&(e.oid=$t.from(this.readBytesWithLength())),t=this.readUB4(),t>0&&(e.snapshot=$t.from(this.readBytesWithLength())),this.skipUB2(),t=this.readUB4(),this.skipUB2(),t>0&&(e.packedData=$t.from(this.readBytesWithLength())),e}readInt8(){return this.readBytes(1).readInt8()}readOracleDate(e){let t=this.readBytesWithLength();return t?this.parseOracleDate(t,e):null}readOracleNumber(){let e=this.readBytesWithLength();return e?this.parseOracleNumber(e):null}readSB2(){return this._readInteger(2,!0,!1)}readSB4(){return this._readInteger(4,!0,!1)}readSB8(){return this._readInteger(8,!0,!1)}readStr(e){let t=this.readBytesWithLength();return t?e===Mt.CSFRM_IMPLICIT?t.toString():$t.from(t).swap16().toString("utf16le"):null}readUB2(){return this._readInteger(2,!1,!1)}readUB4(){return this._readInteger(4,!1,!1)}readUB8(){return this._readInteger(8,!1,!1)}readUInt8(){return this.readBytes(1)[0]}readUInt16BE(){return this.readBytes(2).readUInt16BE()}readUInt16LE(){return this.readBytes(2).readUInt16LE()}readUInt32BE(){return this.readBytes(4).readUInt32BE()}reserveBytes(e){e>this.numBytesLeft()&&this._grow(this.pos+e);let t=this.pos;return this.pos+=e,t}skipBytes(e){e>this.numBytesLeft()&&It.throwErr(It.ERR_UNEXPECTED_END_OF_DATA),this.pos+=e}skipSB4(){return this._readInteger(4,!0,!0)}skipUB1(){this.skipBytes(1)}skipUB2(){return this._readInteger(2,!1,!0)}skipUB4(){return this._readInteger(4,!1,!0)}skipUB8(){return this._readInteger(8,!1,!0)}writeBinaryDouble(e,t){t||(t=this.reserveBytes(8)),this.buf.writeDoubleBE(e,t),this.buf[t]&128?(this.buf[t]^=255,this.buf[t+1]^=255,this.buf[t+2]^=255,this.buf[t+3]^=255,this.buf[t+4]^=255,this.buf[t+5]^=255,this.buf[t+6]^=255,this.buf[t+7]^=255):this.buf[t]|=128}writeBinaryFloat(e,t){t||(t=this.reserveBytes(4)),this.buf.writeFloatBE(e,t),this.buf[t]&128?(this.buf[t]^=255,this.buf[t+1]^=255,this.buf[t+2]^=255,this.buf[t+3]^=255):this.buf[t]|=128}writeBytes(e){let t=0,s=e.length;for(;s>0;){let r=this.numBytesLeft();r===0&&this._grow(this.pos+s);let n=Math.min(r,s);e.copy(this.buf,this.pos,t,t+n),this.pos+=n,t+=n,s-=n}}_writeRawBytesAndLength(e,t){if(t<=Mt.TNS_MAX_SHORT_LENGTH)this.writeUInt8(t),t>0&&this.writeBytes(e);else{let s=0;for(this.writeUInt8(Mt.TNS_LONG_LENGTH_INDICATOR);t>0;){let r=Math.min(t,Mt.BUFFER_CHUNK_SIZE);this.writeUB4(r),this.writeBytes(e.subarray(s,s+r)),t-=r,s+=r}this.writeUB4(0)}}writeBytesWithLength(e){let t=e.length;this._writeRawBytesAndLength(e,t)}writeDbObject(e){this.writeUB4(e.toid.length),this.writeBytesWithLength(e.toid),e.oid?(this.writeUB4(e.oid.length),this.writeBytesWithLength(e.oid)):this.writeUB4(0),this.writeUB4(0),this.writeUB4(0);let t=e._getPackedData();this.writeUB4(t.length),this.writeUB4(e.flags),this.writeBytesWithLength(t)}writeOracleDate(e,t,s=!0){let r,n=t._bufferSizeFactor;n>7&&(r=e.getUTCMilliseconds()*1e3*1e3,r===0&&n<=11&&(n=7)),s&&this.writeUInt8(n);let a=this.reserveBytes(n);if(t===$E.DB_TYPE_DATE||t==$E.DB_TYPE_TIMESTAMP){let _=e.getFullYear();this.buf[a]=Math.trunc(_/100)+100,this.buf[a+1]=_%100+100,this.buf[a+2]=e.getMonth()+1,this.buf[a+3]=e.getDate(),this.buf[a+4]=e.getHours()+1,this.buf[a+5]=e.getMinutes()+1,this.buf[a+6]=e.getSeconds()+1}else{let _=e.getUTCFullYear();this.buf[a]=Math.trunc(_/100)+100,this.buf[a+1]=_%100+100,this.buf[a+2]=e.getUTCMonth()+1,this.buf[a+3]=e.getUTCDate(),this.buf[a+4]=e.getUTCHours()+1,this.buf[a+5]=e.getUTCMinutes()+1,this.buf[a+6]=e.getUTCSeconds()+1}n>7&&(this.buf.writeInt32BE(r,a+7),n>11&&(this.buf[a+11]=Mt.TZ_HOUR_OFFSET,this.buf[a+12]=Mt.TZ_MINUTE_OFFSET))}writeOracleNumber(e){let t=!1;e[0]==="-"&&(t=!0,e=e.substring(1));let s=0,r=e.indexOf("e");r>0&&(s=Number(e.substring(r+1)),e=e.substring(0,r));let n=e.indexOf(".");if(n>0&&(s-=e.length-n-1,e=e.substring(0,n)+e.substring(n+1)),e[0]==="0"&&(e=e.replace(/^0+/,"")),e.length>0&&e[e.length-1]==="0"){let E=e.replace(/0+$/,"");s+=e.length-E.length,e=E}(e.length>Mt.NUMBER_MAX_DIGITS||s>=126||s<=-131)&&It.throwErr(It.ERR_ORACLE_NUMBER_NO_REPR),(s>0&&s%2===1||s<0&&s%2===-1)&&(s--,e+="0"),e.length%2===1&&(e="0"+e);let a=t&&e.length<Mt.NUMBER_MAX_DIGITS,_=e.length/2,T=(s+e.length)/2+192;t?T=T^255:e.length===0&&s===0&&(T=128);let l=this.reserveBytes(_+2+a);this.buf[l++]=_+1+a,this.buf[l++]=T;for(let E=0;E<e.length;E+=2){let h=Number(e.substring(E,E+2));t?this.buf[l++]=101-h:this.buf[l++]=h+1}a&&(this.buf[l]=102)}writeStr(e){this.writeBytes($t.from(e))}writeInt32BE(e){let t=this.reserveBytes(4);this.buf.writeInt32BE(e,t)}writeUB4(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):e<=65535?(this.writeUInt8(2),this.writeUInt16BE(e)):(this.writeUInt8(4),this.writeUInt32BE(e))}writeUB2(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):(this.writeUInt8(2),this.writeUInt16BE(e))}writeUB8(e){e===0?this.writeUInt8(0):e<=255?(this.writeUInt8(1),this.writeUInt8(e)):e<=65535?(this.writeUInt8(2),this.writeUInt16BE(e)):e<=4294967295?(this.writeUInt8(4),this.writeUInt32BE(e)):(this.writeUInt8(8),this.writeUInt64BE(e))}writeUInt8(e){let t=this.reserveBytes(1);this.buf[t]=e}writeSB1(e){let t=this.reserveBytes(1);this.buf[t]=e}writeUInt16BE(e){let t=this.reserveBytes(2);this.buf.writeUInt16BE(e,t)}writeUInt32BE(e){let t=this.reserveBytes(4);this.buf.writeUInt32BE(e,t)}writeUInt64BE(e){let t=this.reserveBytes(8);this.buf.writeUInt32BE(0,t),this.buf.writeUInt32BE(e,t+4)}writeUInt16LE(e){let t=this.reserveBytes(2);this.buf.writeUInt16LE(e,t)}};c(eo,"BaseBuffer");var Pi=eo,to=class to extends Pi{constructor(e){e?super(e):(super(Mt.BUFFER_CHUNK_SIZE),this.size=this.maxSize)}_grow(e){let t=e%Mt.BUFFER_CHUNK_SIZE;t>0&&(e+=Mt.BUFFER_CHUNK_SIZE-t);let s=$t.allocUnsafe(e);this.buf.copy(s),this.buf=s,this.maxSize=this.size=e}};c(to,"GrowableBuffer");var Zn=to;jE.exports={BaseBuffer:Pi,GrowableBuffer:Zn}});var Ri=P((nB,JE)=>{"use strict";var{BaseBuffer:YP,GrowableBuffer:MP}=nr(),{Buffer:VP}=require("buffer"),$e=Ur(),or=W(),io=class io extends YP{decode(){let e=this.readUInt8();e!=$e.TNS_VECTOR_MAGIC_BYTE&&or.throwErr(or.ERR_UNEXPECTED_DATA,VP.from([e]).toString("hex"));let t=this.readUInt8();t>$e.TNS_VECTOR_VERSION_WITH_BINARY&&or.throwErr(or.ERR_VECTOR_VERSION_NOT_SUPPORTED,t);let s=this.readUInt16BE(),r=this.readUInt8(),n=this.readUInt32BE(),a,_;r===$e.VECTOR_FORMAT_FLOAT32?(a=4,_=new Float32Array(n)):r===$e.VECTOR_FORMAT_FLOAT64?(a=8,_=new Float64Array(n)):r===$e.VECTOR_FORMAT_INT8?(a=1,_=new Int8Array(n)):r===$e.VECTOR_FORMAT_BINARY?(a=1,n=n/8,_=new Uint8Array(n)):or.throwErr(or.ERR_VECTOR_FORMAT_NOT_SUPPORTED,r),(r===$e.VECTOR_FORMAT_BINARY||s&$e.TNS_VECTOR_FLAG_NORM)&&this.skipBytes(8);for(let T=0;T<n;T++){let l=this.readBytes(a);r===$e.VECTOR_FORMAT_FLOAT32?_[T]=this.parseBinaryFloat(l):r===$e.VECTOR_FORMAT_FLOAT64?_[T]=this.parseBinaryDouble(l):_[T]=l[0]}return _}};c(io,"VectorDecoder");var so=io,no=class no extends MP{encode(e){let t=$e.VECTOR_FORMAT_FLOAT32,s=this.writeBinaryFloat.bind(this),r=e.length,n=$e.TNS_VECTOR_VERSION_BASE,a=$e.TNS_VECTOR_FLAG_NORMSRC|$e.TNS_VECTOR_FLAG_NORM;return Array.isArray(e)||e instanceof Float64Array?(t=$e.VECTOR_FORMAT_FLOAT64,s=this.writeBinaryDouble.bind(this)):e instanceof Int8Array?(t=$e.VECTOR_FORMAT_INT8,s=this.writeSB1.bind(this)):e.constructor.name==="Uint8Array"&&(t=$e.VECTOR_FORMAT_BINARY,r=r*8,n=$e.TNS_VECTOR_VERSION_WITH_BINARY,a=$e.TNS_VECTOR_FLAG_NORMSRC,s=this.writeUInt8.bind(this)),this.writeUInt8($e.TNS_VECTOR_MAGIC_BYTE),this.writeUInt8(n),this.writeUInt16BE(a),this.writeUInt8(t),this.writeUInt32BE(r),this.reserveBytes(8),e.forEach(_=>{s(_)}),this.buf.subarray(0,this.pos)}};c(no,"VectorEncoder");var ro=no;JE.exports={VectorDecoder:so,VectorEncoder:ro}});var Vt=P((aB,ZE)=>{"use strict";var FP=nt(),Ii=W(),ne=lt(),xP=et(),QE=Ri(),ao=class ao{constructor(){this.autoCommit=!1,this.connectionClass="",this.dbObjectAsPojo=!1,this.edition="",this.errorOnConcurrentExecute=!1,this.events=!1,this.externalAuth=!1,this.fetchArraySize=100,this.fetchAsBuffer=[],this.fetchAsString=[],this.lobPrefetchSize=16384,this.maxRows=0,this.outFormat=FP.OUT_FORMAT_ARRAY,this.poolIncrement=1,this.poolMax=4,this.poolMaxPerShard=0,this.poolMin=0,this.poolPingInterval=60,this.poolPingTimeout=5e3,this.poolTimeout=60,this.prefetchRows=2,this.queueTimeout=6e4,this.queueMax=500,this.stmtCacheSize=30,this.thin=!0,this.thinDriverInitialized=!1,this.createFetchTypeMap(this.fetchAsString,this.fetchAsBuffer),this.fetchTypeHandler=void 0,this._JsonId=ne.JsonId}_getDateComponents(e,t){return e?[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()*1e3*1e3]:[t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()*1e3*1e3]}_makeDate(e,t,s,r,n,a,_,T,l){return xP.makeDate(e,t,s,r,n,a,_,T,l)}_decodeVector(e){return new QE.VectorDecoder(e).decode()}_encodeVector(e){return new QE.VectorEncoder().encode(e)}addToOptions(e){for(let t=1;t<arguments.length;t++){let s=arguments[t];e[s]===void 0&&(e[s]=this[s])}}createFetchTypeMap(e,t){let s=new Map(ne.DB_TYPE_FETCH_TYPE_MAP);for(let r of e)switch(r){case ne.DB_TYPE_NUMBER:s.set(ne.DB_TYPE_BINARY_DOUBLE,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_BINARY_FLOAT,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_BINARY_INTEGER,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_NUMBER,ne.DB_TYPE_VARCHAR);break;case ne.DB_TYPE_TIMESTAMP:s.set(ne.DB_TYPE_DATE,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_TIMESTAMP,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_TIMESTAMP_TZ,ne.DB_TYPE_VARCHAR),s.set(ne.DB_TYPE_TIMESTAMP_LTZ,ne.DB_TYPE_VARCHAR);break;case ne.DB_TYPE_CLOB:case ne.DB_TYPE_NCLOB:s.set(ne.DB_TYPE_CLOB,ne.DB_TYPE_LONG),s.set(ne.DB_TYPE_NCLOB,ne.DB_TYPE_LONG_NVARCHAR);break;case ne.DB_TYPE_VECTOR:s.set(ne.DB_TYPE_VECTOR,ne.DB_TYPE_LONG);break;case ne.DB_TYPE_RAW:s.set(ne.DB_TYPE_RAW,ne.DB_TYPE_VARCHAR);break;case ne.DB_TYPE_JSON:s.set(ne.DB_TYPE_JSON,ne.DB_TYPE_VARCHAR);break;default:Ii.throwErr(Ii.ERR_INVALID_TYPE_FOR_CONVERSION)}for(let r of t)switch(r){case ne.DB_TYPE_BLOB:s.set(ne.DB_TYPE_BLOB,ne.DB_TYPE_LONG_RAW);break;default:Ii.throwErr(Ii.ERR_INVALID_TYPE_FOR_CONVERSION)}this.fetchTypeMap=s}};c(ao,"Settings");var oo=ao;ZE.exports=new oo});var W=P((cB,RN)=>{"use strict";var bP=require("util"),eu="NJS",kP=[1,1400,1438,2290,2291,2292,21525,40479],tu=2,_o=3,co=4,To=5,lo=7,Eo=9,su=10,ru=11,iu=12,nu=13,ou=15,au=16,_u=17,cu=18,Tu=19,lu=21,Eu=22,uu=23,hu=24,Nu=34,Su=35,Au=36,du=37,pu=40,fu=41,mu=42,Pu=43,Ru=44,Iu=45,Du=46,Cu=47,Ou=52,gu=55,yu=56,Lu=57,Bu=58,wu=59,Uu=60,Yu=61,Mu=62,Vu=63,Fu=64,xu=65,bu=66,ku=67,uo=68,qu=69,Gu=70,Hu=75,vu=76,Ku=78,Wu=80,Xu=81,zu=82,$u=83,ju=84,Ju=85,Qu=86,ho=87,No=89,Zu=90,eh=91,th=92,So=95,sh=97,rh=98,ih=99,nh=100,oh=101,ah=102,_h=103,ch=104,Ao=105,Th=106,po=107,lh=109,Eh=110,uh=111,hh=112,Nh=113,Sh=114,fo=115,Ah=116,dh=118,ph=119,fh=120,mh=121,Ph=122,mo=123,Rh=125,Ih=126,Dh=127,Ch=128,Po=129,Oh=130,Ro=131,Io=132,Do=133,gh=134,yh=135,Lh=136,Bh=137,wh=138,Uh=139,Yh=140,Mh=141,Vh=142,Fh=143,xh=144,bh=145,kh=146,qh=147,Gh=149,Hh=150,vh=151,Kh=152,Wh=153,Xh=154,zh=155,$h=156,ar=500,jh=501,Jh=503,Qh=504,Zh=505,eN=506,tN=507,sN=508,rN=509,iN=510,nN=511,oN=512,aN=513,_N=514,cN=515,TN=516,lN=517,EN=518,uN=519,hN=520,NN=521,SN=522,AN=523,dN=524,pN=525,fN=526,mN=527,PN=528,Co=700,ot=new Map;ot.set("DPI-1010",_o);ot.set("DPI-1024",[Io,"at index ([0-9]+) does"]);ot.set("DPI-1044",fo);ot.set("DPI-1055",Ao);ot.set("DPI-1063",So);ot.set("DPI-1067",[mo,"call timeout of ([0-9]+) ms"]);ot.set("DPI-1080",ar);ot.set("OCI-22303",[Po,'type "([^"]*"."[^"]*)"']);ot.set("OCI-22164",Do);ot.set("OCI-22165",[Ro,/index \[([0-9]+)\] must be in the range of \[([0-9]+)\] to \[([0-9]+)\]/]);ot.set("ORA-00028",ar);ot.set("ORA-00600",ar);ot.set("ORA-24338",po);ot.set("ORA-25708",ho);ot.set("ORA-24344",Co);var I=new Map;I.set(tu,"invalid pool");I.set(_o,"invalid or closed connection");I.set(co,'invalid value for property "%s"');I.set(To,"invalid value for parameter %d");I.set(lo,'invalid value for "%s" in parameter %d');I.set(Eo,"invalid number of parameters");I.set(su,"unsupported data type %d in column %d");I.set(ru,"encountered bind value and type mismatch");I.set(iu,"encountered invalid bind data type in parameter %d");I.set(nu,"invalid bind direction");I.set(ou,"type was not specified for conversion");I.set(au,"buffer is too small for OUT binds");I.set(_u,"concurrent operations on ResultSet are not allowed");I.set(cu,"invalid ResultSet");I.set(Tu,"ResultSet cannot be returned for non-query statements");I.set(lu,"invalid type for conversion specified");I.set(Eu,"invalid Lob");I.set(uu,"concurrent operations on a Lob are not allowed");I.set(hu,"memory allocation failed");I.set(Nu,"data type is unsupported for array bind");I.set(Su,"maxArraySize is required for IN OUT array bind");I.set(Au,'length of given array is greater than "maxArraySize"');I.set(du,'invalid data type at array index %d for bind ":%s"');I.set(pu,'connection request timeout. Request exceeded "queueTimeout" of %d');I.set(fu,"cannot convert ResultSet to QueryStream after invoking methods");I.set(mu,"cannot invoke ResultSet methods after converting to QueryStream");I.set(Pu,"ResultSet already converted to QueryStream");I.set(Ru,'bind object must contain one of the following attributes: "dir", "type", "maxSize", or "val"');I.set(Iu,"cannot load a node-oracledb Thick mode binary for Node.js. Please try using Thin mode. %s");I.set(Du,'pool alias "%s" already exists in the connection pool cache');I.set(Cu,'pool alias "%s" not found in connection pool cache');I.set(Ou,"invalid data type at array index %d for bind position %d");I.set(gu,"binding by position and name cannot be mixed");I.set(yu,"maxSize for bind position %d must be specified and be greater than zero");I.set(Lu,'maxSize for bind "%s" must be specified and greater than zero');I.set(Bu,"maxSize of %d is too small for value of length %d in row %d");I.set(wu,"type must be specified for bind position %d");I.set(Uu,'type must be specified for bind "%s"');I.set(Yu,"invalid subscription");I.set(Mu,"subscription notification callback missing");I.set(Vu,"subscription notification SQL missing");I.set(Fu,"connection pool is closing");I.set(xu,"connection pool was closed");I.set(bu,"invalid SODA document cursor");I.set(ku,"a pre-built node-oracledb Thick mode binary was not found for %s");I.set(uo,"invalid error number %d supplied");I.set(qu,"node-oracledb %s requires Node.js %s or later");I.set(Gu,"message must be a string, buffer, database object or an object containing a payload property which itself is a string, buffer or database object");I.set(Hu,'only one of "connectString" and "connectionString" can be used');I.set(vu,'connection request rejected. Pool queue length "queueMax" %d reached');I.set(Ku,"unsupported data type %d in JSON value");I.set(Wu,'only one of "user" and "username" can be used');I.set(Xu,"concurrent operations on a connection are disabled");I.set(zu,"connection pool is being reconfigured");I.set($u,"pool statistics are not enabled");I.set(ju,"invalid access token");I.set(Ju,'invalid connection pool configuration with token-based authentication. The "homogeneous" and "externalAuth" attributes must be set to true');I.set(Qu,'invalid standalone configuration with token-based authentication. The "externalAuth" attribute must be set to true');I.set(ho,"access token has expired");I.set(No,"%s is not supported by node-oracledb in Thin mode");I.set(Zu,"initOracleClient() was already called with different arguments");I.set(eh,"file %s is missing");I.set(th,'"poolMax" %d must be greater than or equal to "poolMin" %d');I.set(So,'setting "batchErrors" or "dmlRowCounts" to true is only permitted for DML statements');I.set(sh,'no bind placeholder named ":%s" was found in the statement text');I.set(rh,"%s positional bind values are required but %s were provided");I.set(ih,"internal error: buffer of length %s insufficient to hold %s bytes");I.set(nh,"national character set id %d is not supported by node-oracledb in Thin mode");I.set(oh,"no credentials specified");I.set(ah,"unexpected end of data: want %d bytes but only %d bytes are available");I.set(_h,"unexpected message type %d received at position %d of packet %d");I.set(ch,"connection pool cannot be closed because connections are busy");I.set(Ao,"value is not a number (NaN) and cannot be used in Oracle Database numbers");I.set(Th,"internal error: %s");I.set(po,"invalid cursor");I.set(lh,"invalid type number %d");I.set(Eh,"invalid Oracle type number %d [csfrm: %d]");I.set(uh,"internal error: read a negative integer when expecting a positive integer at position %d of packet %d");I.set(hh,"internal error: read integer of length %d when expecting integer of no more than length %d at position %d of packet %d");I.set(Nh,"unexpected data received: %s");I.set(Sh,"OSON field names may not exceed %d UTF-8 encoded bytes");I.set(fo,"value cannot be represented as an Oracle Database number");I.set(Ah,"password verifier type 0x%s is not supported by node-oracledb in Thin mode");I.set(dh,"node-oracledb Thick mode cannot be enabled because a Thin mode connection has already been created");I.set(ph,"conversion from type %s to type %s is not supported");I.set(fh,"fetchTypeHandler return value must be an object");I.set(mh,'fetchTypeHandler return value attribute "type" must be a valid database type');I.set(Ph,'fetchTypeHandler return value attribute "converter" must be a function');I.set(mo,"call timeout of %d ms exceeded");I.set(Rh,'"connectString" cannot be empty or undefined. Bequeath connections are not supported in Thin mode');I.set(Ih,"OSON version %s is not supported");I.set(Dh,"internal error: unknown server side piggyback opcode %s");I.set(Ch,'internal error: unknown column type name "%s"');I.set(Po,'invalid object type name: "%s"');I.set(Oh,"Oracle TDS data type %d is not supported");I.set(Ro,"given index %d must be in the range of %d to %d");I.set(Io,"element at index %d does not exist");I.set(Do,"cannot delete elements of a VARRAY");I.set(gh,"value is of wrong type for attribute %s of object %s");I.set(yh,"value is of wrong type for an element of object %s");I.set(Lh,"user name and password cannot be set when using external authentication");I.set(Bh,'a bind variable replacement value for placeholder ":%s" was not provided');I.set(wh,"connections to this database server version are not supported by node-oracledb in Thin mode");I.set(Uh,"unexpected XML type with flag %d");I.set(Yh,"user name must be enclosed in [] when using external authentication with a proxy user");I.set(Mh,"the number of batch errors from executemany() exceeds 65535");I.set(Vh,"value too large for attribute %s of object %s (actual: %d, maximum: %d)");I.set(Fh,"value too large for element %d of object %s (actual: %d, maximum: %d)");I.set(xh,"VECTOR format %d is not supported");I.set(bh,"VECTOR version %d is not supported");I.set(kh,"object %s is not a collection");I.set(qh,"cursor has been closed by the database");I.set(Gh,'the bind variable placeholder "%s" cannot be used both before and after the RETURNING clause in a DML RETURNING statement');I.set(Hh,"invalid flags for tpcBegin() in Two Phase Commit");I.set(vh,"invalid flags for tpcEnd() in Two Phase Commit");I.set(Kh,"internal error: unknown transaction state {state} in Two Phase Commit");I.set(Wh,"size of the transaction ID is %d and cannot exceed 64");I.set(Xh,"size of the branch ID is %d and cannot exceed 64");I.set(zh,"operation is not supported on BFILE LOBs");I.set($h,"operation is only supported on BFILE LOBs");I.set(ar,"connection to the Oracle Database was broken");I.set(jh,`connection to host %s port %d terminated unexpectedly. (CONNECTION_ID=%s)
%s`);I.set(Jh,`connection to host %s port %d could not be established. (CONNECTION_ID=%s)
%s`);I.set(Qh,`connection establishment through a web proxy at host %s port %d failed. (CONNECTION_ID=%s)
%s`);I.set(Zh,"unable to initiate TLS connection. Please check if wallet credentials are valid");I.set(eN,`connection to host %s port %d encountered TLS handshake failure. (CONNECTION_ID=%s)
%s`);I.set(tN,"TLS detected an invalid certificate. Server DN in certificate does not match the specified DN");I.set(sN,"TLS detected an invalid certificate. %s not present in certificate");I.set(rN,"internal error: invalid packet type or malformed packet received");I.set(iN,'connection to host %s port %d timed out. Request exceeded "%s" of %d seconds. (CONNECTION_ID=%s)');I.set(nN,`connection to listener at host %s port %d was refused. (CONNECTION_ID=%s)
Cause: %s`);I.set(oN,`invalid connection string parameters.
%s`);I.set(aN,"error received through in-band notification: %s");I.set(_N,"syntax error in connection string");I.set(cN,"error in Easy Connect connection string: %s: %s");I.set(TN,"no configuration directory set or available to search for tnsnames.ora");I.set(lN,'cannot connect to Oracle Database. Unable to find "%s" in "%s"');I.set(EN,'cannot connect to Oracle Database. Service "%s" is not registered with the listener at host %s port %s. (CONNECTION_ID=%s)');I.set(uN,'cannot connect to Oracle Database. SID "%s" is not registered with the listener at host %s port %s. (CONNECTION_ID=%s)');I.set(hN,"cannot connect to Oracle Database. File tnsnames.ora not found in %s");I.set(NN,"connection to host %s port %d received end-of-file on communication channel. (CONNECTION_ID=%s)");I.set(SN,"Azure Authentication Failed: The authentication parameter value %s may be incorrect");I.set(AN,`Failed to retrieve configuration from Centralized Configuration Provider:
 %s`);I.set(dN,"Configuration Provider not supported: %s");I.set(pN,`Centralized Config Provider failed to load required libraries. Please install the required libraries.
 %s`);I.set(fN,"OCI authentication failed: The authentication parameter value %s may be incorrect");I.set(mN,"Azure Vault: Provide correct azure vault authentication details");I.set(PN,"Azure service principal authentication requires either a client certificate path or a client secret string");I.set(Co,"creation succeeded with compilation errors");function Yr(i){if(!i){let e=Array.prototype.slice.call(arguments,1);Oo(...e)}}c(Yr,"assert");function qP(i,e,t){Yr(i.length>=e&&i.length<=t,Eo)}c(qP,"assertArgCount");function GP(i,e,t){i[t]!==void 0&&Vs(typeof i[t]=="boolean",e,t)}c(GP,"assertParamPropBool");function HP(i,e,t){i[t]!==void 0&&Vs(typeof i[t]=="function",e,t)}c(HP,"assertParamPropFunction");function vP(i,e,t){i[t]!==void 0&&Vs(Number.isInteger(i[t]),e,t)}c(vP,"assertParamPropInt");function KP(i,e,t){i[t]!==void 0&&Vs(Number.isInteger(i[t])&&i[t]>=0,e,t)}c(KP,"assertParamPropUnsignedInt");function WP(i,e,t){i[t]!==void 0&&Vs(Number.isInteger(i[t])&&i[t]>0,e,t)}c(WP,"assertParamPropUnsignedIntNonZero");function XP(i,e,t){i[t]!==void 0&&Vs(typeof i[t]=="string",e,t)}c(XP,"assertParamPropString");function Vs(i,e,t){Yr(i,lo,t,e)}c(Vs,"assertParamPropValue");function zP(i,e){Yr(i,To,e)}c(zP,"assertParamValue");function $P(i,e){Yr(i,co,e)}c($P,"assertPropValue");function Di(i){let e=I.get(i),t=[...arguments];e||(t=[void 0,i],i=uo,e=I.get(i));let s=i.toString().padStart(3,"0"),r=`${eu}-${s}`;t[0]=`${r}: ${e}`;let n=new Error(bP.format(...t));return n.code=r,Error.captureStackTrace(n,Di),n}c(Di,"getErr");function Oo(){throw Di(...arguments)}c(Oo,"throwErr");function jP(i){Oo(No,i)}c(jP,"throwNotImplemented");function JP(i,e){if(!i.code){let t=i.message.indexOf(":");if(t>0){i.code=i.message.substr(0,t);let s=Vt();if(i.errorNum&&s.thin&&(i.message+=`
Help: https://docs.oracle.com/error-help/db/ora-${i.errorNum.toString().padStart(5,"0")}/`),ot.has(i.code)){let r=[],n,a=ot.get(i.code);if(typeof a=="number")n=a;else{n=a[0];let T=a[1],l=i.message.match(T);l&&(r=l.slice(1))}let _=Di(n,...r);i.code=_.code,i.message=_.message+`
`+i.message}}}return i.requiresStackCapture&&(delete i.requiresStackCapture,Error.captureStackTrace(i,e)),i}c(JP,"transformErr");RN.exports={ERR_INTEGRITY_ERROR_CODES:kP,ERR_INVALID_POOL:tu,ERR_INVALID_CONNECTION:_o,ERR_INVALID_PROPERTY_VALUE:co,ERR_INVALID_PARAMETER_VALUE:To,ERR_INVALID_PROPERTY_VALUE_IN_PARAM:lo,ERR_INVALID_NUMBER_OF_PARAMETERS:Eo,ERR_UNSUPPORTED_DATA_TYPE:su,ERR_BIND_VALUE_AND_TYPE_MISMATCH:ru,ERR_INVALID_BIND_DATA_TYPE:iu,ERR_INVALID_BIND_DIRECTION:nu,ERR_NO_TYPE_FOR_CONVERSION:ou,ERR_INSUFFICIENT_BUFFER_FOR_BINDS:au,ERR_BUSY_RS:_u,ERR_INVALID_RS:cu,ERR_NOT_A_QUERY:Tu,ERR_INVALID_TYPE_FOR_CONVERSION:lu,ERR_INVALID_LOB:Eu,ERR_BUSY_LOB:uu,ERR_INSUFFICIENT_MEMORY:hu,ERR_INVALID_TYPE_FOR_ARRAY_BIND:Nu,ERR_REQUIRED_MAX_ARRAY_SIZE:Su,ERR_INVALID_ARRAY_SIZE:Au,ERR_INCOMPATIBLE_TYPE_ARRAY_BIND:du,ERR_CONN_REQUEST_TIMEOUT:pu,ERR_CANNOT_CONVERT_RS_TO_STREAM:fu,ERR_CANNOT_INVOKE_RS_METHODS:mu,ERR_RS_ALREADY_CONVERTED:Pu,ERR_INVALID_BIND_UNIT:Ru,ERR_CANNOT_LOAD_BINARY:Iu,ERR_POOL_WITH_ALIAS_ALREADY_EXISTS:Du,ERR_POOL_WITH_ALIAS_NOT_FOUND:Cu,ERR_INCOMPATIBLE_TYPE_ARRAY_INDEX_BIND:Ou,ERR_MIXED_BIND:gu,ERR_MISSING_MAX_SIZE_BY_POS:yu,ERR_MISSING_MAX_SIZE_BY_NAME:Lu,ERR_MAX_SIZE_TOO_SMALL:Bu,ERR_MISSING_TYPE_BY_POS:wu,ERR_MISSING_TYPE_BY_NAME:Uu,ERR_INVALID_SUBSCR:Yu,ERR_MISSING_SUBSCR_CALLBACK:Mu,ERR_MISSING_SUBSCR_SQL:Vu,ERR_POOL_CLOSING:Fu,ERR_POOL_CLOSED:xu,ERR_INVALID_SODA_DOC_CURSOR:bu,ERR_NO_BINARY_AVAILABLE:ku,ERR_INVALID_ERR_NUM:uo,ERR_NODE_TOO_OLD:qu,ERR_INVALID_AQ_MESSAGE:Gu,ERR_DBL_CONNECT_STRING:Hu,ERR_QUEUE_MAX_EXCEEDED:vu,ERR_UNSUPPORTED_DATA_TYPE_IN_JSON:Ku,ERR_DBL_USER:Wu,ERR_CONCURRENT_OPS:Xu,ERR_POOL_RECONFIGURING:zu,ERR_POOL_STATISTICS_DISABLED:$u,ERR_TOKEN_BASED_AUTH:ju,ERR_POOL_TOKEN_BASED_AUTH:Ju,ERR_CONN_TOKEN_BASED_AUTH:Qu,ERR_TOKEN_HAS_EXPIRED:ho,ERR_NOT_IMPLEMENTED:No,ERR_INIT_ORACLE_CLIENT_ARGS:Zu,ERR_MISSING_FILE:eh,ERR_INVALID_NUMBER_OF_CONNECTIONS:th,ERR_EXEC_MODE_ONLY_FOR_DML:So,ERR_CONNECTION_CLOSED:ar,ERR_CONNECTION_LOSTCONTACT:jh,ERR_CONNECTION_INCOMPLETE:Jh,ERR_PROXY_CONNECTION_FAILURE:Qh,ERR_TLS_INIT_FAILURE:Zh,ERR_TLS_AUTH_FAILURE:eN,ERR_TLS_DNMATCH_FAILURE:tN,ERR_TLS_HOSTMATCH_FAILURE:sN,ERR_INVALID_PACKET:rN,ERR_CONNECTION_TIMEDOUT:iN,ERR_CONNECTION_REFUSED:nN,ERR_INVALID_CONNECT_STRING_PARAMETERS:oN,ERR_CONNECTION_INBAND:aN,ERR_INVALID_CONNECT_STRING_SYNTAX:_N,ERR_INVALID_EZCONNECT_SYNTAX:cN,ERR_NO_CONFIG_DIR:TN,ERR_TNS_ENTRY_NOT_FOUND:lN,ERR_CONNECTION_EOF:NN,ERR_AZURE_CONFIG_PROVIDER_AUTH_FAILED:SN,ERR_OCIOBJECT_CONFIG_PROVIDER_AUTH_FAILED:fN,ERR_AZURE_VAULT_AUTH_FAILED:mN,ERR_AZURE_SERVICE_PRINCIPAL_AUTH_FAILED:PN,ERR_CONFIG_PROVIDER_FAILED_TO_RETRIEVE_CONFIG:AN,ERR_CONFIG_PROVIDER_NOT_SUPPORTED:dN,ERR_CONFIG_PROVIDER_LOAD_FAILED:pN,ERR_INVALID_BIND_NAME:sh,ERR_WRONG_NUMBER_OF_POSITIONAL_BINDS:rh,ERR_BUFFER_LENGTH_INSUFFICIENT:ih,ERR_NCHAR_CS_NOT_SUPPORTED:nh,ERR_MISSING_CREDENTIALS:oh,ERR_UNEXPECTED_END_OF_DATA:ah,ERR_UNEXPECTED_MESSAGE_TYPE:_h,ERR_POOL_HAS_BUSY_CONNECTIONS:ch,ERR_INTERNAL:Th,ERR_INVALID_REF_CURSOR:po,ERR_UNSUPPORTED_VERIFIER_TYPE:Ah,ERR_NAN_VALUE:Ao,ERR_ORACLE_NUMBER_NO_REPR:fo,ERR_INVALID_SERVICE_NAME:EN,ERR_INVALID_SID:uN,ERR_TNS_NAMES_FILE_MISSING:hN,ERR_INVALID_TYPE_NUM:lh,ERR_INVALID_ORACLE_TYPE_NUM:Eh,ERR_UNEXPECTED_NEGATIVE_INTEGER:uh,ERR_INTEGER_TOO_LARGE:hh,ERR_UNEXPECTED_DATA:Nh,ERR_OSON_FIELD_NAME_LIMITATION:Sh,ERR_OSON_VERSION_NOT_SUPPORTED:Ih,ERR_THIN_CONNECTION_ALREADY_CREATED:dh,ERR_UNSUPPORTED_CONVERSION:ph,ERR_FETCH_TYPE_HANDLER_RETURN_VALUE:fh,ERR_FETCH_TYPE_HANDLER_TYPE:mh,ERR_FETCH_TYPE_HANDLER_CONVERTER:Ph,ERR_CALL_TIMEOUT_EXCEEDED:mo,ERR_EMPTY_CONNECT_STRING:Rh,ERR_UNKOWN_SERVER_SIDE_PIGGYBACK:Dh,ERR_UNKNOWN_COLUMN_TYPE_NAME:Ch,ERR_INVALID_OBJECT_TYPE_NAME:Po,ERR_TDS_TYPE_NOT_SUPPORTED:Oh,ERR_INVALID_COLL_INDEX_SET:Ro,ERR_INVALID_COLL_INDEX_GET:Io,ERR_DELETE_ELEMENTS_OF_VARRAY:Do,ERR_WRONG_VALUE_FOR_DBOBJECT_ATTR:gh,ERR_WRONG_VALUE_FOR_DBOBJECT_ELEM:yh,ERR_WRONG_CRED_FOR_EXTAUTH:Lh,ERR_MISSING_BIND_VALUE:Bh,ERR_SERVER_VERSION_NOT_SUPPORTED:wh,ERR_UNEXPECTED_XML_TYPE:Uh,ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY:Yh,ERR_TOO_MANY_BATCH_ERRORS:Mh,ERR_WRONG_LENGTH_FOR_DBOBJECT_ATTR:Vh,ERR_WRONG_LENGTH_FOR_DBOBJECT_ELEM:Fh,ERR_VECTOR_FORMAT_NOT_SUPPORTED:xh,ERR_VECTOR_VERSION_NOT_SUPPORTED:bh,ERR_OBJECT_IS_NOT_A_COLLECTION:kh,ERR_CURSOR_HAS_BEEN_CLOSED:qh,ERR_DML_RETURNING_DUP_BINDS:Gh,ERR_INVALID_TPC_BEGIN_FLAGS:Hh,ERR_INVALID_TPC_END_FLAGS:vh,ERR_UNKNOWN_TRANSACTION_STATE:Kh,ERR_INVALID_TRANSACTION_SIZE:Wh,ERR_INVALID_BRANCH_SIZE:Xh,ERR_CONNECTION_CLOSED_CODE:`${eu}-${ar}`,ERR_OPERATION_NOT_SUPPORTED_ON_BFILE:zh,ERR_OPERATION_ONLY_SUPPORTED_ON_BFILE:$h,WRN_COMPILATION_CREATE:Co,assert:Yr,assertArgCount:qP,assertParamPropBool:GP,assertParamPropFunction:HP,assertParamPropInt:vP,assertParamPropString:XP,assertParamPropUnsignedInt:KP,assertParamPropUnsignedIntNonZero:WP,assertParamPropValue:Vs,assertParamValue:zP,assertPropValue:$P,getErr:Di,throwErr:Oo,throwNotImplemented:jP,transformErr:JP}});var Ci=P((lB,IN)=>{"use strict";var yo=class yo{constructor(e){let t=new URLSearchParams(e);this.paramMap=new URLSearchParams([...t].map(([s,r])=>[s.toLowerCase(),r]))}modifyOptionsPrecedence(e,t){return t={...t},t.user||(t.user=e.user),t.password||(t.password=e.password),e.connectString&&(t.connectString=e.connectString,t.connectionString=void 0),e.poolMin&&(t.poolMin=e.poolMin),e.poolMax&&(t.poolMax=e.poolMax),e.poolIncrement&&(t.poolIncrement=e.poolIncrement),e.poolTimeout&&(t.poolTimeout=e.poolTimeout),e.poolPingInterval&&(t.poolPingInterval=e.poolPingInterval),e.poolPingTimeout&&(t.poolPingTimeout=e.poolPingTimeout),e.stmtCacheSize&&(t.stmtCacheSize=e.stmtCacheSize),e.prefetchRows&&(t.prefetchRows=e.prefetchRows),e.lobPrefetch&&(t.lobPrefetch=e.lobPrefetch),t}_addParam(e,t){let s=e.toLowerCase();this.paramMap.set(s,t)}_parsePwd(e){let t=new RegExp("(?<vault_url>https://[A-Za-z0-9._-]+)/secrets/(?<secretKey>[A-Za-z][A-Za-z0-9-]*)$","g"),s=[];for(let r of e.matchAll(t))s[0]=r.groups.vault_url,s[1]=r.groups.secretKey;return s}};c(yo,"base");var go=yo;IN.exports={base:go}});var LN=P((uB,yN)=>{"use strict";var DN,Lo,Bo,CN,ON,gN,Oi=W(),{base:QP}=Ci(),Uo=class Uo extends QP{constructor(e,t){super(t),this._addParam("appconfigname",e)}init(){({AppConfigurationClient:DN}=require("@azure/app-configuration")),{ClientSecretCredential:Lo,ClientCertificateCredential:Bo,ChainedTokenCredential:CN,ManagedIdentityCredential:ON,EnvironmentCredential:gN}=require("@azure/identity")}_withChainedTokenCredential(){let e=[];return this.paramMap.get("azure_client_secret")&&e.push(new Lo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_secret"))),this.paramMap.get("azure_client_certificate_path")&&e.push(new Bo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_certificate_path"))),this.paramMap.get("azure_managed_identity_client_id")&&e.push(this.paramMap.get("azure_managed_identity_client_id")),e.push(new gN),new CN(...e)}_returnCredential(){let e=null;if(this.paramMap.get("authentication")&&(e=this.paramMap.get("authentication").toUpperCase()),e&&e!="AZURE_DEFAULT")if(e=="AZURE_SERVICE_PRINCIPAL"){if(this.paramMap.get("azure_client_certificate_path"))return new Bo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_certificate_path"));if(this.paramMap.get("azure_client_secret"))return new Lo(this.paramMap.get("azure_tenant_id"),this.paramMap.get("azure_client_id"),this.paramMap.get("azure_client_secret"));Oi.throwErr(Oi.ERR_AZURE_SERVICE_PRINCIPAL_AUTH_FAILED)}else{if(e=="AZURE_MANAGED_IDENTITY")return new ON(this.paramMap.get("azure_managed_identity_client_id"));Oi.throwErr(Oi.ERR_AZURE_CONFIG_PROVIDER_AUTH_FAILED,e)}else return this._withChainedTokenCredential()}async _getConfigurationSetting(e,t,s){return await e.getConfigurationSetting({key:t,label:s})}async returnConfig(){let e={},t=this.paramMap.get("label"),s=this._returnCredential(),r=new DN("https://"+this.paramMap.get("appconfigname"),s);e.connectString=(await this._getConfigurationSetting(r,this.paramMap.get("key")+"connect_descriptor",t)).value;try{let _=(await this._getConfigurationSetting(r,this.paramMap.get("key")+"node-oracledb",t)).value,T=JSON.parse(_);for(let l in T){var n=T[l];e[l]=n}}catch{e["node-oracledb"]=null}try{e.user=(await this._getConfigurationSetting(r,this.paramMap.get("key")+"user",t)).value}catch{e.user=null}let a=null;try{a=await this._getConfigurationSetting(r,this.paramMap.get("key")+"password",t)}catch{e.password=null}if(a){let _;try{_=JSON.parse(a.value)}catch{_=a.value}if(_.uri){let{SecretClient:T}=require("@azure/keyvault-secrets"),l=await this._parsePwd(_.uri),E=new T(l[0],s);e.password=(await E.getSecret(l[1])).value}else e.password=a.value}return e}};c(Uo,"AzureProvider");var wo=Uo;yN.exports=wo});var wN=P((NB,BN)=>{"use strict";var _r=W(),{base:ZP}=Ci(),eR=require("fs"),tR=new RegExp("(?<objservername>[A-Za-z0-9._-]+)/n/(?<namespace>[A-Za-z0-9._-]+)/b/(?<bucketname>[A-Za-z0-9._-]+)/o/(?<filename>[A-Za-z0-9._-]+)(/c/(?<alias>.+))?$"),Rs={},Mo=class Mo extends ZP{constructor(e,t){super(t);let s=e.match(tR);s&&(this._addParam("objservername",s.groups.objservername),this._addParam("namespace",s.groups.namespace),this._addParam("bucketname",s.groups.bucketname),this._addParam("filename",s.groups.filename),s.groups.alias&&this._addParam("alias",s.groups.alias))}init(){Rs.common=require("oci-common"),Rs.objectstorage=require("oci-objectstorage")}async _streamToString(e){let t=[];for await(let s of e)t.push(Buffer.from(s));return Buffer.concat(t).toString("utf-8")}async _returnCredential(){let e=null,t=null;if(this.paramMap.get("authentication")&&(t=this.paramMap.get("authentication").toUpperCase()),t&&t!="OCI_DEFAULT")t=="OCI_INSTANCE_PRINCIPAL"?e=await new Rs.common.InstancePrincipalsAuthenticationDetailsProviderBuilder().build():t=="OCI_RESOURCE_PRINCIPAL"?e=await new Rs.common.ResourcePrincipalAuthenticationDetailsProvider.builder:_r.throwErr(_r.ERR_OCIOBJECT_CONFIG_PROVIDER_AUTH_FAILED,t);else try{e=new Rs.common.ConfigFileAuthenticationDetailsProvider(this.paramMap.get("oci_profile_path"),this.paramMap.get("oci_profile"))}catch(s){if(!this.paramMap.get("oci_tenancy")||!this.paramMap.get("oci_user"))throw s;let r=eR.readFileSync(this.paramMap.get("oci_key_file"),{encoding:"utf8"}),n=this.retrieveRegion(this.paramMap.get("objservername"));e=new Rs.common.SimpleAuthenticationDetailsProvider(this.paramMap.get("oci_tenancy"),this.paramMap.get("oci_user"),this.paramMap.get("oci_fingerprint"),r,void 0,Rs.common.Region[n])}return e}async returnConfig(){let e={},t=await this._returnCredential(),s=new Rs.objectstorage.ObjectStorageClient({authenticationDetailsProvider:t}),r={objectName:this.paramMap.get("filename"),bucketName:this.paramMap.get("bucketname"),namespaceName:this.paramMap.get("namespace")},n,a=await s.getObject(r),_=await this._streamToString(a.value),T=JSON.parse(_),l=this.paramMap.get("alias");l&&(T=T[l]);let h=T["node-oracledb"];for(let A in h){var p=h[A];e[A]=p}if(e.connectString=T.connect_descriptor,e.user=T.user,T.password)if(T.password.type=="vault-azure")if(T.password.authentication){let{SecretClient:A}=require("@azure/keyvault-secrets"),{ClientSecretCredential:u,ClientCertificateCredential:N}=require("@azure/identity");T.password.authentication.azure_client_secret?n=new u(T.password.authentication.azure_tenant_id,T.password.authentication.azure_client_id,T.password.authentication.azure_client_secret):T.password.authentication.azure_client_certificate_path?n=new N(T.password.authentication.azure_tenant_id,T.password.authentication.azure_client_id,T.password.authentication.azure_client_certificate_path):_r.throwErr(_r.ERR_AZURE_VAULT_AUTH_FAILED);let d=await this._parsePwd(T.password.value),S=new A(d[0],n);e.password=(await S.getSecret(d[1])).value}else _r.throwErr(_r.ERR_AZURE_VAULT_AUTH_FAILED);else if(T.password.type=="vault-oci"){let A=require("oci-secrets"),u=new A.SecretsClient({authenticationDetailsProvider:t}),N={secretId:T.password.value},d=await u.getSecretBundle(N);e.password=d.secretBundle.secretBundleContent.content}else T.password&&(e.password=T.password);else e.password=null;return e}retrieveRegion(e){return e.split(".")[1].toUpperCase().replaceAll("-","_")}};c(Mo,"OCIProvider");var Yo=Mo;BN.exports=Yo});var nO,Vo=Jm(()=>{nO=LE({"./configProviders/azure.js":()=>LN(),"./configProviders/base.js":()=>Ci(),"./configProviders/ociobject.js":()=>wN()})});var YN=P((pB,UN)=>{"use strict";var tt=W(),xo=class xo{getCondition(){tt.throwNotImplemented("getting condition (dequeue options)")}getConsumerName(){tt.throwNotImplemented("getting consumer name (dequeue options)")}getCorrelation(){tt.throwNotImplemented("getting correlation (dequeue options)")}getMode(){tt.throwNotImplemented("getting mode (dequeue options)")}getMsgId(){tt.throwNotImplemented("getting message id (dequeue options)")}getNavigation(){tt.throwNotImplemented("getting navigation (dequeue options)")}getTransformation(){tt.throwNotImplemented("getting transformation (dequeue options)")}getVisibility(){tt.throwNotImplemented("getting visibility (dequeue options)")}getWait(){tt.throwNotImplemented("getting wait (dequeue options)")}setCondition(){tt.throwNotImplemented("setting condition (dequeue options)")}setConsumerName(){tt.throwNotImplemented("setting consumer name (dequeue options)")}setCorrelation(){tt.throwNotImplemented("setting correlation (dequeue options)")}setMode(){tt.throwNotImplemented("setting mode (dequeue options)")}setMsgId(){tt.throwNotImplemented("setting message id (dequeue options)")}setNavigation(){tt.throwNotImplemented("setting navigation (dequeue options)")}setTransformation(){tt.throwNotImplemented("setting transformation (dequeue options)")}setVisibility(){tt.throwNotImplemented("setting visibility (dequeue options)")}setWait(){tt.throwNotImplemented("setting wait (dequeue options)")}};c(xo,"AqDeqOptionsImpl");var Fo=xo;UN.exports=Fo});var VN=P((mB,MN)=>{"use strict";var cr=W(),ko=class ko{getDeliveryMode(){cr.throwNotImplemented("getting delivery mode (enqueue options)")}getTransformation(){cr.throwNotImplemented("getting transformation (enqueue options)")}getVisibility(){cr.throwNotImplemented("getting visibility (enqueue options)")}setDeliveryMode(){cr.throwNotImplemented("setting delivery mode (enqueue options)")}setTransformation(){cr.throwNotImplemented("setting transformation (enqueue options)")}setVisibility(){cr.throwNotImplemented("setting visibility (enqueue options)")}};c(ko,"AqEnqOptionsImpl");var bo=ko;MN.exports=bo});var xN=P((RB,FN)=>{"use strict";var kt=W(),Go=class Go{getCorrelation(){kt.throwNotImplemented("getting correlation (message)")}getDelay(){kt.throwNotImplemented("getting delay (message)")}getDeliveryMode(){kt.throwNotImplemented("getting delivery mode (message)")}getExceptionQueue(){kt.throwNotImplemented("getting exception queue (message)")}getExpiration(){kt.throwNotImplemented("getting expiration (message)")}getMsgId(){kt.throwNotImplemented("getting message id (message)")}getNumAttempts(){kt.throwNotImplemented("getting number of attempts (message)")}getOriginalMsgId(){kt.throwNotImplemented("getting original message id (message)")}getPayload(){kt.throwNotImplemented("getting payload (message)")}getPriority(){kt.throwNotImplemented("getting priority (message)")}getState(){kt.throwNotImplemented("getting state (message)")}};c(Go,"AqMessageImpl");var qo=Go;FN.exports=qo});var kN=P((DB,bN)=>{"use strict";var gi=W(),vo=class vo{_getConnImpl(){return this._connection}deqMany(){gi.throwNotImplemented("dequeuing multiple items from a queue")}deqOne(){gi.throwNotImplemented("dequeuing a single item from a queue")}enqMany(){gi.throwNotImplemented("enqueuing multiple items from a queue")}enqOne(){gi.throwNotImplemented("enqueuing a single item from a queue")}};c(vo,"AqQueueImpl");var Ho=vo;bN.exports=Ho});var yi=P((OB,qN)=>{"use strict";var Lt=W(),Wo=class Wo{constructor(e){this._objType=e}append(){Lt.throwNotImplemented("appending element to collection")}copy(){Lt.throwNotImplemented("copying an object")}deleteElement(){Lt.throwNotImplemented("deleting an element from a collection")}getElement(){Lt.throwNotImplemented("getting an element from a collection")}getFirstIndex(){Lt.throwNotImplemented("getting the first index in a collection")}getKeys(){Lt.throwNotImplemented("returning the keys of a collection")}getLastIndex(){Lt.throwNotImplemented("getting the last index in a collection")}getNextIndex(){Lt.throwNotImplemented("getting the next index in a collection")}getPrevIndex(){Lt.throwNotImplemented("getting the previous index in a collection")}getValues(){Lt.throwNotImplemented("getting the values in a collection")}hasElement(){Lt.throwNotImplemented("getting if value exists in a collection")}setElement(){Lt.throwNotImplemented("setting an element in a collection")}trim(){Lt.throwNotImplemented("trimming elements from a collection")}};c(Wo,"DbObjectImpl");var Ko=Wo;qN.exports=Ko});var Li=P((yB,GN)=>{"use strict";var sR=Vt(),j=W(),rR=require("util"),zo=class zo{constructor(){this._inProgress=!1,this._dbObjectTypes=new Map,this._requestQueue=[],this._osonMaxFieldNameSize=255}async _acquireLock(){this._inProgress&&(sR.errorOnConcurrentExecute&&j.throwErr(j.ERR_CONCURRENT_OPS),await new Promise((e,t)=>{let s={resolve:e,reject:t};this._requestQueue.push(s)})),this._inProgress=!0}_getConnImpl(){return this}_getDbObjectType(e,t,s,r){let n;if(r&&(n=this._dbObjectTypes.get(r),n))return n;let a=s?`${e}.${s}.${t}`:`${e}.${t}`;return n=this._dbObjectTypes.get(a),n||(n={oid:r,fqn:a,schema:e,name:t,packageName:s,partial:!0,isXmlType:e==="SYS"&&t==="XMLTYPE"},this._dbObjectTypes.set(a,n)),r&&!n.oid&&(n.oid=r,this._dbObjectTypes.set(r,n)),n}_isDate(e){return rR.types.isDate(e)}_releaseLock(){this._requestQueue.length>0?this._requestQueue.shift().resolve():this._inProgress=!1}breakExecution(){j.throwNotImplemented("getting Oracle Server version number")}changePassword(){j.throwNotImplemented("changing the password")}close(){j.throwNotImplemented("closing the connection")}commit(){j.throwNotImplemented("committing the transaction")}createLob(){j.throwNotImplemented("creating a temporary LOB")}execute(){j.throwNotImplemented("executing a SQL statement")}executeMany(){j.throwNotImplemented("executing a SQL statement multiple times")}getCallTimeout(){j.throwNotImplemented("getting call timeout")}getCurrentSchema(){j.throwNotImplemented("getting current schema")}getDbDomain(){j.throwNotImplemented("getting db domain")}getDbName(){j.throwNotImplemented("getting db name")}getDbObjectClass(){j.throwNotImplemented("getting a database object class")}getExternalName(){j.throwNotImplemented("getting the external name")}getInstanceName(){j.throwNotImplemented("getting the Oracle Database instance name.")}getInternalName(){j.throwNotImplemented("getting the internal name")}getMaxOpenCursors(){j.throwNotImplemented("getting max open cursors")}getOracleServerVersion(){j.throwNotImplemented("getting Oracle Server version number")}getOracleServerVersionString(){j.throwNotImplemented("getting Oracle Server version as a string")}getQueue(){j.throwNotImplemented("getting a queue")}getServiceName(){j.throwNotImplemented("getting service name")}getSodaDatabase(){j.throwNotImplemented("getting a SODA database")}getStatementInfo(){j.throwNotImplemented("getting information about a statement")}getStmtCacheSize(){j.throwNotImplemented("getting the statement cache size")}getTag(){j.throwNotImplemented("getting the tag for the connection")}getTransactionInProgress(){j.throwNotImplemented("getting the status of an active transaction on the connection")}getWarning(){j.throwNotImplemented("getting information about warning")}isHealthy(){j.throwNotImplemented("getting the health of the connection")}ping(){j.throwNotImplemented("sending a ping to the database")}rollback(){j.throwNotImplemented("rolling back a transaction")}setAction(){j.throwNotImplemented("setting end-to-end attribute 'action'")}setCallTimeout(){j.throwNotImplemented("setting call timeout")}setClientId(){j.throwNotImplemented("setting end-to-end attribute 'clientId'")}setClientInfo(){j.throwNotImplemented("setting end-to-end attribute 'clientInfo'")}setCurrentSchema(){j.throwNotImplemented("setting the current schema")}setDbOp(){j.throwNotImplemented("setting end-to-end attribute 'dbOp'")}setECID(){j.throwNotImplemented("setting end-to-end attribute 'ecid'")}setExternalName(){j.throwNotImplemented("setting the external name")}setInternalName(){j.throwNotImplemented("setting the internal name")}setStmtCacheSize(){j.throwNotImplemented("setting the size of the statement cache")}setModule(){j.throwNotImplemented("setting end-to-end attribute 'module'")}setTag(){j.throwNotImplemented("setting the tag for the connection")}shutdown(){j.throwNotImplemented("shutting down the database instance")}startup(){j.throwNotImplemented("starting up the database instance")}subscribe(){j.throwNotImplemented("subscribing to events in the database")}tpcBegin(){j.throwNotImplemented("starting a two-phase transaction")}tpcCommit(){j.throwNotImplemented("committing a two-phase transaction")}tpcEnd(){j.throwNotImplemented("ending a two-phase transaction")}tpcForget(){j.throwNotImplemented("forgetting a two-phase transaction")}tpcPrepare(){j.throwNotImplemented("preparing a two-phase transaction")}tpcRollback(){j.throwNotImplemented("rolling back a two-phase transaction")}unsubscribe(){j.throwNotImplemented("unsubscribing from events")}};c(zo,"ConnectionImpl");var Xo=zo;GN.exports=Xo});var Jo=P((BB,HN)=>{"use strict";var iR=Li(),Fs=W(),jo=class jo{_getConnImpl(){let e=this._parentObj;for(;!(e instanceof iR);)e=e._parentObj;return e}close(){Fs.throwNotImplemented("closing a LOB")}fileExists(){Fs.throwNotImplemented("check if BFILE exists")}getData(){Fs.throwNotImplemented("getting all of the data from a LOB")}getDirFileName(){Fs.throwNotImplemented("getting directory and filename of LOB(BFILE)")}read(){Fs.throwNotImplemented("reading from a LOB")}setDirFileName(){Fs.throwNotImplemented("setting directory and filename of LOB(BFILE)")}write(){Fs.throwNotImplemented("writing to a LOB")}};c(jo,"LobImpl");var $o=jo;HN.exports=$o});var ea=P((UB,KN)=>{"use strict";var st=W(),vN=et(),Zo=class Zo{async _accessTokenHandler(e,t,s,r){let n;try{let a=e(s,r);a instanceof Promise&&(a=await a),vN.isTokenValid(a)||st.throwErr(st.ERR_TOKEN_HAS_EXPIRED),typeof a=="object"&&a.privateKey!==void 0&&(a.privateKey=vN.denormalizePrivateKey(a.privateKey)),n=a}finally{this.returnAccessToken(t,n)}}close(){st.throwNotImplemented("closing the pool")}create(){st.throwNotImplemented("creating the pool")}getConnection(){st.throwNotImplemented("getting a connection from the pool")}getConnectionsInUse(){st.throwNotImplemented("getting num connection in use")}getConnectionsOpen(){st.throwNotImplemented("getting num connection open")}getPoolIncrement(){st.throwNotImplemented("getting the pool increment")}getPoolMax(){st.throwNotImplemented("getting the pool max")}getPoolMaxPerShard(){st.throwNotImplemented("getting the pool max per shard")}getPoolMin(){st.throwNotImplemented("getting the pool min")}getPoolPingInterval(){st.throwNotImplemented("getting the pool ping interval")}getPoolPingTimeout(){st.throwNotImplemented("getting the pool ping Timeout")}getPoolTimeout(){st.throwNotImplemented("getting the pool timeout")}getStmtCacheSize(){st.throwNotImplemented("getting the pool statement cache size")}getSodaMetaDataCache(){st.throwNotImplemented("getting the SODA metadata cache flag")}reconfigure(){st.throwNotImplemented("reconfiguring the pool")}setAccessToken(){st.throwNotImplemented("sets the access token")}};c(Zo,"PoolImpl");var Qo=Zo;KN.exports=Qo});var ra=P((MB,WN)=>{"use strict";var nR=W(),sa=class sa{constructor(){this._featureFlags={},this._featureFlags.oldJsonColumnAsObj=!1}get oldJsonColumnAsObj(){return this._featureFlags.oldJsonColumnAsObj}set oldJsonColumnAsObj(e){nR.assertPropValue(typeof e=="boolean","oldJsonColumnAsObj"),this._featureFlags.oldJsonColumnAsObj=e}};c(sa,"Future");var ta=sa;WN.exports=new ta});var xs=P((FB,zN)=>{"use strict";var{Buffer:ia}=require("buffer"),{Duplex:oR}=require("stream"),XN=nt(),qe=W(),wi=et(),Bi=lt(),na=class na extends oR{constructor(){super({decodeStrings:!1}),this.offset=1,this._isActive=!1,this.once("finish",function(){this._autoCloseLob&&this.destroy()})}_checkIsBfile(){this.type!==Bi.DB_TYPE_BFILE&&qe.throwErr(qe.ERR_OPERATION_ONLY_SUPPORTED_ON_BFILE)}_checkNotBfile(){this.type===Bi.DB_TYPE_BFILE&&qe.throwErr(qe.ERR_OPERATION_NOT_SUPPORTED_ON_BFILE)}async _destroy(e,t){if(e&&e.message.startsWith("NJS-003:")&&delete this._impl,this._impl){let s=this._impl;delete this._impl;try{await s.close()}catch(r){t(r);return}}t(e)}async _read(){try{let e=await this._serializedRead(this.offset);e?(this.offset+=e.length,this.push(e)):(this.push(null),this._autoCloseLob&&this.destroy())}catch(e){throw this._autoCloseLob&&this.destroy(e),e}}async _readData(e){qe.assert(this._impl,qe.ERR_INVALID_LOB);try{return await this._impl.read(e)}catch(t){throw qe.transformErr(t,this._readData)}}_setup(e,t){this._impl=e,this.type!==Bi.DB_TYPE_BFILE&&(this._chunkSize=e.getChunkSize()),this._pieceSize=e.getPieceSize(),this._length=e.getLength(),this._type=e.getType(),typeof this._type=="number"&&(this._type=Bi.getTypeByNum(this._type)),this._autoCloseLob=t}async _write(e,t,s){this.type==XN.DB_TYPE_BLOB&&!ia.isBuffer(e)?e=ia.from(e):this.type==XN.DB_TYPE_CLOB&&ia.isBuffer(e)&&(e=e.toString());try{await this._serializedWrite(this.offset,e)}catch(r){this._autoCloseLob&&this.destroy(r),s(r);return}this.offset+=e.length,s(null)}async _writeData(e,t){qe.assert(this._impl,qe.ERR_INVALID_LOB);try{await this._impl.write(e,t)}catch(s){throw qe.transformErr(s,this._writeData)}}get chunkSize(){return this._checkNotBfile(),this._chunkSize}async close(){if(qe.assertArgCount(arguments,0,0),this._impl){let e=this._impl;delete this._impl;try{await e.close(),this.emit("close")}catch(t){this.destroy(t)}}}async getData(e,t){return qe.assertArgCount(arguments,0,2),e===void 0?e=1:qe.assertParamValue(Number.isInteger(e)&&e>0,1),t===void 0?t=0:qe.assertParamValue(Number.isInteger(t)&&t>0,2),qe.assert(this._impl,qe.ERR_INVALID_LOB),await this._impl.getData(e,t)}getDirFileName(){return this._checkIsBfile(),this._impl.getDirFileName()}setDirFileName(e){this._checkIsBfile(),qe.assertArgCount(arguments,1,1),qe.assertParamValue(wi.isObject(e),1),this._impl.setDirFileName(e)}async fileExists(){return this._checkIsBfile(),await this._impl.fileExists()}get length(){return this._length}get pieceSize(){return this._pieceSize}set pieceSize(e){qe.assertPropValue(Number.isInteger(e)&&e>=0,"pieceSize"),qe.assert(this._impl,qe.ERR_INVALID_LOB),this._impl.setPieceSize(e),this._pieceSize=e}get type(){return this._type}};c(na,"Lob");var Is=na;wi.wrapFns(Is.prototype,qe.ERR_BUSY_LOB,"close","fileExists","getData");Is.prototype._serializedRead=wi.serialize(Is.prototype._readData);Is.prototype._serializedWrite=wi.serialize(Is.prototype._writeData);zN.exports=Is});var Mi=P((bB,jN)=>{"use strict";var{BaseBuffer:aR,GrowableBuffer:Ta}=nr(),{Buffer:Tr}=require("buffer"),K=Ur(),Ds=W(),Ui=lt(),_R=require("util"),$N=Ri(),cR=et(),la=class la extends aR{_decodeContainerNode(e){let t,s,r,n=this.pos-this.treeSegPos-1,a=this._getNumChildren(e),_=(e&64)===0;if(a===void 0){let T=this._getOffset(e);s=this.pos,this.pos=this.treeSegPos+T;let l=this.readUInt8();a=this._getNumChildren(l),t=_?{}:new Array(a),r=this.pos}else _?(t={},r=this.pos,s=this.pos+this.fieldIdLength*a):(t=new Array(a),s=this.pos);for(let T=0;T<a;T++){let l;if(_){let h;this.fieldIdLength===1?h=this.buf[r]:this.fieldIdLength==2?h=this.buf.readUInt16BE(r):h=this.buf.readUInt32BE(r),l=this.fieldNames[h-1],r+=this.fieldIdLength}this.pos=s;let E=this._getOffset(e);this.relativeOffsets&&(E+=n),s=this.pos,this.pos=this.treeSegPos+E,_?t[l]=this._decodeNode():t[T]=this._decodeNode()}return t}_decodeNode(){let e=this.readUInt8();if(e&128)return this._decodeContainerNode(e);if(e===K.TNS_JSON_TYPE_NULL)return null;if(e===K.TNS_JSON_TYPE_TRUE)return!0;if(e===K.TNS_JSON_TYPE_FALSE)return!1;if(e===K.TNS_JSON_TYPE_DATE||e===K.TNS_JSON_TYPE_TIMESTAMP7)return this.parseOracleDate(this.readBytes(7));if(e===K.TNS_JSON_TYPE_TIMESTAMP)return this.parseOracleDate(this.readBytes(11));if(e===K.TNS_JSON_TYPE_TIMESTAMP_TZ)return this.parseOracleDate(this.readBytes(13));if(e===K.TNS_JSON_TYPE_BINARY_FLOAT)return this.parseBinaryFloat(this.readBytes(4));if(e===K.TNS_JSON_TYPE_BINARY_DOUBLE)return this.parseBinaryDouble(this.readBytes(8));if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT8)return this.readBytes(this.readUInt8()).toString();if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT16)return this.readBytes(this.readUInt16BE()).toString();if(e===K.TNS_JSON_TYPE_STRING_LENGTH_UINT32)return this.readBytes(this.readUInt32BE()).toString();if(e===K.TNS_JSON_TYPE_NUMBER_LENGTH_UINT8)return parseFloat(this.readOracleNumber());if(e===K.TNS_JSON_TYPE_ID){let s=this.readBytes(this.readUInt8()),r=new Ui.JsonId(s.length);return s.copy(r),r}else{if(e===K.TNS_JSON_TYPE_BINARY_LENGTH_UINT16)return Tr.from(this.readBytes(this.readUInt16BE()));if(e===K.TNS_JSON_TYPE_BINARY_LENGTH_UINT32)return Tr.from(this.readBytes(this.readUInt32BE()));if(e===K.TNS_JSON_TYPE_EXTENDED&&(e=this.readUInt8(),e===K.TNS_JSON_TYPE_VECTOR)){let s=this.readBytes(this.readUInt32BE());return new $N.VectorDecoder(s).decode()}}let t=e&240;if(t===32||t===96){let s=e&15;return parseFloat(this.parseOracleNumber(this.readBytes(s+1)))}else if(t===64||t===80){let s=e&15;return parseFloat(this.parseOracleNumber(this.readBytes(s)))}else if(!(e&224))return e===0?"":this.readBytes(e).toString();Ds.throwErr(Ds.ERR_UNSUPPORTED_DATA_TYPE_IN_JSON,e)}_getNumChildren(e){let t=e&24;if(t===0)return this.readUInt8();if(t===8)return this.readUInt16BE();if(t===16)return this.readUInt32BE()}_getOffset(e){return e&32?this.readUInt32BE():this.readUInt16BE()}_getFieldNames(e,t,s,r,n){this.skipBytes(t*n);let a=this.pos;this.skipBytes(t*s);let _=this.readBytes(r),T=this.pos;this.pos=a;let l;for(let E=e;E<e+t;E++){s===2?l=this.readUInt16BE():l=this.readUInt32BE();let h;n===1?h=_.readUInt8(l):h=_.readUInt16BE(l),this.fieldNames[E]=_.subarray(l+n,l+h+n).toString()}this.pos=T}decode(){let e=this.readBytes(3);(e[0]!==K.TNS_JSON_MAGIC_BYTE_1||e[1]!==K.TNS_JSON_MAGIC_BYTE_2||e[2]!==K.TNS_JSON_MAGIC_BYTE_3)&&Ds.throwErr(Ds.ERR_UNEXPECTED_DATA,e.toString("hex"));let t=this.readUInt8();t!==K.TNS_JSON_VERSION_MAX_FNAME_255&&t!==K.TNS_JSON_VERSION_MAX_FNAME_65535&&Ds.throwErr(Ds.ERR_OSON_VERSION_NOT_SUPPORTED,t);let s=this.readUInt16BE();if(this.relativeOffsets=s&K.TNS_JSON_FLAG_REL_OFFSET_MODE,s&K.TNS_JSON_FLAG_IS_SCALAR)return s&K.TNS_JSON_FLAG_TREE_SEG_UINT32?this.skipBytes(4):this.skipBytes(2),this._decodeNode();let r;s&K.TNS_JSON_FLAG_NUM_FNAMES_UINT32?(r=this.readUInt32BE(),this.fieldIdLength=4):s&K.TNS_JSON_FLAG_NUM_FNAMES_UINT16?(r=this.readUInt16BE(),this.fieldIdLength=2):(r=this.readUInt8(),this.fieldIdLength=1);let n,a;s&K.TNS_JSON_FLAG_FNAMES_SEG_UINT32?(n=4,a=this.readUInt32BE()):(n=2,a=this.readUInt16BE());let _,T,l=0;return t===K.TNS_JSON_VERSION_MAX_FNAME_65535&&(this.readUInt16BE()&K.TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16?_=2:_=4,l=this.readUInt32BE(),T=this.readUInt32BE()),s&K.TNS_JSON_FLAG_TREE_SEG_UINT32?this.skipBytes(4):this.skipBytes(2),this.skipBytes(2),this.fieldNames=new Array(r+l),r>0&&this._getFieldNames(0,r,n,a,1),l>0&&this._getFieldNames(r,l,_,T,2),this.treeSegPos=this.pos,this._decodeNode()}};c(la,"OsonDecoder");var oa=la,Ea=class Ea{constructor(e,t){this.name=e,this.nameBytes=Tr.from(e),this.nameBytes.length>t&&Ds.throwErr(Ds.ERR_OSON_FIELD_NAME_LIMITATION,t);let s=0x811C9DC5n,r=16777619n,n=0xffffffffn;this.hashId=s;for(let a=0;a<this.nameBytes.length;a++){let _=BigInt(this.nameBytes[a]);this.hashId=(this.hashId^_)*r&n}this.hashId=Number(this.hashId)&255}};c(Ea,"OsonFieldName");var aa=Ea,ua=class ua extends Ta{constructor(){super(),this.fieldNames=[]}addName(e){e.offset=this.pos,e.nameBytes.length<=255?this.writeUInt8(e.nameBytes.length):this.writeUInt16BE(e.nameBytes.length),this.writeBytes(e.nameBytes),this.fieldNames.push(e)}_processFieldNames(e){this.fieldNames.sort((t,s)=>t.hashId<s.hashId?-1:t.hashId>s.hashId?1:t.nameBytes.length<s.nameBytes.length?-1:t.nameBytes.length>s.nameBytes.length?1:t.name<s.name?-1:t.name>s.name?1:0);for(let t=0;t<this.fieldNames.length;t++)this.fieldNames[t].fieldId=e+t+1;this.fieldNames.length<256?this.fieldIdSize=1:this.fieldNames.length<65536?this.fieldIdSize=2:this.fieldIdSize=4}};c(ua,"OsonFieldNamesSegment");var Yi=ua,ha=class ha extends Ta{_encodeArray(e,t){this._encodeContainer(K.TNS_JSON_TYPE_ARRAY,e.length);let s=e.length*4,n=this.reserveBytes(s);for(let a of e)this.buf.writeUInt32BE(this.pos,n),n+=4,this.encodeNode(a,t)}_encodeContainer(e,t){e|=32,t>65535?e|=16:t>255&&(e|=8),this.writeUInt8(e),t<256?this.writeUInt8(t):t<65536?this.writeUInt16BE(t):this.writeUInt32BE(t)}_encodeObject(e,t){let s=e.values.length;this._encodeContainer(K.TNS_JSON_TYPE_OBJECT,s);let r=this.pos,n=this.pos+s*t.fieldIdSize,a=n+s*4;this.reserveBytes(a-this.pos);for(let _=0;_<e.fields.length;_++){let T=t.fieldNamesMap.get(e.fields[_]);t.fieldIdSize==1?this.buf[r]=T.fieldId:t.fieldIdSize==2?this.buf.writeUInt16BE(T.fieldId,r):this.buf.writeUInt32BE(T.fieldId,r),this.buf.writeUInt32BE(this.pos,n),r+=t.fieldIdSize,n+=4,this.encodeNode(e.values[_],t)}}encodeNode(e,t){if(e==null)this.writeUInt8(K.TNS_JSON_TYPE_NULL);else if(typeof e=="boolean")e?this.writeUInt8(K.TNS_JSON_TYPE_TRUE):this.writeUInt8(K.TNS_JSON_TYPE_FALSE);else if(typeof e=="number")this.writeUInt8(K.TNS_JSON_TYPE_NUMBER_LENGTH_UINT8),this.writeOracleNumber(e.toString());else if(typeof e=="string"){let s=Tr.from(e);s.length<256?(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT8),this.writeUInt8(s.length)):s.length<65536?(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT16),this.writeUInt16BE(s.length)):(this.writeUInt8(K.TNS_JSON_TYPE_STRING_LENGTH_UINT32),this.writeUInt32BE(s.length)),s.length>0&&this.writeBytes(s)}else if(_R.types.isDate(e))e.getUTCMilliseconds()===0?(this.writeUInt8(K.TNS_JSON_TYPE_TIMESTAMP7),this.writeOracleDate(e,Ui.DB_TYPE_DATE,!1)):(this.writeUInt8(K.TNS_JSON_TYPE_TIMESTAMP),this.writeOracleDate(e,Ui.DB_TYPE_TIMESTAMP,!1));else if(Tr.isBuffer(e))e.length<65536?(this.writeUInt8(K.TNS_JSON_TYPE_BINARY_LENGTH_UINT16),this.writeUInt16BE(e.length)):(this.writeUInt8(K.TNS_JSON_TYPE_BINARY_LENGTH_UINT32),this.writeUInt32BE(e.length)),this.writeBytes(e);else if(Array.isArray(e))this._encodeArray(e,t);else if(cR.isVectorValue(e)){this.writeUInt8(K.TNS_JSON_TYPE_EXTENDED),this.writeUInt8(K.TNS_JSON_TYPE_VECTOR);let r=new $N.VectorEncoder().encode(e);this.writeUInt32BE(r.length),this.writeBytes(r)}else e instanceof Ui.JsonId?(this.writeUInt8(K.TNS_JSON_TYPE_ID),this.writeUInt8(e.length),this.writeBytes(Tr.from(e.buffer))):this._encodeObject(e,t)}};c(ha,"OsonTreeSegment");var _a=ha,Na=class Na extends Ta{_addFieldName(e){let t=new aa(e,this.maxFieldNameSize);this.fieldNamesMap.set(e,t),t.nameBytes.length<=255?this.shortFieldNamesSeg.addName(t):(this.longFieldNamesSeg||(this.longFieldNamesSeg=new Yi),this.longFieldNamesSeg.addName(t))}_examineNode(e){if(Array.isArray(e))for(let t of e)this._examineNode(t);else if(e&&Array.isArray(e.fields))for(let t=0;t<e.fields.length;t++){let s=e.fields[t],r=e.values[t];this.fieldNamesMap.has(s)||this._addFieldName(s),this._examineNode(r)}}_writeExtendedHeader(){if(this.fieldIdSize===1?this.writeUInt8(this.shortFieldNamesSeg.fieldNames.length):this.fieldIdSize===2?this.writeUInt16BE(this.shortFieldNamesSeg.fieldNames.length):this.writeUInt32BE(this.shortFieldNamesSeg.fieldNames.length),this.shortFieldNamesSeg.pos<65536?this.writeUInt16BE(this.shortFieldNamesSeg.pos):this.writeUInt32BE(this.shortFieldNamesSeg.pos),this.longFieldNamesSeg){let e=0;this.longFieldNamesSeg.pos<65536&&(e=K.TNS_JSON_FLAG_SEC_FNAMES_SEG_UINT16),this.writeUInt16BE(e),this.writeUInt32BE(this.longFieldNamesSeg.fieldNames.length),this.writeUInt32BE(this.longFieldNamesSeg.pos)}}_writeFieldNamesSeg(e){for(let t of e.fieldNames)t.nameBytes.length<=255?this.writeUInt8(t.hashId):this.writeUInt16BE(t.hashId);for(let t of e.fieldNames)e.pos<65536?this.writeUInt16BE(t.offset):this.writeUInt32BE(t.offset);e.pos>0&&this.writeBytes(e.buf.subarray(0,e.pos))}encode(e,t){this.maxFieldNameSize=t;let s=K.TNS_JSON_FLAG_INLINE_LEAF;if(Array.isArray(e)||e&&Array.isArray(e.fields)){this.fieldNamesMap=new Map,this.shortFieldNamesSeg=new Yi,this._examineNode(e);let n=0;this.shortFieldNamesSeg&&(this.shortFieldNamesSeg._processFieldNames(0),n+=this.shortFieldNamesSeg.fieldNames.length),this.longFieldNamesSeg&&(this.longFieldNamesSeg._processFieldNames(n),n+=this.longFieldNamesSeg.fieldNames.length),s|=K.TNS_JSON_FLAG_HASH_ID_UINT8|K.TNS_JSON_FLAG_TINY_NODES_STAT,n>65535?(s|=K.TNS_JSON_FLAG_NUM_FNAMES_UINT32,this.fieldIdSize=4):n>255?(s|=K.TNS_JSON_FLAG_NUM_FNAMES_UINT16,this.fieldIdSize=2):this.fieldIdSize=1,this.shortFieldNamesSeg.pos>65535&&(s|=K.TNS_JSON_FLAG_FNAMES_SEG_UINT32)}else s|=K.TNS_JSON_FLAG_IS_SCALAR;let r=new _a;return r.encodeNode(e,this),r.pos>65535&&(s|=K.TNS_JSON_FLAG_TREE_SEG_UINT32),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_1),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_2),this.writeUInt8(K.TNS_JSON_MAGIC_BYTE_3),this.longFieldNamesSeg?this.writeUInt8(K.TNS_JSON_VERSION_MAX_FNAME_65535):this.writeUInt8(K.TNS_JSON_VERSION_MAX_FNAME_255),this.writeUInt16BE(s),this.shortFieldNamesSeg&&this._writeExtendedHeader(),r.pos<65536?this.writeUInt16BE(r.pos):this.writeUInt32BE(r.pos),this.shortFieldNamesSeg&&(this.writeUInt16BE(0),this._writeFieldNamesSeg(this.shortFieldNamesSeg),this.longFieldNamesSeg&&this._writeFieldNamesSeg(this.longFieldNamesSeg)),this.writeBytes(r.buf.subarray(0,r.pos)),this.buf.subarray(0,this.pos)}};c(Na,"OsonEncoder");var ca=Na;jN.exports={OsonDecoder:oa,OsonEncoder:ca}});var da=P((qB,ZN)=>{"use strict";var TR=nt(),jt=W(),lR=et(),JN=Vt(),ER=ra(),Xe=lt(),QN=xs(),uR=Mi(),Aa=class Aa{_determineFetchType(e,t){if(delete e.fetchType,delete e.converter,t.fetchTypeHandler){let n=t.fetchTypeHandler(e);n!==void 0&&(jt.assert(typeof n=="object",jt.ERR_FETCH_TYPE_HANDLER_RETURN_VALUE),n.type!==void 0&&jt.assert(n.type instanceof Xe.DbType,jt.ERR_FETCH_TYPE_HANDLER_TYPE),n.converter!==void 0&&jt.assert(typeof n.converter=="function",jt.ERR_FETCH_TYPE_HANDLER_CONVERTER),e.fetchType=n.type,e.converter=n.converter)}if(e.fetchType||(t.fetchTypeMap&&t.fetchTypeMap.has(e.name)?(e.fetchType=t.fetchTypeMap.get(e.name),e.fetchType===TR.DEFAULT&&(e.fetchType=Xe.DB_TYPE_FETCH_TYPE_MAP.get(e.dbType))):e.fetchType=JN.fetchTypeMap.get(e.dbType)),e.fetchType!==e.dbType){let n=Xe.DB_TYPE_CONVERSION_MAP.get(e.dbType),a=n&&n.get(e.fetchType);a||jt.throwErr(jt.ERR_UNSUPPORTED_CONVERSION,e.dbType.name,e.fetchType.name),e.fetchType=a}let s,r=e.converter;if(e.dbType!==Xe.DB_TYPE_JSON&&ER.oldJsonColumnAsObj&&r===void 0){let n;e.isOson?(n=c(async function(a){if(!a)return a;let _=a;return a instanceof QN&&(_=await a.getData()),new uR.OsonDecoder(_).decode()},"outConverter"),s=n):e.isJson&&(n=c(async function(a){if(!a)return a;let _=a;return a instanceof QN&&(_=await a.getData()),_ instanceof Buffer&&(_=_.toString()),_=JSON.parse(_),_},"outConverter"),s=n)}if(JN.thin&&(e.dbType===Xe.DB_TYPE_NUMBER&&e.fetchType===Xe.DB_TYPE_NUMBER?s=c(n=>n===null?null:parseFloat(n),"converter"):e.fetchType===Xe.DB_TYPE_VARCHAR?e.dbType===Xe.DB_TYPE_BINARY_DOUBLE||e.dbType===Xe.DB_TYPE_BINARY_FLOAT||e.dbType===Xe.DB_TYPE_DATE||e.dbType===Xe.DB_TYPE_TIMESTAMP||e.dbType===Xe.DB_TYPE_TIMESTAMP_LTZ||e.dbType===Xe.DB_TYPE_TIMESTAMP_TZ?s=c(n=>n===null?null:n.toString(),"converter"):e.dbType===Xe.DB_TYPE_RAW&&(s=c(n=>n===null?null:n.toString("hex").toUpperCase(),"converter")):e.dbType===Xe.DB_TYPE_XMLTYPE&&(s=c(async function(a){return!a||typeof a=="string"?a:await a.getData()},"xmlConverter")),r&&s)){let n=s;s=c(a=>r(n(a)),"converter")}s&&(e.converter=s)}_getConnImpl(){return this._parentObj}_setup(e,t){this._parentObj=e.connection._impl,this.metaData=t,this.lobIndices=[],this.dbObjectIndices=[],this.nestedCursorIndices=[],this.converterIndices=[],this.outFormat=e.outFormat,this.fetchArraySize=e.fetchArraySize,this.dbObjectAsPojo=e.dbObjectAsPojo,this.maxRows=e.maxRows;let s=new Map;for(let r=0;r<t.length;r++){let n=t[r].name;s.has(n)||s.set(n,r)}for(let r=0;r<t.length;r++){let n=t[r];if(n.dbTypeClass){let _=e.connection._getDbObjectClass(n.dbTypeClass);n.dbTypeClass=_}lR.addTypeProperties(n,"dbType"),this._determineFetchType(n,e),n.fetchType===Xe.DB_TYPE_CURSOR?this.nestedCursorIndices.push(r):n.fetchType===Xe.DB_TYPE_CLOB||n.fetchType===Xe.DB_TYPE_NCLOB||n.fetchType===Xe.DB_TYPE_BLOB||n.fetchType===Xe.DB_TYPE_BFILE?this.lobIndices.push(r):n.fetchType===Xe.DB_TYPE_OBJECT&&this.dbObjectIndices.push(r),n.converter&&this.converterIndices.push(r);let a=n.name;if(s.get(a)!==r){let _=0;for(;s.has(a);)_=_+1,a=`${n.name}_${_}`;s.set(a,r),n.name=a}}}close(){jt.throwNotImplemented("closing a result set")}getRows(){jt.throwNotImplemented("getting rows")}async _getAllRows(){let t=[];for(;;){let s=await this.getRows(100,{});if(s&&(await this._processRows(s,!1),t=t.concat(s)),s.length<100)break}return t}};c(Aa,"ResultSetImpl");var Sa=Aa;ZN.exports=Sa});var tS=P((HB,eS)=>{"use strict";var Dt=W(),fa=class fa{_getConnImpl(){return this._database._connection}createIndex(){Dt.throwNotImplemented("creating an index on a SODA collection")}drop(){Dt.throwNotImplemented("dropping a SODA collection")}dropIndex(){Dt.throwNotImplemented("dropping an index on a SODA collection")}find(){Dt.throwNotImplemented("creating a SODA operation")}getDataGuide(){Dt.throwNotImplemented("getting the data guide for the collection")}getMetaData(){Dt.throwNotImplemented("getting the metadata for the collection")}getName(){Dt.throwNotImplemented("getting the name of the collection")}insertMany(){Dt.throwNotImplemented("inserting multiple docs into a collection")}insertManyAndGet(){Dt.throwNotImplemented("insert/return many docs in a collection")}insertOne(){Dt.throwNotImplemented("inserting a single doc into a collection")}insertOneAndGet(){Dt.throwNotImplemented("insert/return a single doc in a collection")}save(){Dt.throwNotImplemented("saving a single doc in a collection")}saveAndGet(){Dt.throwNotImplemented("saving a single doc in a collection")}truncate(){Dt.throwNotImplemented("removing all docs from a collection")}};c(fa,"SodaCollectionImpl");var pa=fa;eS.exports=pa});var rS=P((KB,sS)=>{"use strict";var Vi=W(),Pa=class Pa{_getConnImpl(){return this._connection}createCollection(){Vi.throwNotImplemented("creating a SODA collection")}createDocument(){Vi.throwNotImplemented("creating a SODA document")}getCollectionNames(){Vi.throwNotImplemented("getting a list of SODA collection names")}openCollection(){Vi.throwNotImplemented("getting a list of SODA collection names")}};c(Pa,"SodaDatabaseImpl");var ma=Pa;sS.exports=ma});var oS=P((XB,nS)=>{"use strict";var iS=W(),Ia=class Ia{_getConnImpl(){return this._operation._getConnImpl()}close(){iS.throwNotImplemented("closing a SODA document cursor")}getNext(){iS.throwNotImplemented("getting a document from a SODA doc cursor")}};c(Ia,"SodaDocCursorImpl");var Ra=Ia;nS.exports=Ra});var _S=P(($B,aS)=>{"use strict";var bs=W(),Ca=class Ca{getContentAsBuffer(){bs.throwNotImplemented("getting doc content as a buffer")}getContentAsString(){bs.throwNotImplemented("getting doc content as a string")}getCreatedOn(){bs.throwNotImplemented("getting the created date of a document")}getKey(){bs.throwNotImplemented("getting the key of a document")}getLastModified(){bs.throwNotImplemented("getting the last modified date of a doc")}getMediaType(){bs.throwNotImplemented("getting the media type of a document")}getVersion(){bs.throwNotImplemented("getting the version of a document")}};c(Ca,"SodaDocumentImpl");var Da=Ca;aS.exports=Da});var TS=P((JB,cS)=>{"use strict";var ks=W(),ga=class ga{_getConnImpl(){return this._collection._database._connection}count(){ks.throwNotImplemented("getting a count of documents")}getCursor(){ks.throwNotImplemented("getting a cursor for documents")}getDocuments(){ks.throwNotImplemented("getting a cursor for documents")}getOne(){ks.throwNotImplemented("getting a single document")}remove(){ks.throwNotImplemented("removing documents from a collection")}replaceOne(){ks.throwNotImplemented("replacing a single document")}replaceOneAndGet(){ks.throwNotImplemented("replacing/returning a single document")}};c(ga,"SodaOperationImpl");var Oa=ga;cS.exports=Oa});var lr=P((ZB,lS)=>{"use strict";var hR=YN(),NR=VN(),SR=xN(),AR=kN(),dR=yi(),pR=Li(),fR=Jo(),mR=ea(),PR=da(),RR=tS(),IR=rS(),DR=oS(),CR=_S(),OR=TS();lS.exports={AqDeqOptionsImpl:hR,AqEnqOptionsImpl:NR,AqMessageImpl:SR,AqQueueImpl:AR,DbObjectImpl:dR,ConnectionImpl:pR,LobImpl:fR,PoolImpl:mR,ResultSetImpl:PR,SodaCollectionImpl:RR,SodaDatabaseImpl:IR,SodaDocCursorImpl:DR,SodaDocumentImpl:CR,SodaOperationImpl:OR}});var Ba=P((ew,ES)=>{"use strict";var{Buffer:gR}=require("buffer"),Ts=nt(),ls=W(),La=class La{get condition(){return this._impl.getCondition()}set condition(e){ls.assertPropValue(typeof e=="string","condition"),this._impl.setCondition(e)}get consumerName(){return this._impl.getConsumerName()}set consumerName(e){ls.assertPropValue(typeof e=="string","consumerName"),this._impl.setConsumerName(e)}get correlation(){return this._impl.getCorrelation()}set correlation(e){ls.assertPropValue(typeof e=="string","correlation"),this._impl.setCorrelation(e)}get mode(){return this._impl.getMode()}set mode(e){ls.assertPropValue(e===Ts.AQ_DEQ_MODE_BROWSE||e===Ts.AQ_DEQ_MODE_LOCKED||e===Ts.AQ_DEQ_MODE_REMOVE||e===Ts.AQ_DEQ_MODE_REMOVE_NO_DATA,"mode"),this._impl.setMode(e)}get msgId(){return this._impl.getMsgId()}set msgId(e){ls.assertPropValue(gR.isBuffer(e),"msgId"),this._impl.setMsgId(e)}get navigation(){return this._impl.getNavigation()}set navigation(e){ls.assertPropValue(e===Ts.AQ_DEQ_NAV_FIRST_MSG||e===Ts.AQ_DEQ_NAV_NEXT_TRANSACTION||e===Ts.AQ_DEQ_NAV_NEXT_MSG,"navigation"),this._impl.setNavigation(e)}get transformation(){return this._impl.getTransformation()}set transformation(e){ls.assertPropValue(typeof e=="string","transformation"),this._impl.setTransformation(e)}get visibility(){return this._impl.getVisibility()}set visibility(e){ls.assertPropValue(e===Ts.AQ_VISIBILITY_IMMEDIATE||e===Ts.AQ_VISIBILITY_ON_COMMIT,"visibility"),this._impl.setVisibility(e)}get wait(){return this._impl.getWait()}set wait(e){ls.assertPropValue(Number.isInteger(e)&&e>=0,"wait"),this._impl.setWait(e)}};c(La,"AqDeqOptions");var ya=La;ES.exports=ya});var Ma=P((sw,uS)=>{"use strict";var Mr=nt(),wa=W(),Ya=class Ya{get deliveryMode(){return this._impl.getDeliveryMode()}set deliveryMode(e){wa.assertPropValue(e===Mr.AQ_MSG_DELIV_MODE_PERSISTENT||e===Mr.AQ_MSG_DELIV_MODE_BUFFERED||e===Mr.AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED,"deliveryMode"),this._impl.setDeliveryMode(e)}get transformation(){return this._impl.getTransformation()}set transformation(e){wa.assertPropValue(typeof e=="string","transformation"),this._impl.setTransformation(e)}get visibility(){return this._impl.getVisibility()}set visibility(e){wa.assertPropValue(e===Mr.AQ_VISIBILITY_IMMEDIATE||e===Mr.AQ_VISIBILITY_ON_COMMIT,"visibility"),this._impl.setVisibility(e)}};c(Ya,"AqEnqOptions");var Ua=Ya;uS.exports=Ua});var xa=P((iw,hS)=>{"use strict";var yR=yi(),Fa=class Fa{get correlation(){return this._impl.getCorrelation()}get delay(){return this._impl.getDelay()}get deliveryMode(){return this._impl.getDeliveryMode()}get exceptionQueue(){return this._impl.getExceptionQueue()}get expiration(){return this._impl.getExpiration()}get msgId(){return this._impl.getMsgId()}get numAttempts(){return this._impl.getNumAttempts()}get originalMsgId(){return this._impl.getOriginalMsgId()}get payload(){let e=this._impl.getPayload();if(e instanceof yR){let t=Object.create(this._payloadTypeClass.prototype);return t._impl=e,t}return e}get priority(){return this._impl.getPriority()}get state(){return this._impl.getState()}};c(Fa,"AqMessage");var Va=Fa;hS.exports=Va});var qa=P((ow,NS)=>{"use strict";var LR=require("process"),{Readable:BR}=require("stream"),ka=class ka extends BR{constructor(e){super({objectMode:!0}),this._fetching=!1,this._numRows=0,e&&LR.nextTick(()=>{this._open(e)})}async _destroy(e,t){if(this._resultSet){let s=this._resultSet;this._resultSet=null,this._fetching&&await new Promise(r=>this.once("_doneFetching",r));try{await s._impl.close()}catch(r){t(r);return}}t(e)}_open(e){this._resultSet=e,this.emit("open"),this.emit("metadata",e.metaData)}async _read(){if(!this._resultSet){this.once("open",this._read);return}try{this._fetching=!0,this._resultSet._allowGetRowCall=!0;let e=await this._resultSet.getRow();e?this.push(e):this.push(null)}catch(e){this.destroy(e)}finally{this._fetching=!1,this._resultSet?this._resultSet._allowGetRowCall=!1:this.emit("_doneFetching")}}};c(ka,"QueryStream");var ba=ka;NS.exports=ba});var bi=P((_w,SS)=>{"use strict";var wR=qa(),UR=Er(),YR=et(),MR=nt(),VR=xs(),Ge=W(),xi=class xi{constructor(){this._rowCache=[],this._processingStarted=!1,this._convertedToStream=!1,this._allowGetRowCall=!1,this._isActive=!1}async _getAllRows(){try{let e=this._impl.maxRows,t=this._impl.fetchArraySize,s=[];for(;;){e>0&&t>=e&&(t=e);let r=await this._getRows(t);if(r&&(await this._processRows(r,!0),s=s.concat(r)),r.length==e||r.length<t)break;e>0&&(e-=r.length)}return s}finally{await this._impl.close(),delete this._impl}}async _getRows(e){let t={};return this._impl.nestedCursorIndices.length>0&&(t={connection:this._connection,outFormat:this._impl.outFormat,fetchArraySize:this._impl.fetchArraySize,dbObjectAsPojo:this._impl.dbObjectAsPojo,maxRows:this._impl.maxRows,fetchTypeMap:this._impl.fetchTypeMap}),await this._impl.getRows(e,t)}async _processRows(e,t){for(let s of this._impl.nestedCursorIndices)for(let r=0;r<e.length;r++){let n=e[r][s];if(n){let a=new xi;a._setup(this._connection,n),this._impl.metaData[s].metaData=n.metaData,t?e[r][s]=await a._getAllRows():e[r][s]=a}}for(let s of this._impl.lobIndices)for(let r=0;r<e.length;r++){let n=e[r][s];n&&(e[r][s]=new VR)._setup(n,!0)}for(let s of this._impl.dbObjectIndices){let r=this._impl.metaData[s].dbTypeClass;for(let n=0;n<e.length;n++){let a=e[n][s];if(a){let _=e[n][s]=Object.create(r.prototype);_._impl=a,this._impl.dbObjectAsPojo?e[n][s]=_._toPojo():_.isCollection&&(e[n][s]=new Proxy(_,UR._collectionProxyHandler))}}}for(let s of this._impl.converterIndices){let r=this._impl.metaData[s].converter;this._connection._impl._inProgress=!1;try{for(let n=0;n<e.length;n++){let a=r(e[n][s]);a instanceof Promise&&(a=await a),e[n][s]=a}}finally{this._connection._impl._inProgress=!0}}if(this._impl.outFormat===MR.OUT_FORMAT_OBJECT)for(let s=0;s<e.length;s++){let r=e[s],n=e[s]={},a=this._impl.metaData;for(let _=0;_<a.length;_++)n[a[_].name]=r[_]}}_setup(e,t){this._connection=e,this._impl=t}async close(){Ge.assertArgCount(arguments,0,0),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),this._convertedToStream&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._processingStarted=!0;let e=this._impl;delete this._impl,await e.close()}async getRow(){if(Ge.assertArgCount(arguments,0,0),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),this._convertedToStream&&!this._allowGetRowCall&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._allowGetRowCall=!1,this._processingStarted=!0,this._rowCache.length==0){let e=await this._getRows(this._impl.fetchArraySize);await this._processRows(e,!1),this._rowCache=e}return this._rowCache.shift()}async getRows(e){let t;Ge.assertArgCount(arguments,0,1),Ge.assert(this._impl&&this._connection._impl,Ge.ERR_INVALID_RS),arguments.length==0?e=0:Ge.assertParamValue(Number.isInteger(e)&&e>=0,1),this._convertedToStream&&Ge.throwErr(Ge.ERR_CANNOT_INVOKE_RS_METHODS),this._processingStarted=!0;let s;if(e==0){s=this._rowCache;let r=this._impl.fetchArraySize;for(;;){let n=await this._getRows(r);if(n&&(await this._processRows(n,!1),s=s.concat(n)),n.length<r)break}return s}if(this._rowCache.length===0)s=await this._getRows(e),await this._processRows(s,!1);else if(t=e-this._rowCache.length,t<=0)s=this._rowCache.splice(0,e);else{let r=await this._getRows(t);await this._processRows(r,!1),s=this._rowCache.concat(r),this._rowCache=[]}return s}get metaData(){if(this._impl)return this._impl.metaData}toQueryStream(){return Ge.assertArgCount(arguments,0,0),this._processingStarted&&Ge.throwErr(Ge.ERR_CANNOT_CONVERT_RS_TO_STREAM),this._convertedToStream&&Ge.throwErr(Ge.ERR_RS_ALREADY_CONVERTED),this._convertedToStream=!0,new wR(this)}[Symbol.asyncIterator](){let e=this;return{async next(){let t=await e.getRow();return{value:t,done:t===void 0}},return(){return{done:!0}}}}};c(xi,"ResultSet");var Fi=xi;YR.wrapFns(Fi.prototype,Ge.ERR_BUSY_RS,"close","getRow","getRows");SS.exports=Fi});var qi=P((Tw,fS)=>{"use strict";var Ga=Er(),{Buffer:Ha}=require("buffer"),FR=xs(),xR=bi(),bR=nt(),He=W(),AS=require("util"),pe=lt(),dS=et();function Jt(i,e){if(i.type===void 0&&arguments.length>2)i.type=arguments[2];else{let t=!1;for(let s=2;s<arguments.length;s++)if(i.type===arguments[s]){t=!0;break}t||(i.attrName?He.throwErr(He.ERR_WRONG_VALUE_FOR_DBOBJECT_ATTR,i.attrName,i.fqn):i.fqn?He.throwErr(He.ERR_WRONG_VALUE_FOR_DBOBJECT_ELEM,i.fqn):i.isArray&&i.name?He.throwErr(He.ERR_INCOMPATIBLE_TYPE_ARRAY_BIND,e.pos,i.name):i.isArray?He.throwErr(He.ERR_INCOMPATIBLE_TYPE_ARRAY_INDEX_BIND,e.pos,i.pos):He.throwErr(He.ERR_BIND_VALUE_AND_TYPE_MISMATCH))}}c(Jt,"checkType");function ki(i){if(i==null||typeof i=="number"||typeof i=="string"||typeof i=="boolean"||Ha.isBuffer(i)||AS.types.isDate(i)||dS.isVectorValue(i))return i;if(Array.isArray(i)){let t=new Array(i.length);for(let s=0;s<i.length;s++)t[s]=ki(i[s]);return t}if(i instanceof Ga)return{fields:[],values:[]};if(i instanceof pe.JsonId)return i;let e={};e.fields=Object.getOwnPropertyNames(i),e.values=new Array(e.fields.length);for(let t=0;t<e.fields.length;t++)e.values[t]=ki(i[e.fields[t]]);return e}c(ki,"transformJsonValue");function pS(i,e,t){if(e!=null){if(i.type===pe.DB_TYPE_OBJECT){let s=e;return e instanceof Ga||(s=new i.typeClass(e)),s._impl}else{if(i.type===pe.DB_TYPE_JSON)return ki(e);if(typeof e=="string"){if(Jt(i,t,pe.DB_TYPE_VARCHAR,pe.DB_TYPE_NVARCHAR,pe.DB_TYPE_CHAR,pe.DB_TYPE_NCHAR,pe.DB_TYPE_CLOB,pe.DB_TYPE_NCLOB),i.type!==pe.DB_TYPE_CLOB&&i.type!==pe.DB_TYPE_NCLOB){let s=Ha.byteLength(e);(i.maxSize===void 0||s>i.maxSize)&&(i.checkSize&&He.throwErr(He.ERR_MAX_SIZE_TOO_SMALL,i.maxSize,s,t.pos),i.maxSize=s)}return e}else{if(typeof e=="number"||typeof e=="bigint")return Jt(i,t,pe.DB_TYPE_NUMBER,pe.DB_TYPE_BINARY_INTEGER,pe.DB_TYPE_BINARY_FLOAT,pe.DB_TYPE_BINARY_DOUBLE),Number.isNaN(e)&&i.type===pe.DB_TYPE_NUMBER&&He.throwErr(He.ERR_NAN_VALUE),e;if(typeof e=="boolean")return Jt(i,t,pe.DB_TYPE_BOOLEAN),e;if(AS.types.isDate(e))return Jt(i,t,pe.DB_TYPE_TIMESTAMP,pe.DB_TYPE_TIMESTAMP_TZ,pe.DB_TYPE_TIMESTAMP_LTZ,pe.DB_TYPE_DATE),e;if(Ha.isBuffer(e))return Jt(i,t,pe.DB_TYPE_RAW,pe.DB_TYPE_BLOB),i.type===pe.DB_TYPE_RAW&&(i.maxSize===void 0||e.length>i.maxSize)&&(i.checkSize&&He.throwErr(He.ERR_MAX_SIZE_TOO_SMALL,i.maxSize,e.length,t.pos),i.maxSize=e.length),e;if(e instanceof xR)return Jt(i,t,pe.DB_TYPE_CURSOR),e._impl;if(e instanceof FR)return Jt(i,t,e.type),e._impl;if(e instanceof Ga)return Jt(i,t,pe.DB_TYPE_OBJECT),e._impl;if(dS.isVectorValue(e))return Jt(i,t,pe.DB_TYPE_VECTOR),e;if(i.type===pe.DB_TYPE_VECTOR&&Array.isArray(e))return new Float64Array(e);if(t.allowArray&&Array.isArray(e)){i.isArray=!0,i.dir===bR.BIND_IN?i.maxArraySize=e.length||1:i.maxArraySize===void 0?He.throwErr(He.ERR_REQUIRED_MAX_ARRAY_SIZE):e.length>i.maxArraySize&&He.throwErr(He.ERR_INVALID_ARRAY_SIZE),t.allowArray=!1;let s=new Array(e.length);for(let r=0;r<e.length;r++)t.pos=r,s[r]=pS(i,e[r],t);return s}}}i.type===void 0&&He.throwErr(He.ERR_INVALID_BIND_DATA_TYPE,2),Jt(i,t)}}c(pS,"transformValueIn");fS.exports={transformJsonValue:ki,transformValueIn:pS}});var Er=P((Ew,PS)=>{"use strict";var kR=xs(),mS=lr(),fe=W(),ur=lt(),va=require("util");function Ka(i,e,t,s){let r,n=!1;if(t){switch(e.type){case ur.DB_TYPE_VARCHAR:case ur.DB_TYPE_NVARCHAR:case ur.DB_TYPE_NCHAR:case ur.DB_TYPE_CHAR:r=Buffer.byteLength(t),r>e.maxSize&&(n=!0);break;case ur.DB_TYPE_RAW:r=t.length,r>e.maxSize&&(n=!0);break;default:break}n&&(s!==void 0?fe.throwErr(fe.ERR_WRONG_LENGTH_FOR_DBOBJECT_ELEM,s,i.fqn,r,e.maxSize):fe.throwErr(fe.ERR_WRONG_LENGTH_FOR_DBOBJECT_ATTR,e.name,i.fqn,r,e.maxSize))}}c(Ka,"validatePropertyValue");var Vr=class Vr{_getAttrValue(e){let t=this._impl.getAttrValue(e);return this._transformValueOut(t,e.typeClass)}_setAttrValue(e,t){let s={fqn:this._objType.fqn,attrName:e.name,type:e.type,typeClass:e.typeClass},r={allowArray:!1};t=Wa.transformValueIn(s,t,r),Ka(this._objType,e,t),this._impl.setAttrValue(e,t)}_toPojo(){if(this.isCollection){let t=this.getValues();if(this.elementType===ur.DB_TYPE_OBJECT)for(let s=0;s<t.length;s++)t[s]=t[s]._toPojo();return t}let e={};for(let t in this.attributes){let s=this[t];s instanceof Vr&&(s=s._toPojo()),e[t]=s}return e}_transformValueOut(e,t){let s=e;return e instanceof mS.LobImpl?(s=new kR,s._setup(e,!0)):e instanceof mS.DbObjectImpl&&(s=Object.create(t.prototype),s._impl=e,s.isCollection&&(s=new Proxy(s,Vr._collectionProxyHandler))),s}append(e){fe.assertArgCount(arguments,1,1);let t={fqn:this._objType.fqn,type:this._objType.elementType,typeClass:this._objType.elementTypeClass},s={allowArray:!1};e=Wa.transformValueIn(t,e,s);let r=this._impl.getLastIndex();r?r=r+1:r=0,Ka(this._objType,this._objType.elementTypeInfo,e,r),this._impl.append(e)}get attributes(){if(!this._attributes){let e=this._objType.attributes||[],t={};for(let s=0;s<e.length;s++){let r=e[s],n={type:r.type,typeName:r.typeName};r.typeClass&&(n.typeClass=r.typeClass),t[r.name]=n}this._attributes=t}return this._attributes}deleteElement(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.deleteElement(e)}get elementType(){return this._objType.elementType}get elementTypeClass(){return this._objType.elementTypeClass}get elementTypeName(){return this._objType.elementTypeName}get fqn(){return this._objType.fqn}getElement(e){fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1);let t=this._impl.getElement(e);return this._transformValueOut(t,this.elementTypeClass)}getKeys(){return fe.assertArgCount(arguments,0,0),this._impl.getKeys()}getFirstIndex(){return fe.assertArgCount(arguments,0,0),this._impl.getFirstIndex()}getLastIndex(){return fe.assertArgCount(arguments,0,0),this._impl.getLastIndex()}getNextIndex(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.getNextIndex(e)}getPrevIndex(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.getPrevIndex(e)}getValues(){fe.assertArgCount(arguments,0,0);let e=this._impl.getValues();for(let t=0;t<e.length;t++)e[t]=this._transformValueOut(e[t],this.elementTypeClass);return e}hasElement(e){return fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e),1),this._impl.hasElement(e)}get isCollection(){return this._objType.isCollection}get name(){return this._objType.name}get schema(){return this._objType.schema}get packageName(){return this._objType.packageName}setElement(e,t){fe.assertArgCount(arguments,2,2),fe.assertParamValue(Number.isInteger(e),1);let s={fqn:this._objType.fqn,type:this._objType.elementType,typeClass:this._objType.elementTypeClass},r={allowArray:!1};t=Wa.transformValueIn(s,t,r),Ka(this._objType,this._objType.elementTypeInfo,t,e),this._impl.setElement(e,t)}trim(e){fe.assertArgCount(arguments,1,1),fe.assertParamValue(Number.isInteger(e)&&e>=0,1),this._impl.trim(e)}[va.inspect.custom](e,t){return"["+this.fqn+"] "+va.inspect(this._toPojo(),t)}[Symbol.iterator](){if(this.isCollection)return this.getValues()[Symbol.iterator]();throw TypeError("obj is not iterable")}[Symbol.toPrimitive](e){switch(e){case"number":return NaN;default:return"["+this.fqn+"] "+va.inspect(this._toPojo(),{})}}get[Symbol.toStringTag](){return this.fqn}toJSON(){return this._toPojo()}toMap(){fe.assertArgCount(arguments,0,0),this.isCollection||fe.throwErr(fe.ERR_OBJECT_IS_NOT_A_COLLECTION,this.name);let e=new Map;return this.getKeys().forEach(t=>{e.set(t,this.getElement(t))}),e}};c(Vr,"BaseDbObject");var Fr=Vr;function qR(i){return function(){try{return i.apply(this,arguments)}catch(e){throw fe.transformErr(e,fe.transformErr)}}}c(qR,"transformErr");function GR(i){for(let e=1;e<arguments.length;e++){let t=arguments[e];i[t]=qR(i[t])}}c(GR,"wrapFns");GR(Fr.prototype,"_getAttrValue","_setAttrValue","append","deleteElement","getElement","getKeys","getFirstIndex","getLastIndex","getNextIndex","getPrevIndex","getValues","toMap","hasElement","setElement","trim");Fr._collectionProxyHandler={deleteProperty(i,e){if(typeof e=="string"){let t=+e;if(!isNaN(t))return i.deleteElement(t)}return delete i[e]},get(i,e){if(typeof e=="string"){let s=+e;if(!isNaN(s))return i.getElement(s)}let t=i[e];return typeof t=="function"?t.bind(i):t},set(i,e,t){if(typeof e=="string"){let s=+e;if(!isNaN(s))return i.setElement(s,t),!0}return i[e]=t,!0}};PS.exports=Fr;var Wa=qi()});var ja=P((hw,IS)=>{"use strict";var{Buffer:Xa}=require("buffer"),pt=W(),za=et(),HR=Ba(),vR=Ma(),KR=xa(),RS=Er(),WR=qi(),xr=lt(),$a=class $a{_isPayload(e){return typeof e=="string"||Xa.isBuffer(e)||e instanceof RS}_makeMessage(e){let t=new KR;return t._impl=e,t._payloadTypeClass=this._payloadTypeClass,t}_verifyMessage(e){let t;return this._isPayload(e)?(t=e,e={}):(e={...e},this._isJson||this._isPayload(e.payload)?t=e.payload:this._payloadTypeClass?t=new this._payloadTypeClass(e.payload):pt.throwErr(pt.ERR_INVALID_AQ_MESSAGE)),this._isJson?e.payload=WR.transformJsonValue(t):typeof t=="string"?e.payload=Xa.from(t):Xa.isBuffer(t)?e.payload=t:e.payload=t._impl,e.correlation!==void 0&&pt.assertParamPropValue(typeof e.correlation=="string",1,"correlation"),e.delay!==void 0&&pt.assertParamPropValue(Number.isInteger(e.delay),1,"delay"),e.exceptionQueue!==void 0&&pt.assertParamPropValue(typeof e.exceptionQueue=="string",1,"exceptionQueue"),e.expiration!==void 0&&pt.assertParamPropValue(Number.isInteger(e.expiration),1,"expiration"),e.priority!==void 0&&pt.assertParamPropValue(Number.isInteger(e.priority),1,"priority"),e.recipients!==void 0&&pt.assertParamPropValue(za.isArrayOfStrings(e.recipients),1,"recipients"),e}async create(e,t,s){if(s.payloadType===xr.DB_TYPE_JSON)this._isJson=!0,this._payloadType=xr.DB_TYPE_JSON,this._payloadTypeName="JSON";else if(s.payloadType===void 0||s.payloadType===xr.DB_TYPE_RAW)this._payloadType=xr.DB_TYPE_RAW,this._payloadTypeName="RAW";else{if(typeof s.payloadType=="string"){let r=await e._getDbObjectClassForName(s.payloadType);this._payloadTypeClass=r,s.payloadType=r}else pt.assertParamPropValue(za.isObject(s.payloadType)&&s.payloadType.prototype instanceof RS,2,"payloadType"),this._payloadTypeClass=s.payloadType;this._payloadType=xr.DB_TYPE_OBJECT,this._payloadTypeName=this._payloadTypeClass.prototype.name}this._name=t,this._impl=await e._impl.getQueue(t,this._payloadTypeClass,this._payloadType)}async deqMany(e){return pt.assertArgCount(arguments,1,1),pt.assertParamValue(Number.isInteger(e)&&e>0,1),(await this._impl.deq(e)).map(s=>this._makeMessage(s))}async deqOne(){pt.assertArgCount(arguments,0,0);let e=await this._impl.deq(1);if(e.length>0)return this._makeMessage(e[0])}get deqOptions(){if(!this._deqOptions){let e=new HR;e._impl=this._impl.deqOptions,this._deqOptions=e}return this._deqOptions}async enqMany(e){pt.assertArgCount(arguments,1,1),pt.assertParamValue(Array.isArray(e)&&e.length>0,1);let t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=this._verifyMessage(e[r]);return(await this._impl.enq(t)).map(r=>this._makeMessage(r))}async enqOne(e){pt.assertArgCount(arguments,1,1),e=this._verifyMessage(e);let t=await this._impl.enq([e]);return this._makeMessage(t[0])}get enqOptions(){if(!this._enqOptions){let e=new vR;e._impl=this._impl.enqOptions,this._enqOptions=e}return this._enqOptions}get name(){return this._name}get payloadType(){return this._payloadType}get payloadTypeName(){return this._payloadTypeName}get payloadTypeClass(){return this._payloadTypeClass}};c($a,"AqQueue");var Gi=$a;za.wrapFns(Gi.prototype,"deqOne","deqMany","enqOne","enqMany");IS.exports=Gi});var hr=P((Sw,DS)=>{"use strict";var Ja=class Ja{get createdOn(){return this._impl.getCreatedOn()}getContent(){return JSON.parse(this._impl.getContentAsString())}getContentAsBuffer(){return this._impl.getContentAsBuffer()}getContentAsString(){return this._impl.getContentAsString()}get key(){return this._impl.getKey()}get lastModified(){return this._impl.getLastModified()}get mediaType(){return this._impl.getMediaType()}get version(){return this._impl.getVersion()}};c(Ja,"SodaDocument");var Hi=Ja;Hi.prototype._sodaDocumentMarker=!0;DS.exports=Hi});var Za=P((dw,CS)=>{"use strict";var Nr=W(),XR=et(),zR=hr(),Qa=class Qa{async close(){Nr.assertArgCount(arguments,0,0),Nr.assert(this._impl,Nr.ERR_INVALID_SODA_DOC_CURSOR),await this._impl.close(),delete this._impl}async getNext(){Nr.assertArgCount(arguments,0,0),Nr.assert(this._impl,Nr.ERR_INVALID_SODA_DOC_CURSOR);let e=await this._impl.getNext();if(e){let t=new zR;return t._impl=e,t}}[Symbol.asyncIterator](){let e=this;return{async next(){let t=await e.getNext();return{value:t,done:t===void 0}},return(){return{done:!0}}}}};c(Qa,"SodaDocCursor");var vi=Qa;XR.wrapFns(vi.prototype,"close","getNext");CS.exports=vi});var s_=P((fw,gS)=>{"use strict";var $R=Za(),e_=hr(),Le=W(),Ki=et(),OS=Vt(),t_=class t_{constructor(){this._options={autoCommit:OS.autoCommit,fetchArraySize:OS.fetchArraySize}}async count(){return Le.assertArgCount(arguments,0,0),await this._impl.count(this._options)}async getCursor(){Le.assertArgCount(arguments,0,0);let e=new $R;return e._impl=await this._impl.getCursor(this._options),e}async getDocuments(){Le.assertArgCount(arguments,0,0);let e=await this._impl.getDocuments(this._options),t=new Array(e.length);for(let s=0;s<e.length;s++)t[s]=new e_,t[s]._impl=e[s];return t}async getOne(){Le.assertArgCount(arguments,0,0);let e=await this._impl.getOne(this._options);if(e){let t=new e_;return t._impl=e,t}}lock(){return Le.assertArgCount(arguments,0,0),this._options.lock=!0,this}async replaceOne(e){return Le.assertArgCount(arguments,1,1),e=Ki.verifySodaDoc(e),await this._impl.replaceOne(this._options,e)}async replaceOneAndGet(e){Le.assertArgCount(arguments,1,1),e=Ki.verifySodaDoc(e);let t=await this._impl.replaceOneAndGet(this._options,e);if(t){let s=new e_;return s._impl=t,s}}async remove(){return Le.assertArgCount(arguments,0,0),await this._impl.remove(this._options)}fetchArraySize(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(Number.isInteger(e)&&e>=0,1),this._options.fetchArraySize=e,this}filter(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(Ki.isObject(e),1),this._options.filter=JSON.stringify(e),this}hint(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(typeof e=="string",1),this._options.hint=e,this}key(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(typeof e=="string",1),this._options.key=e,this._options.keys=void 0,this}keys(e){Le.assertArgCount(arguments,1,1),Le.assertParamValue(Array.isArray(e),1);for(let t=0;t<e.length;t++)Le.assertParamValue(typeof e[t]=="string",1);return this._options.keys=e,this._options.key=void 0,this}limit(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(typeof e=="number",1),this._options.limit=e,this}skip(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(typeof e=="number",1),this._options.skip=e,this}version(e){return Le.assertArgCount(arguments,1,1),Le.assertParamValue(typeof e=="string",1),this._options.version=e,this}};c(t_,"SodaOperation");var Wi=t_;Ki.wrapFns(Wi.prototype,"count","getCursor","getDocuments","getOne","remove","replaceOne","replaceOneAndGet");gS.exports=Wi});var i_=P((Pw,yS)=>{"use strict";var Xi=hr(),jR=s_(),Ve=W(),qt=et(),Es=Vt(),r_=class r_{async createIndex(e){Ve.assertArgCount(arguments,1,1),Ve.assertParamValue(qt.isObject(e),1);let t={autoCommit:Es.autoCommit};return await this._impl.createIndex(JSON.stringify(e),t)}async drop(){Ve.assertArgCount(arguments,0,0);let e={autoCommit:Es.autoCommit};return await this._impl.drop(e)}async dropIndex(e,t){let s={autoCommit:Es.autoCommit};return Ve.assertArgCount(arguments,1,2),Ve.assertParamValue(typeof e=="string",1),arguments.length==2&&(Ve.assertParamValue(typeof t=="object",2),t.force!==void 0&&(Ve.assertParamPropValue(typeof t.force=="boolean",2,"force"),s.force=t.force)),await this._impl.dropIndex(e,s)}find(){Ve.assertArgCount(arguments,0,0);let e=new jR;return e._impl=this._impl.find(),e}async getDataGuide(){Ve.assertArgCount(arguments,0,0);let e=new Xi;return e._impl=await this._impl.getDataGuide(),e}async insertMany(e){Ve.assertArgCount(arguments,1,1),Ve.assertParamValue(Array.isArray(e)&&e.length>0,1);let t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=qt.verifySodaDoc(e[r]);let s={autoCommit:Es.autoCommit};await this._impl.insertMany(t,s)}async insertManyAndGet(e,t){let s={autoCommit:Es.autoCommit};Ve.assertArgCount(arguments,1,2),Ve.assertParamValue(Array.isArray(e)&&e.length>0,1),arguments.length==2&&(Ve.assertParamValue(qt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let r=Array(e.length);for(let a=0;a<e.length;a++)r[a]=qt.verifySodaDoc(e[a]);let n=await this._impl.insertManyAndGet(r,s);for(let a=0;a<e.length;a++){let _=r[a]=new Xi;_._impl=n[a]}return r}async insertOne(e){Ve.assertArgCount(arguments,1,1),e=qt.verifySodaDoc(e);let t={autoCommit:Es.autoCommit};await this._impl.insertOne(e,t)}async insertOneAndGet(e,t){let s={autoCommit:Es.autoCommit};Ve.assertArgCount(arguments,1,2),e=qt.verifySodaDoc(e),arguments.length==2&&(Ve.assertParamValue(qt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let r=new Xi;return r._impl=await this._impl.insertOneAndGet(e,s),r}async listIndexes(){return(await this._impl.listIndexes()).map(t=>JSON.parse(t))}get metaData(){return JSON.parse(this._impl.getMetaData())}get name(){return this._impl.getName()}async save(e){Ve.assertArgCount(arguments,1,1),e=qt.verifySodaDoc(e);let t={autoCommit:Es.autoCommit};await this._impl.save(e,t)}async saveAndGet(e,t){Ve.assertArgCount(arguments,1,2),e=qt.verifySodaDoc(e);let s={autoCommit:Es.autoCommit};arguments.length==2&&(Ve.assertParamValue(qt.isObject(t),2),t.hint!==void 0&&(Ve.assertParamPropValue(typeof t.hint=="string",2,"hint"),s.hint=t.hint));let r=new Xi;return r._impl=await this._impl.saveAndGet(e,s),r}async truncate(){Ve.assertArgCount(arguments,0,0),await this._impl.truncate()}};c(r_,"SodaCollection");var zi=r_;qt.wrapFns(zi.prototype,"createIndex","drop","dropIndex","getDataGuide","insertMany","insertManyAndGet","insertOne","insertOneAndGet","listIndexes","save","saveAndGet","truncate");yS.exports=zi});var a_=P((Iw,wS)=>{"use strict";var{Buffer:n_}=require("buffer"),LS=i_(),JR=hr(),Et=W(),qs=et(),BS=Vt(),o_=class o_{_getConnection(){return this._connection}async createCollection(e,t){let s={autoCommit:BS.autoCommit};Et.assertArgCount(arguments,1,2),Et.assertParamValue(typeof e=="string",1),arguments.length==2&&(Et.assertParamValue(qs.isObject(t),2),t.mode!==void 0&&(Et.assertParamPropValue(Number.isInteger(t.mode)&&t.mode>0,2,"mode"),s.mode=t.mode),t.metaData!==void 0&&(Et.assertParamPropValue(qs.isObject(t.metaData),2,"metaData"),s.metaData=JSON.stringify(t.metaData)));let r=new LS;return r._impl=await this._impl.createCollection(e,s),r}createDocument(e,t){let s={};Et.assertArgCount(arguments,1,2),Et.assertParamValue(n_.isBuffer(e)||typeof e=="string"||qs.isObject(e),1),arguments.length>1&&(Et.assertParamValue(qs.isObject(t),2),s=t,Et.assertParamPropString(s,2,"key"),Et.assertParamPropString(s,2,"mediaType")),typeof e=="string"?e=n_.from(e):qs.isObject(e)&&(e=n_.from(JSON.stringify(e)));let r=new JR;return r._impl=this._impl.createDocument(e,s),r}async getCollectionNames(e){let t={};return Et.assertArgCount(arguments,0,1),arguments.length==1&&(Et.assertParamValue(qs.isObject(e),1),t=e,t.startsWith!==void 0&&Et.assertParamPropValue(typeof t.startsWith=="string",1,"startsWith"),t.limit!==void 0&&Et.assertParamPropValue(Number.isInteger(t.limit),1,"limit")),await this._impl.getCollectionNames(t)}async openCollection(e){Et.assertArgCount(arguments,1,1),Et.assertParamValue(typeof e=="string",1);let t={autoCommit:BS.autoCommit},s=await this._impl.openCollection(e,t);if(s){let r=new LS;return r._impl=s,r}}};c(o_,"SodaDatabase");var $i=o_;qs.wrapFns($i.prototype,"createCollection","getCollectionNames","openCollection");wS.exports=$i});var l_=P((Cw,VS)=>{"use strict";var QR=ja(),Sr=Er(),{Buffer:US}=require("buffer"),__=xs(),ji=bi(),ZR=a_(),eI=require("events"),tI=qa(),f=W(),Ne=et(),Ji=lr(),sI=require("process"),rI=require("util"),Be=nt(),c_=Vt(),YS=qi(),De=lt(),MS=Mi(),br=new Map,T_=class T_ extends eI{constructor(){super(),this._dbObjectClasses=new Map,this._closing=!1}_addDefaultsToExecOpts(e){e.connection=this,e.keepInStmtCache===void 0&&(e.keepInStmtCache=!0),c_.addToOptions(e,"autoCommit","dbObjectAsPojo","fetchArraySize","fetchTypeHandler","maxRows","outFormat","prefetchRows")}_buildDbObjectClass(e){let t=c(function(s){if(this._impl=new Ji.DbObjectImpl(e),this.isCollection){let r=new Proxy(this,Sr._collectionProxyHandler);if(s!==void 0)for(let n=0;n<s.length;n++)this.append(s[n]);return r}else s!==void 0&&Object.assign(this,s)},"DbObject");if(t.prototype=Object.create(Sr.prototype),t.prototype.constructor=t,t.prototype._objType=e,e.elementTypeClass){let s=this._getDbObjectClass(e.elementTypeClass);e.elementTypeClass=s}if(e.isCollection&&(Ne.addTypeProperties(e,"elementType"),e.elementTypeInfo.type=e.elementType),e.attributes){let s={};for(let r of e.attributes){r.typeClass&&(r.typeClass=this._getDbObjectClass(r.typeClass)),Ne.addTypeProperties(r,"type");let n={get(){return this._getAttrValue(r)},set(a){this._setAttrValue(r,a)}};s[r.name]=n}Object.defineProperties(t.prototype,s)}return t.toString=function(){return"DbObjectClass ["+e.fqn+"]"},t}_getDbObjectClass(e){if(e.prototype instanceof Sr)return e;let t=this._dbObjectClasses.get(e);return t||(t=this._buildDbObjectClass(e),t._connection=this,t._objType=e,e._connection=this._impl,this._dbObjectClasses.set(e,t)),t}async _getDbObjectClassForName(e){let t=this._dbObjectClasses.get(e);if(!t){let s=await this._impl.getDbObjectClass(e);t=this._getDbObjectClass(s),this._dbObjectClasses.set(e,t)}return t}_isBindDir(e){return e===Be.BIND_IN||e===Be.BIND_OUT||e===Be.BIND_INOUT}_isBindValue(e){return e==null||typeof e=="number"||typeof e=="string"||typeof e=="boolean"||typeof e=="bigint"||Array.isArray(e)||Ne.isVectorValue(e)||US.isBuffer(e)||rI.types.isDate(e)||e instanceof __||e instanceof ji||e instanceof Sr}async _processBindUnit(e,t,s){let r=!1;if(t.dir===void 0?e.dir=Be.BIND_IN:(f.assert(this._isBindDir(t.dir),f.ERR_INVALID_BIND_DIRECTION),e.dir=t.dir,r=!0),t.type!==void 0?(typeof t.type=="string"?(e.type=De.DB_TYPE_OBJECT,e.typeClass=await this._getDbObjectClassForName(t.type),e.objType=e.typeClass._objType):t.type.prototype instanceof Sr?(e.type=De.DB_TYPE_OBJECT,e.typeClass=t.type,e.objType=e.typeClass._objType):(f.assert(t.type instanceof De.DbType,f.ERR_INVALID_BIND_DATA_TYPE,2),e.type=t.type),r=!0):s&&(e.name&&f.throwErr(f.ERR_MISSING_TYPE_BY_NAME,e.name),f.throwErr(f.ERR_MISSING_TYPE_BY_POS,e.pos)),(e.dir!==Be.BIND_IN||s)&&(t.maxSize!==void 0?(f.assertParamPropValue(Number.isInteger(t.maxSize)&&t.maxSize>0,2,"maxSize"),e.maxSize=t.maxSize,e.checkSize=!0,r=!0):s?(e.type===De.DB_TYPE_VARCHAR||e.type===De.DB_TYPE_RAW)&&(e.name&&f.throwErr(f.ERR_MISSING_MAX_SIZE_BY_NAME,e.name),f.throwErr(f.ERR_MISSING_MAX_SIZE_BY_POS,e.pos)):e.maxSize=Be.DEFAULT_MAX_SIZE_FOR_OUT_BINDS),e.isArray=!1,s||t.maxArraySize!==void 0&&(f.assertParamPropValue(Number.isInteger(t.maxArraySize)&&t.maxArraySize>0,2,"maxArraySize"),e.maxArraySize=t.maxArraySize,e.isArray=!0),!s&&t.val!==void 0)return t.val;r||f.throwErr(f.ERR_INVALID_BIND_UNIT)}async _processBindValue(e,t,s){let r=YS.transformValueIn(e,t,s);e.isArray?e.values=r.concat(e.values.slice(r.length)):e.values[s.pos]=r,e.type===De.DB_TYPE_OBJECT&&e.typeClass===void 0&&(e.typeClass=await this._getDbObjectClass(t._objType),e.objType=e.typeClass._objType)}async _processExecuteBind(e,t){e.isArray=!1;let s;if(this._isBindValue(t)?(e.dir=Be.BIND_IN,s=t):s=await this._processBindUnit(e,t,!1),e.dir!==Be.BIND_OUT){let r={pos:0,allowArray:!0};await this._processBindValue(e,s,r)}e.type===void 0&&(e.type=De.DB_TYPE_VARCHAR,e.maxSize===void 0&&(e.maxSize=1)),e.isArray&&e.type!==De.DB_TYPE_VARCHAR&&e.type!==De.DB_TYPE_NVARCHAR&&e.type!==De.DB_TYPE_CHAR&&e.type!==De.DB_TYPE_NCHAR&&e.type!==De.DB_TYPE_NUMBER&&e.type!==De.DB_TYPE_BINARY_FLOAT&&e.type!==De.DB_TYPE_BINARY_DOUBLE&&e.type!==De.DB_TYPE_DATE&&e.type!==De.DB_TYPE_TIMESTAMP&&e.type!==De.DB_TYPE_TIMESTAMP_LTZ&&e.type!==De.DB_TYPE_TIMESTAMP_TZ&&e.type!==De.DB_TYPE_RAW&&f.throwErr(f.ERR_INVALID_TYPE_FOR_ARRAY_BIND)}async _processExecuteBinds(e){let t=[];if(Array.isArray(e))for(let s=0;s<e.length;s++){let r=t[s]={pos:s+1,values:[]};await this._processExecuteBind(r,e[s])}else{f.assertParamValue(Ne.isObject(e),2);let s=Object.getOwnPropertyNames(e);for(let r=0;r<s.length;r++){let n=t[r]={name:s[r],values:[]};await this._processExecuteBind(n,e[s[r]])}}return t}async _processExecuteManyBinds(e,t){let s=[],r;if(t!==void 0)if(Array.isArray(t)){r=!0;for(let n=0;n<t.length;n++){let a=s[n]={pos:n+1,values:[]};await this._processBindUnit(a,t[n],!0)}}else{r=!1;let n=Object.getOwnPropertyNames(t);for(let a=0;a<n.length;a++){let _=s[a]={name:n[a],values:[]};await this._processBindUnit(_,t[n[a]],!0)}}else{let n=e[0];if(f.assertParamValue(Ne.isObjectOrArray(n),2),Array.isArray(n)){r=!0;for(let a=0;a<n.length;a++)s[a]={pos:a+1}}else{r=!1;let a=Object.getOwnPropertyNames(n);for(let _=0;_<a.length;_++)s[_]={name:a[_]}}for(let a=0;a<s.length;a++)s[a].dir=Be.BIND_IN,s[a].isArray=!1,s[a].values=[]}for(let n=0;n<e.length;n++){let a=e[n],_={pos:n,allowArray:!1};f.assert(r&&Array.isArray(a)||!r&&Ne.isObject(a),f.ERR_MIXED_BIND);for(let T=0;T<s.length;T++){let l=s[T],E=r?a[T]:a[l.name];await this._processBindValue(l,E,_)}}for(let n=0;n<s.length;n++){let a=s[n];a.type===void 0&&(a.type=De.DB_TYPE_VARCHAR,a.maxSize=1)}return s}_transformOutBind(e,t){let s=e;if(Array.isArray(e)){s=[];for(let r=0;r<e.length;r++)s.push(this._transformOutBind(e[r],t))}else if(e instanceof Ji.ResultSetImpl)s=new ji,s._setup(this,e);else if(e instanceof Ji.LobImpl)s=new __,s._setup(e,!0);else if(e instanceof Ji.DbObjectImpl){let r=this._dbObjectClasses.get(e._objType);s=Object.create(r.prototype),s._impl=e,t.dbObjectAsPojo?s=s._toPojo():s.isCollection&&(s=new Proxy(s,Sr._collectionProxyHandler))}return s}_verifyExecOpts(e,t){let s={};if(f.assertParamValue(Ne.isObject(e),3),e.autoCommit!==void 0&&(f.assertParamPropValue(typeof e.autoCommit=="boolean",3,"autoCommit"),s.autoCommit=e.autoCommit),e.dbObjectAsPojo!==void 0&&(f.assertParamPropValue(typeof e.dbObjectAsPojo=="boolean",3,"dbObjectAsPojo"),s.dbObjectAsPojo=e.dbObjectAsPojo),e.keepInStmtCache!==void 0&&(f.assertParamPropValue(typeof e.keepInStmtCache=="boolean",3,"keepInStmtCache"),s.keepInStmtCache=e.keepInStmtCache),t)e.bindDefs!==void 0&&(f.assertParamPropValue(Ne.isObjectOrArray(e.bindDefs),3,"bindDefs"),s.bindDefs=e.bindDefs),e.batchErrors!==void 0&&(f.assertParamPropValue(typeof e.batchErrors=="boolean",3,"batchErrors"),s.batchErrors=e.batchErrors),e.dmlRowCounts!==void 0&&(f.assertParamPropValue(typeof e.dmlRowCounts=="boolean",3,"dmlRowCounts"),s.dmlRowCounts=e.dmlRowCounts);else{if(f.assertParamPropUnsignedIntNonZero(e,3,"fetchArraySize"),s.fetchArraySize=e.fetchArraySize,e.fetchInfo!==void 0){f.assertParamPropValue(Ne.isObject(e.fetchInfo),3,"fetchInfo");let r=Object.getOwnPropertyNames(e.fetchInfo),n=new Map(c_.fetchTypeMap);for(let a of r){let _=e.fetchInfo[a];_.type===void 0&&f.throwErr(f.ERR_NO_TYPE_FOR_CONVERSION),_.type!==Be.DEFAULT&&_.type!==De.DB_TYPE_VARCHAR&&_.type!==De.DB_TYPE_RAW&&f.throwErr(f.ERR_INVALID_TYPE_FOR_CONVERSION),n.set(a,_.type)}s.fetchTypeMap=n}if(e.fetchTypeHandler!==void 0){let r=typeof e.fetchTypeHandler;f.assertParamPropValue(r==="function",3,"fetchTypeHandler"),s.fetchTypeHandler=e.fetchTypeHandler}e.maxRows!==void 0&&(f.assertParamPropValue(Number.isInteger(e.maxRows)&&e.maxRows>=0,3,"maxRows"),s.maxRows=e.maxRows),e.outFormat!==void 0&&(f.assertParamPropValue(e.outFormat===Be.OUT_FORMAT_ARRAY||e.outFormat===Be.OUT_FORMAT_OBJECT,3,"outFormat"),s.outFormat=e.outFormat),e.prefetchRows!==void 0&&(f.assertParamPropValue(Number.isInteger(e.prefetchRows)&&e.prefetchRows>=0,3,"prefetchRows"),s.prefetchRows=e.prefetchRows),e.resultSet!==void 0&&(f.assertParamPropValue(typeof e.resultSet=="boolean",3,"resultSet"),s.resultSet=e.resultSet)}return s}get action(){return null}set action(e){f.assertPropValue(typeof e=="string","action"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setAction(e)}async breakExecution(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.breakExecution()}get callTimeout(){if(this._impl)return this._impl.getCallTimeout()}set callTimeout(e){f.assertPropValue(Number.isInteger(e)&&e>=0,"callTimeout"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setCallTimeout(e)}async changePassword(e,t,s){f.assertArgCount(arguments,3,3),f.assertParamValue(typeof e=="string",1),f.assertParamValue(typeof t=="string",2),f.assertParamValue(typeof s=="string",3),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.changePassword(e,t,s)}get clientId(){return null}set clientId(e){f.assertPropValue(typeof e=="string","clientId"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setClientId(e)}get clientInfo(){return null}set clientInfo(e){f.assertPropValue(typeof e=="string","clientInfo"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setClientInfo(e)}async close(e){let t={};f.assertArgCount(arguments,0,1),arguments.length==1&&(f.assertParamValue(Ne.isObject(e),1),t=e,f.assertParamPropBool(t,1,"drop")),f.assert(this._impl&&!this._closing,f.ERR_INVALID_CONNECTION),this._closing=!0;try{await this._impl.close(t)}finally{this._closing=!1}delete this._impl,this._dbObjectClasses.clear(),this.emit("_afterConnClose")}async commit(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.commit()}async createLob(e){f.assertArgCount(arguments,1,1),f.assertParamValue(e===De.DB_TYPE_CLOB||e===De.DB_TYPE_BLOB||e===De.DB_TYPE_NCLOB,1),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let t=new __;return t._setup(await this._impl.createLob(e),!1),t}get currentSchema(){if(this._impl)return this._impl.getCurrentSchema()}set currentSchema(e){f.assertPropValue(typeof e=="string","currentSchema"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setCurrentSchema(e)}get dbOp(){return null}set dbOp(e){f.assertPropValue(typeof e=="string","dbOp"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setDbOp(e)}get thin(){return c_.thin}get ecid(){return null}set ecid(e){f.assertPropValue(typeof e=="string","ecid"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setECID(e)}decodeOSON(e){return f.assertArgCount(arguments,1,1),f.assertParamValue(US.isBuffer(e),1),new MS.OsonDecoder(e).decode()}encodeOSON(e){return new MS.OsonEncoder().encode(YS.transformJsonValue(e),this._impl._osonMaxFieldNameSize)}async execute(e,t,s){let n=[],a={};Ne.isObject(e)&&typeof e.statement=="string"?(f.assertArgCount(arguments,1,2),e.values&&(n=await this._processExecuteBinds(e.values)),e=e.statement,arguments.length==2&&(a=this._verifyExecOpts(t,!1))):(f.assertArgCount(arguments,1,3),f.assertParamValue(typeof e=="string",1),arguments.length>=2&&(n=await this._processExecuteBinds(t)),arguments.length==3&&(a=this._verifyExecOpts(s,!1))),this._addDefaultsToExecOpts(a),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let _;try{_=await this._impl.execute(e,1,n,a,!1)}catch(T){throw T.errorNum===1406&&f.throwErr(f.ERR_INSUFFICIENT_BUFFER_FOR_BINDS),T}if(_.warning&&(_.warning=f.transformErr(_.warning)),_.resultSet!==void 0){let T=new ji;T._setup(this,_.resultSet),_.metaData=T._impl.metaData,a.resultSet?_.resultSet=T:(_.rows=await T._getAllRows(),delete _.resultSet)}if(_.outBinds!==void 0)for(let[T,l]of Object.entries(_.outBinds)){let E=this._transformOutBind(l,a);_.outBinds[T]=E}if(_.implicitResults)for(let[T,l]of Object.entries(_.implicitResults)){let E=new ji;E._setup(this,l),a.resultSet?_.implicitResults[T]=E:_.implicitResults[T]=await E._getAllRows()}return _}async executeMany(e,t,s){let r={},n=[],a;f.assertArgCount(arguments,2,3),f.assertParamValue(typeof e=="string",1),arguments.length==3&&(r=this._verifyExecOpts(s,!0)),this._addDefaultsToExecOpts(r),typeof t=="number"?(f.assertParamValue(Number.isInteger(t)&&t>0,2),a=t,r.bindDefs!==void 0&&(n=await this._processExecuteManyBinds([],r.bindDefs))):(f.assertParamValue(Array.isArray(t)&&t.length>0,2),a=t.length,n=await this._processExecuteManyBinds(t,r.bindDefs)),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let _=await this._impl.execute(e,a,n,r,!0);if(_.warning&&(_.warning=f.transformErr(_.warning)),_.outBinds!==void 0)for(let T=0;T<_.outBinds.length;T++){let l=_.outBinds[T];for(let[E,h]of Object.entries(l))l[E]=this._transformOutBind(h,r)}return _}get externalName(){if(this._impl)return this._impl.getExternalName()}set externalName(e){f.assertPropValue(typeof e=="string","externalName"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setExternalName(e)}get dbDomain(){return this._impl&&this._impl.getDbDomain()}get dbName(){return this._impl&&this._impl.getDbName()}async getDbObjectClass(e){return f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._getDbObjectClassForName(e)}async getQueue(e,t){let s={};f.assertArgCount(arguments,1,2),f.assertParamValue(typeof e=="string",1),arguments.length==2&&(f.assertParamValue(Ne.isObject(t),2),s={...t}),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let r=new QR;return await r.create(this,e,s),r}getSodaDatabase(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let e=new ZR;return e._impl=this._impl.getSodaDatabase(),e}async getStatementInfo(e){f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let t=await this._impl.getStatementInfo(e);if(t.metaData)for(let s=0;s<t.metaData.length;s++){let r=t.metaData[s];Ne.addTypeProperties(r,"dbType"),r.fetchType=De.DB_TYPE_FETCH_TYPE_MAP.get(r.dbType)}return t}get instanceName(){if(this._impl)return this._impl.getInstanceName()}get internalName(){if(this._impl)return this._impl.getInternalName()}set internalName(e){f.assertPropValue(typeof e=="string","internalName"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setInternalName(e)}isHealthy(){return this._impl!==void 0&&!this._closing&&this._impl.isHealthy()}get maxOpenCursors(){return this._impl&&this._impl.getMaxOpenCursors()}get warning(){let e=this._impl.getWarning();return e&&(e=f.transformErr(e)),this._impl&&e}get module(){return null}set module(e){f.assertPropValue(typeof e=="string","module"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setModule(e)}get oracleServerVersion(){if(this._impl)return this._impl.getOracleServerVersion()}get oracleServerVersionString(){if(this._impl)return this._impl.getOracleServerVersionString()}get serviceName(){return this._impl&&this._impl.getServiceName()}get transactionInProgress(){return this._impl&&this._impl.getTransactionInProgress()}async ping(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.ping()}queryStream(e,t,s){f.assertArgCount(arguments,1,3),f.assertParamValue(typeof e=="string",1),arguments.length==3?(f.assertParamValue(Ne.isObject(s),3),s={...s}):s={},s.resultSet=!0;let r=new tI;return sI.nextTick(async()=>{try{let n=await this.execute(e,t||[],s);n.resultSet||f.throwErr(f.ERR_NOT_A_QUERY),r._open(n.resultSet)}catch(n){r.destroy(n);return}}),r}async rollback(){f.assertArgCount(arguments,0,0),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.rollback()}async shutdown(e){let t=Be.SHUTDOWN_MODE_DEFAULT;f.assertArgCount(arguments,0,1),e!==void 0&&(f.assertParamValue(typeof t=="number",1),t=e),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.shutdown(t)}async startup(e){let t={};f.assertArgCount(arguments,0,1),arguments.length==1&&(f.assertParamValue(typeof t=="object",1),t=e,f.assertParamPropBool(t,1,"force"),f.assertParamPropBool(t,1,"restrict"),f.assertParamPropString(t,1,"pfile")),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.startup(t)}get stmtCacheSize(){if(this._impl)return this._impl.getStmtCacheSize()}set stmtCacheSize(e){f.assertPropValue(Number.isInteger(e)&&e>=0,"stmtCacheSize"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setStmtCacheSize(e)}async subscribe(e,t){f.assertArgCount(arguments,2,2),f.assertParamValue(typeof e=="string",1),f.assertParamValue(Ne.isObject(t),2),t={name:e,...t},f.assertParamPropUnsignedInt(t,2,"namespace"),t.namespace===void 0&&(t.namespace=Be.SUBSCR_NAMESPACE_DBCHANGE),f.assertParamPropString(t,2,"ipAddress"),f.assertParamPropUnsignedInt(t,2,"port"),f.assertParamPropUnsignedInt(t,2,"timeout"),f.assertParamPropUnsignedInt(t,2,"operations"),f.assertParamPropUnsignedInt(t,2,"qos"),f.assertParamPropUnsignedInt(t,2,"groupingClass"),f.assertParamPropUnsignedInt(t,2,"groupingValue"),f.assertParamPropUnsignedInt(t,2,"groupingType"),f.assertParamPropBool(t,2,"clientInitiated"),f.assertParamPropFunction(t,2,"callback"),f.assert(t.callback,f.ERR_MISSING_SUBSCR_CALLBACK),t.namespace===Be.SUBSCR_NAMESPACE_DBCHANGE&&(f.assertParamPropString(t,2,"sql"),f.assert(t.sql&&t.sql.length>0,f.ERR_MISSING_SUBSCR_SQL),t.binds!==void 0&&(t.binds=await this._processExecuteBinds(t.binds))),f.assert(this._impl,f.ERR_INVALID_CONNECTION);let s=br.get(e),r=await this._impl.subscribe(s,t),n;return t.namespace===Be.SUBSCR_NAMESPACE_DBCHANGE?(n=r.subscription,delete r.subscription):n=r,br.set(e,n),r}get tag(){if(this._impl)return this._impl.getTag()}set tag(e){f.assertPropValue(typeof e=="string","tag"),f.assert(this._impl,f.ERR_INVALID_CONNECTION),this._impl.setTag(e)}async tpcBegin(e,t,s){f.assertArgCount(arguments,1,3),f.assertParamValue(Ne.isXid(e),1);let r=Ne.normalizeXid(e);arguments.length<3?s=60:f.assertParamValue(typeof s=="number",3),arguments.length<2?t=Be.TPC_BEGIN_NEW:(f.assertParamValue(typeof t=="number",2),[Be.TPC_BEGIN_NEW,Be.TPC_BEGIN_JOIN,Be.TPC_BEGIN_RESUME,Be.TPC_BEGIN_PROMOTE].indexOf(t)<0&&f.throwErr(f.ERR_INVALID_TPC_BEGIN_FLAGS)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcBegin(r,t,s)}async tpcCommit(e,t){f.assertArgCount(arguments,0,2),arguments.length<2?t=!1:f.assertParamValue(typeof t=="boolean",2);let s;arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),s=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcCommit(s,t)}async tpcEnd(e,t){f.assertArgCount(arguments,0,2),arguments.length<2?t=Be.TPC_END_NORMAL:(f.assertParamValue(typeof t=="number",2),[Be.TPC_END_NORMAL,Be.TPC_END_SUSPEND].includes(t)||f.throwErr(f.ERR_INVALID_TPC_END_FLAGS));let s;arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),s=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcEnd(s,t)}async tpcForget(e){f.assertArgCount(arguments,1,1),f.assertParamValue(Ne.isXid(e),1);let t=Ne.normalizeXid(e);f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcForget(t)}async tpcPrepare(e){f.assertArgCount(arguments,0,1);let t;return arguments.length>=1&&(f.assertParamValue(Ne.isXid(e),1),t=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcPrepare(t)}async tpcRecover(e){f.assertArgCount(arguments,0,1),arguments.length==1?f.assertParamValue(typeof e=="boolean",1):e=!0;let t=`
      SELECT
          formatid as "formatId",
          UTL_RAW.CAST_TO_VARCHAR2(globalid) as "globalTransactionId",
          UTL_RAW.CAST_TO_VARCHAR2(branchid) as "branchQualifier"
      FROM DBA_PENDING_TRANSACTIONS`,s=`
      SELECT
          formatid as "formatId",
          globalid as "globalTransactionId",
          branchid as "branchQualifier"
      FROM DBA_PENDING_TRANSACTIONS`,r={outFormat:Be.OUT_FORMAT_OBJECT,resultSet:!1};return(await this.execute(e?t:s,{},r)).rows}async tpcRollback(e){f.assertArgCount(arguments,0,1);let t;arguments.length==1&&(f.assertParamValue(Ne.isXid(e),1),t=Ne.normalizeXid(e)),f.assert(this._impl,f.ERR_INVALID_CONNECTION),await this._impl.tpcRollback(t)}async unsubscribe(e){f.assertArgCount(arguments,1,1),f.assertParamValue(typeof e=="string",1),f.assert(this._impl,f.ERR_INVALID_CONNECTION),f.assert(br.has(e),f.ERR_INVALID_SUBSCR),await this._impl.unsubscribe(br.get(e)),br.delete(e)}};c(T_,"Connection");var Qt=T_;Qt.prototype.break=Ne.callbackify(Qt.prototype.breakExecution);Qt.prototype.tpcRecover=Ne.callbackify(Qt.prototype.tpcRecover);Ne.wrapFns(Qt.prototype,"changePassword","close","commit","createLob","execute","executeMany","getDbObjectClass","getQueue","getStatementInfo","ping","rollback","shutdown","startup","subscribe","tpcBegin","tpcCommit","tpcEnd","tpcForget","tpcPrepare","tpcRollback","unsubscribe");Qt.prototype.release=Qt.prototype.close;VS.exports=Qt});var h_=P((gw,FS)=>{"use strict";var iI=require("process"),nI=Vt(),u_=class u_{constructor(e){let t=0;e._totalRequestsEnqueued!==0&&(t=Math.round(e._totalTimeInQueue/e._totalRequestsEnqueued)),this.gatheredDate=Date.now(),this.upTime=this.gatheredDate-e._createdDate,this.upTimeSinceReset=this.gatheredDate-e._timeOfReset,this.connectionRequests=e._totalConnectionRequests,this.requestsEnqueued=e._totalRequestsEnqueued,this.requestsDequeued=e._totalRequestsDequeued,this.failedRequests=e._totalFailedRequests,this.rejectedRequests=e._totalRequestsRejected,this.requestTimeouts=e._totalRequestTimeouts,this.maximumQueueLength=e._maximumQueueLength,this.currentQueueLength=e._connRequestQueue.length,this.timeInQueue=e._totalTimeInQueue,this.minimumTimeInQueue=e._minTimeInQueue,this.maximumTimeInQueue=e._maxTimeInQueue,this.averageTimeInQueue=t,this.connectionsInUse=e.connectionsInUse,this.connectionsOpen=e.connectionsOpen,this.connectString=e.connectString,this.edition=e.edition,this.events=e.events,this.externalAuth=e.externalAuth,this.homogeneous=e.homogeneous,this.poolAlias=e.poolAlias,this.poolIncrement=e.poolIncrement,this.poolMax=e.poolMax,this.poolMaxPerShard=e.poolMaxPerShard,this.poolMin=e.poolMin,this.poolPingInterval=e.poolPingInterval,this.poolPingTimeout=e.poolPingTimeout,this.poolTimeout=e.poolTimeout,this.queueMax=e.queueMax,this.queueTimeout=e.queueTimeout,this.sodaMetaDataCache=e.sodaMetaDataCache,this.stmtCacheSize=e.stmtCacheSize,this.user=e.user,this.threadPoolSize=iI.env.UV_THREADPOOL_SIZE,this.thin=nI.thin}logStatistics(){console.log(`
Driver:`),console.log("...thin mode:",this.thin),console.log("Pool statistics:"),console.log("...gathered at:",new Date(this.gatheredDate).toISOString()),console.log("...up time (milliseconds):",this.upTime),console.log("...up time from last reset (milliseconds)",this.upTimeSinceReset),console.log("...connection requests:",this.connectionRequests),console.log("...requests enqueued:",this.requestsEnqueued),console.log("...requests dequeued:",this.requestsDequeued),console.log("...requests failed:",this.failedRequests),console.log("...requests exceeding queueMax:",this.rejectedRequests),console.log("...requests exceeding queueTimeout:",this.requestTimeouts),console.log("...current queue length:",this.currentQueueLength),console.log("...maximum queue length:",this.maximumQueueLength),console.log("...sum of time in queue (milliseconds):",this.timeInQueue),console.log("...minimum time in queue (milliseconds):",this.minimumTimeInQueue),console.log("...maximum time in queue (milliseconds):",this.maximumTimeInQueue),console.log("...average time in queue (milliseconds):",this.averageTimeInQueue),console.log("...pool connections in use:",this.connectionsInUse),console.log("...pool connections open:",this.connectionsOpen),console.log("Pool attributes:"),console.log("...connectString:",this.connectString),console.log("...edition:",this.edition),console.log("...events:",this.events),console.log("...externalAuth:",this.externalAuth),console.log("...homogeneous:",this.homogeneous),console.log("...poolAlias:",this.poolAlias),console.log("...poolIncrement:",this.poolIncrement),console.log("...poolMax:",this.poolMax),console.log("...poolMaxPerShard:",this.poolMaxPerShard),console.log("...poolMin:",this.poolMin),console.log("...poolPingInterval (seconds):",this.poolPingInterval),console.log("...poolPingTimeout (milliseconds):",this.poolPingTimeout),console.log("...poolTimeout (seconds):",this.poolTimeout),console.log("...queueMax:",this.queueMax),console.log("...queueTimeout (milliseconds):",this.queueTimeout),console.log("...sessionCallback:",this.sessionCallback),console.log("...sodaMetaDataCache:",this.sodaMetaDataCache),console.log("...stmtCacheSize:",this.stmtCacheSize),console.log("...user:",this.user),console.log("Related environment variables:"),console.log("...UV_THREADPOOL_SIZE:",this.threadPoolSize)}};c(u_,"PoolStatistics");var E_=u_;FS.exports=E_});var kS=P((Lw,bS)=>{"use strict";var oI=l_(),aI=require("events"),us=nt(),$=W(),xS=Vt(),Zt=et(),_I=lr(),cI=h_(),N_=class N_ extends aI{constructor(){super(),this._impl=new _I.PoolImpl,this._queueMax=0,this._queueTimeout=0,this._enableStatistics=!1,this._timeOfReset=this._createdDate=Date.now(),this._sessionCallback=void 0,this._connRequestQueue=[],this._connectionClass=xS.connectionClass}_checkPoolOpen(e){this.status===us.POOL_STATUS_DRAINING?$.throwErr($.ERR_POOL_CLOSING):this.status===us.POOL_STATUS_CLOSED?$.throwErr($.ERR_POOL_CLOSED):e||this.status===us.POOL_STATUS_RECONFIGURING&&$.throwErr($.ERR_POOL_RECONFIGURING)}_checkRequestQueue(){let e=this._connectionsOut;for(;this._connRequestQueue.length>0&&e<this.poolMax;){e+=1;let t=this._connRequestQueue.shift();this._enableStatistics&&(this._totalRequestsDequeued+=1,this._updateWaitStatistics(t)),t.timeoutHandle&&clearTimeout(t.timeoutHandle),t.resolve()}}get _enableStats(){return this._enableStatistics}_resetStatistics(){this._timeOfReset=Date.now(),this._totalConnectionRequests=0,this._totalRequestsEnqueued=0,this._totalRequestsDequeued=0,this._totalFailedRequests=0,this._totalRequestsRejected=0,this._totalRequestTimeouts=0,this._maximumQueueLength=this._connRequestQueue.length,this._totalTimeInQueue=0,this._minTimeInQueue=0,this._maxTimeInQueue=0}_setup(e,t){this._queueTimeout=e.queueTimeout,this._queueMax=e.queueMax,this._enableStatistics=e.enableStatistics,this._edition=e.edition,this._eventsFlag=e.events,this._externalAuth=e.externalAuth,this._homogeneous=e.homogeneous,this._user=e.user,this._connectString=e.connectString,this._status=us.POOL_STATUS_OPEN,this._connectionsOut=0,this._poolAlias=t,this.on("_checkRequestQueue",this._checkRequestQueue),this._resetStatistics()}_updateWaitStatistics(e){let t=Date.now()-e.enqueuedTime;this._totalTimeInQueue+=t,this._minTimeInQueue===0?this._minTimeInQueue=t:this._minTimeInQueue=Math.min(this._minTimeInQueue,t),this._maxTimeInQueue=Math.max(this._maxTimeInQueue,t)}_verifyGetConnectionOptions(e){let t={};if(e.user!==void 0&&($.assertParamPropValue(typeof e.user=="string",1,"user"),t.user=e.user),e.username!==void 0&&($.assert(t.user===void 0,$.ERR_DBL_USER),$.assertParamPropValue(typeof e.username=="string",1,"username"),t.user=e.username),this.externalAuth&&t.user&&(t.user[0]!=="["||t.user.slice(-1)!=="]")&&$.throwErr($.ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY),e.password!==void 0&&($.assertParamPropValue(typeof e.password=="string",1,"password"),this.externalAuth&&$.throwErr($.ERR_WRONG_CRED_FOR_EXTAUTH),t.password=e.password),e.tag!==void 0&&($.assertParamPropValue(typeof e.tag=="string",1,"tag"),t.tag=e.tag),e.matchAnyTag!==void 0&&($.assertParamPropValue(typeof e.matchAnyTag=="boolean",1,"matchAnyTag"),t.matchAnyTag=e.matchAnyTag),e.shardingKey!==void 0){let s=e.shardingKey;$.assertParamPropValue(Zt.isShardingKey(s),1,"shardingKey"),t.shardingKey=e.shardingKey}if(e.superShardingKey!==void 0){let s=e.superShardingKey;$.assertParamPropValue(Zt.isShardingKey(s),1,"superShardingKey"),t.superShardingKey=e.superShardingKey}return e.privilege!==void 0&&($.assertParamPropValue(Zt.isPrivilege(e.privilege),1,"privilege"),t.privilege=e.privilege),t}async close(e){let t=0,s=!1;$.assertArgCount(arguments,0,1),arguments.length==1&&($.assertParamValue(typeof e=="number",1),(e<0||isNaN(e)||e>2**31)&&$.throwErr($.ERR_INVALID_PARAMETER_VALUE,1),s=!0,this._connectionsOut>0&&(t=e*1e3)),this._checkPoolOpen(!1),t>0&&(this._status=us.POOL_STATUS_DRAINING,await new Promise(r=>{let n=setTimeout(()=>{this.removeAllListeners("_allCheckedIn"),r()},t);this.once("_allCheckedIn",()=>{clearTimeout(n),r()})})),!s&&this._connectionsOut>0&&$.throwErr($.ERR_POOL_HAS_BUSY_CONNECTIONS),await this._impl.close(),this._status=us.POOL_STATUS_CLOSED,this.emit("_afterPoolClose")}get connectionsInUse(){return this._impl.getConnectionsInUse()}get connectionsOpen(){return this._impl.getConnectionsOpen()}get connectString(){return this._connectString}get thin(){return xS.thin}get edition(){return this._edition}get enableStatistics(){return this._enableStatistics}get events(){return this._eventsFlag}get externalAuth(){return this._externalAuth}async getConnection(e){let t,s={};$.assertArgCount(arguments,0,1),arguments.length==1&&($.assertParamValue(Zt.isObject(e),1),s=this._verifyGetConnectionOptions(e)),s.connectionClass=this._connectionClass,this._checkPoolOpen(!0),this._enableStatistics&&(this._totalConnectionRequests+=1);try{t=this.poolMax}catch(r){throw this._enableStatistics&&(this._totalFailedRequests+=1),r}(this._connectionsOut>=t||this.status===us.POOL_STATUS_RECONFIGURING)&&(this._connRequestQueue.length>=this._queueMax&&this._queueMax>=0&&(this._enableStatistics&&(this._totalRequestsRejected+=1),$.throwErr($.ERR_QUEUE_MAX_EXCEEDED,this._queueMax)),await new Promise((r,n)=>{let a={resolve:r,reject:n};this._queueTimeout!==0&&(a.timeoutHandle=setTimeout(()=>{let _=this._connRequestQueue.indexOf(a);_>=0&&this._connRequestQueue.splice(_,1),this._enableStatistics&&(this._totalRequestTimeouts+=1,this._updateWaitStatistics(a));try{$.throwErr($.ERR_CONN_REQUEST_TIMEOUT,this._queueTimeout)}catch(T){n(T)}},this._queueTimeout)),this._connRequestQueue.push(a),this._enableStatistics&&(a.enqueuedTime=Date.now(),this._totalRequestsEnqueued+=1,this._maximumQueueLength=Math.max(this._maximumQueueLength,this._connRequestQueue.length))}),this._checkPoolOpen(!0)),this._connectionsOut+=1;try{let r=new oI;r._impl=await this._impl.getConnection(s),r._pool=this;let n=s.tag||"";if(typeof this.sessionCallback=="function"&&(r._impl._newSession||r.tag!=n))try{await new Promise((a,_)=>{this.sessionCallback(r,n,function(T){T?_(T):a()})})}catch(a){throw await r.close({drop:!0}),a}return r.on("_afterConnClose",()=>{this._connectionsOut-=1,this.emit("_checkRequestQueue"),this._connectionsOut==0&&this.emit("_allCheckedIn")}),r}catch(r){throw this._connectionsOut-=1,this._enableStatistics&&(this._totalFailedRequests+=1),this.emit("_checkRequestQueue"),r}}getStatistics(){return this._checkPoolOpen(!1),this._enableStatistics!==!0?null:new cI(this)}get homogeneous(){return this._homogeneous}logStatistics(){let e=this.getStatistics();e===null&&$.throwErr($.ERR_POOL_STATISTICS_DISABLED),e.logStatistics()}get poolAlias(){return this._poolAlias}get poolIncrement(){return this._impl.getPoolIncrement()}get poolMax(){return this._impl.getPoolMax()}get poolMaxPerShard(){return this._impl.getPoolMaxPerShard()}get poolMin(){return this._impl.getPoolMin()}get poolPingInterval(){return this._impl.getPoolPingInterval()}get poolPingTimeout(){return this._impl.getPoolPingTimeout()}get poolTimeout(){return this._impl.getPoolTimeout()}get queueMax(){return this._queueMax}get queueTimeout(){return this._queueTimeout}async reconfigure(e){$.assertArgCount(arguments,1,1),$.assertParamValue(Zt.isObject(e)),$.assertParamPropUnsignedInt(e,1,"queueMax"),$.assertParamPropUnsignedInt(e,1,"queueTimeout"),$.assertParamPropBool(e,1,"enableStatistics"),$.assertParamPropBool(e,1,"resetStatistics"),$.assertParamPropUnsignedInt(e,1,"poolMin"),$.assertParamPropUnsignedIntNonZero(e,1,"poolMax"),$.assertParamPropUnsignedInt(e,1,"poolMaxPerShard"),$.assertParamPropUnsignedInt(e,1,"poolIncrement"),$.assertParamPropInt(e,1,"poolPingInterval"),$.assertParamPropUnsignedInt(e,1,"poolTimeout"),$.assertParamPropUnsignedInt(e,1,"stmtCacheSize"),$.assertParamPropBool(e,1,"sodaMetaDataCache"),e.poolMin>e.poolMax&&$.throwErr($.ERR_INVALID_NUMBER_OF_CONNECTIONS,e.poolMax,e.poolMin),this._checkPoolOpen(!1),this._status=us.POOL_STATUS_RECONFIGURING;try{await this._impl.reconfigure(e),(e.resetStatistics==!0||e.enableStatistics==!0&&this._enableStatistics==!1)&&this._resetStatistics(),e.queueMax!==void 0&&(this._queueMax=e.queueMax),e.queueTimeout!==void 0&&(this._queueTimeout=e.queueTimeout),e.enableStatistics!==void 0&&(this._enableStatistics=e.enableStatistics)}finally{this._status=us.POOL_STATUS_OPEN}this.emit("_checkRequestQueue")}get sessionCallback(){return this._sessionCallback}async setAccessToken(e){$.assertArgCount(arguments,1,1),$.assertParamValue(Zt.isObject(e),1),$.assertParamPropString(e,1,"token"),$.assertParamPropString(e,1,"privateKey"),await this._impl.setAccessToken(e)}get sodaMetaDataCache(){return this._impl.getSodaMetaDataCache()}get status(){return this._status}get stmtCacheSize(){return this._impl.getStmtCacheSize()}get user(){return this._user}};c(N_,"Pool");var ft=N_;ft.prototype.close=Zt.callbackify(ft.prototype.close);ft.prototype.getConnection=Zt.callbackify(ft.prototype.getConnection);ft.prototype.reconfigure=Zt.callbackify(ft.prototype.reconfigure);ft.prototype.setAccessToken=Zt.callbackify(ft.prototype.setAccessToken);ft.prototype.terminate=ft.prototype.close;ft.prototype._logStats=ft.prototype.logStatistics;bS.exports=ft});var we=P((ww,HS)=>{"use strict";var{Buffer:qS}=require("buffer"),Qe=nt(),GS=Ur();HS.exports={BIND_IN:Qe.BIND_IN,BIND_INOUT:Qe.BIND_INOUT,BIND_OUT:Qe.BIND_OUT,CLIENT_VERSION:Qe.VERSION_MAJOR<<24|Qe.VERSION_MINOR<<20|Qe.VERSION_PATCH<<12,CSFRM_IMPLICIT:Qe.CSFRM_IMPLICIT,CSFRM_NCHAR:Qe.CSFRM_NCHAR,DRIVER_NAME:Qe.DEFAULT_DRIVER_NAME+" thn",PURITY_DEFAULT:Qe.PURITY_DEFAULT,PURITY_NEW:Qe.PURITY_NEW,PURITY_SELF:Qe.PURITY_SELF,SYSASM:Qe.SYSASM,SYSBKP:Qe.SYSBKP,SYSDBA:Qe.SYSDBA,SYSDG:Qe.SYSDG,SYSKM:Qe.SYSKM,SYSOPER:Qe.SYSOPER,SYSRAC:Qe.SYSRAC,AUTH_MODE_DEFAULT:0,AUTH_MODE_PRELIM:8,AUTH_MODE_SYSASM:32768,AUTH_MODE_SYSBKP:131072,AUTH_MODE_SYSDBA:2,AUTH_MODE_SYSDGD:262144,AUTH_MODE_SYSKMT:524288,AUTH_MODE_SYSOPER:4,AUTH_MODE_SYSRAC:1048576,TNS_AUTH_MODE_LOGON:1,TNS_AUTH_MODE_CHANGE_PASSWORD:2,TNS_AUTH_MODE_SYSDBA:32,TNS_AUTH_MODE_SYSOPER:64,TNS_AUTH_MODE_PRELIM:128,TNS_AUTH_MODE_WITH_PASSWORD:256,TNS_AUTH_MODE_SYSASM:4194304,TNS_AUTH_MODE_SYSBKP:16777216,TNS_AUTH_MODE_SYSDGD:33554432,TNS_AUTH_MODE_SYSKMT:67108864,TNS_AUTH_MODE_SYSRAC:134217728,TNS_AUTH_MODE_IAM_TOKEN:536870912,TNS_PACKET_TYPE_CONNECT:1,TNS_PACKET_TYPE_ACCEPT:2,TNS_PACKET_TYPE_REFUSE:4,TNS_PACKET_TYPE_REDIRECT:5,TNS_PACKET_TYPE_DATA:6,TNS_PACKET_TYPE_RESEND:11,TNS_PACKET_TYPE_MARKER:12,TNS_PACKET_TYPE_CONTROL:14,TNS_DATA_TYPE_DEFAULT:0,TNS_DATA_TYPE_VARCHAR:1,TNS_DATA_TYPE_NUMBER:2,TNS_DATA_TYPE_BINARY_INTEGER:3,TNS_DATA_TYPE_FLOAT:4,TNS_DATA_TYPE_STR:5,TNS_DATA_TYPE_VNU:6,TNS_DATA_TYPE_PDN:7,TNS_DATA_TYPE_LONG:8,TNS_DATA_TYPE_VCS:9,TNS_DATA_TYPE_TIDDEF:10,TNS_DATA_TYPE_ROWID:11,TNS_DATA_TYPE_DATE:12,TNS_DATA_TYPE_VBI:15,TNS_DATA_TYPE_RAW:23,TNS_DATA_TYPE_LONG_RAW:24,TNS_DATA_TYPE_UB2:25,TNS_DATA_TYPE_UB4:26,TNS_DATA_TYPE_SB1:27,TNS_DATA_TYPE_SB2:28,TNS_DATA_TYPE_SB4:29,TNS_DATA_TYPE_SWORD:30,TNS_DATA_TYPE_UWORD:31,TNS_DATA_TYPE_PTRB:32,TNS_DATA_TYPE_PTRW:33,TNS_DATA_TYPE_OER8:290,TNS_DATA_TYPE_FUN:291,TNS_DATA_TYPE_AUA:292,TNS_DATA_TYPE_RXH7:293,TNS_DATA_TYPE_NA6:294,TNS_DATA_TYPE_OAC9:39,TNS_DATA_TYPE_AMS:40,TNS_DATA_TYPE_BRN:41,TNS_DATA_TYPE_BRP:298,TNS_DATA_TYPE_BRV:299,TNS_DATA_TYPE_KVA:300,TNS_DATA_TYPE_CLS:301,TNS_DATA_TYPE_CUI:302,TNS_DATA_TYPE_DFN:303,TNS_DATA_TYPE_DQR:304,TNS_DATA_TYPE_DSC:305,TNS_DATA_TYPE_EXE:306,TNS_DATA_TYPE_FCH:307,TNS_DATA_TYPE_GBV:308,TNS_DATA_TYPE_GEM:309,TNS_DATA_TYPE_GIV:310,TNS_DATA_TYPE_OKG:311,TNS_DATA_TYPE_HMI:312,TNS_DATA_TYPE_INO:313,TNS_DATA_TYPE_LNF:315,TNS_DATA_TYPE_ONT:316,TNS_DATA_TYPE_OPE:317,TNS_DATA_TYPE_OSQ:318,TNS_DATA_TYPE_SFE:319,TNS_DATA_TYPE_SPF:320,TNS_DATA_TYPE_VSN:321,TNS_DATA_TYPE_UD7:322,TNS_DATA_TYPE_DSA:323,TNS_DATA_TYPE_UIN:68,TNS_DATA_TYPE_PIN:327,TNS_DATA_TYPE_PFN:328,TNS_DATA_TYPE_PPT:329,TNS_DATA_TYPE_STO:331,TNS_DATA_TYPE_ARC:333,TNS_DATA_TYPE_MRS:334,TNS_DATA_TYPE_MRT:335,TNS_DATA_TYPE_MRG:336,TNS_DATA_TYPE_MRR:337,TNS_DATA_TYPE_MRC:338,TNS_DATA_TYPE_VER:339,TNS_DATA_TYPE_LON2:340,TNS_DATA_TYPE_INO2:341,TNS_DATA_TYPE_ALL:342,TNS_DATA_TYPE_UDB:343,TNS_DATA_TYPE_AQI:344,TNS_DATA_TYPE_ULB:345,TNS_DATA_TYPE_ULD:346,TNS_DATA_TYPE_SLS:91,TNS_DATA_TYPE_SID:348,TNS_DATA_TYPE_NA7:349,TNS_DATA_TYPE_LVC:94,TNS_DATA_TYPE_LVB:95,TNS_DATA_TYPE_CHAR:96,TNS_DATA_TYPE_AVC:97,TNS_DATA_TYPE_AL7:354,TNS_DATA_TYPE_K2RPC:355,TNS_DATA_TYPE_BINARY_FLOAT:100,TNS_DATA_TYPE_BINARY_DOUBLE:101,TNS_DATA_TYPE_CURSOR:102,TNS_DATA_TYPE_RDD:104,TNS_DATA_TYPE_XDP:359,TNS_DATA_TYPE_OSL:106,TNS_DATA_TYPE_OKO8:363,TNS_DATA_TYPE_EXT_NAMED:108,TNS_DATA_TYPE_INT_NAMED:109,TNS_DATA_TYPE_EXT_REF:110,TNS_DATA_TYPE_INT_REF:111,TNS_DATA_TYPE_CLOB:112,TNS_DATA_TYPE_BLOB:113,TNS_DATA_TYPE_BFILE:114,TNS_DATA_TYPE_CFILE:115,TNS_DATA_TYPE_RSET:116,TNS_DATA_TYPE_CWD:117,TNS_DATA_TYPE_JSON:119,TNS_DATA_TYPE_OAC122:120,TNS_DATA_TYPE_UD12:380,TNS_DATA_TYPE_AL8:381,TNS_DATA_TYPE_LFOP:382,TNS_DATA_TYPE_VECTOR:127,TNS_DATA_TYPE_FCRT:383,TNS_DATA_TYPE_DNY:384,TNS_DATA_TYPE_OPR:385,TNS_DATA_TYPE_PLS:386,TNS_DATA_TYPE_XID:387,TNS_DATA_TYPE_TXN:388,TNS_DATA_TYPE_DCB:389,TNS_DATA_TYPE_CCA:390,TNS_DATA_TYPE_WRN:391,TNS_DATA_TYPE_TLH:393,TNS_DATA_TYPE_TOH:394,TNS_DATA_TYPE_FOI:395,TNS_DATA_TYPE_SID2:396,TNS_DATA_TYPE_TCH:397,TNS_DATA_TYPE_PII:398,TNS_DATA_TYPE_PFI:399,TNS_DATA_TYPE_PPU:400,TNS_DATA_TYPE_PTE:401,TNS_DATA_TYPE_CLV:146,TNS_DATA_TYPE_RXH8:404,TNS_DATA_TYPE_N12:405,TNS_DATA_TYPE_AUTH:406,TNS_DATA_TYPE_KVAL:407,TNS_DATA_TYPE_DTR:152,TNS_DATA_TYPE_DUN:153,TNS_DATA_TYPE_DOP:154,TNS_DATA_TYPE_VST:155,TNS_DATA_TYPE_ODT:156,TNS_DATA_TYPE_FGI:413,TNS_DATA_TYPE_DSY:414,TNS_DATA_TYPE_DSYR8:415,TNS_DATA_TYPE_DSYH8:416,TNS_DATA_TYPE_DSYL:417,TNS_DATA_TYPE_DSYT8:418,TNS_DATA_TYPE_DSYV8:419,TNS_DATA_TYPE_DSYP:420,TNS_DATA_TYPE_DSYF:421,TNS_DATA_TYPE_DSYK:422,TNS_DATA_TYPE_DSYY:423,TNS_DATA_TYPE_DSYQ:424,TNS_DATA_TYPE_DSYC:425,TNS_DATA_TYPE_DSYA:426,TNS_DATA_TYPE_OT8:427,TNS_DATA_TYPE_DOL:172,TNS_DATA_TYPE_DSYTY:429,TNS_DATA_TYPE_AQE:430,TNS_DATA_TYPE_KV:431,TNS_DATA_TYPE_AQD:432,TNS_DATA_TYPE_AQ8:433,TNS_DATA_TYPE_TIME:178,TNS_DATA_TYPE_TIME_TZ:179,TNS_DATA_TYPE_TIMESTAMP:180,TNS_DATA_TYPE_TIMESTAMP_TZ:181,TNS_DATA_TYPE_INTERVAL_YM:182,TNS_DATA_TYPE_INTERVAL_DS:183,TNS_DATA_TYPE_EDATE:184,TNS_DATA_TYPE_ETIME:185,TNS_DATA_TYPE_ETTZ:186,TNS_DATA_TYPE_ESTAMP:187,TNS_DATA_TYPE_ESTZ:188,TNS_DATA_TYPE_EIYM:189,TNS_DATA_TYPE_EIDS:190,TNS_DATA_TYPE_RFS:449,TNS_DATA_TYPE_RXH10:450,TNS_DATA_TYPE_DCLOB:195,TNS_DATA_TYPE_DBLOB:196,TNS_DATA_TYPE_DBFILE:197,TNS_DATA_TYPE_DJSON:198,TNS_DATA_TYPE_KPN:454,TNS_DATA_TYPE_KPDNR:455,TNS_DATA_TYPE_DSYD:456,TNS_DATA_TYPE_DSYS:457,TNS_DATA_TYPE_DSYR:458,TNS_DATA_TYPE_DSYH:459,TNS_DATA_TYPE_DSYT:460,TNS_DATA_TYPE_DSYV:461,TNS_DATA_TYPE_AQM:462,TNS_DATA_TYPE_OER11:463,TNS_DATA_TYPE_UROWID:208,TNS_DATA_TYPE_AQL:466,TNS_DATA_TYPE_OTC:467,TNS_DATA_TYPE_KFNO:468,TNS_DATA_TYPE_KFNP:469,TNS_DATA_TYPE_KGT8:470,TNS_DATA_TYPE_RASB4:471,TNS_DATA_TYPE_RAUB2:472,TNS_DATA_TYPE_RAUB1:473,TNS_DATA_TYPE_RATXT:474,TNS_DATA_TYPE_RSSB4:475,TNS_DATA_TYPE_RSUB2:476,TNS_DATA_TYPE_RSUB1:477,TNS_DATA_TYPE_RSTXT:478,TNS_DATA_TYPE_RIDL:479,TNS_DATA_TYPE_GLRDD:480,TNS_DATA_TYPE_GLRDG:481,TNS_DATA_TYPE_GLRDC:482,TNS_DATA_TYPE_OKO:483,TNS_DATA_TYPE_DPP:484,TNS_DATA_TYPE_DPLS:485,TNS_DATA_TYPE_DPMOP:486,TNS_DATA_TYPE_TIMESTAMP_LTZ:231,TNS_DATA_TYPE_ESITZ:232,TNS_DATA_TYPE_UB8:233,TNS_DATA_TYPE_STAT:490,TNS_DATA_TYPE_RFX:491,TNS_DATA_TYPE_FAL:492,TNS_DATA_TYPE_CKV:493,TNS_DATA_TYPE_DRCX:494,TNS_DATA_TYPE_KGH:495,TNS_DATA_TYPE_AQO:496,TNS_DATA_TYPE_PNTY:241,TNS_DATA_TYPE_OKGT:498,TNS_DATA_TYPE_KPFC:499,TNS_DATA_TYPE_FE2:500,TNS_DATA_TYPE_SPFP:501,TNS_DATA_TYPE_DPULS:502,TNS_DATA_TYPE_BOOLEAN:252,TNS_DATA_TYPE_AQA:509,TNS_DATA_TYPE_KPBF:510,TNS_DATA_TYPE_TSM:513,TNS_DATA_TYPE_MSS:514,TNS_DATA_TYPE_KPC:516,TNS_DATA_TYPE_CRS:517,TNS_DATA_TYPE_KKS:518,TNS_DATA_TYPE_KSP:519,TNS_DATA_TYPE_KSPTOP:520,TNS_DATA_TYPE_KSPVAL:521,TNS_DATA_TYPE_PSS:522,TNS_DATA_TYPE_NLS:523,TNS_DATA_TYPE_ALS:524,TNS_DATA_TYPE_KSDEVTVAL:525,TNS_DATA_TYPE_KSDEVTTOP:526,TNS_DATA_TYPE_KPSPP:527,TNS_DATA_TYPE_KOL:528,TNS_DATA_TYPE_LST:529,TNS_DATA_TYPE_ACX:530,TNS_DATA_TYPE_SCS:531,TNS_DATA_TYPE_RXH:532,TNS_DATA_TYPE_KPDNS:533,TNS_DATA_TYPE_KPDCN:534,TNS_DATA_TYPE_KPNNS:535,TNS_DATA_TYPE_KPNCN:536,TNS_DATA_TYPE_KPS:537,TNS_DATA_TYPE_APINF:538,TNS_DATA_TYPE_TEN:539,TNS_DATA_TYPE_XSSCS:540,TNS_DATA_TYPE_XSSSO:541,TNS_DATA_TYPE_XSSAO:542,TNS_DATA_TYPE_KSRPC:543,TNS_DATA_TYPE_KVL:560,TNS_DATA_TYPE_SESSGET:563,TNS_DATA_TYPE_SESSREL:564,TNS_DATA_TYPE_XSSDEF:565,TNS_DATA_TYPE_PDQCINV:572,TNS_DATA_TYPE_PDQIDC:573,TNS_DATA_TYPE_KPDQCSTA:574,TNS_DATA_TYPE_KPRS:575,TNS_DATA_TYPE_KPDQIDC:576,TNS_DATA_TYPE_RTSTRM:578,TNS_DATA_TYPE_SESSRET:579,TNS_DATA_TYPE_SCN6:580,TNS_DATA_TYPE_KECPA:581,TNS_DATA_TYPE_KECPP:582,TNS_DATA_TYPE_SXA:583,TNS_DATA_TYPE_KVARR:584,TNS_DATA_TYPE_KPNGN:585,TNS_DATA_TYPE_XSNSOP:590,TNS_DATA_TYPE_XSATTR:591,TNS_DATA_TYPE_XSNS:592,TNS_DATA_TYPE_TXT:593,TNS_DATA_TYPE_XSSESSNS:594,TNS_DATA_TYPE_XSATTOP:595,TNS_DATA_TYPE_XSCREOP:596,TNS_DATA_TYPE_XSDETOP:597,TNS_DATA_TYPE_XSDESOP:598,TNS_DATA_TYPE_XSSETSP:599,TNS_DATA_TYPE_XSSIDP:600,TNS_DATA_TYPE_XSPRIN:601,TNS_DATA_TYPE_XSKVL:602,TNS_DATA_TYPE_XSSSDEF2:603,TNS_DATA_TYPE_XSNSOP2:604,TNS_DATA_TYPE_XSNS2:605,TNS_DATA_TYPE_IMPLRES:611,TNS_DATA_TYPE_OER19:612,TNS_DATA_TYPE_UB1ARRAY:613,TNS_DATA_TYPE_SESSSTATE:614,TNS_DATA_TYPE_AC_REPLAY:615,TNS_DATA_TYPE_AC_CONT:616,TNS_DATA_TYPE_KPDNREQ:622,TNS_DATA_TYPE_KPDNRNF:623,TNS_DATA_TYPE_KPNGNC:624,TNS_DATA_TYPE_KPNRI:625,TNS_DATA_TYPE_AQENQ:626,TNS_DATA_TYPE_AQDEQ:627,TNS_DATA_TYPE_AQJMS:628,TNS_DATA_TYPE_KPDNRPAY:629,TNS_DATA_TYPE_KPDNRACK:630,TNS_DATA_TYPE_KPDNRMP:631,TNS_DATA_TYPE_KPDNRDQ:632,TNS_DATA_TYPE_CHUNKINFO:636,TNS_DATA_TYPE_SCN:637,TNS_DATA_TYPE_SCN8:638,TNS_DATA_TYPE_UD21:639,TNS_DATA_TYPE_TNP:640,TNS_DATA_TYPE_OAC:646,TNS_DATA_TYPE_OER:652,TNS_DATA_TYPE_UDS:663,TNS_TYPE_REP_NATIVE:0,TNS_TYPE_REP_UNIVERSAL:1,TNS_TYPE_REP_ORACLE:10,TNS_MSG_TYPE_PROTOCOL:1,TNS_MSG_TYPE_DATA_TYPES:2,TNS_MSG_TYPE_FUNCTION:3,TNS_MSG_TYPE_ERROR:4,TNS_MSG_TYPE_ROW_HEADER:6,TNS_MSG_TYPE_ROW_DATA:7,TNS_MSG_TYPE_PARAMETER:8,TNS_MSG_TYPE_STATUS:9,TNS_MSG_TYPE_IO_VECTOR:11,TNS_MSG_TYPE_LOB_DATA:14,TNS_MSG_TYPE_WARNING:15,TNS_MSG_TYPE_DESCRIBE_INFO:16,TNS_MSG_TYPE_PIGGYBACK:17,TNS_MSG_TYPE_FLUSH_OUT_BINDS:19,TNS_MSG_TYPE_BIT_VECTOR:21,TNS_MSG_TYPE_SERVER_SIDE_PIGGYBACK:23,TNS_MSG_TYPE_ONEWAY_FN:26,TNS_MSG_TYPE_IMPLICIT_RESULTSET:27,TNS_MSG_TYPE_RENEGOTIATE:28,TNS_MSG_TYPE_END_OF_REQUEST:29,TNS_MSG_TYPE_FAST_AUTH:34,TNS_KEYWORD_NUM_CURRENT_SCHEMA:168,TNS_KEYWORD_NUM_EDITION:172,TNS_BIND_USE_INDICATORS:1,TNS_BIND_USE_LENGTH:2,TNS_BIND_ARRAY:64,TNS_BIND_DIR_OUTPUT:16,TNS_BIND_DIR_INPUT:32,TNS_BIND_DIR_INPUT_OUTPUT:48,TNS_EXEC_OPTION_PARSE:1,TNS_EXEC_OPTION_BIND:8,TNS_EXEC_OPTION_DEFINE:16,TNS_EXEC_OPTION_EXECUTE:32,TNS_EXEC_OPTION_FETCH:64,TNS_EXEC_OPTION_COMMIT:256,TNS_EXEC_OPTION_COMMIT_REEXECUTE:1,TNS_EXEC_OPTION_PLSQL_BIND:1024,TNS_EXEC_OPTION_DML_ROWCOUNTS:16384,TNS_EXEC_OPTION_NOT_PLSQL:32768,TNS_EXEC_OPTION_IMPLICIT_RESULTSET:32768,TNS_EXEC_OPTION_DESCRIBE:131072,TNS_EXEC_OPTION_NO_COMPRESSED_FETCH:262144,TNS_EXEC_OPTION_BATCH_ERRORS:524288,TNS_EXEC_OPTION_NO_IMPL_REL:2097152,TNS_SERVER_PIGGYBACK_QUERY_CACHE_INVALIDATION:1,TNS_SERVER_PIGGYBACK_OS_PID_MTS:2,TNS_SERVER_PIGGYBACK_TRACE_EVENT:3,TNS_SERVER_PIGGYBACK_SESS_RET:4,TNS_SERVER_PIGGYBACK_SYNC:5,TNS_SERVER_PIGGYBACK_LTXID:7,TNS_SERVER_PIGGYBACK_AC_REPLAY_CONTEXT:8,TNS_SERVER_PIGGYBACK_EXT_SYNC:9,TNS_SESSGET_SESSION_CHANGED:4,TNS_LOB_OP_GET_LENGTH:1,TNS_LOB_OP_READ:2,TNS_LOB_OP_TRIM:32,TNS_LOB_OP_WRITE:64,TNS_LOB_OP_GET_CHUNK_SIZE:16384,TNS_LOB_OP_CREATE_TEMP:272,TNS_LOB_OP_FREE_TEMP:273,TNS_LOB_OP_OPEN:32768,TNS_LOB_OP_CLOSE:65536,TNS_LOB_OP_IS_OPEN:69632,TNS_LOB_OP_ARRAY:524288,TNS_LOB_OP_FILE_OPEN:256,TNS_LOB_OP_FILE_CLOSE:512,TNS_LOB_OP_FILE_ISOPEN:1024,TNS_LOB_OP_FILE_EXISTS:2048,TNS_LOB_LOC_OFFSET_FLAG_1:4,TNS_LOB_LOC_OFFSET_FLAG_3:6,TNS_LOB_LOC_OFFSET_FLAG_4:7,TNS_LOB_QLOCATOR_VERSION:4,TNS_LOB_LOC_FIXED_OFFSET:16,TNS_LOB_LOC_FLAGS_BLOB:1,TNS_LOB_LOC_FLAGS_VALUE_BASED:32,TNS_LOB_LOC_FLAGS_ABSTRACT:64,TNS_LOB_LOC_FLAGS_INIT:8,TNS_LOB_LOC_FLAGS_TEMP:1,TNS_LOB_LOC_FLAGS_VAR_LENGTH_CHARSET:128,TNS_LOB_OPEN_READ_WRITE:2,TNS_LOB_OPEN_READ_ONLY:11,TNS_LOB_PREFETCH_FLAG:33554432,TNS_JSON_MAX_LENGTH:32*1024*1024,TNS_END_TO_END_ACTION:16,TNS_END_TO_END_CLIENT_IDENTIFIER:1,TNS_END_TO_END_CLIENT_INFO:256,TNS_END_TO_END_DBOP:512,TNS_END_TO_END_MODULE:8,TNS_VERSION_MIN_ACCEPTED:315,TNS_VERSION_MIN_LARGE_SDU:315,TNS_FUNC_AUTH_PHASE_ONE:118,TNS_FUNC_AUTH_PHASE_TWO:115,TNS_FUNC_CLOSE_CURSORS:105,TNS_FUNC_COMMIT:14,TNS_FUNC_EXECUTE:94,TNS_FUNC_FETCH:5,TNS_FUNC_LOB_OP:96,TNS_FUNC_LOGOFF:9,TNS_FUNC_PING:147,TNS_FUNC_ROLLBACK:15,TNS_FUNC_SET_END_TO_END_ATTR:135,TNS_FUNC_REEXECUTE:4,TNS_FUNC_REEXECUTE_AND_FETCH:78,TNS_FUNC_SET_SCHEMA:152,TNS_FUNC_SESSION_GET:162,TNS_FUNC_SESSION_RELEASE:163,TNS_FUNC_SESSION_STATE:176,TNS_FUNC_CANCEL_ALL:120,TNS_FUNC_TPC_TXN_SWITCH:103,TNS_FUNC_TPC_TXN_CHANGE_STATE:104,TNS_CHARSET_UTF8:873,TNS_CHARSET_UTF16:2e3,TNS_ENCODING_UTF8:"UTF-8",TNS_ENCODING_UTF16:"UTF-16LE",TNS_ENCODING_MULTI_BYTE:1,TNS_ENCODING_CONV_LENGTH:2,TNS_CCAP_SQL_VERSION:0,TNS_CCAP_LOGON_TYPES:4,TNS_CCAP_CTB_FEATURE_BACKPORT:5,TNS_CCAP_FIELD_VERSION:7,TNS_CCAP_SERVER_DEFINE_CONV:8,TNS_CCAP_TTC1:15,TNS_CCAP_OCI1:16,TNS_CCAP_TDS_VERSION:17,TNS_CCAP_RPC_VERSION:18,TNS_CCAP_RPC_SIG:19,TNS_CCAP_DBF_VERSION:21,TNS_CCAP_LOB:23,TNS_CCAP_TTC2:26,TNS_CCAP_UB2_DTY:27,TNS_CCAP_OCI2:31,TNS_CCAP_CLIENT_FN:34,TNS_CCAP_TTC3:37,TNS_CCAP_TTC4:40,TNS_CCAP_LOB2:42,TNS_CCAP_TTC5:44,TNS_CCAP_VECTOR_FEATURES:52,TNS_CCAP_MAX:53,TNS_CCAP_SQL_VERSION_MAX:6,TNS_CCAP_FIELD_VERSION_11_2:6,TNS_CCAP_FIELD_VERSION_12_1:7,TNS_CCAP_FIELD_VERSION_12_2:8,TNS_CCAP_FIELD_VERSION_12_2_EXT1:9,TNS_CCAP_FIELD_VERSION_18_1:10,TNS_CCAP_FIELD_VERSION_18_1_EXT_1:11,TNS_CCAP_FIELD_VERSION_19_1:12,TNS_CCAP_FIELD_VERSION_19_1_EXT_1:13,TNS_CCAP_FIELD_VERSION_20_1:14,TNS_CCAP_FIELD_VERSION_20_1_EXT_1:15,TNS_CCAP_FIELD_VERSION_21_1:16,TNS_CCAP_FIELD_VERSION_23_1:17,TNS_CCAP_FIELD_VERSION_23_1_EXT_1:18,TNS_CCAP_FIELD_VERSION_23_1_EXT_2:19,TNS_CCAP_FIELD_VERSION_23_1_EXT_3:20,TNS_CCAP_FIELD_VERSION_23_1_EXT_4:21,TNS_CCAP_FIELD_VERSION_23_1_EXT_5:22,TNS_CCAP_FIELD_VERSION_23_1_EXT_6:23,TNS_CCAP_FIELD_VERSION_23_4:24,TNS_CCAP_FIELD_VERSION_MAX:24,TNS_CCAP_O5LOGON:8,TNS_CCAP_O5LOGON_NP:2,TNS_CCAP_O7LOGON:32,TNS_CCAP_O8LOGON_LONG_IDENTIFIER:64,TNS_CCAP_O9LOGON_LONG_PASSWORD:128,TNS_CCAP_END_OF_CALL_STATUS:1,TNS_CCAP_IND_RCD:8,TNS_CCAP_FAST_BVEC:32,TNS_CCAP_FAST_SESSION_PROPAGATE:16,TNS_CCAP_APP_CTX_PIGGYBACK:128,TNS_CCAP_TDS_VERSION_MAX:3,TNS_CCAP_RPC_VERSION_MAX:7,TNS_CCAP_RPC_SIG_VALUE:3,TNS_CCAP_DBF_VERSION_MAX:1,TNS_CCAP_IMPLICIT_RESULTS:16,TNS_CCAP_BIG_CHUNK_CLR:32,TNS_CCAP_KEEP_OUT_ORDER:128,TNS_CCAP_LOB_UB8_SIZE:1,TNS_CCAP_LOB_ENCS:2,TNS_CCAP_LOB_PREFETCH_DATA:4,TNS_CCAP_LOB_TEMP_SIZE:8,TNS_CCAP_LOB_PREFETCH:64,TNS_CCAP_LOB_12C:128,TNS_CCAP_DRCP:16,TNS_CCAP_ZLNP:4,TNS_CCAP_INBAND_NOTIFICATION:4,TNS_CCAP_END_OF_REQUEST:32,TNS_CCAP_CLIENT_FN_MAX:12,TNS_CCAP_LOB2_QUASI:1,TNS_CCAP_LOB2_2GB_PREFETCH:4,TNS_CCAP_CTB_IMPLICIT_POOL:8,TNS_CCAP_VECTOR_SUPPORT:8,TNS_CCAP_VECTOR_FEATURE_BINARY:1,TNS_RCAP_COMPAT:0,TNS_RCAP_TTC:6,TNS_RCAP_MAX:7,TNS_RCAP_COMPAT_81:2,TNS_RCAP_TTC_ZERO_COPY:1,TNS_RCAP_TTC_32K:4,TNS_VERIFIER_TYPE_11G_1:45394,TNS_VERIFIER_TYPE_11G_2:6949,TNS_VERIFIER_TYPE_12C:18453,TNS_UDS_FLAGS_IS_JSON:256,TNS_UDS_FLAGS_IS_OSON:2048,TNS_EOCS_FLAGS_TXN_IN_PROGRESS:2,TNS_EOCS_FLAGS_SESS_RELEASE:32768,TNS_TPC_TXN_START:1,TNS_TPC_TXN_DETACH:2,TNS_TPC_TXN_COMMIT:1,TNS_TPC_TXN_ABORT:2,TNS_TPC_TXN_PREPARE:3,TNS_TPC_TXN_FORGET:4,TNS_TPC_TXN_STATE_PREPARE:0,TNS_TPC_TXN_STATE_REQUIRES_COMMIT:1,TNS_TPC_TXN_STATE_COMMITTED:2,TNS_TPC_TXN_STATE_ABORTED:3,TNS_TPC_TXN_STATE_READ_ONLY:4,TNS_TPC_TXN_STATE_FORGOTTEN:5,TNS_ESCAPE_CHAR:253,TNS_LONG_LENGTH_INDICATOR:GS.TNS_LONG_LENGTH_INDICATOR,TNS_NULL_LENGTH_INDICATOR:GS.TNS_NULL_LENGTH_INDICATOR,TNS_MAX_ROWID_LENGTH:18,TNS_DURATION_SESSION:10,TNS_MAX_LONG_LENGTH:2147483647,TNS_SDU:8192,TNS_TDU:65535,TNS_MAX_CONNECT_DATA:230,TNS_MAX_UROWID_LENGTH:3950,TNS_SERVER_CONVERTS_CHARS:1,DRCP_DEAUTHENTICATE:2,TNS_OBJ_IS_VERSION_81:128,TNS_OBJ_IS_DEGENERATE:16,TNS_OBJ_IS_COLLECTION:8,TNS_OBJ_NO_PREFIX_SEG:4,TNS_OBJ_IMAGE_VERSION:1,TNS_OBJ_MAX_SHORT_LENGTH:245,TNS_OBJ_ATOMIC_NULL:253,TNS_OBJ_NON_NULL_OID:2,TNS_OBJ_HAS_EXTENT_OID:8,TNS_OBJ_TOP_LEVEL:1,TNS_OBJ_HAS_INDEXES:16,TNS_OBJ_PLSQL_INDEX_TABLE:1,TNS_OBJ_NESTED_TABLE:2,TNS_OBJ_VARRAY:3,TNS_OBJ_TDS_TYPE_CHAR:1,TNS_OBJ_TDS_TYPE_DATE:2,TNS_OBJ_TDS_TYPE_FLOAT:5,TNS_OBJ_TDS_TYPE_NUMBER:6,TNS_OBJ_TDS_TYPE_VARCHAR:7,TNS_OBJ_TDS_TYPE_BOOLEAN:8,TNS_OBJ_TDS_TYPE_RAW:19,TNS_OBJ_TDS_TYPE_TIMESTAMP:21,TNS_OBJ_TDS_TYPE_TIMESTAMP_TZ:23,TNS_OBJ_TDS_TYPE_OBJ:27,TNS_OBJ_TDS_TYPE_COLL:28,TNS_OBJ_TDS_TYPE_CLOB:29,TNS_OBJ_TDS_TYPE_BLOB:30,TNS_OBJ_TDS_TYPE_TIMESTAMP_LTZ:33,TNS_OBJ_TDS_TYPE_BINARY_FLOAT:37,TNS_OBJ_TDS_TYPE_START_EMBED_ADT:39,TNS_OBJ_TDS_TYPE_END_EMBED_ADT:40,TNS_OBJ_TDS_TYPE_SUBTYPE_MARKER:43,TNS_OBJ_TDS_TYPE_EMBED_ADT_INFO:44,TNS_OBJ_TDS_TYPE_BINARY_DOUBLE:45,TNS_XML_TYPE_LOB:1,TNS_XML_TYPE_STRING:4,TNS_XML_TYPE_FLAG_SKIP_NEXT_4:1048576,TNS_ERR_INCONSISTENT_DATA_TYPES:932,TNS_ERR_VAR_NOT_IN_SELECT_LIST:1007,TNS_ERR_INBAND_MESSAGE:12573,TNS_ERR_INVALID_SERVICE_NAME:12514,TNS_ERR_INVALID_SID:12505,TNS_ERR_NO_DATA_FOUND:1403,TNS_ERR_SESSION_SHUTDOWN:12572,TNS_WARN_COMPILATION_CREATE:32,TNS_VECTOR_MAX_LENGTH:1048576,VECTOR_FORMAT_FLEX:0,VECTOR_META_FLAG_FLEXIBLE_DIM:1,PACKET_HEADER_SIZE:8,NUMBER_AS_TEXT_CHARS:172,CHUNKED_BYTES_CHUNK_SIZE:65536,TNS_DATA_FLAGS_END_OF_REQUEST:8192,TNS_BASE64_ALPHABET_ARRAY:qS.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),TNS_EXTENT_OID:qS.from("00000000000000000000000000010001","hex")}});var kr=P((Uw,KS)=>{"use strict";var{Buffer:A_}=require("buffer"),vS=we(),TI=require("crypto"),d_=class d_ extends Error{};c(d_,"OutOfPacketsError");var S_=d_;function Qi(i,e,t,s){for(let r=0;r<t;r++)i[s+t-r-1]=vS.TNS_BASE64_ALPHABET_ARRAY[e&63],e=e>>6;return s+t}c(Qi,"_convertBase64");function lI(i){let e=0;if(i.rba!==0||i.partitionID!==0||i.blockNum!==0||i.slotNum!=0){let t=A_.allocUnsafe(vS.TNS_MAX_ROWID_LENGTH);return e=Qi(t,i.rba,6,e),e=Qi(t,i.partitionID,3,e),e=Qi(t,i.blockNum,6,e),Qi(t,i.slotNum,3,e),t.toString("utf8")}}c(lI,"encodeRowID");function EI(i){let e=A_.from(i),t=TI.randomBytes(e.length);for(let s=0;s<e.length;s++)e[s]=t[s]^e[s];return{obfuscatedValue:t,value:e}}c(EI,"setObfuscatedValue");function uI(i,e){let t=A_.from(i);for(let r=0;r<i.length;r++)t[r]=i[r]^e[r];let s=t.toString();return t.fill(0),s}c(uI,"getDeobfuscatedValue");KS.exports={encodeRowID:lI,getDeobfuscatedValue:uI,OutOfPacketsError:S_,setObfuscatedValue:EI}});var Ct=P((Mw,WS)=>{"use strict";var{Buffer:p_}=require("buffer"),ie=we(),hs=W(),m_=class m_{constructor(e){this.errorInfo={},this.connection=e,this.messageType=ie.TNS_MSG_TYPE_FUNCTION,this.functionCode=0,this.callStatus=0,this.flushOutBinds=!1,this.endOfResponse=!1,this.endToEndSeqNum=0,this.errorOccurred=!1,this.warning=void 0}preProcess(){}async postProcess(){}writeFunctionHeader(e){e.writeUInt8(this.messageType),e.writeUInt8(this.functionCode),e.writeSeqNum(),e.caps.ttcFieldVersion>=ie.TNS_CCAP_FIELD_VERSION_23_1_EXT_1&&e.writeUB8(0)}processErrorInfo(e){this.callStatus=e.readUB4(),e.skipUB2(),e.skipUB4(),e.skipUB2(),e.skipUB2(),e.skipUB2(),this.errorInfo.cursorId=e.readUB2();let t=e.readSB2();e.skipUB1(),e.skipUB1(),e.skipUB1(),e.skipUB1(),e.skipUB1(),e.readUInt8()&ie.TNS_WARN_COMPILATION_CREATE&&(this.warning=hs.getErr(hs.WRN_COMPILATION_CREATE)),this.errorInfo.rowID=e.readRowID(),e.skipUB4(),e.skipUB1(),e.skipUB1(),e.skipUB2(),e.skipUB4(),e.readUB4()>0&&e.skipBytesChunked();let n=e.readUB2();if(n>0){this.errorInfo.batchErrors=[];let T=e.readUInt8();for(let l=0;l<n;l++){T===ie.TNS_LONG_LENGTH_INDICATOR&&e.skipUB4();let E=e.readUB2();this.errorInfo.batchErrors.push(new Error(E))}T===ie.TNS_LONG_LENGTH_INDICATOR&&e.skipBytes(1)}let a=e.readUB4();if(a>0){a>65535&&hs.throwErr(hs.ERR_TOO_MANY_BATCH_ERRORS);let T=e.readUInt8(),l;for(let E=0;E<a;E++)T===ie.TNS_LONG_LENGTH_INDICATOR&&e.skipUB4(),l=e.readUB4(),E<n&&(this.errorInfo.batchErrors[E].offset=l);T===ie.TNS_LONG_LENGTH_INDICATOR&&e.skipBytes(1)}let _=e.readUB2();if(_>0){e.skipBytes(1);for(let T=0;T<_;T++)e.skipUB2(),this.errorInfo.batchErrors[T].message=e.readStr(ie.CSFRM_IMPLICIT),e.skipBytes(2)}this.errorInfo.num=e.readUB4(),this.errorInfo.rowCount=e.readUB8(),e.caps.ttcFieldVersion>=ie.TNS_CCAP_FIELD_VERSION_20_1&&(e.skipUB4(),e.skipUB4()),this.errorInfo.num!==0&&(this.errorOccurred=!0,t>=0&&(this.errorInfo.pos=t),this.errorInfo.message=e.readStr(ie.CSFRM_IMPLICIT),this.errorInfo.message=this.errorInfo.message.trim()),this.endOfResponse=!this.connection.nscon.endOfRequestSupport}processReturnParameter(){}processWarningInfo(e){let t=e.readUB2(),s=e.readUB2();if(e.skipUB2(),t!=0&&s>0){let r=e.readStr(ie.CSFRM_IMPLICIT).trim();this.warning=new Error(r),this.warning.errorNum=t}}decode(e){this.process(e)}process(e){this.endOfResponse=!1,this.flushOutBinds=!1;do{this.savePoint(e);let t=e.readUInt8();this.processMessage(e,t)}while(!this.endOfResponse)}savePoint(e){e.savePoint()}processMessage(e,t){t===ie.TNS_MSG_TYPE_ERROR?this.processErrorInfo(e):t===ie.TNS_MSG_TYPE_WARNING?this.processWarningInfo(e):t===ie.TNS_MSG_TYPE_STATUS?(this.callStatus=e.readUB4(),this.endToEndSeqNum=e.readUB2(),this.endOfResponse=!this.connection.nscon.endOfRequestSupport):t===ie.TNS_MSG_TYPE_PARAMETER?this.processReturnParameter(e):t===ie.TNS_MSG_TYPE_SERVER_SIDE_PIGGYBACK?this.processServerSidePiggyBack(e):t===ie.TNS_MSG_TYPE_END_OF_REQUEST?this.endOfResponse=!0:hs.throwErr(hs.ERR_UNEXPECTED_MESSAGE_TYPE,t,e.pos,e.packetNum)}processServerSidePiggyBack(e){let t=e.readUInt8();if(t===ie.TNS_SERVER_PIGGYBACK_LTXID)e.readUB4()>0&&e.skipBytesChunked();else if(!(t===ie.TNS_SERVER_PIGGYBACK_QUERY_CACHE_INVALIDATION||t===ie.TNS_SERVER_PIGGYBACK_TRACE_EVENT))if(t===ie.TNS_SERVER_PIGGYBACK_OS_PID_MTS){let s=e.readUB2();e.skipUB1(),e.skipBytes(s)}else if(t===ie.TNS_SERVER_PIGGYBACK_SYNC){e.skipUB2(),e.skipUB1();let s=e.readUB4();e.skipBytes(1);for(let r=0;r<s;r++){let n=e.readUB2();n>0&&e.skipBytesChunked(),n=e.readUB2(),n>0&&e.skipBytesChunked(),e.skipUB2()}e.skipUB4()}else if(t===ie.TNS_SERVER_PIGGYBACK_EXT_SYNC)e.skipUB2(),e.skipUB1();else if(t===ie.TNS_SERVER_PIGGYBACK_AC_REPLAY_CONTEXT)e.skipUB2(),e.skipUB1(),e.skipUB4(),e.skipUB4(),e.skipUB1(),e.readUB4()>0&&e.skipBytesChunked();else if(t===ie.TNS_SERVER_PIGGYBACK_SESS_RET){e.skipUB2(),e.skipUB1();let s=e.readUB2();if(s>0){e.skipUB1();for(let n=0;n<s;++n){let a=e.readUB2();a>0&&e.skipBytesChunked(),a=e.readUB2(),a>0&&e.skipBytesChunked(),e.skipUB2()}}e.readUB4()&ie.TNS_SESSGET_SESSION_CHANGED&&this.connection._drcpEstablishSession&&this.connection.statementCache.clearCursors(),this.connection._drcpEstablishSession=!1,e.skipUB4(),e.skipUB2()}else hs.throwErr(hs.ERR_UNKOWN_SERVER_SIDE_PIGGYBACK,t)}writePiggybacks(e){this.connection._currentSchemaModified&&this._writeCurrentSchemaPiggyback(e),this.connection.statementCache._cursorsToClose.size>0&&!this.connection._drcpEstablishSession&&this.writeCloseCursorsPiggyBack(e),(this.connection._actionModified||this.connection._clientIdentifierModified||this.connection._dbopModified||this.connection._clientInfoModified||this.connection._moduleModified)&&this._writeEndToEndPiggybacks(e),this.connection._tempLobsTotalSize>0&&this.writeCloseTempLobsPiggyback(e)}writePiggybackHeader(e,t){e.writeUInt8(ie.TNS_MSG_TYPE_PIGGYBACK),e.writeUInt8(t),e.writeSeqNum(),e.caps.ttcFieldVersion>=ie.TNS_CCAP_FIELD_VERSION_23_1_EXT_1&&e.writeUB8(0)}writeCloseCursorsPiggyBack(e){this.writePiggybackHeader(e,ie.TNS_FUNC_CLOSE_CURSORS),e.writeUInt8(1),this.connection.statementCache.writeCursorsToClose(e)}writeCloseTempLobsPiggyback(e){let t=this.connection._tempLobsToClose,s=ie.TNS_LOB_OP_FREE_TEMP|ie.TNS_LOB_OP_ARRAY;this.writePiggybackHeader(e,ie.TNS_FUNC_LOB_OP),e.writeUInt8(1),e.writeUB4(this.connection._tempLobsTotalSize),e.writeUInt8(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(s),e.writeUInt8(0),e.writeUB4(0),e.writeUB8(0),e.writeUB8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);for(let r of t)e.writeBytes(r);this.connection._tempLobsToClose=[],this.connection._tempLobsTotalSize=0}_writeCurrentSchemaPiggyback(e){this.writePiggybackHeader(e,ie.TNS_FUNC_SET_SCHEMA),e.writeUInt8(1);let t=p_.byteLength(this.connection.currentSchema);e.writeUB4(t),e.writeBytesWithLength(p_.from(this.connection.currentSchema))}_writeEndToEndPiggybacks(e){let t=0;this.connection._actionModified&&(t|=ie.TNS_END_TO_END_ACTION),this.connection._clientIdentifierModified&&(t|=ie.TNS_END_TO_END_CLIENT_IDENTIFIER),this.connection._clientInfoModified&&(t|=ie.TNS_END_TO_END_CLIENT_INFO),this.connection._moduleModified&&(t|=ie.TNS_END_TO_END_MODULE),this.connection._dbOpModified&&(t|=ie.TNS_END_TO_END_DBOP),this.writePiggybackHeader(e,ie.TNS_FUNC_SET_END_TO_END_ATTR),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(t);let s=this.writeEndEndTraceValue(e,this.connection._clientIdentifier,this.connection._clientIdentifierModified),r=this.writeEndEndTraceValue(e,this.connection._module,this.connection._moduleModified),n=this.writeEndEndTraceValue(e,this.connection._action,this.connection._actionModified);e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);let a=this.writeEndEndTraceValue(e,this.connection._clientInfo,this.connection._clientInfoModified);e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0);let _=this.writeEndEndTraceValue(e,this.connection._dbOp,this.connection._dbOpModified);this.connection._clientIdentifierModified&&this.connection._clientIdentifier&&e.writeBytesWithLength(s),this.connection._moduleModified&&this.connection._module&&e.writeBytesWithLength(r),this.connection._actionModified&&this.connection._action&&e.writeBytesWithLength(n),this.connection._clientInfoModified&&this.connection._clientInfo&&e.writeBytesWithLength(a),this.connection._dbOpModified&&this.connection._dbOp&&e.writeBytesWithLength(_),this.connection._actionModified=!1,this.connection._action="",this.connection._clientIdentifierModified=!1,this.connection._clientIdentifier="",this.connection._clientInfoModified=!1,this.connection._clientInfo="",this.connection._dbOpModified=!1,this.connection._dbOp="",this.connection._moduleModified=!1,this.connection._module=""}writeEndEndTraceValue(e,t,s){let r;return s?(e.writeUInt8(1),t?(r=p_.from(t),e.writeUB4(r.length)):e.writeUB4(0)):(e.writeUInt8(0),e.writeUB4(0)),r}saveDeferredErr(){this.deferredErr||(this.deferredErr=hs.getErr(...arguments))}};c(m_,"Message");var f_=m_;WS.exports=f_});var I_=P((Fw,XS)=>{"use strict";var{Buffer:qr}=require("buffer"),ve=we(),hI=Ct(),R_=class R_ extends hI{constructor(e,t){super(e),this.sourceLobImpl=t.sourceLobImpl||null,this.operation=t.operation,this.destLobImpl=t.destLobImpl||null,this.sourceOffset=t.sourceOffset||0,this.destOffset=t.destOffset||0,this.boolFlag=!1,t.data&&(this.data=t.data),this.functionCode=ve.TNS_FUNC_LOB_OP,this.sendAmount=t.sendAmount,this.amount=t.amount||0}encode(e){this.writeFunctionHeader(e),this.sourceLobImpl===null?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(this.sourceLobImpl._locator.length)),this.destLobImpl===null?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(this.destLobImpl._locator.length)),e.writeUB4(0),e.writeUB4(0),this.operation===ve.TNS_LOB_OP_CREATE_TEMP?e.writeUInt8(1):e.writeUInt8(0),e.writeUInt8(0),[ve.TNS_LOB_OP_CREATE_TEMP,ve.TNS_LOB_OP_IS_OPEN,ve.TNS_LOB_OP_FILE_EXISTS,ve.TNS_LOB_OP_FILE_ISOPEN].includes(this.operation)?e.writeUInt8(1):e.writeUInt8(0),e.writeUB4(this.operation),e.writeUInt8(0),e.writeUInt8(0),e.writeUB8(this.sourceOffset),e.writeUB8(this.destOffset),this.sendAmount?e.writeUInt8(1):e.writeUInt8(0);for(let s=0;s<3;s++)e.writeUInt16BE(0);if(this.sourceLobImpl&&e.writeBytes(this.sourceLobImpl._locator),this.destLobImpl&&e.writeBytes(this.destLobImpl._locator),this.operation===ve.TNS_LOB_OP_CREATE_TEMP&&(this.sourceLobImpl.dbType._csfrm===ve.CSFRM_NCHAR?(e.caps.checkNCharsetId(),e.writeUB4(ve.TNS_CHARSET_UTF16)):e.writeUB4(ve.TNS_CHARSET_UTF8)),this.data){let s;e.writeUInt8(ve.TNS_MSG_TYPE_LOB_DATA),this.sourceLobImpl.dbType._oraTypeNum===ve.TNS_DATA_TYPE_BLOB?s=this.data:this.sourceLobImpl.getCsfrm()===ve.CSFRM_NCHAR?(s=this.data,qr.isBuffer(this.data)&&(s=s.toString()),s=qr.from(s,ve.TNS_ENCODING_UTF16).swap16()):s=qr.from(this.data),e.writeBytesWithLength(s)}this.sendAmount&&e.writeUB8(this.amount)}processMessage(e,t){if(t===ve.TNS_MSG_TYPE_LOB_DATA){let s=this.sourceLobImpl.dbType._oraTypeNum,r=e.readBytesWithLength();r!==null&&(s===ve.TNS_DATA_TYPE_BLOB||s===ve.TNS_DATA_TYPE_BFILE?r=qr.from(r):this.sourceLobImpl.getCsfrm()===ve.CSFRM_NCHAR?r=qr.from(r).swap16().toString("utf16le"):r=r.toString()),this.data=r}else super.processMessage(e,t)}processReturnParameter(e){let t,s,r,n;this.sourceLobImpl!==null&&(n=this.sourceLobImpl._locator.length,t=e.readBytes(n),s=t.slice(0,n),s.copy(this.sourceLobImpl._locator)),this.destLobImpl!==null&&(n=this.destLobImpl._locator.length,t=e.readBytes(n),s=t.slice(0,n),s.copy(this.destLobImpl._locator)),this.operation===ve.TNS_LOB_OP_CREATE_TEMP?(e.skipUB2(),e.skipBytes(3)):this.sendAmount&&(this.amount=e.readSB8()),(this.operation===ve.TNS_LOB_OP_IS_OPEN||this.operation===ve.TNS_LOB_OP_FILE_EXISTS||this.operation===ve.TNS_LOB_OP_FILE_ISOPEN)&&(r=e.readUInt8(),this.boolFlag=r>0)}};c(R_,"LobOpMessage");var P_=R_;XS.exports=P_});var Gr=P((bw,$S)=>{"use strict";var{Buffer:Zi}=require("buffer"),NI=Jo(),Se=we(),SI=I_(),zS=W(),AI=lt(),C_=class C_ extends NI{_getConnImpl(){return this.conn}async _sendMessage(e){let t=new SI(this.conn,e);return await this.conn._protocol._processMessage(t),e.operation===Se.TNS_LOB_OP_READ?t.data?t.data:null:e.operation===Se.TNS_LOB_OP_FILE_EXISTS||e.operation===Se.TNS_LOB_OP_FILE_ISOPEN?t.boolFlag:t.amount}getChunkSize(){return this._chunkSize}async _getChunkSizeAsync(){this.checkConn();let e={operation:Se.TNS_LOB_OP_GET_CHUNK_SIZE,sourceLobImpl:this,sendAmount:!0};this._chunkSize=this._pieceSize=await this._sendMessage(e)}getLength(){return this._length}getPieceSize(){return this._pieceSize}setPieceSize(e){this._pieceSize=e}getType(){return this.dbType}async getData(e=1,t=this._length){let s=!1;t||(t=this._length),this.dbType===AI.DB_TYPE_BFILE&&(await this.isFileOpen()||(s=!0,await this.openFile()));let r;try{r=await this.read(e,t)}finally{s&&await this.closeFile()}return r}async read(e,t){this.checkConn();let s={operation:Se.TNS_LOB_OP_READ,sourceLobImpl:this,sourceOffset:e,sendAmount:!0,amount:t||this._pieceSize};return await this._sendMessage(s)}async write(e,t){this.checkConn();let s={operation:Se.TNS_LOB_OP_WRITE,sourceLobImpl:this,sourceOffset:e,data:t};await this._sendMessage(s),this._length+=t.length}getCsfrm(){return this.dbType._csfrm!==Se.CSFRM_NCHAR&&this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_3]&Se.TNS_LOB_LOC_FLAGS_VAR_LENGTH_CHARSET?Se.CSFRM_NCHAR:this.dbType._csfrm}async create(e,t){this.dirtyLength=!1,this.conn=e,this.dbType=t,this._locator=Zi.alloc(40),this._isTempLob=!0,this._length=0;let s={operation:Se.TNS_LOB_OP_CREATE_TEMP,sourceLobImpl:this,amount:Se.TNS_DURATION_SESSION,destOffset:t._oraTypeNum,sourceOffset:t._csfrm,sendAmount:!0};await this._sendMessage(s),await this._getChunkSizeAsync()}async fileExists(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_EXISTS,sourceLobImpl:this};return await this._sendMessage(e)}getDirFileName(){let e=Se.TNS_LOB_LOC_FIXED_OFFSET+2,t=this._locator.readUInt16BE(Se.TNS_LOB_LOC_FIXED_OFFSET),s=Se.TNS_LOB_LOC_FIXED_OFFSET+t+4,r=this._locator.readUInt16BE(e+t),n=this._locator.slice(e,e+t).toString(),a=this._locator.slice(s,s+r).toString();return{dirName:n,fileName:a}}checkConn(){this.conn.nscon.connected||zS.throwErr(zS.ERR_INVALID_CONNECTION)}close(){this.checkConn(),this._isTempLob&&(this.conn._tempLobsToClose.push(this._locator),this.conn._tempLobsTotalSize+=this._locator.length)}async closeFile(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_CLOSE,sourceLobImpl:this};await this._sendMessage(e)}init(e,t,s,r,n){this.dirtyLength=!1,this.conn=e,this._locator=t,this._isTempLob=!1,(this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_4]&Se.TNS_LOB_LOC_FLAGS_TEMP===Se.TNS_LOB_LOC_FLAGS_TEMP||this._locator[Se.TNS_LOB_LOC_OFFSET_FLAG_1]&Se.TNS_LOB_LOC_FLAGS_ABSTRACT===Se.TNS_LOB_LOC_FLAGS_ABSTRACT)&&(this._isTempLob=!0),this.dbType=s,this._length=r,this._chunkSize=n,this._pieceSize=n}async isFileOpen(){let e={operation:Se.TNS_LOB_OP_FILE_ISOPEN,sourceLobImpl:this};await this._sendMessage(e)}async openFile(){this.checkConn();let e={operation:Se.TNS_LOB_OP_FILE_OPEN,sourceLobImpl:this,amount:Se.TNS_LOB_OPEN_READ_ONLY,sendAmount:!0};return await this._sendMessage(e)}setDirFileName(e){let t=Zi.byteLength(e.dirName),s=Se.TNS_LOB_LOC_FIXED_OFFSET+2,r=s+t+2,n=Zi.byteLength(e.fileName),a=r+n,_=Zi.allocUnsafe(a);this._locator.copy(_,0,0,Se.TNS_LOB_LOC_FIXED_OFFSET+1),_.writeUInt16BE(t,Se.TNS_LOB_LOC_FIXED_OFFSET),_.write(e.dirName,s),_.writeInt16BE(n,s+t),_.write(e.fileName,r),this._locator=_}};c(C_,"ThinLobImpl");var D_=C_;$S.exports=D_});var y_=P((qw,JS)=>{"use strict";var{Buffer:Gs}=require("buffer"),Ae=we(),Ot=W(),Te=lt(),dI=yi(),{GrowableBuffer:pI}=nr(),fI=Gr(),g_=class g_ extends pI{_readBytesWithLength(e){return e===Ae.TNS_LONG_LENGTH_INDICATOR&&(e=this.readUInt32BE()),this.readBytes(e)}getIsAtomicNull(){let e=this.readUInt8();return e===Ae.TNS_OBJ_ATOMIC_NULL||e===Ae.TNS_NULL_LENGTH_INDICATOR?!0:(this.pos-=1,!1)}readHeader(e){if(e.imageFlags=this.readUInt8(),e.imageVersion=this.readUInt8(),this.readLength(),!(e.imageFlags&Ae.TNS_OBJ_NO_PREFIX_SEG)){let t=this.readLength();this.skipBytes(t)}}readLength(){let e=this.readUInt8();return e!==Ae.TNS_LONG_LENGTH_INDICATOR?e:this.readUInt32BE()}writeHeader(e){this.writeUInt8(e.imageFlags),this.writeUInt8(e.imageVersion),this.writeUInt8(Ae.TNS_LONG_LENGTH_INDICATOR),this.writeUInt32BE(0),e._objType.isCollection&&(this.writeUInt8(1),this.writeUInt8(1))}writeLength(e){e<=Ae.TNS_OBJ_MAX_SHORT_LENGTH?this.writeUInt8(e):(this.writeUInt8(Ae.TNS_LONG_LENGTH_INDICATOR),this.writeUInt32BE(e))}_writeRawBytesAndLength(e,t){this.writeLength(t),this.writeBytes(e)}};c(g_,"DbObjectPickleBuffer");var Hr=g_,en=class en extends dI{constructor(e,t){if(typeof e=="function"&&(e=e.prototype._objType),super(e),this.packedData=t,this.unpackedAttrs=new Map,t)this.unpackedAssocArray=new Map,this.unpackedAssocKeys=void 0;else if(e){let s=Gs.from([0,34,Ae.TNS_OBJ_NON_NULL_OID,Ae.TNS_OBJ_HAS_EXTENT_OID]);this.toid=Gs.concat([s,e.oid,Ae.TNS_EXTENT_OID]),this.flags=Ae.TNS_OBJ_TOP_LEVEL,this.imageFlags=Ae.TNS_OBJ_IS_VERSION_81,this.imageVersion=Ae.TNS_OBJ_IMAGE_VERSION,e.isCollection?(this.imageFlags|=Ae.TNS_OBJ_IS_COLLECTION,e.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?this.unpackedAssocArray=new Map:this.unpackedArray=[]):this.imageFlags|=Ae.TNS_OBJ_NO_PREFIX_SEG}}_ensureAssocKeys(){this.unpackedAssocKeys||(this.unpackedAssocKeys=[...this.unpackedAssocArray.keys()].sort())}_ensureUnpacked(){this.packedData&&this._unpackData()}_getPackedData(){if(this.packedData)return this.packedData;let e=new Hr;e.writeHeader(this),this._packData(e);let t=e.pos;return e.pos=3,e.writeUInt32BE(t),e.buf.subarray(0,t)}_packData(e){let t=this._objType;if(t.isCollection)if(e.writeUInt8(t.collectionFlags),t.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE){this._ensureAssocKeys(),e.writeLength(this.unpackedAssocKeys.length);for(let s of this.unpackedAssocKeys)e.writeInt32BE(s),this._packValue(e,t.elementType,t.elementTypeClass,this.unpackedAssocArray.get(s))}else{e.writeLength(this.unpackedArray.length);for(let s of this.unpackedArray)this._packValue(e,t.elementType,t.elementTypeClass,s)}else for(let s of t.attributes)this._packValue(e,s.type,s.typeClass,this.unpackedAttrs.get(s.name))}_packValue(e,t,s,r){if(r==null)s&&!s.prototype.isCollection?e.writeUInt8(Ae.TNS_OBJ_ATOMIC_NULL):e.writeUInt8(Ae.TNS_NULL_LENGTH_INDICATOR);else switch(t){case Te.DB_TYPE_CHAR:case Te.DB_TYPE_VARCHAR:e.writeBytesWithLength(Gs.from(r));break;case Te.DB_TYPE_NCHAR:case Te.DB_TYPE_NVARCHAR:e.writeBytesWithLength(Gs.from(r,"utf16le").swap16());break;case Te.DB_TYPE_NUMBER:e.writeOracleNumber(r.toString());break;case Te.DB_TYPE_BINARY_INTEGER:case Te.DB_TYPE_BOOLEAN:e.writeUInt8(4),e.writeUInt32BE(r);break;case Te.DB_TYPE_RAW:e.writeBytesWithLength(r);break;case Te.DB_TYPE_BINARY_DOUBLE:e.writeUInt8(8),e.writeBinaryDouble(r);break;case Te.DB_TYPE_BINARY_FLOAT:e.writeUInt8(4),e.writeBinaryFloat(r);break;case Te.DB_TYPE_DATE:case Te.DB_TYPE_TIMESTAMP:case Te.DB_TYPE_TIMESTAMP_LTZ:case Te.DB_TYPE_TIMESTAMP_TZ:e.writeOracleDate(r,t);break;case Te.DB_TYPE_OBJECT:this._objType.isCollection||r._objType.isCollection?e.writeBytesWithLength(r._getPackedData()):r._packData(e);break;default:Ot.throwErr(Ot.ERR_NOT_IMPLEMENTED,t)}}_unpackData(){let e=new Hr(this.packedData);e.readHeader(this),this._unpackDataFromBuf(e),this.packedData=void 0}_unpackDataFromBuf(e){let t,s,r,n,a=this._objType;if(a.isCollection){a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?s=new Map:t=[],this.collectionFlags=e.readUInt8();let _=e.readLength();for(let T=0;T<_;T++){a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE&&(r=e.readUInt32BE());let l=this._unpackValue(e,a.elementType,a.elementTypeClass);a.collectionType===Ae.TNS_OBJ_PLSQL_INDEX_TABLE?s.set(r,l):t.push(l)}}else{n=new Map;for(let _ of a.attributes){let T=this._unpackValue(e,_.type,_.typeClass);n.set(_.name,T)}}this.unpackedAttrs=n,this.unpackedArray=t,this.unpackedAssocArray=s}_unpackValue(e,t,s){let r,n,a;switch(t){case Te.DB_TYPE_NUMBER:return a=e.readOracleNumber(),a!==null&&(a=parseFloat(a)),a;case Te.DB_TYPE_BINARY_INTEGER:return e.readBinaryInteger();case Te.DB_TYPE_VARCHAR:case Te.DB_TYPE_CHAR:return e.readStr(Ae.CSFRM_IMPLICIT);case Te.DB_TYPE_NVARCHAR:case Te.DB_TYPE_NCHAR:return e.readStr(Ae.CSFRM_NCHAR);case Te.DB_TYPE_RAW:return a=e.readBytesWithLength(),a!==null&&(a=Gs.from(a)),a;case Te.DB_TYPE_BINARY_DOUBLE:return e.readBinaryDouble();case Te.DB_TYPE_BINARY_FLOAT:return e.readBinaryFloat();case Te.DB_TYPE_DATE:case Te.DB_TYPE_TIMESTAMP:return e.readOracleDate(!0);case Te.DB_TYPE_TIMESTAMP_LTZ:case Te.DB_TYPE_TIMESTAMP_TZ:return e.readOracleDate(!1);case Te.DB_TYPE_BOOLEAN:return e.readBool();case Te.DB_TYPE_OBJECT:case Te.DB_TYPE_XMLTYPE:return r=e.getIsAtomicNull(),r?null:(n=new en(s),n._objType.isXmlType?jS(n._objType._connection,e.readBytesWithLength()):(n._objType.isCollection||this._objType.isCollection?n.packedData=Gs.from(e.readBytesWithLength()):n._unpackDataFromBuf(e),n));default:Ot.throwErr(Ot.ERR_NOT_IMPLEMENTED,t)}}append(e){if(this._ensureUnpacked(),this.unpackedArray){let t=this._objType;t.maxNumElements>0&&this.unpackedArray.length>=t.maxNumElements&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_SET,this.unpackedArray.length,0,t.maxNumElements),this.unpackedArray.push(e)}else{this._ensureAssocKeys();let t;if(this.unpackedAssocKeys.length===0)t=0;else{let s=this.unpackedAssocKeys.length-1;t=this.unpackedAssocKeys[s]+1}this.unpackedAssocArray.set(t,e),this.unpackedAssocKeys.push(t)}}deleteElement(e){this._ensureUnpacked(),this.unpackedArray?(this._objType.collectionType==Ae.TNS_OBJ_VARRAY&&Ot.throwErr(Ot.ERR_DELETE_ELEMENTS_OF_VARRAY),this.unpackedArray.splice(e,1)):(this._unpackedAssocKeys=void 0,this.unpackedAssocArray.delete(e))}getAttrValue(e){this._ensureUnpacked();let t=this.unpackedAttrs.get(e.name);return t===void 0?null:t}getElement(e){let t;return this._ensureUnpacked(),this.unpackedArray?t=this.unpackedArray[e]:t=this.unpackedAssocArray.get(e),t===void 0&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_GET,e),t}getFirstIndex(){if(this._ensureUnpacked(),this.unpackedArray)return 0;if(this.unpackedAssocArray)return this._ensureAssocKeys(),this.unpackedAssocKeys[0]}getKeys(){return this._ensureUnpacked(),this.unpackedArray?Array.from(this.unpackedArray.keys()):this.unpackedAssocArray?(this._ensureAssocKeys(),Array.from(this.unpackedAssocKeys)):[]}getLastIndex(){if(this._ensureUnpacked(),this.unpackedArray){if(this.unpackedArray.length>0)return this.unpackedArray.length-1}else if(this.unpackedAssocArray)return this._ensureAssocKeys(),this.unpackedAssocKeys[this.unpackedAssocKeys.length-1]}getNextIndex(e){if(this._ensureUnpacked(),this.unpackedArray){if(e+1<this.unpackedArray.length)return e+1}else if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys)if(t>e)return t}}getPrevIndex(e){if(this._ensureUnpacked(),this.unpackedArray){if(e>0)return e-1}else if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys.reverse())if(t<e)return t}}getValues(){let e=[];if(this._ensureUnpacked(),this.unpackedArray)return Array.from(this.unpackedArray);if(this.unpackedAssocArray){this._ensureAssocKeys();for(let t of this.unpackedAssocKeys)e.push(this.unpackedAssocArray.get(t))}return e}hasElement(e){return this._ensureUnpacked(),this.unpackedArray?e>=0&&e<this.unpackedArray.length:this.unpackedAssocArray.has(e)}setAttrValue(e,t){this._ensureUnpacked(),this.unpackedAttrs.set(e.name,t)}setElement(e,t){if(this._ensureUnpacked(),this.unpackedArray){let s=Math.max(this.unpackedArray.length-1,0);e>s&&Ot.throwErr(Ot.ERR_INVALID_COLL_INDEX_SET,e,0,s),this.unpackedArray[e]=t}else this.unpackedAssocArray.has(e)||(this.unpackedAssocKeys=void 0),this.unpackedAssocArray.set(e,t)}trim(e){this._ensureUnpacked(),e>0&&(this.unpackedArray=this.unpackedArray.slice(0,this.unpackedArray.length-e))}};c(en,"ThinDbObjectImpl");var O_=en;function jS(i,e){let t,s=new Hr(e),r={};s.readHeader(r),s.skipBytes(1);let n=s.readUInt32BE();n&Ae.TNS_XML_TYPE_FLAG_SKIP_NEXT_4&&s.skipBytes(4);let a=s.numBytesLeft(),_=s.readBytes(a);if(n&Ae.TNS_XML_TYPE_STRING)t=_.toString();else if(n&Ae.TNS_XML_TYPE_LOB){let T=new fI,l=Gs.from(_);T.init(i,l,Te.DB_TYPE_CLOB,0,0),t=T}else Ot.throwErr(Ot.ERR_UNEXPECTED_XML_TYPE,n);return t}c(jS,"readXML");JS.exports={ThinDbObjectImpl:O_,readXML:jS}});var w_=P((Hw,eA)=>{"use strict";var{Buffer:Cs}=require("buffer"),QS=kr(),L=we(),mI=Ct(),{ThinDbObjectImpl:PI,readXML:RI}=y_(),II=Gr(),Os=W(),Ie=lt(),B_=class B_ extends mI{constructor(e,t=null,s=null){super(e),this.statement=t,this.options=s,this.offset=0,this.numExecs=1,this.arrayDmlRowCounts=!1,this.requiresDefine=!1,this.rowIndex=t.bufferRowCount||0,this.dmlRowCounts=[],this.batchErrors=!1,this.outVariables=[],this.inFetch=!1,this.parseOnly=!1,this.resultSetsToSetup=[],this.deferredErr=null}processMessage(e,t){if(t===L.TNS_MSG_TYPE_DESCRIBE_INFO){e.skipBytesChunked();let s=this.statement.queryVars;this.statement.queryVars=[],this.statement.numQueryVars=0,this.statement.bufferRowCount=0,this.statement.bufferRowIndex=0,this.processDescribeInfo(e,this.resultSet,s),this.outVariables=this.statement.queryVars}else t===L.TNS_MSG_TYPE_ROW_HEADER?this.processRowHeader(e):t===L.TNS_MSG_TYPE_ROW_DATA?this.processRowData(e):t===L.TNS_MSG_TYPE_IMPLICIT_RESULTSET?this.processImplicitResultSet(e):t===L.TNS_MSG_TYPE_BIT_VECTOR?this.processBitVector(e):t===L.TNS_MSG_TYPE_IO_VECTOR?this.processIOVector(e):t===L.TNS_MSG_TYPE_FLUSH_OUT_BINDS?(this.flushOutBinds=!0,this.endOfResponse=!0):t===L.TNS_MSG_TYPE_ERROR?this.processErrorInfo(e):super.processMessage(e,t)}processErrorInfo(e){super.processErrorInfo(e),this.errorInfo.cursorId!==0&&(this.statement.cursorId=this.errorInfo.cursorId),this.statement.isPlSql||(this.statement.rowCount=this.errorInfo.rowCount),this.errorInfo.rowCount>0&&(this.statement.lastRowid=QS.encodeRowID(this.errorInfo.rowID)),this.options.batchErrors=this.errorInfo.batchErrors,this.batchErrors&&this.options.batchErrors===null&&(this.options.batchErrors=[]),this.errorInfo.num===L.TNS_ERR_NO_DATA_FOUND&&this.statement.isQuery?(this.errorInfo.num=0,this.errorOccurred=!1,this.statement.moreRowsToFetch=!1):this.retry?this.retry=!1:this.statement.isQuery&&(this.errorInfo.num===L.TNS_ERR_VAR_NOT_IN_SELECT_LIST||this.errorInfo.num===L.TNS_ERR_INCONSISTENT_DATA_TYPES)?(this.retry=!0,this.connection.statementCache.clearCursor(this.statement)):this.errorInfo.num!==0&&this.errorInfo.cursorId!==0&&(Os.ERR_INTEGRITY_ERROR_CODES.includes(this.errorInfo.num)||(this.connection.statementCache.clearCursor(this.statement),this.statement.returnToCache=!1)),this.errorInfo.batchErrors&&(this.errorOccurred=!1)}_adjustFetchType(e,t){(t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_CLOB&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_BLOB&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG_RAW||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_JSON&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_VARCHAR||t.fetchInfo.dbType._oraTypeNum===L.TNS_DATA_TYPE_VECTOR&&e.fetchInfo.fetchType._oraTypeNum===L.TNS_DATA_TYPE_LONG)&&(t.type=e.fetchInfo.fetchType,t.maxSize=e.maxSize)}processDescribeInfo(e,t,s){let r=t.statement;e.skipUB4(),r.numQueryVars=e.readUB4(),r.numQueryVars>0&&e.skipUB1(),t.metadata=[];let n=[],a=[];for(let T=0;T<r.numQueryVars;T++){let l=this.processColumnInfo(e,T+1);s&&T<s.length&&this._adjustFetchType(s[T],l),a.push(l),n.push(l.fetchInfo)}let _=e.readUB4();_>0&&e.skipBytesChunked(),e.skipUB4(),e.skipUB4(),e.skipUB4(),e.skipUB4(),_=e.readUB4(),_>0&&e.skipBytesChunked(),t.metadata=n,r.queryVars=a,this.resultSetsToSetup.push(t)}processColumnInfo(e,t){let s=e.readUInt8();e.skipUB1();let r=e.readInt8(),n=e.readInt8(),a=e.readUB4();e.skipUB4(),e.skipUB8();let _,T=e.readUB4();T>0&&(_=Cs.from(e.readBytesWithLength())),e.skipUB2(),e.skipUB2();let l=e.readUInt8(),E=e.readUB4();s===L.TNS_DATA_TYPE_RAW&&(E=a),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_12_2&&e.skipUB4();let h=!!e.readUInt8();e.skipUB1();let p;T=e.readUB4(),T>0&&(p=e.readStr(L.CSFRM_IMPLICIT));let A;T=e.readUB4(),T>0&&(A=e.readStr(L.CSFRM_IMPLICIT)),T=e.readUB4();let u;T>0&&(u=e.readStr(L.CSFRM_IMPLICIT)),e.skipUB2();let N=e.readUB4(),d={name:p,dbType:Ie.getTypeByOraTypeNum(s,l),nullable:h};if(d.isJson=!!(N&L.TNS_UDS_FLAGS_IS_JSON),d.isOson=!!(N&L.TNS_UDS_FLAGS_IS_OSON),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_1&&(T=e.readUB4(),T>0&&(d.domainSchema=e.readStr(L.CSFRM_IMPLICIT)),T=e.readUB4(),T>0&&(d.domainName=e.readStr(L.CSFRM_IMPLICIT))),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_1_EXT_3&&e.readUB4()>0){d.annotations={},e.skipUB1();let S=e.readUB4();e.skipUB1();let D,m;for(let O=0;O<S;O++)e.skipUB4(),m="",D=e.readStr(L.CSFRM_IMPLICIT),T=e.readUB4(),T>0&&(m=e.readStr(L.CSFRM_IMPLICIT)),d.annotations[D]=m,e.skipUB4();e.skipUB4()}if(e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_23_4){let S=e.readUB4(),D=e.readUInt8(),m=e.readUInt8();d.dbType===Ie.DB_TYPE_VECTOR&&(m&L.VECTOR_META_FLAG_FLEXIBLE_DIM||(d.vectorDimensions=S),D!==L.VECTOR_FORMAT_FLEX&&(d.vectorFormat=D))}switch(d.dbType){case Ie.DB_TYPE_VARCHAR:case Ie.DB_TYPE_NVARCHAR:case Ie.DB_TYPE_CHAR:case Ie.DB_TYPE_NCHAR:case Ie.DB_TYPE_RAW:d.byteSize=E;break;case Ie.DB_TYPE_NUMBER:d.precision=r;break;case Ie.DB_TYPE_TIMESTAMP:case Ie.DB_TYPE_TIMESTAMP_TZ:case Ie.DB_TYPE_TIMESTAMP_LTZ:d.precision=n;break;case Ie.DB_TYPE_OBJECT:d.dbTypeClass=this.connection._getDbObjectType(A,u,void 0,_),d.dbTypeClass.partial&&this.connection._partialDbObjectTypes.push(d.dbTypeClass),d.dbTypeClass.isXmlType&&(d.dbType=Ie.DB_TYPE_XMLTYPE);break;default:break}return d.dbType===Ie.DB_TYPE_NUMBER&&(d.scale=n),{fetchInfo:d,type:d.dbType,maxSize:a,columnNum:t,values:new Array(this.options.fetchArraySize)}}processRowHeader(e){e.skipUB1(),e.skipUB2(),e.skipUB4(),e.skipUB4(),e.skipUB2();let t=e.readUB4();t>0&&(this.bitVector=Cs.from(e.readBytesWithLength())),t=e.readUB4(),t>0&&e.skipBytesChunked()}isDuplicateData(e){if(!this.bitVector)return!1;let t=Math.floor(e/8),s=e%8;return(this.bitVector[t]&1<<s)===0}processRowData(e){let t;for(let[s,r]of this.outVariables.entries())if(r.isArray){r.numElementsInArray=e.readUB4();let n=new Array(r.numElementsInArray).fill(null);for(let a=0;a<r.numElementsInArray;a++)t=this.processColumnData(e,r,a),n[a]=t;r.values[this.rowIndex]=n}else if(this.statement.isReturning){let n=e.readUB4(),a=Array(n).fill(null);for(let _=0;_<n;_++)a[_]=this.processColumnData(e,r,_);r.values[this.rowIndex]=a}else this.isDuplicateData(s)?(this.rowIndex===0&&r.outConverter?t=r.lastRawValue:t=r.values[this.statement.lastRowIndex],r.values[this.rowIndex]=t):(t=this.processColumnData(e,r,this.rowIndex),r.values[this.rowIndex]=t);this.rowIndex++,this.inFetch&&(this.statement.lastRowIndex=this.rowIndex-1,this.statement.bufferRowCount++,this.bitVector=null)}processIOVector(e){let t;e.skipUB1();let s=e.readUB2(),n=e.readUB4()*256+s;e.skipUB4(),e.skipUB2(),t=e.readUB2(),t>0&&e.skipBytes(t),t=e.readUB2(),t>0&&e.skipBytes(t),this.outVariables=[];for(let a=0;a<n;a++){let _=this.statement.bindInfoList[a];_.bindDir=e.readUInt8(),_.bindDir!==L.TNS_BIND_DIR_INPUT&&this.outVariables.push(_.bindVar)}}processColumnData(e,t){let s=t.type,r=s._oraTypeNum,n=s._csfrm,a=t.maxSize,_=null;if(a===0&&r!==L.TNS_DATA_TYPE_LONG&&r!==L.TNS_DATA_TYPE_LONG_RAW&&r!==L.TNS_DATA_TYPE_UROWID)_=null;else if(r===L.TNS_DATA_TYPE_VARCHAR||r===L.TNS_DATA_TYPE_CHAR||r===L.TNS_DATA_TYPE_LONG)n===L.CSFRM_NCHAR&&e.caps.checkNCharsetId(),_=e.readStr(n);else if(r===L.TNS_DATA_TYPE_RAW||r===L.TNS_DATA_TYPE_LONG_RAW)_=e.readBytesWithLength(),_!==null&&(_=Cs.from(_));else if(r===L.TNS_DATA_TYPE_NUMBER)_=e.readOracleNumber(),!this.inFetch&&_!==null&&(_=parseFloat(_));else if(r===L.TNS_DATA_TYPE_DATE||r===L.TNS_DATA_TYPE_TIMESTAMP||r===L.TNS_DATA_TYPE_TIMESTAMP_LTZ||r===L.TNS_DATA_TYPE_TIMESTAMP_TZ){let T=r===L.TNS_DATA_TYPE_DATE||r===L.TNS_DATA_TYPE_TIMESTAMP;_=e.readOracleDate(T)}else if(r===L.TNS_DATA_TYPE_ROWID)if(!this.inFetch)_=e.readStr(L.CSFRM_IMPLICIT);else{let T=e.readUInt8();if(ZS(T))_=null;else{let l=e.readRowID();_=QS.encodeRowID(l)}}else if(r===L.TNS_DATA_TYPE_UROWID)this.inFetch?_=e.readURowID():_=e.readStr(L.CSFRM_IMPLICIT);else if(r===L.TNS_DATA_TYPE_BINARY_DOUBLE)_=e.readBinaryDouble();else if(r===L.TNS_DATA_TYPE_BINARY_FLOAT)_=e.readBinaryFloat();else if(r===L.TNS_DATA_TYPE_BINARY_INTEGER)_=e.readOracleNumber(),_!==null&&(_=parseFloat(_));else if(r===L.TNS_DATA_TYPE_CURSOR){let T=e.readUInt8();ZS(T)?_=null:(_=this.createCursorFromDescribe(e),_.statement.cursorId=e.readUB2(),_.statement.cursorId===0&&t.dir!==L.BIND_IN&&(this.options.nullifyInvalidCursor?_=null:Os.throwErr(Os.ERR_INVALID_REF_CURSOR)))}else if(r===L.TNS_DATA_TYPE_BOOLEAN)_=e.readBool();else if(r===L.TNS_DATA_TYPE_CLOB||r===L.TNS_DATA_TYPE_BLOB||r===L.TNS_DATA_TYPE_BFILE){let T=0,l=0;if(e.readUB4()>0){_=new II,r===L.TNS_DATA_TYPE_BFILE?e.skipUB4():(T=e.readUB8(),l=e.readUB4());let h=Cs.from(e.readBytesWithLength());_.init(this.connection,h,s,T,l)}}else if(r===L.TNS_DATA_TYPE_JSON)_=e.readOson();else if(r===L.TNS_DATA_TYPE_VECTOR)_=e.readVector();else if(r===L.TNS_DATA_TYPE_INT_NAMED){let T=e.readDbObject();if(T.packedData){let l=t.fetchInfo?t.fetchInfo.dbTypeClass:t.typeClass;t.type===Ie.DB_TYPE_XMLTYPE?_=RI(this.connection,T.packedData):(_=new PI(l,T.packedData),_.toid=T.toid,_.oid=T.oid)}}else Os.throwErr(Os.ERR_UNSUPPORTED_DATA_TYPE,s.num,t.columnNum);if(this.inFetch)(r===L.TNS_DATA_TYPE_LONG||r===L.TNS_DATA_TYPE_LONG_RAW||t.maxSize>e.caps.maxStringSize)&&(e.skipSB4(),e.skipUB4());else{let T=e.readSB4();T<0&&r===L.TNS_DATA_TYPE_BOOLEAN?_=null:T!==0&&_!==null&&r!==L.TNS_DATA_TYPE_INT_NAMED&&this.saveDeferredErr(Os.ERR_INSUFFICIENT_BUFFER_FOR_BINDS)}return _}processReturnParameter(e){let t=0,s,r=e.readUB2();for(let a=0;a<r;a++)e.skipUB4();let n=e.readUB2();n>0&&e.skipBytes(n),r=e.readUB2();for(let a=0;a<r;a++)n=e.readUB2(),n>0&&(s=e.readStr(L.CSFRM_IMPLICIT)),n=e.readUB2(),n>0&&e.skipBytesChunked(),t=e.readUB2(),t===L.TNS_KEYWORD_NUM_CURRENT_SCHEMA?this.connection.currentSchema=s:t===L.TNS_KEYWORD_NUM_EDITION&&(this.connection._edition=s);if(n=e.readUB2(),n>0&&e.skip(n),this.arrayDmlRowCounts){let a=e.readUB4(),_=this.options.dmlRowCounts=[];for(let T=0;T<a;T++){let l=e.readUB8();_.push(l)}}}async postProcess(){if(this.deferredErr)throw this.deferredErr;if(this.outVariables)for(let e of this.outVariables)if(e.isArray){if(e.outConverter)for(let t=0;t<e.numElementsInArray;t++)e.values[0][t]=await e.outConverter(e.values[0][t])}else e.outConverter&&(e.values[0]=await e.outConverter(e.values[0]));await this.connection._populatePartialDbObjectTypes();for(let e of this.resultSetsToSetup){e._setup(this.options,e.metadata);for(let t of e.statement.queryVars)(t.type===Ie.DB_TYPE_CLOB||t.type===Ie.DB_TYPE_NCLOB||t.type===Ie.DB_TYPE_BLOB||t.type===Ie.DB_TYPE_BFILE||t.type===Ie.DB_TYPE_JSON||t.type===Ie.DB_TYPE_VECTOR)&&(t.type!==t.fetchInfo.fetchType&&(t.type=t.fetchInfo.fetchType,t.maxSize=L.TNS_MAX_LONG_LENGTH),e.statement.noPrefetch||(e.statement.requiresDefine=!0,e.statement.noPrefetch=!0))}}preProcess(){if(this.statement.isReturning&&!this.parseOnly){this.outVariables=[];for(let e of this.statement.bindInfoList)e.isReturnBind&&this.outVariables.push(e.bindVar)}if(this.statement.isQuery&&(this.inFetch=!0,this.statement.queryVars)){this.outVariables=[];for(let e=0;e<this.statement.queryVars.length;e++)this.outVariables.push(this.statement.queryVars[e])}}processBitVector(e){this.numColumnsSent=e.readUB2();let t=Math.floor(this.statement.numQueryVars/8);this.statement.numQueryVars%8>0&&(t+=1),this.bitVector=Cs.from(e.readBytes(t))}processBindParams(e,t){let s=[],r=[];for(let n of t)n.isReturnBind||r.push(n),s.push(n.bindVar);return this.writeColumnMetadata(e,s),r}writeColumnMetadata(e,t){for(let s of t){let r=s.type._oraTypeNum,n=s.maxSize||s.type._bufferSizeFactor,a=0;s.type._csfrm===L.CSFRM_NCHAR&&(n*=s.type._bufferSizeFactor),[L.TNS_DATA_TYPE_ROWID,L.TNS_DATA_TYPE_UROWID].includes(r)&&(r=L.TNS_DATA_TYPE_VARCHAR,n=L.TNS_MAX_UROWID_LENGTH);let _=L.TNS_BIND_USE_INDICATORS;s.isArray&&(_|=L.TNS_BIND_ARRAY);let T=0;if(s.type===Ie.DB_TYPE_BLOB||s.type===Ie.DB_TYPE_CLOB||s.type===Ie.DB_TYPE_NCLOB||s.type===Ie.DB_TYPE_BFILE?T=L.TNS_LOB_PREFETCH_FLAG:s.type===Ie.DB_TYPE_JSON?(T=L.TNS_LOB_PREFETCH_FLAG,n=a=L.TNS_JSON_MAX_LENGTH):s.type===Ie.DB_TYPE_VECTOR&&(T=L.TNS_LOB_PREFETCH_FLAG,n=a=L.TNS_VECTOR_MAX_LENGTH),e.writeUInt8(r),e.writeUInt8(_),e.writeUInt8(0),e.writeUInt8(0),n>e.caps.maxStringSize?e.writeUB4(L.TNS_MAX_LONG_LENGTH):e.writeUB4(n),s.isArray?e.writeUB4(s.maxArraySize):e.writeUB4(0),e.writeUB4(T),s.objType){let l=s.objType;e.writeUB4(l.oid.length),e.writeBytesWithLength(l.oid),e.writeUB2(l.version)}else e.writeUB4(0),e.writeUB2(0);s.type._csfrm!==0?e.writeUB2(L.TNS_CHARSET_UTF8):e.writeUB2(0),e.writeUInt8(s.type._csfrm),e.writeUB4(a),e.caps.ttcFieldVersion>=L.TNS_CCAP_FIELD_VERSION_12_2&&e.writeUB4(0)}}writeBindParamsRow(e,t,s){let r=this.offset,n=!1;for(let a of t){if(a.isReturnBind)continue;let _=a.bindVar;if(_.isArray){let T=_.values.length;e.writeUB4(T);for(let l=0;l<T;l++)this.writeBindParamsColumn(e,_,_.values[l])}else!this.statement.isPlSql&&_.maxSize>e.caps.maxStringSize?n=!0:this.writeBindParamsColumn(e,_,_.values[s+r])}if(n)for(let a of t){if(a.isReturnBind)continue;let _=a.bindVar;_.maxSize>e.caps.maxStringSize&&this.writeBindParamsColumn(e,_,_.values[s+r])}}writeBindParamsColumn(e,t,s){let r=t.type._oraTypeNum,n;if(s==null&&r!==L.TNS_DATA_TYPE_CURSOR&&r!==L.TNS_DATA_TYPE_JSON)r===L.TNS_DATA_TYPE_BOOLEAN?(e.writeUInt8(L.TNS_ESCAPE_CHAR),e.writeUInt8(1)):r===L.TNS_DATA_TYPE_INT_NAMED?(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(L.TNS_OBJ_TOP_LEVEL)):e.writeUInt8(0);else if(r===L.TNS_DATA_TYPE_NUMBER||r===L.TNS_DATA_TYPE_BINARY_INTEGER)typeof s=="boolean"?n=s?"1":"0":n=s.toString(),e.writeOracleNumber(n);else if(r===L.TNS_DATA_TYPE_VARCHAR||r===L.TNS_DATA_TYPE_CHAR||r===L.TNS_DATA_TYPE_LONG||r===L.TNS_DATA_TYPE_RAW||r===L.TNS_DATA_TYPE_LONG_RAW)t.type._csfrm===L.CSFRM_NCHAR?(e.caps.checkNCharsetId(),s=Cs.from(s,L.TNS_ENCODING_UTF16).swap16()):s=Cs.from(s),e.writeBytesWithLength(s);else if(r===L.TNS_DATA_TYPE_DATE||r===L.TNS_DATA_TYPE_TIMESTAMP||r===L.TNS_DATA_TYPE_TIMESTAMP_TZ||r===L.TNS_DATA_TYPE_TIMESTAMP_LTZ)e.writeOracleDate(s,t.type);else if(r===L.TNS_DATA_TYPE_BINARY_DOUBLE)e.writeUInt8(8),e.writeBinaryDouble(s);else if(r===L.TNS_DATA_TYPE_BINARY_FLOAT)e.writeUInt8(4),e.writeBinaryFloat(s);else if(r===L.TNS_DATA_TYPE_CURSOR){let a=s;s||(a=this.connection._createResultSet()),a.statement.cursorId===0?(e.writeUInt8(1),e.writeUInt8(0)):(e.writeUB4(1),e.writeUB4(a.statement.cursorId))}else if(r===L.TNS_DATA_TYPE_BOOLEAN)s?(e.writeUInt8(2),e.writeUInt16BE(257)):e.writeUInt16BE(256);else if(r===L.TNS_DATA_TYPE_CLOB||r===L.TNS_DATA_TYPE_BLOB||r===L.TNS_DATA_TYPE_BFILE)e.writeUB4(s._locator.length),e.writeBytesWithLength(s._locator);else if([L.TNS_DATA_TYPE_ROWID,L.TNS_DATA_TYPE_UROWID].includes(r))e.writeBytesWithLength(Cs.from(s));else if(r===L.TNS_DATA_TYPE_JSON)e.writeOson(s,this.connection._osonMaxFieldNameSize);else if(r===L.TNS_DATA_TYPE_VECTOR)e.writeVector(s);else if(r===L.TNS_DATA_TYPE_INT_NAMED)e.writeDbObject(s);else{let a=`Binding data of type ${t.type}`;Os.throwErr(Os.ERR_NOT_IMPLEMENTED,a)}}createCursorFromDescribe(e){let t=this.connection._createResultSet(this.options);return t.options.moreRowsToFetch=!0,t.statement.isQuery=!0,t.statement.requiresFullExecute=!0,this.processDescribeInfo(e,t),t}processImplicitResultSet(e){this.options.implicitResultSet=[];let t=e.readUB4();for(let s=0;s<t;s++){let r=e.readUInt8();e.skipBytes(r);let n=this.createCursorFromDescribe(e);n.statement.cursorId=e.readUB2(),this.options.implicitResultSet.push(n)}}};c(B_,"MessageWithData");var L_=B_,ZS=c(i=>i===0||i===L.TNS_NULL_LENGTH_INDICATOR,"isNullLength");eA.exports=L_});var M_=P((Kw,sA)=>{"use strict";var DI=w_(),Ce=we(),tA=W(),Y_=class Y_ extends DI{constructor(e,t,s,r){super(e,t,s),!r&&t.isQuery&&(r=e._createResultSet(s,t)),this.resultSet=r,this.functionCode=Ce.TNS_FUNC_EXECUTE,this.bindParams=void 0,this.currentRow=0}writeExecuteMessage(e){let t=0,s=0,r=0,n=1,a=this.statement,_=a.bindInfoList;if(this.noImplicitRelease&&(s|=Ce.TNS_EXEC_OPTION_NO_IMPL_REL),!a.requiresDefine&&!this.parseOnly&&_&&(r=_.length),a.requiresDefine?t|=Ce.TNS_EXEC_OPTION_DEFINE:!this.parseOnly&&a.sql&&(s|=Ce.TNS_EXEC_OPTION_IMPLICIT_RESULTSET,t|=Ce.TNS_EXEC_OPTION_EXECUTE),(a.cursorId===0||a.isDdl)&&(t|=Ce.TNS_EXEC_OPTION_PARSE),a.isQuery&&(this.parseOnly?t|=Ce.TNS_EXEC_OPTION_DESCRIBE:(a.cursorId===0||a.requiresDefine?n=this.options.prefetchRows:n=this.options.fetchArraySize,n>0&&!a.noPrefetch&&(t|=Ce.TNS_EXEC_OPTION_FETCH))),!a.isPlSql&&!this.parseOnly?t|=Ce.TNS_EXEC_OPTION_NOT_PLSQL:a.isPlSql&&r>0&&(t|=Ce.TNS_EXEC_OPTION_PLSQL_BIND),r>0&&(t|=Ce.TNS_EXEC_OPTION_BIND),this.batchErrors&&(t|=Ce.TNS_EXEC_OPTION_BATCH_ERRORS),this.arrayDmlRowCounts&&(s=Ce.TNS_EXEC_OPTION_DML_ROWCOUNTS),this.options.autoCommit&&(t|=Ce.TNS_EXEC_OPTION_COMMIT),this.writePiggybacks(e),this.writeFunctionHeader(e),e.writeUB4(t),e.writeUB4(a.cursorId),a.cursorId===0||a.isDdl?(e.writeUInt8(1),e.writeUB4(a.sqlLength)):(e.writeUInt8(0),e.writeUB4(0)),e.writeUInt8(1),e.writeUB4(13),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(n),e.writeUB4(Ce.TNS_MAX_LONG_LENGTH),r===0?(e.writeUInt8(0),e.writeUB4(0)):(e.writeUInt8(1),e.writeUB4(r)),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),e.writeUInt8(0),a.requiresDefine?(e.writeUInt8(1),e.writeUB4(this.statement.queryVars.length)):(e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(0),e.writeUInt8(0),e.writeUInt8(1),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUB4(0),this.arrayDmlRowCounts?(e.writeUInt8(1),e.writeUB4(this.numExecs),e.writeUInt8(1)):(e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0)),e.caps.ttcFieldVersion>=Ce.TNS_CCAP_FIELD_VERSION_12_2&&(e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0),e.writeUInt8(0),e.caps.ttcFieldVersion>=Ce.TNS_CCAP_FIELD_VERSION_12_2_EXT1&&(e.writeUInt8(0),e.writeUB4(0))),a.cursorId===0||a.isDdl?a.sql?(e.writeBytesWithLength(a.sqlBytes),e.writeUB4(1)):tA.throwErr(tA.ERR_INVALID_REF_CURSOR):e.writeUB4(0),a.isQuery?a.cursorId===0?e.writeUB4(0):e.writeUB4(n):e.writeUB4(this.numExecs),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUB4(a.isQuery?1:0),e.writeUB4(0),e.writeUB4(s),e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),a.requiresDefine)this.writeColumnMetadata(e,this.statement.queryVars);else if(r>0)return this.processBindParams(e,_)}writeReExecuteMessage(e){let t=this.statement,s=t.bindInfoList,r=0,n=0,a;if(s!==void 0){t.isQuery||(this.outVariables=[],s.forEach(T=>{T.bindDir!==Ce.TNS_BIND_DIR_INPUT&&this.outVariables.push(T.bindVar)}));let _=[];s.forEach(T=>{T.bindDir!==Ce.TNS_BIND_DIR_OUTPUT&&!T.isReturnBind&&_.push(T)}),s=_}return this.functionCode===Ce.TNS_FUNC_REEXECUTE_AND_FETCH?(r|=Ce.TNS_EXEC_OPTION_EXECUTE,a=this.options.prefetchRows):(this.options.autoCommit&&(n|=Ce.TNS_EXEC_OPTION_COMMIT_REEXECUTE),a=this.numExecs),this.writePiggybacks(e),this.writeFunctionHeader(e),e.writeUB4(t.cursorId),e.writeUB4(a),e.writeUB4(r),e.writeUB4(n),s}encode(e){if(this.currentRow===0){let t=this.statement;t.cursorId!==0&&!t.requiresFullExecute&&!this.parseOnly&&!t.requiresDefine&&!t.noPrefetch&&!t.isDdl&&!this.batchErrors?(t.isQuery&&this.options.prefetchRows>0?this.functionCode=Ce.TNS_FUNC_REEXECUTE_AND_FETCH:this.functionCode=Ce.TNS_FUNC_REEXECUTE,this.bindParams=this.writeReExecuteMessage(e)):(this.functionCode=Ce.TNS_FUNC_EXECUTE,this.bindParams=this.writeExecuteMessage(e))}if(this.bindParams&&this.bindParams.length>0){let t=e.nsi.ntAdapter;for(;this.currentRow<this.numExecs;)if(e.writeUInt8(Ce.TNS_MSG_TYPE_ROW_DATA),this.writeBindParamsRow(e,this.bindParams,this.currentRow),this.currentRow++,this.currentRow<this.numExecs&&t.shouldPauseWrite())return!0}this.currentRow=0,this.bindParams=void 0}};c(Y_,"ExecuteMessage");var U_=Y_;sA.exports=U_});var x_=P((Xw,iA)=>{"use strict";var CI=we(),OI=w_(),rA=W(),F_=class F_ extends OI{constructor(e,t,s,r){super(e,t,s),this.resultSet=r,this.functionCode=CI.TNS_FUNC_FETCH}encode(e){this.writeFunctionHeader(e),this.statement.cursorId===0&&rA.throwErr(rA.ERR_CURSOR_HAS_BEEN_CLOSED),e.writeUB4(this.statement.cursorId),e.writeUB4(this.options.fetchArraySize)}};c(F_,"FetchMessage");var V_=F_;iA.exports=V_});var q_=P(($w,nA)=>{"use strict";var gI=da(),yI=M_(),LI=x_(),k_=class k_ extends gI{async _fetchMoreRows(e){let t=this.statement.requiresFullExecute?yI:LI,s=new t(this.connection,this.statement,e,this);await this.connection._protocol._processMessage(s),this.statement.requiresFullExecute=!1}_resultSetNew(e,t,s){this.connection=e,this.statement=t,this._nestedCursorIndices=[],this.options=s,this.prefetchRowsProcessed=!1,this.statement.bufferRowIndex=0}close(){this.connection._returnStatement(this.statement)}_processRows(e){let t=[],s=this.statement.bufferRowIndex;for(let r=s;r<s+e;r++){let n=[];for(let a=0;a<this.statement.numQueryVars;a++)n.push(this.statement.queryVars[a].values[r]);t.push(n)}return this.statement.bufferRowIndex+=e,this.statement.bufferRowIndex===this.statement.bufferRowCount&&(this.statement.bufferRowCount=0,this.statement.bufferRowIndex=0),t}async getRows(e,t){if(t.fetchArraySize=e||this.options.fetchArraySize,t.prefetchRows=this.options.prefetchRows,this.statement.bufferRowCount-this.statement.bufferRowIndex>=t.fetchArraySize)return this._processRows(t.fetchArraySize);{t.fetchArraySize=t.fetchArraySize-(this.statement.bufferRowCount-this.statement.bufferRowIndex);let r=this.statement.bufferRowCount;if(this.statement.moreRowsToFetch&&t.fetchArraySize>0&&await this._fetchMoreRows(t),t.fetchArraySize=e||this.options.fetchArraySize,r===this.statement.bufferRowCount){let n=this.statement.bufferRowCount-this.statement.bufferRowIndex;return this.statement.bufferRowCount=0,n>0?this._processRows(n):[]}}let s=this.statement.bufferRowCount-this.statement.bufferRowIndex;return this._processRows(s)}};c(k_,"ThinResultSetImpl");var b_=k_;nA.exports=b_});var cA=P((Jw,_A)=>{"use strict";var{Buffer:oA}=require("buffer"),b=we(),aA=W(),H_=class H_{constructor(e){this.protocolVersion=e.sAtts.version,this.ttcFieldVersion=b.TNS_CCAP_FIELD_VERSION_MAX,this.supports12cLogon=!0,this.supportsOob=!1,this.nCharsetId=b.TNS_CHARSET_UTF16,this.compileCaps=oA.alloc(b.TNS_CCAP_MAX),this.runtimeCaps=oA.alloc(b.TNS_RCAP_MAX),this.initCompileCaps(e),this.initRuntimeCaps(),this.maxStringSize=0}adjustForServerCompileCaps(e,t){e[b.TNS_CCAP_FIELD_VERSION]<this.ttcFieldVersion&&(this.ttcFieldVersion=e[b.TNS_CCAP_FIELD_VERSION],this.compileCaps[b.TNS_CCAP_FIELD_VERSION]=this.ttcFieldVersion),this.ttcFieldVersion<b.TNS_CCAP_FIELD_VERSION_23_4&&t.endOfRequestSupport&&(this.compileCaps[b.TNS_CCAP_TTC4]^=b.TNS_CCAP_END_OF_REQUEST,t.endOfRequestSupport=!1)}adjustForServerRuntimeCaps(e){e[b.TNS_RCAP_TTC]&b.TNS_RCAP_TTC_32K?this.maxStringSize=32767:this.maxStringSize=4e3}initCompileCaps(e){this.compileCaps[b.TNS_CCAP_SQL_VERSION]=b.TNS_CCAP_SQL_VERSION_MAX,this.compileCaps[b.TNS_CCAP_LOGON_TYPES]=b.TNS_CCAP_O5LOGON|b.TNS_CCAP_O5LOGON_NP|b.TNS_CCAP_O7LOGON|b.TNS_CCAP_O8LOGON_LONG_IDENTIFIER|b.TNS_CCAP_O9LOGON_LONG_PASSWORD,this.compileCaps[b.TNS_CCAP_FIELD_VERSION]=this.ttcFieldVersion,this.compileCaps[b.TNS_CCAP_SERVER_DEFINE_CONV]=1,this.compileCaps[b.TNS_CCAP_TTC1]=b.TNS_CCAP_FAST_BVEC|b.TNS_CCAP_END_OF_CALL_STATUS|b.TNS_CCAP_IND_RCD,this.compileCaps[b.TNS_CCAP_OCI1]=b.TNS_CCAP_FAST_SESSION_PROPAGATE|b.TNS_CCAP_APP_CTX_PIGGYBACK,this.compileCaps[b.TNS_CCAP_TDS_VERSION]=b.TNS_CCAP_TDS_VERSION_MAX,this.compileCaps[b.TNS_CCAP_RPC_VERSION]=b.TNS_CCAP_RPC_VERSION_MAX,this.compileCaps[b.TNS_CCAP_RPC_SIG]=b.TNS_CCAP_RPC_SIG_VALUE,this.compileCaps[b.TNS_CCAP_DBF_VERSION]=b.TNS_CCAP_DBF_VERSION_MAX,this.compileCaps[b.TNS_CCAP_LOB]=b.TNS_CCAP_LOB_UB8_SIZE|b.TNS_CCAP_LOB_ENCS|b.TNS_CCAP_LOB_PREFETCH|b.TNS_CCAP_LOB_TEMP_SIZE|b.TNS_CCAP_LOB_12C|b.TNS_CCAP_LOB_PREFETCH_DATA,this.compileCaps[b.TNS_CCAP_UB2_DTY]=1,this.compileCaps[b.TNS_CCAP_LOB2]=b.TNS_CCAP_LOB2_QUASI|b.TNS_CCAP_LOB2_2GB_PREFETCH,this.compileCaps[b.TNS_CCAP_TTC3]=b.TNS_CCAP_IMPLICIT_RESULTS|b.TNS_CCAP_BIG_CHUNK_CLR|b.TNS_CCAP_KEEP_OUT_ORDER,this.compileCaps[b.TNS_CCAP_TTC2]=b.TNS_CCAP_ZLNP,this.compileCaps[b.TNS_CCAP_OCI2]=b.TNS_CCAP_DRCP,this.compileCaps[b.TNS_CCAP_CLIENT_FN]=b.TNS_CCAP_CLIENT_FN_MAX,this.compileCaps[b.TNS_CCAP_TTC4]=b.TNS_CCAP_INBAND_NOTIFICATION,e.endOfRequestSupport&&(this.compileCaps[b.TNS_CCAP_TTC4]|=b.TNS_CCAP_END_OF_REQUEST),this.compileCaps[b.TNS_CCAP_CTB_FEATURE_BACKPORT]=b.TNS_CCAP_CTB_IMPLICIT_POOL,this.compileCaps[b.TNS_CCAP_TTC5]=b.TNS_CCAP_VECTOR_SUPPORT,this.compileCaps[b.TNS_CCAP_VECTOR_FEATURES]=b.TNS_CCAP_VECTOR_FEATURE_BINARY}initRuntimeCaps(){this.runtimeCaps[b.TNS_RCAP_COMPAT]=b.TNS_RCAP_COMPAT_81,this.runtimeCaps[b.TNS_RCAP_TTC]=b.TNS_RCAP_TTC_ZERO_COPY|b.TNS_RCAP_TTC_32K}checkNCharsetId(){this.nCharsetId!==b.TNS_CHARSET_UTF16&&aA.throwErr(aA.ERR_NCHAR_CS_NOT_SUPPORTED,this.nCharsetId)}};c(H_,"Capabilities");var G_=H_;_A.exports=G_});var SA=P((Zw,NA)=>{"use strict";var{BaseBuffer:EA}=nr(),{Buffer:es}=require("buffer"),rt=we(),uA=Mi(),TA=kr(),hA=Ri(),tn=W(),Ar=es.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/","utf8"),BI=2048,wI=8,lA=11,X_=class X_{constructor(e){this.allocLen=e;let t=e%rt.CHUNKED_BYTES_CHUNK_SIZE;t>0&&(this.allocLen+=rt.CHUNKED_BYTES_CHUNK_SIZE-t),this.buf=es.allocUnsafe(this.allocLen),this.actualLen=0}};c(X_,"BytesChunk");var sn=X_,z_=class z_{constructor(){this.chunks=[]}endChunkedRead(){if(this.chunks.length>1){let t=0;for(let n of this.chunks)t+=n.actualLen;let s=0,r=new sn(t);for(let n of this.chunks)n.buf.copy(r.buf,s,0,n.actualLen),s+=n.actualLen;r.actualLen=t,this.chunks=[r]}let e=this.chunks[0];return e.buf.subarray(0,e.actualLen)}getBuf(e){let t;this.chunks.length>0&&(t=this.chunks[this.chunks.length-1],t.allocLen-t.actualLen<e&&(t=void 0)),t||(t=new sn(e),this.chunks.push(t));let s=t.buf.subarray(t.actualLen,t.actualLen+e);return t.actualLen+=e,s}startChunkedRead(){this.chunks.length>0&&(this.chunks=this.chunks.splice(0,1),this.chunks[0].actualLen=0)}};c(z_,"ChunkedBytesBuffer");var v_=z_,$_=class $_ extends EA{constructor(e,t){super(),this.nsi=e,this.caps=t,this.chunkedBytesBuf=new v_}_readBytesWithLength(e){if(e!==rt.TNS_LONG_LENGTH_INDICATOR)return this.readBytes(e);for(this.chunkedBytesBuf.startChunkedRead();;){let t=this.readUB4();if(t===0)break;this.readBytes(t,!0)}return this.chunkedBytesBuf.endChunkedRead()}skipBytes(e){this.pos===this.size&&this.receivePacket();let t=this.numBytesLeft();if(e<=t){this.pos+=e;return}for(e-=t;e>0;){this.receivePacket();let s=Math.min(e,this.size-this.pos);this.pos+=s,e-=s}}readBytes(e,t=!1){this.pos===this.size&&this.receivePacket();let s=this.numBytesLeft();if(e<=s){let a;return t?(a=this.chunkedBytesBuf.getBuf(e),this.buf.copy(a,0,this.pos,this.pos+e)):a=this.buf.subarray(this.pos,this.pos+e),this.pos+=e,a}let r;t?r=this.chunkedBytesBuf.getBuf(e):r=es.allocUnsafe(e);let n=0;for(this.buf.copy(r,n,this.pos,this.pos+s),n+=s,e-=s;e>0;){this.receivePacket();let a=Math.min(e,this.size-this.pos);this.buf.copy(r,n,this.pos,this.pos+a),this.pos+=a,n+=a,e-=a}return r}receivePacket(){if(this.savedPacketPos===this.savedPackets.length){let e=this.nsi.syncRecvPacket();if(!e||this.nsi.isBreak)throw new TA.OutOfPacketsError;this.savedPackets.push(e)}this.startPacket(this.savedPackets[this.savedPacketPos++])}restorePoint(){this.savedPacketPos=0,this.startPacket(this.savedPackets[this.savedPacketPos++]),this.pos=this.savedPos}savePoint(){this.savedPackets?this.savedPackets=this.savedPackets.splice(this.savedPacketPos-1):this.savedPackets=[this.packet],this.savedPacketPos=1,this.savedPos=this.pos}startPacket(e){this.packet=e,this.buf=e.buf,this.pos=10,this.size=e.buf.length,this.packetNum=e.num}async waitForPackets(e=!1){let t=await this.nsi.recvPacket();if(this.savedPackets?this.savedPackets.push(t):(this.savedPackets=[t],this.savedPacketPos=0),e&&this.nsi.endOfRequestSupport)for(;t.type===rt.TNS_PACKET_TYPE_DATA&&!(t.buf.readUInt16BE(8)&rt.TNS_DATA_FLAGS_END_OF_REQUEST||t.buf.length===lA&&t.buf[lA-1]===rt.TNS_MSG_TYPE_END_OF_REQUEST);)t=await this.nsi.recvPacket(),this.savedPackets.push(t);this.startPacket(this.savedPackets[this.savedPacketPos++])}readOson(){if(this.readUB4()===0)return null;this.skipUB8(),this.skipUB4();let t=new uA.OsonDecoder(this.readBytesWithLength());return this.skipBytesChunked(),t.decode()}readURowID(){let e=0,t=1,s=this.readBytesWithLength();if(s===null)return null;s=this.readBytesWithLength();let r=s.length;if(s&&s[0]===1){let T=s.readUInt32BE(1),l=s.readUInt16BE(5),E=s.readUInt32BE(7),h=s.readUInt16BE(11);return TA.encodeRowID({rba:T,partitionID:l,blockNum:E,slotNum:h})}let n=Math.floor(r/3)*4,a=r%3;a===1?n+=1:a===2&&(n+=3);let _=es.allocUnsafe(n);for(r-=1,_[0]=42,e+=1;r>0;){let T=s[t]>>2;if(_[e]=Ar[T],e+=1,T=(s[t]&3)<<4,r==1){_[e]=Ar[T];break}if(t+=1,T|=(s[t]&240)>>4,_[e]=Ar[T],e+=1,T=(s[t]&15)<<2,r==2){_[e]=Ar[T];break}t+=1,T|=(s[t]&192)>>6,_[e]=Ar[T],e+=1,T=s[t]&63,_[e]=Ar[T],e+=1,t+=1,r-=3}return _.toString("utf-8")}readRowID(){let e=this.readUB4(),t=this.readUB2();this.skipUB1();let s=this.readUB4(),r=this.readUB2();return{rba:e,partitionID:t,blockNum:s,slotNum:r}}readVector(){if(this.readUB4()===0)return null;this.skipUB8(),this.skipUB4();let t=new hA.VectorDecoder(this.readBytesWithLength());return this.skipBytesChunked(),t.decode()}skipBytesChunked(){let e=this.readUInt8();if(!(e===0||e===rt.TNS_NULL_LENGTH_INDICATOR))if(e!==rt.TNS_LONG_LENGTH_INDICATOR)this.skipBytes(e);else for(;;){let t=this.readUB4();if(t===0)break;this.skipBytes(t)}}readNullTerminatedBytes(e=50){let t=0,s=es.allocUnsafe(e);for(;t<e&&(s[t]=this.readUInt8(),s[t]!==0);)t=t+1;if(t===e){let r=`Byte Arrray Exceeded MaxSize ${e}`;tn.throwErr(tn.ERR_INTERNAL,r)}return s.subarray(0,t+1)}};c($_,"ReadPacket");var K_=$_,j_=class j_ extends EA{constructor(e,t,s){super(e.sAtts.sdu),this.size=this.maxSize,this.isLargeSDU=e.sAtts.version>=rt.TNS_VERSION_MIN_LARGE_SDU,this.protocol=s,this.packetType=rt.TNS_PACKET_TYPE_DATA,this.caps=t,this.nsi=e}_grow(){this._sendPacket()}_sendPacket(e=!1){let t=this.pos;this.pos=0,this.isLargeSDU?this.writeUInt32BE(t):(this.writeUInt16BE(t),this.writeUInt16BE(0)),this.writeUInt8(this.packetType),this.writeUInt8(0),this.writeUInt16BE(0);let s=this.buf.subarray(0,t);e?this.buf.writeUInt16BE(BI,wI):(s=es.from(s),this.startPacket()),this.nsi.ntAdapter||tn.throwErr(tn.ERR_INVALID_CONNECTION),this.nsi.ntAdapter.send(s)}startPacket(e=0){this.pos=rt.PACKET_HEADER_SIZE,this.packetType===rt.TNS_PACKET_TYPE_DATA&&this.writeUInt16BE(e)}startRequest(e,t=0){this.packetType=e,this.startPacket(t)}endRequest(){this.pos>rt.PACKET_HEADER_SIZE&&this._sendPacket(!0)}writeKeyValue(e,t,s=0){let r=es.byteLength(e),n=es.byteLength(t);this.writeUB4(r),this.writeBytesWithLength(es.from(e)),this.writeUB4(n),n>0&&this.writeBytesWithLength(es.from(t)),this.writeUB4(s)}writeOson(e,t){let r=new uA.OsonEncoder().encode(e,t);this.writeQLocator(r.length),this.writeBytesWithLength(r)}writeSeqNum(){this.writeUInt8(this.protocol.sequenceId),this.protocol.sequenceId=(this.protocol.sequenceId+1)%256}writeVector(e){let s=new hA.VectorEncoder().encode(e);this.writeQLocator(s.length),this.writeBytesWithLength(s)}writeQLocator(e){this.writeUB4(40),this.writeUInt8(40),this.writeUInt16BE(38),this.writeUInt16BE(rt.TNS_LOB_QLOCATOR_VERSION),this.writeUInt8(rt.TNS_LOB_LOC_FLAGS_VALUE_BASED|rt.TNS_LOB_LOC_FLAGS_BLOB|rt.TNS_LOB_LOC_FLAGS_ABSTRACT),this.writeUInt8(rt.TNS_LOB_LOC_FLAGS_INIT),this.writeUInt16BE(0),this.writeUInt16BE(1),this.writeUInt64BE(e),this.writeUInt16BE(0),this.writeUInt16BE(0),this.writeUInt16BE(0),this.writeUInt64BE(0),this.writeUInt64BE(0)}};c(j_,"WritePacket");var W_=j_;NA.exports={ReadPacket:K_,WritePacket:W_}});var dA=P((t0,AA)=>{"use strict";var dr=we(),UI=cA(),{WritePacket:YI,ReadPacket:MI}=SA(),Hs=W(),VI=kr(),Q_=class Q_{constructor(e){this._breakInProgress=!1,this.txnInProgress=!1,this.connInProgress=!0,this.nsi=e.nscon,this.sequenceId=1,this.caps=new UI(e.nscon),this.writeBuf=new YI(e.nscon,this.caps,this),this.readBuf=new MI(e.nscon,this.caps),this.callTimeout=0}async _decodeMessage(e){for(e.preProcess(),await this.readBuf.waitForPackets(!0);;){this.nsi.isBreak&&(await this.resetMessage(),delete this.readBuf.savedPackets,await this.readBuf.waitForPackets());try{e.decode(this.readBuf);break}catch(t){if(t instanceof VI.OutOfPacketsError){this.nsi.isBreak||(await this.readBuf.waitForPackets(),this.readBuf.restorePoint());continue}throw t}}await e.postProcess()}async _encodeMessage(e){let t=this.nsi.ntAdapter;for(this.writeBuf.startRequest(dr.TNS_PACKET_TYPE_DATA);e.encode(this.writeBuf);)await t.pauseWrite();this.writeBuf.endRequest()}async _recoverFromError(e,t){try{this.breakMessage(),this._breakInProgress=!1,await this.resetMessage(),await this.readBuf.waitForPackets(),t.decode(this.readBuf)}catch(s){this.nsi.disconnect();let r=Hs.getErr(Hs.ERR_CONNECTION_CLOSED);throw e.message=r.message+`
Error recovery failed: `+s.message+`
Original error: `+e.message,e}}async _processMessage(e){let t,s=!1;try{this.callTimeout>0&&(t=setTimeout(()=>{s=!0,this.breakMessage()},this.callTimeout)),await this._encodeMessage(e),e.messageType!==dr.TNS_MSG_TYPE_ONEWAY_FN&&await this._decodeMessage(e)}catch(r){throw!this.connInProgress&&r.code!==Hs.ERR_CONNECTION_CLOSED_CODE&&await this._recoverFromError(r,e),r}finally{clearTimeout(t)}if(e.flushOutBinds&&await this.flushOutBindMessage(e),this.txnInProgress=!!(e.callStatus&dr.TNS_EOCS_FLAGS_TXN_IN_PROGRESS),e.callStatus&dr.TNS_EOCS_FLAGS_SESS_RELEASE&&e.connection.statementCache.clearCursors(),e.errorOccurred){if(s&&Hs.throwErr(Hs.ERR_CALL_TIMEOUT_EXCEEDED,this.callTimeout),e.retry)return e.errorOccurred=!1,await this._processMessage(e);let r=new Error(e.errorInfo.message);throw r.offset=e.errorInfo.pos,r.errorNum=e.errorInfo.num,r=Hs.transformErr(r),r.code===Hs.ERR_CONNECTION_CLOSED_CODE&&this.nsi.disconnect(),r}}async flushOutBindMessage(e){this.writeBuf.startRequest(dr.TNS_PACKET_TYPE_DATA),this.writeBuf.writeUInt8(dr.TNS_MSG_TYPE_FLUSH_OUT_BINDS),this.writeBuf.endRequest(),await this._decodeMessage(e)}breakMessage(){this._breakInProgress=!0,this.nsi.sendBreak()}async resetMessage(){await this.nsi.reset()}};c(Q_,"Protocol");var J_=Q_;AA.exports=J_});var pr=P((r0,pA)=>{pA.exports={NSPTCN:1,NSPTAC:2,NSPTAK:3,NSPTRF:4,NSPTRD:5,NSPTDA:6,NSPTNL:7,NSPTAB:9,NSPTRS:11,NSPTMK:12,NSPTAT:13,NSPTCNL:14,NSPTDD:15,NSPTHI:19,NSPHDLEN:0,NSPHDPSM:2,NSPHDTYP:4,NSPHDFLGS:5,NSPHDHSM:6,NSPSIZHD:8,NSPFSID:1,NSPFRDS:2,NSPFRDR:4,NSPFLSD:32,NO_HEADER_FLAGS:0,NSPFSRN:8,NSPCNVSN:8,NSPCNLOV:10,NSPCNOPT:12,NSPCNSDU:14,NSPCNTDU:16,NSPCNNTC:18,NSPCNTNA:20,NSPCNONE:22,NSPCNLEN:24,NSPCNOFF:26,NSPCNMXC:28,NSPCNFL0:32,NSPCNFL1:33,NSPCNTMO:50,NSPCNTCK:52,NSPCNADL:54,NSPCNAOF:56,NSPCNLSD:58,NSPCNLTD:62,NSPCNCFL:66,NSPCNCFL2:70,NSPCNDAT:74,NSPMXCDATA:230,NSINAWANTED:1,NSINAINTCHG:2,NSINADISABLEDFORCONNECTION:4,NSINANOSERVICES:8,NSINAREQUIRED:16,NSINAAUTHWANTED:32,NSISUPSECRENEG:128,NSGDONTCARE:1,NSGHDX:2,NSGFDX:4,NSGHDRCHKSUM:8,NSGPAKCHKSUM:16,NSGBROKEN:32,NSGUSEVIO:64,NSGOSAUTHOK:128,NSGSENDATTN:512,NSGRECVATTN:1024,NSGNOATTNPR:2048,NSGRAW:4096,TNS_VERSION_DESIRED:319,TNS_VERSION_MINIMUM:300,TNS_VERSION_MIN_DATA_FLAGS:318,TNS_VERSION_MIN_END_OF_RESPONSE:319,TNS_UUID_OFFSET:45,NSPACVSN:8,NSPACOPT:10,NSPACSDU:12,NSPACTDU:14,NSPACONE:16,NSPACLEN:18,NSPACOFF:20,NSPACFL0:22,NSPACFL1:23,NSPACTMO:24,NSPACTCK:26,NSPACADL:28,NSPACAOF:30,NSPACLSD:32,NSPACLTD:36,NSPACCFL:40,NSPACFL2:41,NSPACV310DAT:32,NSPACV315DAT:41,NSPRFURS:8,NSPRFSRS:9,NSPRFLEN:10,NSPRFDAT:12,NSPACCFON:128,NSPACCFAT:64,NSPACCFNT:2,NSPACOOB:1,NSGPCHKSCMD:16777216,TNS_ACCEPT_FLAG_HAS_END_OF_REQUEST:33554432,TNS_ACCEPT_FLAG_FAST_AUTH:268435456,NSPRDLEN:8,NSPRDDAT:10,NSPDAFLG:8,NSPDADAT:10,NSPDAFEOF:64,NSPMKTYP:8,NSPMKODT:9,NSPMKDAT:10,NSPMKTD0:0,NSPMKTD1:1,NSPMKTAT:2,NIQBMARK:1,NIQRMARK:2,NIQIMARK:3,NSPCTLCMD:8,NSPCTLDAT:10,NSPCTL_SERR:8,NSPCTL_CLRATTN:9,NSPDFSDULN:8192,NSPABSSDULN:2097152,NSPMXSDULN:65535,NSPMNSDULN:512,NSPDFTDULN:2097152,NSPMXTDULN:2097152,NSPMNTDULN:255,NSFIMM:64,DISABLE_OOB_STR:"DISABLE_OOB",EXPIRE_TIME:"EXPIRE_TIME",PEM_WALLET_FILE_NAME:"ewallet.pem",NT_MOREDATA:1,NS_MOREDATA:2,SVCNAME:3,SERVERTYPE:4,REMOTEADDR:5,HEALTHCHECK:6,CONNCLASS:7,PURITY:8,SID:9,NSNOBLOCK:1}});var PA=P((i0,mA)=>{"use strict";var rn=require("buffer").Buffer,F=pr(),gs=W(),FI=230,fA=74;function xI(i,e,t=0){this.connectData=i,this.connectDataLen=i.length,this.overflow=!1;let s;this.connectDataLen<=FI?s=fA+this.connectDataLen:(s=fA,this.overflow=!0),this.buf=rn.allocUnsafe(s).fill(0),this.buf.writeUInt16BE(s,F.NSPHDLEN),this.buf.writeUInt8(t,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTCN,F.NSPHDTYP),this.buf.writeUInt16BE(F.TNS_VERSION_DESIRED,F.NSPCNVSN),this.buf.writeUInt16BE(F.TNS_VERSION_MINIMUM,F.NSPCNLOV);let r=F.NSGDONTCARE;this.buf.writeUInt16BE(r,F.NSPCNOPT),e.sdu>F.NSPMXSDULN?this.buf.writeUInt16BE(F.NSPMXSDULN,F.NSPCNSDU):this.buf.writeUInt16BE(e.sdu,F.NSPCNSDU),e.tdu>F.NSPMXSDULN?this.buf.writeUInt16BE(F.NSPMXSDULN,F.NSPCNTDU):this.buf.writeUInt16BE(e.tdu,F.NSPCNTDU),this.buf.writeUInt16BE(e.ntCha,F.NSPCNNTC),this.buf.writeUInt16BE(1,F.NSPCNONE),this.buf.writeUInt16BE(this.connectDataLen,F.NSPCNLEN),this.buf.writeUInt16BE(F.NSPCNDAT,F.NSPCNOFF),this.buf.writeUInt8(F.NSISUPSECRENEG|F.NSINADISABLEDFORCONNECTION,F.NSPCNFL0),this.buf.writeUInt8(F.NSISUPSECRENEG|F.NSINADISABLEDFORCONNECTION,F.NSPCNFL1),this.buf.writeUInt16BE(0,F.NSPCNTMO),this.buf.writeUInt16BE(0,F.NSPCNTCK),this.buf.writeUInt16BE(0,F.NSPCNADL),this.buf.writeUInt16BE(0,F.NSPCNAOF),this.buf.writeUInt32BE(e.sdu,F.NSPCNLSD),this.buf.writeUInt32BE(e.tdu,F.NSPCNLTD),this.buf.writeUInt32BE(0,F.NSPCNCFL),this.buf.writeUInt32BE(0,F.NSPCNCFL2),!this.overflow&&this.connectDataLen&&this.buf.write(i.toString("ascii"),F.NSPCNDAT,this.connectDataLen,"ascii")}c(xI,"ConnectPacket");function bI(i){this.dataPtr=0,this.dataLen=0,this.offset=0,this.len=0,this.bufLen=0,this.createPacket=function(e){this.dataPtr=F.NSPDADAT,this.dataLen=F.NSPDADAT,this.buf=rn.allocUnsafe(e).fill(0),this.buf.writeUInt8(0,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTDA,F.NSPHDTYP),this.bufLen=e},this.fillBuf=function(e,t,s,r=0){let n;return this.buf||this.createPacket(s+F.NSPDADAT),s>this.bufLen-this.dataLen?n=this.bufLen-this.dataLen:n=s,n&&e.copy(this.buf,this.dataLen,t,t+n),this.dataLen+=n,this.prepare2Send(r),n},this.prepare2Send=function(e=0){i?this.buf.writeUInt32BE(this.dataLen,F.NSPHDLEN):this.buf.writeUInt16BE(this.dataLen,F.NSPHDLEN),this.buf.writeUInt16BE(e,F.NSPDAFLG),this.dataBuf=this.buf.subarray(0,this.dataLen)},this.fromPacket=function(e){this.buf=e.buf,this.dataLen=e.buf.length,this.dataPtr=F.NSPDADAT,this.offset=this.dataPtr,this.len=this.dataLen,e.dataOffset=this.dataPtr}}c(bI,"DataPacket");function kI(i,e){this.buf=i.buf,this.len=i.buf.length,e.version=i.buf.readUInt16BE(F.NSPACVSN),e.options=i.buf.readUInt16BE(F.NSPACOPT),e.sdu=i.buf.readUInt16BE(F.NSPACSDU),e.tdu=i.buf.readUInt16BE(F.NSPACTDU),e.version>=315&&(e.sdu=i.buf.readUInt32BE(F.NSPACLSD),e.tdu=i.buf.readUInt32BE(F.NSPACLTD),e.largeSDU=!0),this.flag0=i.buf.readUInt8(F.NSPACFL0),this.flag1=i.buf.readUInt8(F.NSPACFL1),e.version>=F.TNS_VERSION_MIN_DATA_FLAGS&&(i.flags=i.buf.readUInt32BE(F.NSPACFL2))}c(kI,"AcceptPacket");function qI(i){this.buf=i.buf,this.len=i.buf.length,this.userReason=i.buf.readUInt8(F.NSPRFURS),this.systemReason=i.buf.readUInt8(F.NSPRFURS),this.dataLen=i.buf.readUInt16BE(F.NSPRFLEN),this.dataOff=F.NSPRFDAT,this.len>this.dataOff?(this.dataBuf=this.buf.toString("ascii",this.dataOff,this.len),this.overflow=!1):this.overflow=!0}c(qI,"RefusePacket");function GI(i){this.buf=i.buf,this.len=i.buf.length,this.flags=i.flags,this.dataLen=i.buf.readUInt16BE(F.NSPRDLEN),this.dataOff=F.NSPRDDAT,this.len>this.dataOff?(this.dataBuf=this.buf.subarray(this.dataOff,this.len),this.overflow=!1):this.overflow=!0}c(GI,"RedirectPacket");function HI(i){this.len=F.NSPMKDAT+1,this.buf=rn.allocUnsafe(F.NSPMKDAT+1).fill(0),i?this.buf.writeUInt32BE(this.len,F.NSPHDLEN):this.buf.writeUInt16BE(this.len,F.NSPHDLEN),this.buf.writeUInt8(0,F.NSPHDFLGS),this.buf.writeUInt8(F.NSPTMK,F.NSPHDTYP),this.prepare=function(e,t){this.buf.writeUInt8(e,F.NSPMKTYP),this.buf.writeUInt8(t,F.NSPMKDAT)},this.fromPacket=function(e,t){switch(this.type=e.buf.readUInt8(F.NSPMKTYP),this.type){case F.NSPMKTD0:t.isBreak=!0;break;case F.NSPMKTD1:this.data=e.buf.readUInt8(F.NSPMKDAT),t.isBreak=!0,this.data==F.NIQRMARK&&(t.isReset=!0,t.isBreak=!0);break;default:gs.throwErr(gs.ERR_INVALID_PACKET)}}}c(HI,"MarkerPacket");function vI(){this.clear=function(){this.errno=0,this.notif=null,this.notifLen=0,this.cmd=0},this.fromPacket=function(i){let r,n,a;switch(this.cmd=i.buf.readUInt16BE(F.NSPCTLCMD),this.cmd){case F.NSPCTL_SERR:r=i.buf.readUInt32BE(F.NSPCTLDAT),n=i.buf.readUInt32BE(F.NSPCTLDAT+4),a=i.buf.readUInt32BE(F.NSPCTLDAT+8),n==12572?this.errno=n:n==12573?(this.errno=n,this.notifLen=a,this.notif=rn.allocUnsafe(a+1).fill(0),this.buf.copy(this.notif,0,F.NSPCTLDAT+12,F.NSPCTLDAT+12+a)):(this.errno=n,r==22?gs.throwErr(gs.ERR_CONNECTION_INBAND,"ORA-"+n):gs.throwErr(gs.ERR_CONNECTION_INBAND,"TNS-"+n));break;default:gs.throwErr(gs.ERR_INVALID_PACKET)}}}c(vI,"ControlPacket");mA.exports={ConnectPacket:xI,DataPacket:bI,AcceptPacket:kI,RefusePacket:qI,RedirectPacket:GI,MarkerPacket:HI,ControlPacket:vI}});var fr=P((o0,yA)=>{"use strict";var me=W(),RA=0,vr=1,Z_=2,ec=3,nn=4,cc=class cc{constructor(e){this.name=e,this.listType=ec,this.rhsType=RA}set setAtom(e){this._containsComment(e)&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.rhsType=vr,this.list=null,this.atom=e}_containsComment(e){for(let t=0;t<e.length;t++)if(e.charAt(t)=="#")if(t!=0){if(e.charAt(t-1)=="\\")continue;return!0}else return!0;return!1}getListSize(){return this.list==null?0:this.list.length}getListElement(e){return this.list==null?null:this.list[e]}addListElement(e){this.list==null&&(this.rhsType=Z_,this.list=new Array,this.atom=null),this.list.push(e),e.parent=this}removeListElement(e){this.list!=null&&(this.list.splice(e,1),this.getListSize==0&&(this.list=null,this.rhsType=RA))}_space(e){var t="";for(let s=0;s<e;s++)t+=" ";return t}valueToString(){let e="";if(this.rhsType==vr)e=e+this.atom;else if(this.rhsType==Z_){if(this.listType==ec)for(let t=0;t<this.getListSize();t++)e=e+this.getListElement(t).toString();else if(this.listType==nn)for(let t=0;t<this.getListSize();t++){let s=this.getListElement(t);e=e+s.name,t!=this.getListSize()-1&&(e=e+", ")}}return e}toString(){let e="("+this.name+"=";if(this.rhsType==vr)e=e+this.atom;else if(this.rhsType==Z_){if(this.listType==ec)for(let t=0;t<this.getListSize();t++)e=e+this.getListElement(t).toString();else if(this.listType==nn){e=e+" (";for(let t=0;t<this.getListSize();t++){let s=this.getListElement(t);e=e+s.name,t!=this.getListSize()-1&&(e=e+", ")}e=e+")"}}return e=e+")",e}};c(cc,"NVPair");var on=cc,KI=0,an=1,nc=2,ys=3,DA=4,_n=8,WI=9,tc="(",sc=")",rc=",",ic="=",XI="\\",IA='"',zI="'",$I="%",jI=" ",JI="	",QI=`
`,ZI="\r",Tc=class Tc{constructor(){this.tkType=null,this.tkValue=null,this.numTokens=0,this.tkPos=0}_isWhiteSpace(e){return e==jI||e==JI||e==QI||e==ZI}_trimWhiteSpace(e){let t=e.length,s=0,r=t;for(;s<t&&this._isWhiteSpace(e.charAt(s));)s++;for(;s<r&&this._isWhiteSpace(e.charAt(r-1));)r--;return e.substring(s,r)}parseTokens(e){this.numTokens=0,this.tkPos=0,this.tkType=new Array,this.tkValue=new Array;let t=e.length,s=!1,r=new Array;r=Array.from(e);let n=0;for(;n<t;){for(;n<t&&this._isWhiteSpace(r[n]);)n++;if(n<t)switch(r[n]){case tc:s=!1,this._addToken(an,tc),n++;break;case ic:s=!0,this._addToken(DA,ic),n++;break;case sc:s=!1,this._addToken(nc,sc),n++;break;case rc:s=!1,this._addToken(ys,rc),n++;break;default:{let a=n,_=-1,T=!1,l=IA;for((r[n]==zI||r[n]==IA)&&(T=!0,l=r[n],n++,a=n);n<t;){if(r[n]==XI){n+=2;continue}if(T){if(r[n]==l){n++,_=n-1;break}}else if(r[n]==tc||r[n]==sc||r[n]==rc&&!s||r[n]==ic&&!s){_=n;break}n++}_==-1&&(_=n),this._addToken(_n,e.substring(a,_).trim());break}}}return this._addToken(WI,$I),!0}getToken(){if(this.tkType==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens)return Number(this.tkType[this.tkPos]);me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX)}popToken(){let e=KI;return this.tkType==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=Number(this.tkType[this.tkPos++]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}getLiteral(){let e=null;return this.tkValue==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=String(this.tkValue[this.tkPos]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}popLiteral(){let e=null;return this.tkValue==null&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),this.tkPos<this.numTokens?e=String(this.tkValue[this.tkPos++]):me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),e}eatToken(){this.tkPos<this.numTokens&&this.tkPos++}toString(){if(this.tkType==null)return"*NO TOKENS*";let e="Tokens";for(let t=0;t<this.numTokens;t++)e=e+" : "+this.tkValue[t];return e}_addToken(e,t){this.tkType.push(Number(e)),this.tkValue.push(String(t)),this.numTokens++}};c(Tc,"NVTokens");var oc=Tc;function eD(i){let e=new oc;return e.parseTokens(i),tD(e)}c(eD,"createNVPair");function tD(i){let e=i.getToken();i.eatToken(),e!=an&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=_c(i),s=new on(t);if((e=i.getToken())==ys){for(;e==_n||e==ys;)t+=i.popLiteral(),e=i.getToken();return s.name=t,ac(s,i)}return ac(s,i)}c(tD,"readTopLevelNVPair");function sD(i){let e=i.getToken();i.eatToken(),e==an||e==ys||me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=_c(i),s=new on(t);return ac(s,i)}c(sD,"readNVPair");function ac(i,e){let t=e.getToken();switch(t){case DA:if(e.eatToken(),t=e.getToken(),t==_n){let s=_c(e);i.setAtom=s}else CA(e,i);break;case ys:case nc:i.setAtom=i.name;break;default:me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX)}return t=e.getToken(),t==nc?e.eatToken():t!=ys&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),i}c(ac,"readRightHandSide");function _c(i){return i.getToken()!=_n&&me.throwErr(me.ERR_INVALID_CONNECT_STRING_SYNTAX),i.popLiteral()}c(_c,"readNVLiteral");function CA(i,e){let t=i.getToken();if(!(t==an||t==ys))return;let s=sD(i);e.addListElement(s),(t==ys||s.name==s.atom)&&e.getListType!=nn&&(e.setListType=nn),CA(i,e)}c(CA,"readNVList");function OA(i,e){if(!i)return null;if(e.toUpperCase()==i.name.toUpperCase())return i;if(i.getRHSType==vr)return null;for(let t=0;t<i.getListSize();t++){let s=OA(i.getListElement(t),e);if(s!==null)return s}return null}c(OA,"findNVPairRecurse");function gA(i,e){if(!i||i.getRHSType==vr)return null;for(let t=0;t<i.getListSize();t++){let s=i.getListElement(t);if(e.toUpperCase()==s.name.toUpperCase())return s}return null}c(gA,"findNVPair");function rD(i,e){if(!i||e[0].toUpperCase()!=i.name.toUpperCase())return null;let t=i,s=e.length;for(let r=1;r<s;r++)if(t=gA(t,e[r]),!t)return null;return t.atom==null?t.list==null?null:t.list.toString():t.atom.toString()}c(rD,"findValue");yA.exports={findNVPairRecurse:OA,createNVPair:eD,findNVPair:gA,findValue:rD}});var wA=P((_0,BA)=>{"use strict";var{Buffer:iD}=require("buffer"),nD=require("net"),LA=require("process"),Kr=require("tls"),oD=require("http"),aD=require("timers"),lc=pr(),Fe=W(),{findValue:_D}=fr(),cD=8,TD=1521,lD=80,ED=4878,uD=1,uc=class uc{constructor(e){this.atts=e,this.cha=ED,this.connected=!1,this.err=!1,this.needsDrain=!1,this.numPacketsSinceLastWait=0,this.secure=!1,this.largeSDU=!1,this.streamNum=uD++,this.packetNum=1,this.doDNMatch=!0}dnMatch(e,t){if(this.atts.sslServerDNMatch&&this.doDNMatch){let s=c(r=>r.split(",").map(n=>n.split("=").map(a=>a.trim())).reduce((n,a)=>(n[a[0]]=a[1],n),{}),"toObject");if(this.atts.sslServerCertDN){let r=s(this.atts.sslServerCertDN);if(Object.keys(r).length==Object.keys(t.subject).length){for(let n in r)if(r[n]!=t.subject[n])return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else if(Kr.checkServerIdentity(this.hostName,t)&&(!this.originHost||Kr.checkServerIdentity(this.originHost,t)))if(this.atts.sslAllowWeakDNMatch){if(_D(this.atts.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"])!=t.subject.CN)return Fe.getErr(Fe.ERR_TLS_DNMATCH_FAILURE)}else{let r=this.hostName+" "+(this.originHost?"or "+this.originHost:"");return Fe.getErr(Fe.ERR_TLS_HOSTMATCH_FAILURE,r)}}}async tlsConnect(e,t){this.stream.removeAllListeners();let s,r={host:this.host,socket:t,rejectUnauthorized:!0,secureContext:e,enableTrace:!1,checkServerIdentity:this.dnMatch.bind(this)};await new Promise(n=>{this.stream=Kr.connect(r,()=>{this.stream.authorized||(s="server certificate unauthorized"),n()}).on("error",a=>{s=a.message,n()})}),s&&Fe.throwErr(Fe.ERR_TLS_AUTH_FAILURE,this.host,this.port,this.atts.connectionId,s),this.connStream=t}async ntConnect(e){e.port||(e.port=TD);let t,s,r,n=e.httpsProxy||this.atts.httpsProxy,a=e.httpsProxyPort||this.atts.httpsProxyPort;await new Promise(_=>{n?(a||(a=lD),r=oD.request({host:n,port:a,method:"CONNECT",path:e.host+":"+e.port}),r.once("connect",(T,l)=>{T.statusCode==200?(this.connected=!0,this.stream=l):s=T.statusCode,_()}),r.once("error",T=>{s=T.message,_()}),r.end()):(this.stream=nD.connect(e.port,e.host,()=>{this.connected=!0,_()}),this.stream.once("error",T=>{t=T.message,_()}))}),r&&r.removeAllListeners(),this.connected||(s?Fe.throwErr(Fe.ERR_PROXY_CONNECTION_FAILURE,n,a,this.atts.connectionId,s):Fe.throwErr(Fe.ERR_CONNECTION_INCOMPLETE,this.host,this.port,this.atts.connectionId,t))}async connect(e){this.originHost=e.originHost,this.host=e.host,this.hostName=e.hostname,this.port=e.port;try{if(await this.ntConnect(e),(this.atts.expireTime||this.atts.enableDCD)&&(this.atts.expireTime?this.stream.setKeepAlive(!0,this.atts.expireTime):this.stream.setKeepAlive(!0)),this.atts.tcpNoDelay&&this.stream.setNoDelay(!0),e.protocol.toUpperCase()=="TCPS"){let t;this.secure=!0,this.atts.sslAllowWeakDNMatch&&(this.doDNMatch=!1);try{t=Kr.createSecureContext({cert:this.atts.wallet,key:this.atts.wallet,passphrase:this.atts.walletPassword,ca:this.atts.wallet})}catch{Fe.throwErr(Fe.ERR_TLS_INIT_FAILURE)}await this.tlsConnect(t,this.stream)}}finally{this.stream&&this.setupEventHandlers()}}disconnect(e){this.connected&&!this.err&&(e==lc.NSFIMM?this.stream.destroy():this.stream.end()),this.stream=null,this.connected=!1,this.drainWaiter=null,this.readWaiter=null}getPacketDump(e){let t=[];for(let s=0;s<e.length;s+=8){let r=s.toString().padStart(4,"0"),n=e.slice(s,s+8),a=[],_=[];for(let E of n)a.push(E.toString(16).toUpperCase().padStart(2,"0")),E>32&&E<127?_.push(String.fromCharCode(E)):_.push(".");for(;a.length<8;)a.push("  "),_.push(" ");let T=a.join(" "),l=_.join("");t.push(`${r} : ${T} |${l}|`)}return t.join(`
`)}printPacket(e,t){let s=new Date,r=`${s.getFullYear()}-${s.getMonth().toString().padStart(2,"0")}-${s.getDay().toString().padStart(2,"0")} ${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}:${s.getSeconds().toString().padStart(2,"0")}.${s.getMilliseconds().toString().padStart(3,"0")}`,n=this.getPacketDump(t);console.log(`${r} ${e}:
${n}
`)}checkErr(){if(!this.connected||this.err){let e;this.savedErr?e=Fe.getErr(Fe.ERR_CONNECTION_LOSTCONTACT,this.host,this.port,this.atts.connectionId,this.savedErr.message):e=Fe.getErr(Fe.ERR_CONNECTION_EOF,this.host,this.port,this.atts.connectionId);let t=Fe.getErr(Fe.ERR_CONNECTION_CLOSED);throw t.message=t.message+`
`+e.message,t}}send(e){this.checkErr(),LA.env.NODE_ORACLEDB_DEBUG_PACKETS&&this.printPacket(`Sending packet ${this.packetNum} on stream ${this.streamNum}`,e),this.stream.write(e,s=>{s&&(this.savedErr=s,this.err=!0,this._notifyWaiters())})||(this.needsDrain=!0),this.numPacketsSinceLastWait++,this.packetNum++}shouldPauseWrite(){return this.needsDrain||this.numPacketsSinceLastWait>=100}async pauseWrite(){this.checkErr(),this.needsDrain?(await new Promise(e=>{this.drainWaiter=e}),this.checkErr()):await new Promise(e=>aD.setImmediate(e)),this.numPacketsSinceLastWait=0}startRead(){let e;this.packets=[],this.stream.on("data",t=>{for(e?e=iD.concat([e,t]):e=t;e.length>=cD;){let s;if(this.largeSDU?s=e.readUInt32BE():s=e.readUInt16BE(),s>e.length)break;let r={buf:e.subarray(0,s),type:e[4],flags:e[5],num:this.packetNum++};if(this.packets.push(r),this.readWaiter&&(this.readWaiter(),this.readWaiter=null),LA.env.NODE_ORACLEDB_DEBUG_PACKETS&&this.printPacket(`Receiving packet ${r.num} on stream ${this.streamNum}`,r.buf),s===e.length){e=null;break}else e=e.subarray(s)}})}syncReceive(){return this.packets.shift()}async receive(){return this.packets.length===0&&(this.checkErr(),await new Promise(e=>{this.readWaiter=e,this.numPacketsSinceLastWait=0}),this.checkErr()),this.packets.shift()}async renegTLS(){try{this.checkErr(),this.doDNMatch=!0;let e=Kr.createSecureContext({cert:this.atts.wallet,key:this.atts.wallet,passphrase:this.atts.walletPassword,ca:this.atts.wallet});await this.tlsConnect(e,this.connStream)}finally{this.setupEventHandlers()}}setupEventHandlers(){this.stream.removeAllListeners(),this.stream.on("error",e=>{this.savedErr=e,this.err=!0,this._notifyWaiters()}),this.stream.on("end",()=>{this.err=!0,this._notifyWaiters()}),this.stream.on("close",()=>{this.connected=!1,this._notifyWaiters()}),this.stream.on("drain",()=>{this.needsDrain=!1,this.drainWaiter&&(this.drainWaiter(),this.drainWaiter=null)})}getOption(e){switch(this.checkErr(),e){case lc.NT_MOREDATA:return this.packets.length>0;case lc.REMOTEADDR:{let t=this.secure?this.connStream:this.stream;return t.remoteAddress+":"+t.remotePort}default:Fe.throwErr(Fe.ERR_INTERNAL,"getOption not supported for opcode "+e)}}_notifyWaiters(){this.drainWaiter&&(this.drainWaiter(),this.drainWaiter=null),this.readWaiter&&(this.readWaiter(),this.readWaiter=null)}};c(uc,"NTTCP");var Ec=uc;BA.exports=Ec});var MA=P((T0,YA)=>{"use strict";var hD=require("crypto"),ND=require("path"),UA=pr(),SD=require("fs");async function AD(){return await new Promise((i,e)=>{hD.randomBytes(16,(t,s)=>{t?e(t):i(s)})})}c(AD,"genuuid");var Nc=class Nc{constructor(e){this.largeSDU=!1,this.tdu=UA.NSPDFTDULN,this.nt={},this.nt.tcpNoDelay=!0,this.uuid=e,this.nt.sslServerDNMatch=!0,this.nt.sslAllowWeakDNMatch=!1}setFrom(e){e&&(e.sdu>0&&(this.sdu=parseInt(e.sdu)),typeof e.walletLocation=="string"&&(this.nt.walletFile=ND.join(e.walletLocation,UA.PEM_WALLET_FILE_NAME)),typeof e.walletPassword=="string"&&(this.nt.walletPassword=e.walletPassword),typeof e.walletContent=="string"&&(this.nt.wallet=e.walletContent),e.expireTime>0&&(this.nt.expireTime=e.expireTime*1e3*60),e.connectTimeout>0&&(this.connectTimeout=e.connectTimeout*1e3),e.transportConnectTimeout>0&&(this.transportConnectTimeout=e.transportConnectTimeout*1e3),e.recvTimeout>0&&(this.recvTimeout=e.recvTimeout*1e3),e.sendTimeout>0&&(this.sendTimeout=e.sendTimeout*1e3),typeof e.connectionIdPrefix=="string"&&(this.connectionIdPrefix=e.connectionIdPrefix),typeof e.tcpNoDelay=="boolean"&&(this.nt.tcpNoDelay=e.tcpNoDelay),typeof e.sslServerDNMatch=="boolean"&&(this.nt.sslServerDNMatch=e.sslServerDNMatch),typeof e.sslAllowWeakDNMatch=="boolean"&&(this.nt.sslAllowWeakDNMatch=e.sslAllowWeakDNMatch),typeof e.sslServerCertDN=="string"&&(this.nt.sslServerCertDN=e.sslServerCertDN),typeof e.enable=="string"&&e.enable.toUpperCase()=="BROKEN"&&(this.nt.enabledDCD=!0),typeof e.httpsProxy=="string"&&(this.nt.httpsProxy=e.httpsProxy),e.httpsProxyPort>=0&&(this.nt.httpsProxyPort=parseInt(e.httpsProxyPort)))}readWalletFile(){return new Promise((e,t)=>{SD.readFile(this.nt.walletFile,(s,r)=>{s?t(s):e(r)})})}clearWallet(){this.nt.wallet&&Buffer.isBuffer(this.nt.wallet)&&this.nt.wallet.fill(0),this.nt.wallet=null}async prepare(e){this.uuid||(this.uuid=await AD(),this.uuid=this.uuid.toString("base64")),this.connectionIdPrefix?this.connectionId=this.connectionIdPrefix+this.uuid:this.connectionId=this.uuid,this.nt.connectionId=this.connectionId,e&&e.toUpperCase()=="TCPS"&&!this.nt.wallet&&this.nt.walletFile&&(this.nt.wallet=await this.readWalletFile()),!this.connectTimeout&&!this.transportConnectTimeout&&(this.transportConnectTimeout=60*1e3)}};c(Nc,"SessionAtts");var hc=Nc;YA.exports=hc});var Wr=P((E0,xA)=>{"use strict";var dD=nt(),cn=W(),VA=require("os");function pD(){this.program=process.argv0,this.terminal="unknown",this.pid=process.pid.toString();try{this.userName=VA.userInfo().username}catch{this.userName="unknown"}this.hostName=VA.hostname()}c(pD,"populateClientInfo");var fD=new pD;function mD(i){let e=[];for(let t of i)e.push(t.fetchInfo);return e}c(mD,"getMetadataMany");function FA(i,e){let t=i[0].name===void 0,s=t?[]:{};for(let r=0;r<i.length;r++)t?s.push(i[r].values[e]):s[i[r].name]=i[r].values[e];return s}c(FA,"getOutBindValues");function PD(i,e,t){let r=i.bindInfoList.map(n=>n.bindVar).filter(n=>n.dir!==dD.BIND_IN);if(r.length>0){if(t){let n=new Array(e);for(let a=0;a<e;a++)n[a]=FA(r,a);return n}return FA(r,0)}}c(PD,"getOutBinds");function RD(i){let e="",t="",s=!1,r=!1,n=0,a={status:-1,proxyUser:"",schemaUser:""},_=i.length,T=0,l,E;for(;T<_;){if(i.charAt(T)==='"'&&(s=!s,n=T),i.charAt(T)==="["&&!s){if(r=!0,n!=0){for(l=n+1;l<T;l++)if(i.charAt(l)!==" ")return a;for(l=0;l<=n;l++)t+=i.charAt(l)}else for(l=0;l<T&&i.charAt(l)!==" ";l++)t+=i.charAt(l);break}T++}if(t.length===0)return a;a.proxyUser=t,T=T+1,s=!1;let h=T;for(n=0;T<_;){if(i.charAt(T)==='"'&&(s=!s,n=T),i.charAt(T)==="["&&!s&&r)return a;if(i.charAt(T)==="]"&&!s){if(n!=h&&n!=0){for(l=h;l<=n;l++)e+=i.charAt(l);for(l=n+1;l<T;l++)if(i.charAt(l)!=" ")return a}else{for(l=h;l<T&&i.charAt(l)==" ";l++);if(l==T)return a;for(E=l;E<T;E++)e+=i[E]}for(l=T+1;l<_;l++)if(i[l]!=" ")return a}T++}return e.length===0||(a.schemaUser=e,a.status=0),a}c(RD,"checkProxyUserValidity");function ID(i){i.token===void 0&&(i.externalAuth===!0&&cn.throwErr(cn.ERR_NOT_IMPLEMENTED,"External Authentication"),i.password===void 0&&cn.throwErr(cn.ERR_MISSING_CREDENTIALS))}c(ID,"checkCredentials");function DD(i){return`-----BEGIN PRIVATE KEY-----
`+i+`
-----END PRIVATE KEY-----`}c(DD,"normalizePrivateKey");xA.exports={getMetadataMany:mD,CLIENT_INFO:fD,getOutBinds:PD,checkProxyUserValidity:RD,checkCredentials:ID,normalizePrivateKey:DD}});var GA=P((h0,qA)=>{"use strict";var{findNVPairRecurse:Xr,createNVPair:un}=fr(),ut=W(),CD=require("os"),OD=require("net"),gD=require("dns"),bA=gD.promises,Sc=Wr().CLIENT_INFO,hn={ADDR:0,ADDR_LIST:1,DESC:2,DESC_LIST:3},mc=class mc{isS(){return hn.ADDR}initFromString(e){let t=un(e);this.initFromNVPair(t)}initFromNVPair(e){(e==null||e.name.toUpperCase()!="ADDRESS")&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);let t=Xr(e,"protocol"),s=Xr(e,"port"),r=Xr(e,"host"),n=Xr(e,"https_proxy"),a=Xr(e,"https_proxy_port");s&&(this.port=Number(s.atom)),r&&(this.host=r.atom),t&&(this.prot=t.atom),n&&(this.httpsProxy=n.atom),a&&(this.httpsProxyPort=Number(a.atom)),this.addr=e.toString()}toString(){return this.addr}};c(mc,"Address");var Ac=mc,Pc=class Pc{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!1,this.failover=!0}isS(){return hn.ADDR_LIST}initFromString(e){let t=un(e);this.initFromNVPair(t)}initFromNVPair(e){this.children=[];let t,s,r=e.getListSize();r==0&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let n=0;n<r;n++)t=e.getListElement(n),t.name.toUpperCase()=="SOURCE_ROUTE"?this.sourceRoute=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="LOAD_BALANCE"?this.loadBalance=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="FAILOVER"?this.failover=t.atom.toLowerCase()=="yes"||t.atom.toLowerCase()=="on"||t.atom.toLowerCase()=="true":t.name.toUpperCase()=="ADDRESS"?(s=new zr,s.initFromNVPair(t),this.children.push(s)):t.name.toUpperCase()=="ADDRESS_LIST"?(s=new $r,s.initFromNVPair(t),this.children.push(s)):ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);this.children.length==0&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX)}toString(){let e=new String("");if(this.children.size()<1)return e;e+="(ADDRESS_LIST=";for(let t=0;t<this.children.size();t++)e+=this.children[t].toString();return this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"+mr.HC),this.loadBalance&&(e+="(LOAD_BALANCE=yes)"),this.failover||(e+="(FAILOVER=false)"),e+=")",e}};c(Pc,"AddressList");var dc=Pc,Rc=class Rc{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!1,this.failover=!0,this.delayInMillis=-1,this.params={}}isS(){return hn.DESC}initFromString(e){let t=un(e);this.initFromNVPair(t)}initFromNVPair(e){let t=e.getListSize(),s,r;t==0&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let n=0;n<t;n++)if(s=e.getListElement(n),s.name.toUpperCase()=="SOURCE_ROUTE")this.sourceRoute=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="LOAD_BALANCE")this.loadBalance=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="FAILOVER")this.failover=s.atom.toLowerCase()=="yes"||s.atom.toLowerCase()=="on"||s.atom.toLowerCase()=="true";else if(s.name.toUpperCase()=="ADDRESS_LIST")r=new $r,r.initFromNVPair(s),this.children.push(r);else if(s.name.toUpperCase()=="ADDRESS")r=new zr,r.initFromNVPair(s),this.children.push(r);else if(s.name.toUpperCase()=="CONNECT_DATA"){let a,_=s.getListSize();for(let T=0;T<_;T++)if(a=s.getListElement(T),a.name.toUpperCase()=="CONNECTION_ID_PREFIX"){this.params.connectionIdPrefix=a.atom,s.removeListElement(T);break}this.connectData=s.valueToString()}else if(s.name.toUpperCase()=="RETRY_DELAY")s.atom>0&&(this.delayInMillis=s.atom*1e3);else if(s.name.toUpperCase()=="RETRY_COUNT")this.retryCount=s.atom;else if(s.name.toUpperCase()=="CONNECTION_ID_PREFIX")this.conidPrefix=s.atom;else if(s.name.toUpperCase()=="CONNECT_TIMEOUT")s.atom>0&&(this.params.connectTimeout=s.atom);else if(s.name.toUpperCase()=="TRANSPORT_CONNECT_TIMEOUT")s.atom>0&&(this.params.transportConnectTimeout=s.atom);else if(s.name.toUpperCase()=="ENABLE")this.params.enable=s.atom;else if(s.name.toUpperCase()=="RECV_TIMEOUT")s.atom>0&&(this.params.recvTimeout=s.atom);else if(s.name.toUpperCase()=="SDU")this.params.sdu=s.atom;else if(s.name.toUpperCase()=="EXPIRE_TIME")s.atom>0&&(this.params.expireTime=s.atom);else if(s.name.toUpperCase()=="SECURITY"){let a=s.getListSize(),_;for(let T=0;T<a;T++)_=s.getListElement(T),_.name.toUpperCase()=="SSL_SERVER_CERT_DN"?this.params.sslServerCertDN=_.valueToString():_.name.toUpperCase()=="SSL_SERVER_DN_MATCH"?this.params.sslServerDNMatch=_.atom.toLowerCase()=="yes"||_.atom.toLowerCase()=="on"||_.atom.toLowerCase()=="true":_.name.toUpperCase()=="SSL_ALLOW_WEAK_DN_MATCH"?this.params.sslAllowWeakDNMatch=_.atom.toLowerCase()=="yes"||_.atom.toLowerCase()=="on"||_.atom.toLowerCase()=="true":(_.name.toUpperCase()=="WALLET_LOCATION"||_.name.toUpperCase()=="MY_WALLET_DIRECTORY")&&(this.params.walletLocation=_.atom)}}toString(){let e=new String(""),t;t=new String("");for(let s=0;s<this.children.size();s++)t=this.children[s].toString(),!t==""&&(e+=t);return!e==""&&this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"),!e==""&&this.loadBalance&&(e+="(LOAD_BALANCE=yes)"),!e==""&&!this.failover&&(e+="(FAILOVER=false)"),e.equals("")||(e="(DESCRIPTION="+e+")"),e}};c(Rc,"Description");var pc=Rc,Ic=class Ic{constructor(){this.children=new Array,this.sourceRoute=!1,this.loadBalance=!0,this.failover=!0}isS(){return hn.ADDR_LIST}initFromString(e){let t=un(e);this.initFromNVPair(t)}initFromNVPair(e){let t=e.getListSize(),s,r;t==0&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);for(let n=0;n<t;n++)r=e.getListElement(n),r.name.toUpperCase()=="SOURCE_ROUTE"?this.sourceRoute=r.atom.toLowerCase()=="yes"||r.atom.toLowerCase()=="on"||r.atom.toLowerCase=="true":r.name.toUpperCase()=="LOAD_BALANCE"?this.loadBalance=r.atom.toLowerCase()=="yes"||r.atom.toLowerCase()=="on"||r.atom.toLowerCase()=="true":r.name.toUpperCase()=="FAILOVER"?this.failover=r.atom.toLowerCase()=="yes"||r.atom.toLowerCase()=="on"||r.atom.toLowerCase()=="true":r.name.toUpperCase()=="DESCRIPTION"?(s=new ln,s.initFromNVPair(r),this.children.push(s)):ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX);this.children.length==0&&ut.throwErr(ut.ERR_INVALID_CONNECT_STRING_SYNTAX)}toString(){let e=new String("");if(this.children.size()<1)return e;let t=new String("");for(let s=0;s<this.children.size();s++)t=this.children[s].toString(),t.equals("")||(e+=t);return e.equals("")&&this.sourceRoute&&(e+="(SOURCE_ROUTE=yes)"),e.equals("")&&!this.loadBalance&&(e+="(LOAD_BALANCE=no)"),e.equals("")&&!this.failover&&(e+="(FAILOVER=false)"),e.equals("")||(e="(DESCRIPTION_LIST="+e+")"),e}};c(Ic,"DescriptionList");var fc=Ic,Dc=class Dc{constructor(){this.CNdata=new Array}};c(Dc,"ConnOption");var Tn=Dc,mr={DEBUG:!1,SR:"(SOURCE_ROUTE=yes)",HC:"(HOP_COUNT=0)",LB:"(LOAD_BALANCE=yes)",NFO:"(FAILOVER=false)",CD:"(CONNECT_DATA=",CONID:"(CONNECTION_ID="},kA={all:!0},Cc=class Cc extends Ac{constructor(){super()}async navigate(e){let t,s=0,r=!1;if(!this.host){s=1,this.host=CD.hostname();try{await bA.lookup(this.host,kA)}catch{this.host="localhost"}}if(e.getcurrentDescription()==null&&(e.newConnectionDescription(),r=!0),OD.isIP(this.host)){let n=new Tn;n.hostname=this.host,n.port=this.port,n.protocol=this.prot,n.httpsProxy=this.httpsProxy,n.httpsProxyPort=this.httpsProxyPort,n.desc=e.getcurrentDescription(),n.CNdata.push(e.sBuf.join("")),n.CNdata.push(this.toString()),n.host=this.host,n.addr=this.addr,e.getcurrentDescription().addConnectOption(n)}else try{t=await bA.lookup(this.host,kA);for(let n of t){let a=new Tn;a.hostname=this.host,a.port=this.port,a.protocol=this.prot,a.httpsProxy=this.httpsProxy,a.httpsProxyPort=this.httpsProxyPort,a.desc=e.getcurrentDescription(),a.CNdata.push(e.sBuf.join("")),s==1?a.CNdata.push("(address=(protocol="+this.prot+")(host="+this.host+")(port="+this.port+"))"):a.CNdata.push(this.toString()),a.host=n.address,a.addr=this.addr,e.getcurrentDescription().addConnectOption(a)}}catch{}r&&e.closeDescription()}addToString(e){let t=this.toString(),s=new Array;s=e.getcurrentDescription().getConnectOptions();for(let r=0;r<s.length;r++)s[r].done||s[r].CNdata.push(t)}};c(Cc,"NavAddress");var zr=Cc,Oc=class Oc extends dc{constructor(){super(),this.activeChildren=new Array,this.sBuflength=0}async navigate(e){await this.navigate2(e,0)}async navigate2(e,t){if(t++,this.sBuflength=e.sBuf.length,e.sBuf.push("(ADDRESS_LIST="),this.sourceRoute){this.activeChildren=this.children,await this.activeChildren[0].navigate(e);for(let s=1;s<this.activeChildren.length;s++)this.activeChildren[s].addToString(e)}else{this.activeChildren=jr.setActiveChildren(this.children,this.failover,this.loadBalance);for(let s=0;s<this.activeChildren.length;s++)this.getChildrenType(s)==1?await this.activeChildren[s].navigate2(e,t):await this.activeChildren[s].navigate(e)}this.closeNVPair(e),e.sBuf.length=this.sBuflength}addToString(e){let t=this.toString(),s=new Array;s=e.getcurrentDescription().getConnectOptions();for(let r=0;r<s.length;r++)s[r].done||s[r].CNdata.push(t)}getChildrenSize(){let e=0;for(let t=0;t<this.activeChildren.length;t++)if(this.getChildrenType(t)==1?e+=this.activeChildren[t].getChildrenSize():e++,this.sourceRoute)return e;return e}getChildrenType(e){return this.activeChildren[e].isS()}getChild(e){return this.children[e]}closeNVPair(e){let t=new Array,s=this.getChildrenSize();if(e.getcurrentDescription()!=null){t=e.getcurrentDescription().getConnectOptions();let r=0,n=null,a=null;for(let _=t.length-1;_>=0&&!t[_].done&&((t[_].hostname!=n||t[_].port!=a)&&r++,n=t[_].hostname,a=t[_].port,!(r>s));_--)this.sourceRoute&&(t[_].CNdata.push(mr.SR),t[_].CNdata.push(mr.HC),t[_].done=!0),t[_].CNdata.push(")")}}};c(Oc,"NavAddressList");var $r=Oc,gc=class gc extends pc{constructor(){super(),this.activeChildren=new Array,this.descProcessed=0}async navigate(e){e.sBuf.length=0,e.sBuf.push("(DESCRIPTION=");let t=e.newConnectionDescription();if(this.retryCount!=null&&(e.retryCount=this.getIntValue(this.retryCount,e.retryCount),t.retryCount=e.retryCount),this.delayInMillis!=-1&&(t.delayInMillis=this.delayInMillis),t.params=this.params,"connectTimeout"in this.params&&e.sBuf.push("(CONNECT_TIMEOUT="+this.params.connectTimeout+")"),"transportConnectTimeout"in this.params&&e.sBuf.push("(TRANSPORT_CONNECT_TIMEOUT="+this.params.transportConnectTimeout+")"),"recvTimeout"in this.params&&e.sBuf.push("(RECV_TIMEOUT="+this.params.recvTimeout+")"),"sdu"in this.params&&e.sBuf.push("(SDU="+this.params.sdu+")"),"expireTime"in this.params&&e.sBuf.push("(EXPIRE_TIME="+this.params.expireTime+")"),"enable"in this.params&&e.sBuf.push("(ENABLE="+this.params.enable+")"),("sslServerCertDN"in this.params||"sslServerDNMatch"in this.params||"walletLocation"in this.params||"sslAllowWeakDNMatch"in this.params)&&(e.sBuf.push("(SECURITY="),"sslServerCertDN"in this.params&&e.sBuf.push("(SSL_SERVER_CERT_DN="+this.params.sslServerCertDN+")"),"sslServerDNMatch"in this.params&&e.sBuf.push("(SSL_SERVER_DN_MATCH="+this.params.sslServerDNMatch+")"),"sslAllowWeakDNMatch"in this.params&&e.sBuf.push("(SSL_ALLOW_WEAK_DN_MATCH="+this.params.sslAllowWeakDNMatch+")"),"walletLocation"in this.params&&e.sBuf.push("(WALLET_LOCATION="+this.params.walletLocation+")"),e.sBuf.push(")")),"httpsProxyPort"in this.params&&e.sBuf.push("(HTTPS_PROXY_PORT="+this.params.httpsProxyPort+")"),"httpsProxy"in this.params&&e.sBuf.push("(HTTPS_PROXY="+this.params.httpsProxy+")"),this.failover||e.sBuf.push(mr.NFO),this.sourceRoute){this.activeChildren=this.children,await this.activeChildren[0].navigate(e);for(let s=1;s<this.activeChildren.length;s++)this.activeChildren[s].addToString(e);this.closeNVPair(e)}else{this.activeChildren=jr.setActiveChildren(this.children,this.failover,this.loadBalance);for(let s=0;s<this.activeChildren.length;s++)await this.activeChildren[s].navigate(e);this.closeNVPair(e)}e.closeDescription()}closeNVPair(e){if(e.getcurrentDescription()==null)return;let t=new Array;t=e.getcurrentDescription().getConnectOptions();for(let s=0;s<t.length;++s){this.sourceRoute&&t[s].CNdata.push(mr.SR),this.connectData==null&&(this.connectData="(SERVICE_NAME=)");let n=`(CID=(PROGRAM=${`"'`+Sc.program+`'"`})(HOST=${Sc.hostName})(USER=${Sc.userName}))`;t[s].CNdata.push(mr.CD),t[s].CNdata.push(this.connectData),t[s].CNdata.push(n),t[s].CNdata.push(")"),this.SID!=null&&(t[s].sid=this.SID),this.serviceName!=null&&(t[s].service_name=this.serviceName),this.instanceName!=null&&(t[s].instance_name=this.instanceName),t[s].CNdata.push(")"),t[s].done=!0}}getIntValue(e,t){try{return parseInt(e)}catch{return t}}};c(gc,"NavDescription");var ln=gc,En=class En extends fc{constructor(e=new Array,t=0,s=0){super(),this.activeChildren=e,this.descProcessed=t,this.done=s}async navigate(e){for(e.sBuf.push("(DESCRIPTION_LIST="),this.activeChildren=En.setActiveChildren(this.children,this.failover,this.loadBalance);this.descProcessed<this.activeChildren.length;)await this.activeChildren[this.descProcessed].navigate(e),this.descProcessed++}static setActiveChildren(e,t,s){let r,n=e.length,a=new Array,_=Math.floor(Math.random()*10),T=new Array(n).fill(!1);if(t)if(s)for(let l=0;l<n;l++){do r=Math.abs(Math.floor(Math.random()*10))%n;while(T[r]);T[r]=!0,a.push(e[r])}else a=e;else s?(r=Math.abs(_)%n,a.push(e[r])):a.push(e[0]);return a}};c(En,"NavDescriptionList");var jr=En;qA.exports={NavAddress:zr,NavAddressList:$r,NavDescription:ln,NavDescriptionList:jr}});var Vc=P((S0,vA)=>{"use strict";var{NavAddress:yD,NavAddressList:LD,NavDescription:BD,NavDescriptionList:wD}=GA(),{createNVPair:UD}=fr(),HA=W(),Uc=class Uc{constructor(){this.cOpts=new Array}addConnectOption(e){this.cOpts.push(e)}getConnectOptions(){return this.cOpts}};c(Uc,"ConnectDescription");var yc=Uc,Yc=class Yc{constructor(){this.reset(),this.retryCount=0,this.currentDescription=null,this.descriptionList=new Array,this.sBuf=new Array}reset(){this.nextOptToTry=0,this.lastRetryCounter=0,this.lastRetryConnectDescription=0,this.reorderDescriptionList=0}hasMoreOptions(){let e=0;for(let t=0;t<this.descriptionList.length;++t)e+=this.descriptionList[t].getConnectOptions().length;return this.nextOptToTry<e}newConnectionDescription(){return this.currentDescription=new yc,this.currentDescription}getcurrentDescription(){return this.currentDescription}closeDescription(){this.descriptionList.push(this.currentDescription),this.currentDescription=null}async execute(e){e!=null&&this.retryCount==0&&e.retryCount>0&&(this.retryCount=e.retryCount),this.reorderDescriptionList||(this.descriptionList=wc.reorderDescriptionList(this.descriptionList),this.reorderDescriptionList=!0);for(let t=this.lastRetryConnectDescription;t<this.descriptionList.length;t++){let s=this.descriptionList[t],r=new Array;r=s.getConnectOptions();let n=s.delayInMillis;e!=null&&(n==0||n==null)&&e.retryDelay>0&&(n=e.retryDelay*1e3);for(let a=this.lastRetryCounter;a<=this.retryCount;++a){for(this.nextOptToTry==0&&(r=wc.reorderAddresses(r));this.nextOptToTry<r.length;){let _=r[this.nextOptToTry];return this.lastRetryCounter=a,this.lastRetryConnectDescription=t,this.nextOptToTry++,_}this.nextOptToTry=0,n>0&&a<this.retryCount&&await YD(n)}this.lastRetryCounter=0}throw this.nextOptToTry=1e3,this.lastRetryCounter=1e3,new Error("All options tried")}};c(Yc,"ConnStrategy");var Lc=Yc;function YD(i){return new Promise(e=>setTimeout(e,i))}c(YD,"sleep");async function MD(i){let e;typeof i=="string"?e=UD(i):e=i;let t=e.name.toUpperCase(),s=null;switch(t){case"ADDRESS":s=new yD;break;case"ADDRESS_LIST":s=new LD;break;case"DESCRIPTION":s=new BD;break;case"DESCRIPTION_LIST":s=new wD;break;default:HA.throwErr(HA.ERR_INVALID_CONNECT_STRING_PARAMETERS,`unknown top element ${t}`)}s.initFromNVPair(e);let r=new Lc;return await s.navigate(r),r}c(MD,"createNode");var Mc=class Mc{constructor(){this.DOWN_HOSTS_TIMEOUT=600,this.MIN_TIME_BETWEEN_REFRESH=60,this.downHostsCacheMap=new Map,this.lastRefreshTime=0}markDownHost(e){return this.downHostsCacheMap.set(e,Date.now())}refreshCache(){Date.now()-this.MIN_TIME_BETWEEN_REFRESH*1e3>this.lastRefreshTime&&(this.downHostsCacheMap.forEach((e,t)=>{let s=e;s!=null&&Date.now()-this.DOWN_HOSTS_TIMEOUT*1e3>s&&this.downHostsCacheMap.delete(t)}),this.lastRefreshTime=Date.now())}reorderAddresses(e){this.refreshCache();let t=0,s=e.length-1;for(;t<s;){for(;t<=s&&!this.isDownHostsCached(e[t]);)t++;for(;s>=t&&this.isDownHostsCached(e[s]);)s--;t<s&&([e[t],e[s]]=[e[s],e[t]])}return e}isDownDescCached(e){let t=e.getConnectOptions();for(let s=0;s<t.length;s++)if(!this.isDownHostsCached(t[s]))return!1;return!0}reorderDescriptionList(e){this.refreshCache();let t=0,s=e.length-1;for(;t<s;){for(;t<=s&&!this.isDownDescCached(e[t]);)t++;for(;s>=t&&this.isDownDescCached(e[s]);)s--;t<s&&([e[t],e[s]]=[e[s],e[t]])}return e}isDownHostsCached(e){return this.downHostsCacheMap.has(e.host)}};c(Mc,"DownHostsCache");var Bc=Mc,wc=new Bc;vA.exports={createNode:MD,SOLE_INST_DHCACHE:wc}});var zA=P((d0,XA)=>{"use strict";var Ls=W(),WA=new RegExp("((?=(?<hostnames>(((\\[[A-z0-9:]+\\])|([A-z0-9][A-z0-9._-]+))[,]?)+)))\\k<hostnames>(:(?<port>\\d+)?)?","g"),VD=new RegExp("^(((?<protocol>[A-z0-9]+):)?//)?(?<hostinfo>("+WA.source+"(?=([,]|[;]|[/]|[:]|$))([,]|[;])?)+)(/(?<servicename>[A-z0-9][A-z0-9,-.]+)?)?(:(?<servermode>dedicated|shared|pooled))?(/(?<instance>[A-z0-9][A-z0-9]+))?$","ig"),KA='"',FD="=",xD="&",bD=["ENABLE","FAILOVER","LOAD_BALANCE","RECV_BUF_SIZE","SEND_BUF_SIZE","SDU","SOURCE_ROUTE","RETRY_COUNT","RETRY_DELAY","CONNECT_TIMEOUT","TRANSPORT_CONNECT_TIMEOUT","RECV_TIMEOUT"],xc=class xc{constructor(e){this.URL_PROPS_ALIAS=this.initializeUrlAlias(),this.url=e,this.resolvedUrl="",this.connectionProps=new Map,this.urlProps=new Map,this.lb=!1}getResolvedUrl(){return this.parse(),this.resolvedUrl}parse(){let e=this.parseExtendedSettings(this.url);this.connectionProps.size===0&&this.urlProps.size===0&&(e=this.url),this.resolvedUrl=this.resolveToLongURLFormat(e)}resolveToLongURLFormat(e){let t=e.replace(/\s/g,""),s=0,r=null,n=null,a=null,_=null,T=null;for(let u of t.matchAll(VD))s=1,r=u.groups.protocol,n=u.groups.hostinfo,a=u.groups.servicename,_=u.groups.servermode,T=u.groups.instance;s||Ls.throwErr(Ls.ERR_INVALID_EZCONNECT_SYNTAX,"input string not in easy connect format",t),r==null?e.includes("//")||(r="TCP"):r.toLowerCase()!="tcp"&&r.toLowerCase()!="tcps"&&Ls.throwErr(Ls.ERR_INVALID_EZCONNECT_SYNTAX,"Unsupported protocol in thin mode",r);let l=this.urlProps.get("HTTPS_PROXY"),E=this.urlProps.get("HTTPS_PROXY_PORT"),h=this.buildAddressList(n,r,l,E),p=this.urlProps.get("CONNECTION_ID_PREFIX"),A=[];return this.lb&&A.push("(LOAD_BALANCE=ON)"),A.push(this.buildDescriptionParams()),A.push(h),A.push(this.buildConnectData(a,_,T,p)),A.push(this.buildSecurityInfo(r)),`(DESCRIPTION=${A.join("")})`}buildConnectData(e,t,s,r){let n=this.urlProps.get("POOL_CONNECTION_CLASS"),a=this.urlProps.get("POOL_PURITY"),_=this.urlProps.get("SERVICE_TAG"),T=this.urlProps.get("POOL_BOUNDARY"),l=[];return e?l.push(`(SERVICE_NAME=${e})`):l.push("(SERVICE_NAME=)"),t&&l.push(`(SERVER=${t})`),s&&l.push(`(INSTANCE_NAME=${s})`),n&&l.push(`(POOL_CONNECTION_CLASS=${n})`),a&&l.push(`(POOL_PURITY=${a})`),_&&l.push(`(SERVICE_TAG=${_})`),r&&l.push(`(CONNECTION_ID_PREFIX=${r})`),T&&l.push(`(POOL_BOUNDARY=${T})`),`(CONNECT_DATA=${l.join("")})`}buildAddressList(e,t,s,r){let n=new Array,a="";s!=null&&(r!=null?a=`(HTTPS_PROXY=${s})(HTTPS_PROXY_PORT=${r})`:a=`(HTTPS_PROXY=${s})`),t==null&&(t="TCP");let _=0,T=e.split(";");for(let l of T){let E=0,h=new Array;for(let A of l.matchAll(WA)){let u=A.groups.hostnames.split(","),N=A.groups.port;N==null&&(N="1521");for(let d of u)h.push(this.getAddrStr(d,N,t,a)),E++}_+=E;let p=[];T.length>1&&E>1&&p.push("(LOAD_BALANCE=ON)"),p.push(h.join("")),T.length>1?n.push(`(ADDRESS_LIST=${p.join("")})`):n.push(p.join(""))}return T.length<2&&_>1&&(this.lb=!0),n.join("")}getAddrStr(e,t,s,r){let n=e.trim();return n.startsWith("[")&&n.endsWith("]")&&(n=n.substring(1,n.length-1)),`(ADDRESS=(PROTOCOL=${s})(HOST=${n})(PORT=${t})${r})`}buildDescriptionParams(){if(this.urlProps.size===0)return"";let e=new Array;return this.urlProps.forEach(function(t,s){bD.includes(s)&&e.push(`(${s}=${t})`)}),e.join("")}buildSecurityInfo(e){let t=new Array;if(e!=null&&e.toLowerCase()=="tcps"){let s=this.urlProps.get("SSL_SERVER_DN_MATCH"),r=this.urlProps.get("SSL_SERVER_CERT_DN"),n=this.urlProps.get("MY_WALLET_DIRECTORY");s!=null&&t.push(`(SSL_SERVER_DN_MATCH=${s})`),r!=null&&t.push(`(SSL_SERVER_CERT_DN=${r}})`),n!=null&&t.push(`(MY_WALLET_DIRECTORY=${n})`)}return t.length===0?"":`(SECURITY=${t.join("")})`}parseExtendedSettings(e){let t=Array.from(e.trim()),s=this.findExtendedSettingPosition(t);return s==-1?e:(this.parseExtendedProperties(t,s+1),e.substring(0,s))}parseExtendedProperties(e,t){let s=null,r=null,n=new Array(e.length),a=0,_="";for(let T=t;T<e.length;T++)if(e[T].trim()!="")switch(e[T]){case KA:_=this.parseQuotedString(T,e,a,n),a=_[1],T=_[0];break;case FD:s!=null&&Ls.throwErr(Ls.ERR_INVALID_EZCONNECT_SYNTAX,"unable to parse, invalid syntax",this.url),s=n.join("").substring(0,a).trim(),a=0;break;case xD:s==null&&Ls.throwErr(Ls.ERR_INVALID_EZCONNECT_SYNTAX,"unable to parse, invalid syntax",this.url),r=n.join("").substring(0,a).trim(),this.addParam(s,r),s=null,r=null,a=0;break;default:n[a++]=e[T]}s!=null&&(r=n.join("").substring(0,a).trim(),this.addParam(s,r))}parseQuotedString(e,t,s,r){let n=e+1;for(;n<t.length;){let a=t[n];if(a==KA)return[n,s];r[s++]=a,n++}}addParam(e,t){let s=e.toLowerCase(),r=this.URL_PROPS_ALIAS.get(s);r!=null?this.urlProps.set(r,t):this.connectionProps.set(r,t)}findExtendedSettingPosition(e){let t=0;for(let s=0;s<e.length;s++)if(e[s]=="(")t++;else if(e[s]==")")t--;else if(e[s]=="?"&&t==0)return s;return-1}initializeUrlAlias(){let e=new Map;return e.set("enable","ENABLE"),e.set("failover","FAILOVER"),e.set("load_balance","LOAD_BALANCE"),e.set("recv_buf_size","RECV_BUF_SIZE"),e.set("send_buf_size","SEND_BUF_SIZE"),e.set("sdu","SDU"),e.set("source_route","SOURCE_ROUTE"),e.set("retry_count","RETRY_COUNT"),e.set("retry_delay","RETRY_DELAY"),e.set("https_proxy","HTTPS_PROXY"),e.set("https_proxy_port","HTTPS_PROXY_PORT"),e.set("connect_timeout","CONNECT_TIMEOUT"),e.set("transport_connect_timeout","TRANSPORT_CONNECT_TIMEOUT"),e.set("recv_timeout","RECV_TIMEOUT"),e.set("ssl_server_cert_dn","SSL_SERVER_CERT_DN"),e.set("ssl_server_dn_match","SSL_SERVER_DN_MATCH"),e.set("wallet_location","MY_WALLET_DIRECTORY"),e.set("pool_connection_class","POOL_CONNECTION_CLASS"),e.set("pool_purity","POOL_PURITY"),e.set("service_tag","SERVICE_TAG"),e.set("connection_id_prefix","CONNECTION_ID_PREFIX"),e.set("pool_boundary","POOL_BOUNDARY"),e}};c(xc,"EZConnectResolver");var Fc=xc;XA.exports=Fc});var JA=P((f0,jA)=>{"use strict";var{createNVPair:kD,findValue:qD}=fr(),Rr=require("fs"),$A=require("process"),GD=require("readline"),Pr=W(),HD=4;function vD(i){let e=null,t=$A.env.TNS_ADMIN;if(i){if(e=i+"/tnsnames.ora",Rr.existsSync(e))return e;Pr.throwErr(Pr.ERR_TNS_NAMES_FILE_MISSING,i)}else return t?(e=t,e+="/tnsnames.ora",Rr.existsSync(e)||Pr.throwErr(Pr.ERR_TNS_NAMES_FILE_MISSING,t)):Pr.throwErr(Pr.ERR_NO_CONFIG_DIR),e}c(vD,"tnsnamesFilePath");var kc=class kc{constructor(){this.waiters=[],this.readInProgress=!1}async initializeNlpa(e){return this.readInProgress&&await new Promise(t=>{this.waiters.push(t)}),this.checkModfTime()?(this.ht=new Map,this.modTime=new Map,this.readInProgress=!0,await this.start(e,0),this.ht):this.ht}async start(e,t){if(t>HD)return;let s=Rr.statSync(e);this.modTime.set(e,s.mtime);let r=GD.createInterface({input:Rr.createReadStream(e),output:$A.stdout,terminal:!1}),n="";for await(let _ of r)if(_.length!=0){if(_[0]=="#")continue;if(_[0]==" "||_[0]=="	"||_[0]==")"||_[0]=="("){if(_=_.replace(/\s+/g,""),_=this.checkNLPforComments(_),_.length==0)continue;n=n+_}else n.length==0?(_=this.checkNLPforComments(_),n=n+_):n.length!=0&&(await this.addNLPListElement(n,t),n="",_=this.checkNLPforComments(_),n=n+_)}n.length!=0&&(await this.addNLPListElement(n,t),n=""),this.readInProgress=!1;let a;for(;a=this.waiters.pop();)a()}checkNLPforComments(e){let t=new Array(e.length);for(let s=0;s<e.length;s++){let r=e[s];if(r=="#"){if(s!=0)break;return""}else t.push(r)}return t.join("")}checkModfTime(){if(this.modTime)for(let[e,t]of this.modTime)if(Rr.existsSync(e)){if(Rr.statSync(e).mtime-t>0)return!0}else return!0;else return!0;return!1}async addNLPListElement(e,t){let s=e.split(/\r?\n/).filter(r=>r);for(let r=0;r<s.length;r++){s[r].charAt(0)!="("&&(s[r]="("+s[r]+")");let n=kD(s[r]),_=n.name.toUpperCase();if(n.name=_,_=="IFILE")await this.start(n.atom,t+1);else{let T=_.split(",");for(let l=0;l<T.length;l++)this.ht.set(T[l],n)}}}toString(){let e="";return this.ht.forEach(t=>{e=e+t.toString()+`
`}),e}findValueOf(e){let t=e.split("/");return qD(this.ht.get(t[0].toUpperCase()),t)}};c(kc,"NLParamParser");var bc=kc;jA.exports={NLParamParser:bc,tnsnamesFilePath:vD}});var Kc=P((P0,sd)=>{"use strict";var Gt=PA(),KD=wA(),WD=MA(),Z=pr(),{createNode:ed}=Vc(),Ue=W(),{findNVPairRecurse:XD,createNVPair:Nn,findValue:Ht}=fr(),{Buffer:QA}=require("buffer"),ZA=zA(),{NLParamParser:zD,tnsnamesFilePath:$D}=JA(),jD=require("process"),JD=Vc().SOLE_INST_DHCACHE;async function QD(i){let e=await td(i.connectString,i.configDir),t=await ed(e),s;typeof e=="string"?s=Nn(e):s=e;let r=Ht(s,["DESCRIPTION","CONNECT_DATA","SERVER"]),n=Ht(s,["DESCRIPTION","CONNECT_DATA","POOL_CONNECTION_CLASS"]),a=Ht(s,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"]),_=Ht(s,["DESCRIPTION","CONNECT_DATA","SID"]),T=Ht(s,["DESCRIPTION","CONNECT_DATA","POOL_PURITY"]);return[r,n,a,T,_,t]}c(QD,"getConnectionInfo");var ZD=new zD;async function td(i,e){let t=i.trim(),s=t;if(t.indexOf(")")==-1||t.indexOf("(")!=0){if(t.indexOf(":")!=-1||t.indexOf("/")!=-1)return s=new ZA(t).getResolvedUrl(),s;{let r=$D(e);if(s=(await ZD.initializeNlpa(r)).get(t.toUpperCase()),s||Ue.throwErr(Ue.ERR_TNS_ENTRY_NOT_FOUND,t,e?e+"/tnsnames.ora":jD.env.TNS_ADMIN+"/tnsnames.ora"),s.rhsType==1){let a=s.atom;if(a.indexOf(":")!=-1||a.indexOf("/")!=-1)return new ZA(a).getResolvedUrl()}s=s.getListElement(0)}}return s}c(td,"resolveConnectStr");async function Gc(i,e){let t=await td(i,e);return ed(t)}c(Gc,"resolveAddress");function qc(i,e,t,s,r){let n,a=new Promise((_,T)=>{e>2147483647&&(e=2147483647),n=setTimeout(()=>T(Ue.getErr(Ue.ERR_CONNECTION_TIMEDOUT,s.host,s.port,t,e/1e3,r)),e)});return Promise.race([i,a]).then(_=>(clearTimeout(n),_)).catch(_=>{throw clearTimeout(n),_})}c(qc,"timeout");var vc=class vc{constructor(){this.connected=!1,this.isBreak=!1,this.isReset=!1,this.breakPosted=!1}async getAddress(e,t){let s=await e.execute(t),r=this.sAtts?this.sAtts.uuid:null;this.sAtts=new WD(r),this.sAtts.setFrom(t),this.sAtts.setFrom(s.desc.params),await this.sAtts.prepare(s.protocol);let n=Nn(s.CNdata.join("")),a=XD(n,"CONNECT_DATA"),_=`(CONNECTION_ID=${this.sAtts.connectionId})`,T=Nn(_);return a.addListElement(T),this.cData=QA.from(n.toString(),"ascii"),this.cDataNVPair=n,this.sAtts.nt.cDataNVPair=n,s}async transportConnect(e){e.protocol.toUpperCase()=="TCP"&&e.httpsProxy&&Ue.throwErr(Ue.ERR_INVALID_CONNECT_STRING_PARAMETERS,"https proxy requires protocol as","tcps "),e.protocol&&(e.protocol.toUpperCase()=="TCP"||e.protocol.toUpperCase()=="TCPS")?this.ntAdapter=new KD(this.sAtts.nt):Ue.throwErr(Ue.ERR_INVALID_CONNECT_STRING_PARAMETERS,e.protocol+" protocol not supported"),await this.ntAdapter.connect(e),this.ntAdapter.startRead(),this.sAtts.ntCha=this.ntAdapter.cha,this.sndDatapkt=new Gt.DataPacket(this.sAtts.largeSDU),this.rcvDatapkt=new Gt.DataPacket(this.sAtts.largeSDU)}_sendConnect(e){this._sendPacket(e.buf),e.overflow&&(this._send(e.connectData,0,e.connectDataLen),this.flush())}async connect2(e){if(this.sAtts.sdu?this.sAtts.sdu>Z.NSPABSSDULN?this.sAtts.sdu=Z.NSPABSSDULN:this.sAtts.sdu<Z.NSPMNSDULN&&(this.sAtts.sdu=Z.NSPMNSDULN):this.sAtts.sdu=Z.NSPDFSDULN,this.sAtts.transportConnectTimeout){let s=this.transportConnect(e);await qc(s,this.sAtts.transportConnectTimeout,"transportConnectTimeout",e,this.sAtts.connectionId)}else await this.transportConnect(e);let t=new Gt.ConnectPacket(this.cData,this.sAtts);for(this._sendConnect(t);;){let s=await this._recvPacket();if(s.type===Z.NSPTAC)break;if(s.type===Z.NSPTRF){this.refusePkt.overflow&&(await this._recvPacket(),this.refusePkt.dataBuf=this.rcvDatapkt.buf.subarray(this.rcvDatapkt.offset,this.rcvDatapkt.len).toString());let r=Nn(this.refusePkt.dataBuf);this.refusePkt=null;let n=Ht(r,["DESCRIPTION","ERR"]);n=="12514"?Ue.throwErr(Ue.ERR_INVALID_SERVICE_NAME,this.getOption(Z.SVCNAME),e.host,e.port,this.sAtts.connectionId):n=="12505"?Ue.throwErr(Ue.ERR_INVALID_SID,this.getOption(Z.SID),e.host,e.port,this.sAtts.connectionId):n?Ue.throwErr(Ue.ERR_CONNECTION_REFUSED,e.host,e.port,this.sAtts.connectionId,"ORA-"+n):Ue.throwErr(Ue.ERR_CONNECTION_REFUSED,e.host,e.port,this.sAtts.connectionId,"refused")}else if(s.type===Z.NSPTRS)(s.flags&Z.NSPFSRN)==Z.NSPFSRN&&(await this.ntAdapter.renegTLS(),this.ntAdapter.startRead()),this._sendConnect(t);else if(s.type===Z.NSPTRD){let r,n,a;this.redirectPkt.overflow&&(await this._recvPacket(),this.redirectPkt.dataBuf=this.rcvDatapkt.buf.subarray(this.rcvDatapkt.offset,this.rcvDatapkt.len)),this.redirectPkt.flags&Z.NSPFRDS?(r=this.redirectPkt.dataBuf.indexOf("\0",0,"ascii"),n=this.redirectPkt.dataBuf.toString("ascii",0,r),a=this.redirectPkt.dataBuf.subarray(r+1,this.redirectPkt.dataLen)):(n=this.redirectPkt.dataBuf.toString("ascii"),a=this.cData);let _=await Gc(n),T=e.hostname;if(e=await _.execute(),e.desc&&this.sAtts.setFrom(e.desc.params),e.originHost=T,this.redirectPkt=null,this.ntAdapter.disconnect(Z.NSFIMM),this.sAtts.transportConnectTimeout){let l=this.transportConnect(e);await qc(l,this.sAtts.transportConnectTimeout,"transportConnectTimeout",e,this.sAtts.connectionId)}else await this.transportConnect(e);t=new Gt.ConnectPacket(a,this.sAtts,Z.NSPFRDR),this.sndDatapkt=new Gt.DataPacket(this.sAtts.largeSDU),this._sendConnect(t)}}return this.connected=!0,this.cData=null,this.sndDatapkt=new Gt.DataPacket(this.sAtts.largeSDU),this.sndDatapkt.createPacket(Z.NSPDADAT),this.sndDatapkt.offset=this.sndDatapkt.dataPtr,this.sndDatapkt.len=this.sndDatapkt.bufLen,this.markerPkt=new Gt.MarkerPacket(this.sAtts.largeSDU),this.controlPkt=new Gt.ControlPacket,this.ntAdapter.largeSDU=this.sAtts.largeSDU,this.sAtts.clearWallet(),this.sAtts.nt.walletPassword=null,!0}async connect1(e,t,s){let r,n;do try{if(this.sAtts.connectTimeout){let a=this.connect2(e);r=await qc(a,this.sAtts.connectTimeout,"connectTimeout",e,this.sAtts.connectionId)}else r=await this.connect2(e)}catch(a){a.message.startsWith("NJS-510")&&!this.ntAdapter.connected&&(JD.markDownHost(e.host,Date.now()),this.ntAdapter.connected=!0),this.ntAdapter&&(this.ntAdapter.disconnect(Z.NSFIMM),this.ntAdapter=null),this.sAtts.clearWallet(),r=!1,n=a;try{e=await this.getAddress(t,s)}catch{break}}while(!r);if(!r)throw n}_processPacket(e){switch(e.type){case Z.NSPTDA:this.rcvDatapkt.fromPacket(e);break;case Z.NSPTMK:this.markerPkt.fromPacket(e,this);break;case Z.NSPTCNL:this.controlPkt.fromPacket(e);break;case Z.NSPTAC:Gt.AcceptPacket(e,this.sAtts),this.sAtts.version>=Z.TNS_VERSION_MIN_END_OF_RESPONSE&&e.flags&Z.TNS_ACCEPT_FLAG_HAS_END_OF_REQUEST&&(this.endOfRequestSupport=!0),e.flags&Z.TNS_ACCEPT_FLAG_FAST_AUTH&&(this.supportsFastAuth=!0);break;case Z.NSPTRF:this.refusePkt=new Gt.RefusePacket(e);break;case Z.NSPTRS:break;case Z.NSPTRD:this.redirectPkt=new Gt.RedirectPacket(e);break;default:Ue.throwErr(Ue.ERR_CONNECTION_INVALID_PACKET)}}async _recvPacket(){for(;;){let e=await this.ntAdapter.receive();if(!e)break;if(this._processPacket(e),e.type!==Z.NSPTCNL)return e}}_sendPacket(e){this.ntAdapter.send(e)}sendBreak(){if(!this.isBreak){if(!this.connected){this.isBreak=!0,this.breakPosted=!0;return}this.isBreak=!0,this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQIMARK),this._sendPacket(this.markerPkt.buf)}}async reset(){for(this.breakPosted&&(this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQBMARK),this._sendPacket(this.markerPkt.buf),this.breakPosted=!1),this.markerPkt.prepare(Z.NSPMKTD1,Z.NIQRMARK),this._sendPacket(this.markerPkt.buf);!this.isReset;)await this._recvPacket();this.sndDatapkt.dataPtr=this.sndDatapkt.dataLen=Z.NSPDADAT,this.sndDatapkt.offset=this.sndDatapkt.dataPtr,this.sndDatapkt.len=this.sndDatapkt.bufLen,this.isBreak=this.isReset=!1}async recvPacket(){return await this._recvPacket()}syncRecvPacket(){for(;this.ntAdapter.packets.length>0;){let e=this.ntAdapter.syncReceive();if(!e)break;if(this._processPacket(e),e.type!==Z.NSPTCNL)return e}}_send(e,t,s){if(this.isBreak)return;let r=0;for(this.sndDatapkt.dataLen=this.sndDatapkt.offset,(this.sndDatapkt.dataLen<this.sndDatapkt.bufLen||!this.sndDatapkt.bufLen)&&(r=this.sndDatapkt.fillBuf(e,t,s),s-=r,t+=r,this.sndDatapkt.offset=this.sndDatapkt.dataLen);s;){if(this._sendPacket(this.sndDatapkt.dataBuf),this.isBreak)return;this.sndDatapkt.dataLen=this.sndDatapkt.dataPtr,this.sndDatapkt.offset=this.sndDatapkt.dataPtr,r=this.sndDatapkt.fillBuf(e,t,s),s-=r,t+=r,this.sndDatapkt.offset=this.sndDatapkt.dataLen}}flush(){this.isBreak||(this.sndDatapkt.dataLen=this.sndDatapkt.offset,this.sndDatapkt.prepare2Send(),this._sendPacket(QA.from(this.sndDatapkt.dataBuf)),this.sndDatapkt.dataLen=this.sndDatapkt.dataPtr,this.sndDatapkt.offset=this.sndDatapkt.dataPtr)}async connect(e){let t=e.connectString?e.connectString:e.connectionString,s;e._connInfo?(s=e._connInfo[5],s.reset()):s=await Gc(t,e.configDir);let r;try{r=await this.getAddress(s,e)}catch(n){n.message=="All options tried"?Ue.throwErr(Ue.ERR_INVALID_CONNECT_STRING_PARAMETERS,"Ensure the ADDRESS parameters have been entered correctly, the most likely incorrect parameter is the host name"):Ue.throwErr(Ue.ERR_INVALID_CONNECT_STRING_PARAMETERS,n.message)}await this.connect1(r,s,e)}forceDisconnect(e){this.connected&&(this.ntAdapter.stream.destroy(e),this.connected=!1)}disconnect(e){this.connected&&(e!=Z.NSFIMM&&!this.ntAdapter.err&&(this.sndDatapkt.dataLen=this.sndDatapkt.offset,this.sndDatapkt.prepare2Send(Z.NSPDAFEOF),this._sendPacket(this.sndDatapkt.dataBuf)),this.ntAdapter.disconnect(e),this.ntAdapter=null,this.connected=!1)}getOption(e){switch(e){case Z.NS_MOREDATA:return this.ntAdapter.packets.length>0;case Z.SVCNAME:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVICE_NAME"]);case Z.SID:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SID"]);case Z.SERVERTYPE:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","SERVER"]);case Z.REMOTEADDR:return this.ntAdapter?this.ntAdapter.getOption(e):null;case Z.CONNCLASS:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","POOL_CONNECTION_CLASS"]);case Z.PURITY:return Ht(this.cDataNVPair,["DESCRIPTION","CONNECT_DATA","POOL_PURITY"]);case Z.HEALTHCHECK:return this.connected&&this.ntAdapter.connected&&!this.ntAdapter.err;default:Ue.throwErr(Ue.ERR_INTERNAL,"getOption not supported for opcode "+e)}}recvInbandNotif(){let e=0;if(this.controlPkt.errno)return e=this.controlPkt.errno,e;if(this.getOption(Z.HEALTHCHECK))if(this.getOption(Z.NS_MOREDATA)){let t=this.ntAdapter.syncReceive();return t.type==Z.NSPTCNL?(this.controlPkt.fromPacket(t),e=this.controlPkt.errno,e):(this.ntAdapter.packets.unshift(t),0)}else return 0;else return Ue.ERR_CONNECTION_CLOSED}};c(vc,"NetworkSession");var Hc=vc;sd.exports={NetworkSession:Hc,resolveAddress:Gc,getConnectionInfo:QD}});var Jc=P((I0,zc)=>{"use strict";var{Buffer:eC}=require("buffer"),ht=nt(),rd=W(),tC=we(),$c=class $c{constructor(e,t=!1){this.bindName=e,this.isReturnBind=t,this.maxSize=0,this.numElements=0,this.maxArraySize=0,this.type=null,this.isArray=!1,this.dir=ht.BIND_IN,this.bindVar=null}};c($c,"BindInfo");var Jr=$c;zc.exports.BindInfo=Jr;var jc=class jc{constructor(){this.returningKeywordFound=!1,this.pos=0,this.maxPos=0,this.sqlData=""}_parseBindName(e){let t=!1,s=!1,r=!1,n=0,a=this.pos+1,_,T;for(;a<=this.maxPos;){if(T=this.sqlData[a],s){if(r&&!new RegExp("\\p{N}","u").test(T)){this.pos=a-1;break}else if(t&&T==='"'){this.pos=a;break}else if(!r&&!t&&!/[\p{L}\p{N}]/u.test(T)&&!["$","_","#"].includes(T)){this.pos=a-1;break}}else{if(new RegExp("\\p{space}","u").test(T)){a+=1;continue}else if(T==='"')t=!0;else if(new RegExp("\\p{N}","u").test(T))r=!0;else if(!new RegExp("\\p{Alpha}","u").test(T))break;s=!0,n=a}a+=1}s&&(t?_=e.sql.substring(n+1,a):r?_=e.sql.substring(n,a):_=e.sql.substring(n,a).toUpperCase(),e._addBind(_))}_parseMultiLineComment(){let e=!1,t=!1,s=this.pos+1,r;for(;s<=this.maxPos;){if(r=this.sqlData[s],e){if(r==="*")t=!0;else if(t){if(r==="/"){this.pos=s;break}t=!1}}else{if(r!=="*")break;e=!0}s+=1}}_parseQstring(){let e=!1,t=!1,s,r;for(this.pos+=1;this.pos<=this.maxPos;){if(r=this.sqlData[this.pos],!t)r==="["?s="]":r==="{"?s="}":r==="("?s=")":r==="<"?s=">":s=r,t=!0;else if(!e&&r===s)e=!0;else if(e){if(r==="'")break;r!==s&&(e=!1)}this.pos+=1}}_parseQuotedString(e){let t;for(this.pos+=1;this.pos<=this.maxPos&&(t=this.sqlData[this.pos],t!==e);)this.pos+=1}_parseSingleLineComment(){let e=!1,t=this.pos+1,s;for(;t<=this.maxPos;){if(s=this.sqlData[t],e){if(s===`
`)break}else{if(s!=="-")return;e=!0}t+=1}this.pos=t}parse(e){let t=!1,s=!1,r,n="",a="",_=0,T,l,E=!1,h;for(this.pos=0,this.maxPos=e.sql.length-1,this.sqlData=e.sql;this.pos<=this.maxPos;){if(r=this.sqlData[this.pos],l=new RegExp("\\p{L}","u").test(r),l&&!E)_=this.pos,a=r;else if(!l&&E){if(T=this.pos-_,t)e.isDml&&!this.returningKeywordFound&&(T===9||T===6)&&["r","R"].includes(a)?(h=e.sql.substring(_,this.pos).toUpperCase(),["RETURNING","RETURN"].includes(h)&&(this.returningKeywordFound=!0)):this.returningKeywordFound&&T===4&&["i","I"].includes(a)&&(h=e.sql.substring(_,this.pos).toUpperCase(),h==="INTO"&&(e.isReturning=!0));else if(h=e.sql.substring(_,this.pos).toUpperCase(),e._determineStatementType(h),t=!0,e.isDdl)break}r==="'"?(s=!0,["q","Q"].includes(n)?this._parseQstring():this._parseQuotedString(r)):new RegExp("\\p{space}","u").test(r)||(r==="-"?this._parseSingleLineComment():r==="/"?this._parseMultiLineComment():r==='"'?this._parseQuotedString(r):r===":"&&!s&&this._parseBindName(e),s=!1),this.pos+=1,E=l,n=r}t||e._determineStatementType(e.sql.toUpperCase())}};c(jc,"Parser");var Wc=jc,Sn=class Sn{constructor(){this.sql="",this.sqlBytes=[],this.sqlLength=0,this.cursorId=0,this.requiresDefine=!1,this.isQuery=!1,this.isPlSql=!1,this.isDml=!1,this.isDdl=!1,this.isReturning=!1,this.bindInfoList=[],this.queryVars=[],this.bindInfoDict=new Map,this.requiresFullExecute=!1,this.noPrefetch=!1,this.returnToCache=!1,this.numColumns=0,this.lastRowIndex,this.lastRowid,this.moreRowsToFetch=!0,this.inUse=!1,this.bufferRowIndex=0,this.bufferRowCount=0,this.pendingClear=!1,this.statementType=ht.STMT_TYPE_UNKNOWN}_copy(){let e=new Sn;e.sql=this.sql,e.sqlBytes=this.sqlBytes,e.sqlLength=this.sqlLength,e.isQuery=this.isQuery,e.isPlSql=this.isPlSql,e.isDml=this.isDml,e.isDdl=this.isDdl,e.isReturning=this.isReturning,e.bindInfoList=[];for(let s of this.bindInfoList){let r=new Jr(s.bindName,s.isReturnBind);e.bindInfoList.push(r)}let t=e.bindInfoDict=new Map;for(let s of e.bindInfoList)t.has(s.bindName)?t.get(s.bindName).push(s):t.set(s.bindName,[s]);return e.returnToCache=!1,e}_determineStatementType(e){switch(e){case"DECLARE":this.isPlSql=!0,this.statementType=ht.STMT_TYPE_DECLARE;break;case"CALL":this.isPlSql=!0,this.statementType=ht.STMT_TYPE_CALL;break;case"BEGIN":this.isPlSql=!0,this.statementType=ht.STMT_TYPE_BEGIN;break;case"SELECT":this.isQuery=!0,this.statementType=ht.STMT_TYPE_SELECT;break;case"WITH":this.isQuery=!0;break;case"INSERT":this.isDml=!0,this.statementType=ht.STMT_TYPE_INSERT;break;case"UPDATE":this.isDml=!0,this.statementType=ht.STMT_TYPE_UPDATE;break;case"DELETE":this.isDml=!0,this.statementType=ht.STMT_TYPE_DELETE;break;case"MERGE":this.isDml=!0,this.statementType=ht.STMT_TYPE_MERGE;break;case"ALTER":this.isDdl=!0,this.statementType=ht.STMT_TYPE_ALTER;break;case"CREATE":this.isDdl=!0,this.statementType=ht.STMT_TYPE_CREATE;break;case"DROP":this.isDdl=!0,this.statementType=ht.STMT_TYPE_DROP;break;case"ANALYZE":case"AUDIT":case"COMMENT":case"GRANT":case"REVOKE":case"TRUNCATE":this.isDdl=!0;break;case"COMMIT":this.statementType=ht.STMT_TYPE_COMMIT;break;case"ROLLBACK":this.statementType=ht.STMT_TYPE_ROLLBACK;break;default:this.statementType=ht.STMT_TYPE_UNKNOWN;break}}_prepare(e){this.sql=e,this.sqlBytes=eC.from(this.sql,"utf8"),this.sqlLength=this.sqlBytes.length,new Wc().parse(this)}_addBind(e){if(!this.isPlSql||!this.bindInfoDict.has(e)){let t=new Jr(e,this.isReturning);this.bindInfoList.push(t),this.bindInfoDict.has(t.bindName)?(this.isReturning&&(this.bindInfoDict.get(t.bindName)[0].isReturnBind||rd.throwErr(rd.ERR_DML_RETURNING_DUP_BINDS,e)),this.bindInfoDict.get(t.bindName).push(t)):this.bindInfoDict.set(t.bindName,[t])}}_setVariable(e,t){t.type._oraTypeNum===tC.TNS_DATA_TYPE_CURSOR&&(this.requiresFullExecute=!0),(t.maxSize!==e.maxSize||t.dir!==e.dir||t.isArray!==e.isArray||t.values.length>e.numElements||t.type!=e.type||t.maxArraySize!=e.maxArraySize)&&(e.isArray=t.isArray,e.numElements=t.values.length,e.maxSize=t.maxSize,e.type=t.type,e.dir=t.dir,e.maxArraySize=t.maxArraySize,this.requiresFullExecute=!0),e.bindVar=t}_clearAllState(){this.cursorId=0,this.requiresDefine=!1,this.noPrefetch=!1,this.requiresFullExecute=!1,this.queryVars=[],this.numQueryVars=0,this.bufferRowCount=0,this.bufferRowIndex=0}_clearState(){this.cursorId=0,this.requiresDefine=!1,this.noPrefetch=!1,this.requiresFullExecute=!1}};c(Sn,"Statement");var Xc=Sn;zc.exports.Statement=Xc});var nd=P((C0,id)=>{"use strict";var{Buffer:de}=require("buffer"),vt=require("crypto"),An="aes-256-cbc",sC=de.from([0,1]),Zc=class Zc{_decrypt(e,t){let s=de.alloc(16,0),r=vt.createDecipheriv(An,e,s);r.setAutoPadding(!1);let n=r.update(t);return n=de.concat([n,r.final()]),n}_encrypt(e,t,s){let n=de.alloc(16,0),a=16-t.length%16,_=de.alloc(a,a);a>0&&(s?t+=de.alloc(a):t=de.concat([t,_]));let T=vt.createCipheriv(An,e,n),l=T.update(t);return l=de.concat([l,T.final()]),s||(l=l.slice(0,t.length)),t.fill(0),l}_setEncryptedPasswordBuffers(e,t,s,r){let n=de.alloc(16);vt.randomFillSync(n,0,16);let a=de.concat([n,e]);if(r.encodedPassword=this._encrypt(s,a),a.fill(0),r.encodedPassword=r.encodedPassword.slice().toString("hex").toUpperCase(),t){let _=de.concat([n,t]);r.encodedNewPassword=this._encrypt(s,_),_.fill(0),r.encodedNewPassword=r.encodedNewPassword.slice().toString("hex").toUpperCase()}e.fill(0),t&&t.fill(0)}updateVerifierData(e,t,s,r,n){let a=32,_="sha512",T=de.from(e.AUTH_VFR_DATA,"hex"),l=de.from(e.AUTH_SESSKEY,"hex"),E=Number(e.AUTH_PBKDF2_VGEN_COUNT),h=de.from(t,"utf8"),p,A;if(r){An="aes-192-cbc",a=24,_="sha1";let m=vt.createHash(_);m.update(h),m.update(T);let O=m.digest();p=de.alloc(O.length+4),O.copy(p,0,0,O.length)}else{An="aes-256-cbc";let m=de.from("AUTH_PBKDF2_SPEEDY_KEY","utf8"),O=de.concat([T,m]);A=vt.pbkdf2Sync(h,O,E,64,"sha512");let U=vt.createHash(_);U.update(A),U.update(T),p=U.digest().slice(0,a)}let u;s&&(u=de.from(s,"utf8"));let N=this._decrypt(p,l),d=de.alloc(N.length);vt.randomFillSync(d);let S=this._encrypt(p,d);if(N.length===48){n.sessionKey=S.slice().toString("hex").toUpperCase().slice(0,96);let m=de.alloc(24);for(let V=16;V<=40;V++)m[V-16]=N[V]^d[V];let O=vt.createHash("md5").update(m.subarray(0,16)).digest(),U=vt.createHash("md5").update(m.subarray(16)).digest();n.comboKey=de.concat([O,U]).slice(0,a)}else{n.sessionKey=S.slice().toString("hex").toUpperCase().slice(0,64);let m=de.from(e.AUTH_PBKDF2_CSK_SALT,"hex");E=Number(e.AUTH_PBKDF2_SDER_COUNT);let U=de.concat([d.slice(0,a),N.slice(0,a)]).toString("hex").toUpperCase(),V=de.from(U,"utf8");n.comboKey=vt.pbkdf2Sync(V,m,E,a,"sha512")}let D=de.alloc(16);if(!r){vt.randomFillSync(D,0,16);let m=de.concat([D,A]);n.speedyKey=this._encrypt(n.comboKey,m),n.speedyKey=n.speedyKey.slice(0,80).toString("hex").toUpperCase()}this._setEncryptedPasswordBuffers(h,u,n.comboKey,n)}getEncryptedJSWPData(e,t){let s=this._encrypt(e,t,!0);return s=s.slice().toString("hex").toUpperCase(),s=de.concat([s,sC]),s}updatePasswordsWithComboKey(e,t,s,r){let n=de.from(e,"utf8"),a;t&&(a=de.from(t,"utf8")),this._setEncryptedPasswordBuffers(n,a,s,r)}};c(Zc,"EncryptDecrypt");var Qc=Zc,rC=new Qc;id.exports=rC});var cd=P((g0,_d)=>{"use strict";var{Buffer:eT}=require("buffer"),ce=we(),od=W(),ad=require("process"),tT=nd(),iC=Ct(),sT=Wr(),Qr=sT.CLIENT_INFO,nC=require("crypto"),iT=class iT extends iC{constructor(e,t){super(e),this.functionCode=ce.TNS_FUNC_AUTH_PHASE_ONE,this.messageType=ce.TNS_MSG_TYPE_FUNCTION,this.sessionData={},this.conn=e,this.sessionKey="",this.encodedPassword="",this.changePassword=!1,Object.defineProperty(this,"password",{enumerable:!1,value:t.password}),this.username=t.user,this.username===void 0?this.username="":this.username=this.username.trim(),this.schemaUser="",this.proxyUser="",this.proxyStatus=-1,this.username.length!==0&&(this.proxyStatusObj=sT.checkProxyUserValidity(this.username),this.proxyStatusObj.status===0&&(this.proxyStatus=0,this.proxyUser=this.proxyStatusObj.proxyUser,this.schemaUser=this.proxyStatusObj.schemaUser,this.username=this.proxyUser)),this.newPassword=t.newPassword,t.changePassword&&(this.changePassword=!0,this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO),this.username?this.userByteLen=eT.byteLength(this.username):this.userByteLen=0,this.token=t.token,this.token&&(this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO),this.privateKey=t.privateKey,this.privateKey&&(this.privateKey=sT.normalizePrivateKey(this.privateKey)),this.serviceName=this.conn.serviceName,this.remoteAddress=this.conn.remoteAddress,this.setAuthMode(t)}setAuthMode(e){this.newPassword||(this.authMode=ce.TNS_AUTH_MODE_LOGON),e.privilege&ce.SYSDBA&&(this.authMode|=ce.TNS_AUTH_MODE_SYSDBA),e.privilege&ce.SYSOPER&&(this.authMode|=ce.TNS_AUTH_MODE_SYSOPER),e.privilege&ce.SYSASM&&(this.authMode|=ce.TNS_AUTH_MODE_SYSASM),e.privilege&ce.SYSBKP&&(this.authMode|=ce.TNS_AUTH_MODE_SYSBKP),e.privilege&ce.SYSDG&&(this.authMode|=ce.TNS_AUTH_MODE_SYSDGD),e.privilege&ce.SYSKM&&(this.authMode|=ce.TNS_AUTH_MODE_SYSKMT),e.privilege&ce.SYSRAC&&(this.authMode|=ce.TNS_AUTH_MODE_SYSRAC),this.privateKey&&(this.authMode|=ce.TNS_AUTH_MODE_IAM_TOKEN),this.newPassword&&(this.authMode|=ce.TNS_AUTH_MODE_CHANGE_PASSWORD),this.token||(this.authMode|=ce.TNS_AUTH_MODE_WITH_PASSWORD)}getAlterTimezoneStatement(){let e,t;if(ad.env.ORA_SDTZ)t=ad.env.ORA_SDTZ;else{let r=new Date().getTimezoneOffset(),n=Math.trunc(r/60),a=Math.abs((r-n*60)%60);n<0?(e="+",n=-n):e="-",n=n.toLocaleString("en-US",{minimumIntegerDigits:2}),t=`${e}${n}:${a}`}return`ALTER SESSION SET TIME_ZONE ='${t}'\0`}encode(e){let t=!1;if(this.writeFunctionHeader(e),this.userByteLen>0?e.writeUInt8(1):e.writeUInt8(0),e.writeUB4(this.userByteLen),e.writeUB4(this.authMode),this.functionCode===ce.TNS_FUNC_AUTH_PHASE_ONE)e.writeUInt8(1),e.writeUB4(5),e.writeUInt8(0),e.writeUInt8(1),this.userByteLen>0&&e.writeBytesWithLength(eT.from(this.username)),e.writeKeyValue("AUTH_TERMINAL",Qr.terminal),e.writeKeyValue("AUTH_PROGRAM_NM",Qr.program),e.writeKeyValue("AUTH_MACHINE",Qr.hostName),e.writeKeyValue("AUTH_PID",Qr.pid),e.writeKeyValue("AUTH_SID",Qr.userName);else{let s=0;if(this.changePassword?(tT.updatePasswordsWithComboKey(this.password,this.newPassword,this.conn.comboKey,this),s=2):(s=4,this.token?s+=1:(s+=2,this.verifierType===ce.TNS_VERIFIER_TYPE_11G_1||this.verifierType===ce.TNS_VERIFIER_TYPE_11G_2?t=!0:this.verifierType!==ce.TNS_VERIFIER_TYPE_12C?od.throwErr(od.ERR_UNSUPPORTED_VERIFIER_TYPE,this.verifierType.toString(16)):s+=1,tT.updateVerifierData(this.sessionData,this.password,this.newPassword,t,this),this.conn.comboKey=this.comboKey,this.newPassword&&(s+=1)),this.privateKey&&(s+=2),this.conn.connectionClass&&(s+=1),this.conn.purity&&(s+=1),this.conn.jdwpData&&(this.encryptedJDWPData=tT.getEncryptedJSWPData(this.sessionKey,this.conn.jdwpData),s+=1),this.schemaUser.length!==0&&(s+=1)),e.writeUInt8(1),e.writeUB4(s),e.writeUInt8(1),e.writeUInt8(1),this.userByteLen>0&&e.writeBytesWithLength(eT.from(this.username)),this.token?e.writeKeyValue("AUTH_TOKEN",this.token):this.changePassword||(e.writeKeyValue("AUTH_SESSKEY",this.sessionKey,1),t||e.writeKeyValue("AUTH_PBKDF2_SPEEDY_KEY",this.speedyKey)),this.changePassword||(e.writeKeyValue("SESSION_CLIENT_CHARSET","873"),e.writeKeyValue("SESSION_CLIENT_DRIVER_NAME",ce.DRIVER_NAME),e.writeKeyValue("SESSION_CLIENT_VERSION",ce.CLIENT_VERSION.toString()),e.writeKeyValue("AUTH_ALTER_SESSION",this.getAlterTimezoneStatement(),1)),this.encodedPassword&&e.writeKeyValue("AUTH_PASSWORD",this.encodedPassword),this.proxyStatus===0&&e.writeKeyValue("PROXY_CLIENT_NAME",this.schemaUser),this.encodedNewPassword&&e.writeKeyValue("AUTH_NEWPASSWORD",this.encodedNewPassword),this.conn.connectionClass&&e.writeKeyValue("AUTH_KPPL_CONN_CLASS",this.conn.connectionClass),this.conn.purity&&e.writeKeyValue("AUTH_KPPL_PURITY",""+this.conn.purity),this.privateKey){let a="date: "+new Date().toGMTString()+`
(request-target): `+this.serviceName+`
host: `+this.remoteAddress,_=nC.createSign("RSA-SHA256").update(a).sign(this.privateKey,"base64");e.writeKeyValue("AUTH_HEADER",a),e.writeKeyValue("AUTH_SIGNATURE",_)}this.conn.jdwpData&&e.writeKeyValue("AUTH_ORA_DEBUG_JDWP",this.encryptedJDWPData)}}processReturnParameter(e){let t=e.readUB2();for(let s=0;s<t;s++){e.skipUB4();let r=e.readStr(ce.CSFRM_IMPLICIT),n="";e.readUB4()>0&&(n=e.readStr(ce.CSFRM_IMPLICIT));let _=e.readUB4();r==="AUTH_VFR_DATA"&&(this.verifierType=_),this.sessionData[r]=n}if(this.functionCode===ce.TNS_FUNC_AUTH_PHASE_ONE)this.functionCode=ce.TNS_FUNC_AUTH_PHASE_TWO;else{let s,r,n,a;this.conn.dbDomain=this.sessionData.AUTH_SC_DB_DOMAIN,this.conn.dbName=this.sessionData.AUTH_SC_DBUNIQUE_NAME,this.conn.maxOpenCursors=Number(this.sessionData.AUTH_MAX_OPEN_CURSORS||0),this.conn.serviceName=this.sessionData.AUTH_SC_SERVICE_NAME,this.conn.instanceName=this.sessionData.AUTH_INSTANCENAME;let _=Number(this.sessionData.AUTH_VERSION_NO),T=_>>24&255;this.conn.warning=this.warning,e.caps.ttcFieldVersion>=ce.TNS_CCAP_FIELD_VERSION_18_1_EXT_1?(s=_>>16&255,r=_>>12&15,n=_>>4&255,a=_&15):(s=_>>20&15,r=_>>12&255,n=_>>8&15,a=_&255),this.conn.serverVersionString=T+"."+s+"."+r+"."+n+"."+a,this.conn.serverVersion=T*1e8+s*1e6+r*1e4+n*100+a*1}}};c(iT,"AuthMessage");var rT=iT;_d.exports=rT});var ld=P((L0,Td)=>{"use strict";var oC=Ct(),aC=we(),oT=class oT extends oC{constructor(e){super(e),this.functionCode=aC.TNS_FUNC_COMMIT}encode(e){this.writeFunctionHeader(e)}};c(oT,"CommitMessage");var nT=oT;Td.exports=nT});var ud=P((w0,Ed)=>{"use strict";var o=we(),_C=Ct(),_T=class _T extends _C{processMessage(e,t){if(t===o.TNS_MSG_TYPE_DATA_TYPES){for(;e.readUInt16BE()!==0;)e.readUInt16BE()!==0&&e.skipBytes(4);this.endOfResponse=!this.connection.nscon.endOfRequestSupport}else super.processMessage(e,t)}encode(e){e.writeUInt8(o.TNS_MSG_TYPE_DATA_TYPES),e.writeUInt16LE(o.TNS_CHARSET_UTF8),e.writeUInt16LE(o.TNS_CHARSET_UTF8),e.writeUInt8(o.TNS_ENCODING_MULTI_BYTE|o.TNS_ENCODING_CONV_LENGTH),e.writeBytesWithLength(e.caps.compileCaps),e.writeBytesWithLength(e.caps.runtimeCaps);for(let t of cC)e.writeUInt16BE(t[0]),e.writeUInt16BE(t[1]),e.writeUInt16BE(t[2]),e.writeUInt16BE(0);e.writeUInt16BE(0)}};c(_T,"DataTypeMessage");var aT=_T,cC=[[o.TNS_DATA_TYPE_VARCHAR,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NUMBER,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_LONG,o.TNS_DATA_TYPE_LONG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DATE,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_RAW,o.TNS_DATA_TYPE_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LONG_RAW,o.TNS_DATA_TYPE_LONG_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB2,o.TNS_DATA_TYPE_UB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB4,o.TNS_DATA_TYPE_UB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SB1,o.TNS_DATA_TYPE_SB1,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_SB2,o.TNS_DATA_TYPE_SB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SB4,o.TNS_DATA_TYPE_SB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SWORD,o.TNS_DATA_TYPE_SWORD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UWORD,o.TNS_DATA_TYPE_UWORD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTRB,o.TNS_DATA_TYPE_PTRB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTRW,o.TNS_DATA_TYPE_PTRW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIDDEF,o.TNS_DATA_TYPE_TIDDEF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ROWID,o.TNS_DATA_TYPE_ROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AMS,o.TNS_DATA_TYPE_AMS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRN,o.TNS_DATA_TYPE_BRN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CWD,o.TNS_DATA_TYPE_CWD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC122,o.TNS_DATA_TYPE_OAC122,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER8,o.TNS_DATA_TYPE_OER8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FUN,o.TNS_DATA_TYPE_FUN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AUA,o.TNS_DATA_TYPE_AUA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH7,o.TNS_DATA_TYPE_RXH7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NA6,o.TNS_DATA_TYPE_NA6,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRP,o.TNS_DATA_TYPE_BRP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BRV,o.TNS_DATA_TYPE_BRV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVA,o.TNS_DATA_TYPE_KVA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLS,o.TNS_DATA_TYPE_CLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CUI,o.TNS_DATA_TYPE_CUI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DFN,o.TNS_DATA_TYPE_DFN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DQR,o.TNS_DATA_TYPE_DQR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSC,o.TNS_DATA_TYPE_DSC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXE,o.TNS_DATA_TYPE_EXE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FCH,o.TNS_DATA_TYPE_FCH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GBV,o.TNS_DATA_TYPE_GBV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GEM,o.TNS_DATA_TYPE_GEM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GIV,o.TNS_DATA_TYPE_GIV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKG,o.TNS_DATA_TYPE_OKG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_HMI,o.TNS_DATA_TYPE_HMI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INO,o.TNS_DATA_TYPE_INO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LNF,o.TNS_DATA_TYPE_LNF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ONT,o.TNS_DATA_TYPE_ONT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OPE,o.TNS_DATA_TYPE_OPE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OSQ,o.TNS_DATA_TYPE_OSQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SFE,o.TNS_DATA_TYPE_SFE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SPF,o.TNS_DATA_TYPE_SPF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VSN,o.TNS_DATA_TYPE_VSN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD7,o.TNS_DATA_TYPE_UD7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSA,o.TNS_DATA_TYPE_DSA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PIN,o.TNS_DATA_TYPE_PIN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PFN,o.TNS_DATA_TYPE_PFN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PPT,o.TNS_DATA_TYPE_PPT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_STO,o.TNS_DATA_TYPE_STO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ARC,o.TNS_DATA_TYPE_ARC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRS,o.TNS_DATA_TYPE_MRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRT,o.TNS_DATA_TYPE_MRT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRG,o.TNS_DATA_TYPE_MRG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRR,o.TNS_DATA_TYPE_MRR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MRC,o.TNS_DATA_TYPE_MRC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VER,o.TNS_DATA_TYPE_VER,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LON2,o.TNS_DATA_TYPE_LON2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INO2,o.TNS_DATA_TYPE_INO2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ALL,o.TNS_DATA_TYPE_ALL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UDB,o.TNS_DATA_TYPE_UDB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQI,o.TNS_DATA_TYPE_AQI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ULB,o.TNS_DATA_TYPE_ULB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ULD,o.TNS_DATA_TYPE_ULD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SID,o.TNS_DATA_TYPE_SID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NA7,o.TNS_DATA_TYPE_NA7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AL7,o.TNS_DATA_TYPE_AL7,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_K2RPC,o.TNS_DATA_TYPE_K2RPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XDP,o.TNS_DATA_TYPE_XDP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKO8,o.TNS_DATA_TYPE_OKO8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD12,o.TNS_DATA_TYPE_UD12,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AL8,o.TNS_DATA_TYPE_AL8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LFOP,o.TNS_DATA_TYPE_LFOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FCRT,o.TNS_DATA_TYPE_FCRT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DNY,o.TNS_DATA_TYPE_DNY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OPR,o.TNS_DATA_TYPE_OPR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PLS,o.TNS_DATA_TYPE_PLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XID,o.TNS_DATA_TYPE_XID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TXN,o.TNS_DATA_TYPE_TXN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DCB,o.TNS_DATA_TYPE_DCB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CCA,o.TNS_DATA_TYPE_CCA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_WRN,o.TNS_DATA_TYPE_WRN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TLH,o.TNS_DATA_TYPE_TLH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TOH,o.TNS_DATA_TYPE_TOH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FOI,o.TNS_DATA_TYPE_FOI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SID2,o.TNS_DATA_TYPE_SID2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TCH,o.TNS_DATA_TYPE_TCH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PII,o.TNS_DATA_TYPE_PII,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PFI,o.TNS_DATA_TYPE_PFI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PPU,o.TNS_DATA_TYPE_PPU,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PTE,o.TNS_DATA_TYPE_PTE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH8,o.TNS_DATA_TYPE_RXH8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_N12,o.TNS_DATA_TYPE_N12,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AUTH,o.TNS_DATA_TYPE_AUTH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVAL,o.TNS_DATA_TYPE_KVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FGI,o.TNS_DATA_TYPE_FGI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSY,o.TNS_DATA_TYPE_DSY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYR8,o.TNS_DATA_TYPE_DSYR8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYH8,o.TNS_DATA_TYPE_DSYH8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYL,o.TNS_DATA_TYPE_DSYL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYT8,o.TNS_DATA_TYPE_DSYT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYV8,o.TNS_DATA_TYPE_DSYV8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYP,o.TNS_DATA_TYPE_DSYP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYF,o.TNS_DATA_TYPE_DSYF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYK,o.TNS_DATA_TYPE_DSYK,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYY,o.TNS_DATA_TYPE_DSYY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYQ,o.TNS_DATA_TYPE_DSYQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYC,o.TNS_DATA_TYPE_DSYC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYA,o.TNS_DATA_TYPE_DSYA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OT8,o.TNS_DATA_TYPE_OT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYTY,o.TNS_DATA_TYPE_DSYTY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQE,o.TNS_DATA_TYPE_AQE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KV,o.TNS_DATA_TYPE_KV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQD,o.TNS_DATA_TYPE_AQD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQ8,o.TNS_DATA_TYPE_AQ8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RFS,o.TNS_DATA_TYPE_RFS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH10,o.TNS_DATA_TYPE_RXH10,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPN,o.TNS_DATA_TYPE_KPN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNR,o.TNS_DATA_TYPE_KPDNR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYD,o.TNS_DATA_TYPE_DSYD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYS,o.TNS_DATA_TYPE_DSYS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYR,o.TNS_DATA_TYPE_DSYR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYH,o.TNS_DATA_TYPE_DSYH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYT,o.TNS_DATA_TYPE_DSYT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DSYV,o.TNS_DATA_TYPE_DSYV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQM,o.TNS_DATA_TYPE_AQM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER11,o.TNS_DATA_TYPE_OER11,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQL,o.TNS_DATA_TYPE_AQL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OTC,o.TNS_DATA_TYPE_OTC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KFNO,o.TNS_DATA_TYPE_KFNO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KFNP,o.TNS_DATA_TYPE_KFNP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KGT8,o.TNS_DATA_TYPE_KGT8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RASB4,o.TNS_DATA_TYPE_RASB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RAUB2,o.TNS_DATA_TYPE_RAUB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RAUB1,o.TNS_DATA_TYPE_RAUB1,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RATXT,o.TNS_DATA_TYPE_RATXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSSB4,o.TNS_DATA_TYPE_RSSB4,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSUB2,o.TNS_DATA_TYPE_RSUB2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSUB1,o.TNS_DATA_TYPE_RSUB1,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSTXT,o.TNS_DATA_TYPE_RSTXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RIDL,o.TNS_DATA_TYPE_RIDL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDD,o.TNS_DATA_TYPE_GLRDD,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDG,o.TNS_DATA_TYPE_GLRDG,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_GLRDC,o.TNS_DATA_TYPE_GLRDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKO,o.TNS_DATA_TYPE_OKO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPP,o.TNS_DATA_TYPE_DPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPLS,o.TNS_DATA_TYPE_DPLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPMOP,o.TNS_DATA_TYPE_DPMOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_STAT,o.TNS_DATA_TYPE_STAT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RFX,o.TNS_DATA_TYPE_RFX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FAL,o.TNS_DATA_TYPE_FAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CKV,o.TNS_DATA_TYPE_CKV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DRCX,o.TNS_DATA_TYPE_DRCX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KGH,o.TNS_DATA_TYPE_KGH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQO,o.TNS_DATA_TYPE_AQO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OKGT,o.TNS_DATA_TYPE_OKGT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPFC,o.TNS_DATA_TYPE_KPFC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_FE2,o.TNS_DATA_TYPE_FE2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SPFP,o.TNS_DATA_TYPE_SPFP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DPULS,o.TNS_DATA_TYPE_DPULS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQA,o.TNS_DATA_TYPE_AQA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPBF,o.TNS_DATA_TYPE_KPBF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TSM,o.TNS_DATA_TYPE_TSM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_MSS,o.TNS_DATA_TYPE_MSS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPC,o.TNS_DATA_TYPE_KPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CRS,o.TNS_DATA_TYPE_CRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KKS,o.TNS_DATA_TYPE_KKS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSP,o.TNS_DATA_TYPE_KSP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSPTOP,o.TNS_DATA_TYPE_KSPTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSPVAL,o.TNS_DATA_TYPE_KSPVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PSS,o.TNS_DATA_TYPE_PSS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_NLS,o.TNS_DATA_TYPE_NLS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ALS,o.TNS_DATA_TYPE_ALS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSDEVTVAL,o.TNS_DATA_TYPE_KSDEVTVAL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSDEVTTOP,o.TNS_DATA_TYPE_KSDEVTTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPSPP,o.TNS_DATA_TYPE_KPSPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KOL,o.TNS_DATA_TYPE_KOL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LST,o.TNS_DATA_TYPE_LST,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ACX,o.TNS_DATA_TYPE_ACX,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCS,o.TNS_DATA_TYPE_SCS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RXH,o.TNS_DATA_TYPE_RXH,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNS,o.TNS_DATA_TYPE_KPDNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDCN,o.TNS_DATA_TYPE_KPDCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNNS,o.TNS_DATA_TYPE_KPNNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNCN,o.TNS_DATA_TYPE_KPNCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPS,o.TNS_DATA_TYPE_KPS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_APINF,o.TNS_DATA_TYPE_APINF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TEN,o.TNS_DATA_TYPE_TEN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSCS,o.TNS_DATA_TYPE_XSSCS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSSO,o.TNS_DATA_TYPE_XSSSO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSAO,o.TNS_DATA_TYPE_XSSAO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KSRPC,o.TNS_DATA_TYPE_KSRPC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVL,o.TNS_DATA_TYPE_KVL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSDEF,o.TNS_DATA_TYPE_XSSDEF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PDQCINV,o.TNS_DATA_TYPE_PDQCINV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PDQIDC,o.TNS_DATA_TYPE_PDQIDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDQCSTA,o.TNS_DATA_TYPE_KPDQCSTA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPRS,o.TNS_DATA_TYPE_KPRS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDQIDC,o.TNS_DATA_TYPE_KPDQIDC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RTSTRM,o.TNS_DATA_TYPE_RTSTRM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSGET,o.TNS_DATA_TYPE_SESSGET,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSREL,o.TNS_DATA_TYPE_SESSREL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSRET,o.TNS_DATA_TYPE_SESSRET,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN6,o.TNS_DATA_TYPE_SCN6,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KECPA,o.TNS_DATA_TYPE_KECPA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KECPP,o.TNS_DATA_TYPE_KECPP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SXA,o.TNS_DATA_TYPE_SXA,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KVARR,o.TNS_DATA_TYPE_KVARR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNGN,o.TNS_DATA_TYPE_KPNGN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_INTEGER,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_FLOAT,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_STR,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VNU,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_PDN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_VCS,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VBI,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC9,o.TNS_DATA_TYPE_OAC9,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UIN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_SLS,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_LVC,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_LVB,o.TNS_DATA_TYPE_RAW,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CHAR,o.TNS_DATA_TYPE_CHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AVC,o.TNS_DATA_TYPE_CHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_FLOAT,o.TNS_DATA_TYPE_BINARY_FLOAT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BINARY_DOUBLE,o.TNS_DATA_TYPE_BINARY_DOUBLE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CURSOR,o.TNS_DATA_TYPE_CURSOR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RDD,o.TNS_DATA_TYPE_ROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OSL,o.TNS_DATA_TYPE_OSL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXT_NAMED,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INT_NAMED,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EXT_REF,o.TNS_DATA_TYPE_INT_REF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INT_REF,o.TNS_DATA_TYPE_INT_REF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLOB,o.TNS_DATA_TYPE_CLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BLOB,o.TNS_DATA_TYPE_BLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BFILE,o.TNS_DATA_TYPE_BFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CFILE,o.TNS_DATA_TYPE_CFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_RSET,o.TNS_DATA_TYPE_CURSOR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_JSON,o.TNS_DATA_TYPE_JSON,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DJSON,o.TNS_DATA_TYPE_DJSON,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CLV,o.TNS_DATA_TYPE_CLV,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DTR,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DUN,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DOP,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_VST,o.TNS_DATA_TYPE_VARCHAR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ODT,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_DOL,o.TNS_DATA_TYPE_NUMBER,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_TIME,o.TNS_DATA_TYPE_TIME,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIME_TZ,o.TNS_DATA_TYPE_TIME_TZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP,o.TNS_DATA_TYPE_TIMESTAMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP_TZ,o.TNS_DATA_TYPE_TIMESTAMP_TZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INTERVAL_YM,o.TNS_DATA_TYPE_INTERVAL_YM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_INTERVAL_DS,o.TNS_DATA_TYPE_INTERVAL_DS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EDATE,o.TNS_DATA_TYPE_DATE,o.TNS_TYPE_REP_ORACLE],[o.TNS_DATA_TYPE_ETIME,o.TNS_DATA_TYPE_ETIME,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ETTZ,o.TNS_DATA_TYPE_ETTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESTAMP,o.TNS_DATA_TYPE_ESTAMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESTZ,o.TNS_DATA_TYPE_ESTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EIYM,o.TNS_DATA_TYPE_EIYM,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_EIDS,o.TNS_DATA_TYPE_EIDS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DCLOB,o.TNS_DATA_TYPE_CLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DBLOB,o.TNS_DATA_TYPE_BLOB,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_DBFILE,o.TNS_DATA_TYPE_BFILE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UROWID,o.TNS_DATA_TYPE_UROWID,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_ESITZ,o.TNS_DATA_TYPE_TIMESTAMP_LTZ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB8,o.TNS_DATA_TYPE_UB8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_PNTY,o.TNS_DATA_TYPE_INT_NAMED,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_BOOLEAN,o.TNS_DATA_TYPE_BOOLEAN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNSOP,o.TNS_DATA_TYPE_XSNSOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSATTR,o.TNS_DATA_TYPE_XSATTR,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNS,o.TNS_DATA_TYPE_XSNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UB1ARRAY,o.TNS_DATA_TYPE_UB1ARRAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SESSSTATE,o.TNS_DATA_TYPE_SESSSTATE,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AC_REPLAY,o.TNS_DATA_TYPE_AC_REPLAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AC_CONT,o.TNS_DATA_TYPE_AC_CONT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_IMPLRES,o.TNS_DATA_TYPE_IMPLRES,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER19,o.TNS_DATA_TYPE_OER19,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TXT,o.TNS_DATA_TYPE_TXT,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSESSNS,o.TNS_DATA_TYPE_XSSESSNS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSATTOP,o.TNS_DATA_TYPE_XSATTOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSCREOP,o.TNS_DATA_TYPE_XSCREOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSDETOP,o.TNS_DATA_TYPE_XSDETOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSDESOP,o.TNS_DATA_TYPE_XSDESOP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSETSP,o.TNS_DATA_TYPE_XSSETSP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSIDP,o.TNS_DATA_TYPE_XSSIDP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSPRIN,o.TNS_DATA_TYPE_XSPRIN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSKVL,o.TNS_DATA_TYPE_XSKVL,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSSSDEF2,o.TNS_DATA_TYPE_XSSSDEF2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNSOP2,o.TNS_DATA_TYPE_XSNSOP2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_XSNS2,o.TNS_DATA_TYPE_XSNS2,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNREQ,o.TNS_DATA_TYPE_KPDNREQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRNF,o.TNS_DATA_TYPE_KPDNRNF,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNGNC,o.TNS_DATA_TYPE_KPNGNC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPNRI,o.TNS_DATA_TYPE_KPNRI,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQENQ,o.TNS_DATA_TYPE_AQENQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQDEQ,o.TNS_DATA_TYPE_AQDEQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_AQJMS,o.TNS_DATA_TYPE_AQJMS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRPAY,o.TNS_DATA_TYPE_KPDNRPAY,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRACK,o.TNS_DATA_TYPE_KPDNRACK,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRMP,o.TNS_DATA_TYPE_KPDNRMP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_KPDNRDQ,o.TNS_DATA_TYPE_KPDNRDQ,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN,o.TNS_DATA_TYPE_SCN,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_SCN8,o.TNS_DATA_TYPE_SCN8,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_CHUNKINFO,o.TNS_DATA_TYPE_CHUNKINFO,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UD21,o.TNS_DATA_TYPE_UD21,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_UDS,o.TNS_DATA_TYPE_UDS,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_TNP,o.TNS_DATA_TYPE_TNP,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OER,o.TNS_DATA_TYPE_OER,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_OAC,o.TNS_DATA_TYPE_OAC,o.TNS_TYPE_REP_UNIVERSAL],[o.TNS_DATA_TYPE_VECTOR,o.TNS_DATA_TYPE_VECTOR,o.TNS_TYPE_REP_UNIVERSAL]];Ed.exports=aT});var Nd=P((Y0,hd)=>{"use strict";var TC=Ct(),lC=we(),TT=class TT extends TC{constructor(e){super(e),this.functionCode=lC.TNS_FUNC_LOGOFF}encode(e){this.writePiggybacks(e),this.writeFunctionHeader(e)}};c(TT,"LogOffMessage");var cT=TT;hd.exports=cT});var Ad=P((V0,Sd)=>{"use strict";var EC=Ct(),uC=we(),ET=class ET extends EC{constructor(e){super(e),this.functionCode=uC.TNS_FUNC_PING}encode(e){this.writeFunctionHeader(e)}};c(ET,"PingMessage");var lT=ET;Sd.exports=lT});var pd=P((x0,dd)=>{"use strict";var uT=we(),hC=Ct(),NT=class NT extends hC{encode(e){e.writeUInt8(uT.TNS_MSG_TYPE_PROTOCOL),e.writeUInt8(6),e.writeUInt8(0),e.writeStr("node-oracledb"),e.writeUInt8(0)}processMessage(e,t){t===uT.TNS_MSG_TYPE_PROTOCOL?(this.processProtocolInfo(e),this.endOfResponse=!this.connection.nscon.endOfRequestSupport):super.processMessage(e,t)}processProtocolInfo(e){this.serverVersion=e.readUInt8(),e.skipUB1(),this.serverBanner=e.readNullTerminatedBytes(48),e.caps.charSetID=e.readUInt16LE(),this.serverFlags=e.readUInt8();let t=e.readUInt16LE();t>0&&e.skipBytes(t*5);let s=e.readUInt16BE(),r=e.readBytes(s),n=6+r[5]+r[6];e.caps.nCharsetId=(r[n+3]<<8)+r[n+4];let a=e.readBytesWithLength();a&&(this.serverCompileCaps=Buffer.from(a),e.caps.adjustForServerCompileCaps(this.serverCompileCaps,this.connection.nscon),e.caps.ttcFieldVersion>=uT.TNS_CCAP_FIELD_VERSION_23_1?this.connection._osonMaxFieldNameSize=65535:this.connection._osonMaxFieldNameSize=255);let _=e.readBytesWithLength();_&&(this.serverRunTimeCaps=Buffer.from(_),e.caps.adjustForServerRuntimeCaps(this.serverRunTimeCaps))}};c(NT,"ProtocolMessage");var hT=NT;dd.exports=hT});var md=P((k0,fd)=>{"use strict";var NC=Ct(),SC=we(),AT=class AT extends NC{constructor(e){super(e),this.functionCode=SC.TNS_FUNC_ROLLBACK}encode(e){this.writeFunctionHeader(e)}};c(AT,"RollbackMessage");var ST=AT;fd.exports=ST});var Id=P((G0,Rd)=>{"use strict";var AC=Ct(),Pd=we(),pT=class pT extends AC{constructor(e){super(e),this.functionCode=Pd.TNS_FUNC_SESSION_RELEASE,this.messageType=Pd.TNS_MSG_TYPE_ONEWAY_FN,this.sessReleaseMode=0}encode(e){this.writeFunctionHeader(e),e.writeUInt8(0),e.writeUInt8(0),e.writeUB4(this.sessReleaseMode)}decode(){}};c(pT,"SessionReleaseMessage");var dT=pT;Rd.exports=dT});var Cd=P((v0,Dd)=>{"use strict";var vs=we(),dC=Ct(),mT=class mT extends dC{encode(e){e.writeUInt8(vs.TNS_MSG_TYPE_FAST_AUTH),e.writeUInt8(1),e.writeUInt8(vs.TNS_SERVER_CONVERTS_CHARS),e.writeUInt8(0),this.protocolMessage.encode(e),e.writeUInt16BE(0),e.writeUInt8(0),e.writeUInt16BE(0),e.caps.ttcFieldVersion=vs.TNS_CCAP_FIELD_VERSION_19_1_EXT_1,e.writeUInt8(e.caps.ttcFieldVersion),this.dataTypeMessage.encode(e),this.authMessage.encode(e),e.caps.ttcFieldVersion=vs.TNS_CCAP_FIELD_VERSION_MAX}processMessage(e,t){t===vs.TNS_MSG_TYPE_RENEGOTIATE?this.reNegotiate=!0:t===vs.TNS_MSG_TYPE_PROTOCOL?this.protocolMessage.processMessage(e,t):t===vs.TNS_MSG_TYPE_DATA_TYPES?this.dataTypeMessage.processMessage(e,t):(this.authMessage.processMessage(e,t),this.endOfResponse=this.authMessage.endOfResponse)}};c(mT,"FastAuthMessage");var fT=mT;Dd.exports=fT});var gd=P((W0,Od)=>{"use strict";var pC=Ct(),fC=we(),RT=class RT extends pC{constructor(e){super(e),this.functionCode=fC.TNS_FUNC_TPC_TXN_CHANGE_STATE}processReturnParameter(e){this.state=e.readUB4()}encode(e){let t;this.xid&&(t=Buffer.alloc(128),this.xid.globalTransactionId.copy(t),this.xid.branchQualifier.copy(t,this.xid.globalTransactionId.length)),this.writeFunctionHeader(e),e.writeUB4(this.operation),this.context?(e.writeUInt8(1),e.writeUB4(this.context.length)):(e.writeUInt8(0),e.writeUB4(0)),this.xid?(e.writeUB4(this.xid.formatId),e.writeUB4(this.xid.globalTransactionId.length),e.writeUB4(this.xid.branchQualifier.length),e.writeUInt8(1),e.writeUB4(t.length)):(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(0),e.writeUB4(this.state),e.writeUInt8(1),e.writeUB4(this.flags),this.context&&e.writeBytes(this.context),this.xid&&e.writeBytes(t)}};c(RT,"TransactionChangeStateMessage");var PT=RT;Od.exports=PT});var Ld=P((z0,yd)=>{"use strict";var mC=Ct(),PC=we(),DT=class DT extends mC{constructor(e){super(e),this.functionCode=PC.TNS_FUNC_TPC_TXN_SWITCH,this.applicationValue=0,this.internalName=e.internalName,this.internalName&&(this.internalName=Buffer.from(this.internalName)),this.externalName=e.externalName,this.externalName&&(this.externalName=Buffer.from(this.externalName))}processReturnParameter(e){this.applicationValue=e.readUB4(),this.contextLen=e.readUB2(),this.contextLen>0&&(this.context=Buffer.from(e.readBytes(this.contextLen)))}encode(e){let t;this.xid&&(t=Buffer.alloc(128),this.xid.globalTransactionId.copy(t),this.xid.branchQualifier.copy(t,this.xid.globalTransactionId.length)),this.writeFunctionHeader(e),e.writeUB4(this.operation),this.context?(e.writeUInt8(1),e.writeUB4(this.context.length)):(e.writeUInt8(0),e.writeUB4(0)),this.xid?(e.writeUB4(this.xid.formatId),e.writeUB4(this.xid.globalTransactionId.length),e.writeUB4(this.xid.branchQualifier.length),e.writeUInt8(1),e.writeUB4(t.length)):(e.writeUB4(0),e.writeUB4(0),e.writeUB4(0),e.writeUInt8(0),e.writeUB4(0)),e.writeUB4(this.flags),e.writeUB4(this.timeout),e.writeUInt8(1),e.writeUInt8(1),e.writeUInt8(1),this.internalName?(e.writeUInt8(1),e.writeUB4(this.internalName.length)):(e.writeUInt8(0),e.writeUB4(0)),this.externalName?(e.writeUInt8(1),e.writeUB4(this.externalName.length)):(e.writeUInt8(0),e.writeUB4(0)),this.context&&e.writeBytes(this.context),this.xid&&e.writeBytes(t),e.writeUB4(this.applicationValue),this.internalName&&e.writeBytes(this.internalName),this.externalName&&e.writeBytes(this.externalName)}};c(DT,"TransactionSwitchMessage");var IT=DT;yd.exports=IT});var wd=P((j0,Bd)=>{"use strict";var RC=cd(),IC=ld(),DC=ud(),CC=M_(),OC=x_(),gC=I_(),yC=Nd(),LC=Ad(),BC=pd(),wC=md(),UC=Id(),YC=Cd(),MC=gd(),VC=Ld();Bd.exports={AuthMessage:RC,CommitMessage:IC,FastAuthMessage:YC,DataTypeMessage:DC,ExecuteMessage:CC,FetchMessage:OC,LobOpMessage:gC,LogOffMessage:yC,PingMessage:LC,ProtocolMessage:BC,RollbackMessage:wC,SessionReleaseMessage:UC,TransactionChangeStateMessage:MC,TransactionSwitchMessage:VC}});var Md=P((J0,Yd)=>{var Ud=W(),{Statement:FC}=Jc(),OT=class OT{constructor(e){this._cachedStatements=new Map,this._maxSize=e,this._cursorsToClose=new Set,this._openCursors=new Set}_addCursorToClose(e){if(this._cursorsToClose.has(e.cursorId)){let t=`attempt to close cursor ${e.cursorId} twice`;Ud.throwErr(Ud.ERR_INTERNAL,t)}e.cursorId!=0&&this._cursorsToClose.add(e.cursorId),this._openCursors.delete(e)}_adjustCache(){for(;this._cachedStatements.size>this._maxSize;){let e=this._cachedStatements.keys().next().value,t=this._cachedStatements.get(e);this._cachedStatements.delete(e),t.inUse?t.returnToCache=!1:t.cursorId!==0&&this._addCursorToClose(t)}}clearCursors(){let e=new Set;for(let t of this._openCursors)(t.inUse||t.returnToCache)&&(t.pendingClear=!0,e.add(t)),t._clearState();this._openCursors=e,this._cursorsToClose.clear()}clearPendingStatus(){for(let e of this._openCursors)e.pendingClear&&!e.inUse&&(e._clearAllState(),e.pendingClear=!1)}getStatement(e,t=!1,s=!1){let r=null;return e&&(r=this._cachedStatements.get(e)),r?s||r.inUse?(t||(this._addCursorToClose(r),this._cachedStatements.delete(e)),r=r._copy(),this._openCursors.add(r)):t?(this._cachedStatements.delete(e),this._cachedStatements.set(e,r)):(this._cachedStatements.delete(e),r.returnToCache=!1):(r=new FC,e&&r._prepare(e),t&&!r.isDdl&&this._maxSize>0&&(r.returnToCache=!0,this._cachedStatements.set(e,r),this._adjustCache()),this._openCursors.add(r)),this._openCursors.add(r),r.inUse=!0,r}clearCursor(e){this._addCursorToClose(e),e.cursorId=0}returnStatement(e){e.bindInfoList&&e.bindInfoList.forEach(t=>{t.bindVar=null}),e.queryVars&&e.queryVars.forEach(t=>{t.values.fill(null)}),e.returnToCache?e.inUse=!1:this._addCursorToClose(e),this.clearPendingStatus()}writeCursorsToClose(e){e.writeUB4(this._cursorsToClose.size);for(let t of this._cursorsToClose.keys())e.writeUB4(t);this._cursorsToClose.clear()}};c(OT,"StatementCache");var CT=OT;Yd.exports=CT});var UT=P((Z0,xd)=>{"use strict";var{Buffer:Vd}=require("buffer"),xC=Li(),bC=q_(),gT=Gr(),kC=dA(),{BaseBuffer:qC}=nr(),{NetworkSession:GC}=Kc(),{Statement:HC}=Jc(),dn=Wr(),Ir=pr(),X=we(),Fd=require("process"),se=lt(),Ke=W(),at=wd(),vC=Md(),KC=new global.FinalizationRegistry(i=>{i.disconnect()}),BT=class BT extends qC{};c(BT,"TDSBuffer");var yT=BT,wT=class wT extends xC{async close(){try{if(this._protocol.txnInProgress){if(this.tpcContext){let e=this.createTpcRollbackMessage();await this._protocol._processMessage(e)}else await this.rollback();this.tpcContext=null}if(this._drcpEnabled&&(await this._sessRelease(),this._drcpEstablishSession=!0),this._pool&&!this._dropSess)await this._pool.release(this);else{if(!this._drcpEnabled){let e=new at.LogOffMessage(this);await this._protocol._processMessage(e)}this.nscon.disconnect()}}catch{this.nscon.disconnect(Ir.NSFIMM)}}async _sessRelease(){let e=new at.SessionReleaseMessage(this);this.isPooled()||(e.sessReleaseMode=X.DRCP_DEAUTHENTICATE),await this._protocol._processMessage(e)}async _getElementTypeObj(e){let t=[{name:"owner",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.schema]},{name:"name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.name]},{name:"package_name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_IN,maxSize:128,values:[e.packageName]}],s;e.packageName?s=`
        select
            elem_type_owner,
            elem_type_name,
            elem_type_package
        from all_plsql_coll_types
        where owner = :owner
          and type_name = :name
          and package_name = :package_name`:(t.pop(),s=`
        select
            elem_type_owner,
            elem_type_name
        from all_coll_types
        where owner = :owner
          and type_name = :name`);let r={connection:{_impl:this},prefetchRows:2},n=await this.execute(s,1,t,r,!1),a=await n.resultSet.getRows(1,r);await n.resultSet.close();let _=a[0];e.elementTypeClass=this._getDbObjectType(_[0],_[1],_[2]),e.elementTypeClass.partial&&this._partialDbObjectTypes.push(e.elementTypeClass)}async _execute(e,t,s,r,n){let a=e.bindInfoList.length,_=s.length;a!==_&&(_===0||!s[0].name)&&Ke.throwErr(Ke.ERR_WRONG_NUMBER_OF_POSITIONAL_BINDS,a,_);for(let E=0;E<s.length;E++)await this._bind(e,s[E],E+1);e.isPlSql&&(r.batchErrors||r.dmlRowCounts)&&Ke.throwErr(Ke.ERR_EXEC_MODE_ONLY_FOR_DML);let T=new at.ExecuteMessage(this,e,r);T.numExecs=t,T.arrayDmlRowCounts=r.dmlRowCounts,T.batchErrors=r.batchErrors,e.isPlSql&&(e.cursorId===0||e.requiresFullExecute)&&(T.numExecs=1,T.noImplicitRelease=!0,await this._protocol._processMessage(T),e.requiresFullExecute=!1,T.numExecs=t-1,T.offset=1,T.noImplicitRelease=!1),T.numExecs>0&&(await this._protocol._processMessage(T),e.requiresFullExecute=!1),e.requiresDefine&&e.sql&&(e.requiresFullExecute=!0,await this._protocol._processMessage(T),e.requiresFullExecute=!1,e.requiresDefine=!1);let l={};if(T.warning&&(l.warning=T.warning),e.numQueryVars>0)l.resultSet=T.resultSet;else{e.bufferRowIndex=0;let E=dn.getOutBinds(e,t,n);E&&(l.outBinds=E),n?(e.isPlSql||(l.rowsAffected=e.rowCount,delete e.rowCount),r.dmlRowCounts&&(l.dmlRowCounts=r.dmlRowCounts),r.batchErrors&&(l.batchErrors=r.batchErrors)):(e.isPlSql&&r.implicitResultSet&&(l.implicitResults=r.implicitResultSet),e.lastRowid&&(l.lastRowid=e.lastRowid,delete e.lastRowid),e.isPlSql?e.rowCount&&(l.rowsAffected=e.rowCount):l.rowsAffected=e.rowCount||0,e.rowCount&&delete e.rowCount),this._returnStatement(e)}return l}_parseTDSAttr(e,t){let s,r,n;for(;;)if(n=e.readUInt8(),n===X.TNS_OBJ_TDS_TYPE_EMBED_ADT_INFO)e.skipBytes(1);else if(n!==X.TNS_OBJ_TDS_TYPE_SUBTYPE_MARKER)break;switch(n){case X.TNS_OBJ_TDS_TYPE_NUMBER:return t.precision=e.readInt8(),t.scale=e.readInt8(),se.DB_TYPE_NUMBER;case X.TNS_OBJ_TDS_TYPE_FLOAT:return t.precision=e.readInt8(),se.DB_TYPE_NUMBER;case X.TNS_OBJ_TDS_TYPE_VARCHAR:case X.TNS_OBJ_TDS_TYPE_CHAR:return t.maxSize=e.readUInt16BE(),s=n===X.TNS_OBJ_TDS_TYPE_VARCHAR?X.TNS_DATA_TYPE_VARCHAR:X.TNS_DATA_TYPE_CHAR,r=e.readUInt8(),r=r&127,e.skipBytes(2),se.getTypeByOraTypeNum(s,r);case X.TNS_OBJ_TDS_TYPE_RAW:return t.maxSize=e.readUInt16BE(),se.DB_TYPE_RAW;case X.TNS_OBJ_TDS_TYPE_BINARY_FLOAT:return se.DB_TYPE_BINARY_FLOAT;case X.TNS_OBJ_TDS_TYPE_BINARY_DOUBLE:return se.DB_TYPE_BINARY_DOUBLE;case X.TNS_OBJ_TDS_TYPE_DATE:return se.DB_TYPE_DATE;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP_LTZ:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP_LTZ;case X.TNS_OBJ_TDS_TYPE_TIMESTAMP_TZ:return e.skipBytes(1),se.DB_TYPE_TIMESTAMP_TZ;case X.TNS_OBJ_TDS_TYPE_BOOLEAN:return se.DB_TYPE_BOOLEAN;case X.TNS_OBJ_TDS_TYPE_CLOB:return se.DB_TYPE_CLOB;case X.TNS_OBJ_TDS_TYPE_BLOB:return se.DB_TYPE_BLOB;case X.TNS_OBJ_TDS_TYPE_OBJ:return e.skipBytes(5),se.DB_TYPE_OBJECT;case X.TNS_OBJ_TDS_TYPE_START_EMBED_ADT:for(;this._parseTDSAttr(e,{})!==0;);return se.DB_TYPE_OBJECT;case X.TNS_OBJ_TDS_TYPE_END_EMBED_ADT:return 0;default:Ke.throwErr(Ke.ERR_TDS_TYPE_NOT_SUPPORTED,n)}}async _parseTDS(e,t){let s=new yT(e);s.skipBytes(4),s.skipBytes(2),s.skipBytes(2);let r=s.readUInt16BE();if(s.skipBytes(1),s.skipBytes(1),s.skipBytes(2),s.skipBytes(4),t.isCollection=!1,r===1){let n=s.pos;s.readUInt8()===X.TNS_OBJ_TDS_TYPE_COLL?t.isCollection=!0:s.pos=n}if(t.isCollection){let n=s.readUInt32BE();t.maxNumElements=s.readUInt32BE(),t.collectionType=s.readUInt8(),t.collectionType===X.TNS_OBJ_PLSQL_INDEX_TABLE&&(t.collectionFlags=X.TNS_OBJ_HAS_INDEXES),s.pos=n,t.elementTypeInfo={},t.elementType=this._parseTDSAttr(s,t.elementTypeInfo),t.elementType===se.DB_TYPE_OBJECT&&(await this._getElementTypeObj(t),t.elementTypeClass.isXmlType&&(t.elementType=se.DB_TYPE_XMLTYPE))}else if(t.attributes)for(let n of t.attributes)this._parseTDSAttr(s,n)}async _populateDbObjectTypeInfo(e){let t=`
      declare
          t_Instantiable              varchar2(3);
          t_SuperTypeOwner            varchar2(128);
          t_SuperTypeName             varchar2(128);
          t_SubTypeRefCursor          sys_refcursor;
          t_Pos                       pls_integer;
      begin
          :ret_val := dbms_pickler.get_type_shape(:full_name, :oid,
              :version, :tds, t_Instantiable, t_SuperTypeOwner,
              t_SuperTypeName, :attrs_rc, t_SubTypeRefCursor);
          :package_name := null;
          if substr(:full_name, length(:full_name) - 7) = '%ROWTYPE' then
              t_Pos := instr(:full_name, '.');
              :schema := substr(:full_name, 1, t_Pos - 1);
              :name := substr(:full_name, t_Pos + 1);
          else
              begin
                  select owner, type_name
                  into :schema, :name
                  from all_types
                  where type_oid = :oid;
              exception
              when no_data_found then
                  begin
                      select owner, package_name, type_name
                      into :schema, :package_name, :name
                      from all_plsql_types
                      where type_oid = :oid;
                  exception
                  when no_data_found then
                      null;
                  end;
              end;
          end if;
      end;`,s=`
      SELECT
        column_name,
        data_type,
        data_type_owner,
        case
          when data_type in
            ('CHAR', 'NCHAR', 'VARCHAR2', 'NVARCHAR2', 'RAW')
          then data_length
          else 0
        end,
        nvl(data_precision, 0),
        nvl(data_scale, 0)
      from all_tab_cols
      where owner = :owner
        and table_name = :name
        and hidden_column != 'YES'
      order by column_id`,r=[{name:"full_name",type:se.DB_TYPE_VARCHAR,dir:X.BIND_INOUT,maxSize:500,values:[e]},{name:"ret_val",type:se.DB_TYPE_BINARY_INTEGER,dir:X.BIND_OUT,values:[]},{name:"oid",type:se.DB_TYPE_RAW,maxSize:16,dir:X.BIND_OUT,values:[]},{name:"version",type:se.DB_TYPE_BINARY_INTEGER,dir:X.BIND_OUT,values:[]},{name:"tds",type:se.DB_TYPE_RAW,maxSize:2e3,dir:X.BIND_OUT,values:[]},{name:"attrs_rc",type:se.DB_TYPE_CURSOR,dir:X.BIND_OUT,values:[]},{name:"package_name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]},{name:"schema",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]},{name:"name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_OUT,values:[]}],n={connection:{_impl:this},nullifyInvalidCursor:!0},a=await this.execute(t,1,r,n,!1);a.outBinds.ret_val!==0&&Ke.throwErr(Ke.ERR_INVALID_OBJECT_TYPE_NAME,e);let _=this._getDbObjectType(a.outBinds.schema,a.outBinds.name,a.outBinds.package_name,a.outBinds.oid);if(!_.partial)return _;if(_.name.endsWith("%ROWTYPE")){let T=[{name:"owner",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_IN,values:[a.outBinds.schema]},{name:"name",type:se.DB_TYPE_VARCHAR,maxSize:128,dir:X.BIND_IN,values:[_.name.substring(0,_.name.length-8)]}],E=await(await this.execute(s,1,T,n,!1)).resultSet._getAllRows();_.attributes=[];for(let h of E){let p={name:h[0],dataType:h[1],dataTypeOwner:h[2],maxSize:h[3],dataPrecision:h[4],dataScale:h[5]};if(!p.dataTypeOwner){let A=h[1].indexOf("("),u=h[1].indexOf(")");u>A&&(p.dataType=p.dataType.substring(0,A)+p.dataType.substring(u+1,p.dataType.length))}this._addAttr(_.attributes,p)}}else{_.version=a.outBinds.version;let T=await a.outBinds.attrs_rc._getAllRows();if(T.length>0){_.attributes=[];for(let l of T){let E={name:l[1],dataType:l[3],dataTypeOwner:l[4],packageName:l[5],oid:l[6]};this._addAttr(_.attributes,E)}}await this._parseTDS(a.outBinds.tds,_)}return _.partial=!1,_}_addAttr(e,t){let s={name:t.name};t.dataTypeOwner?(s.type=se.DB_TYPE_OBJECT,s.typeClass=this._getDbObjectType(t.dataTypeOwner,t.dataType,t.packageName,t.oid),s.typeClass.isXmlType&&(s.type=se.DB_TYPE_XMLTYPE),s.typeClass.partial&&this._partialDbObjectTypes.push(s.typeClass)):(s.type=se.getTypeByColumnTypeName(t.dataType),s.maxSize=t.maxSize,s.precision=t.dataPrecision,s.scale=t.dataScale),e.push(s)}async _populatePartialDbObjectTypes(){for(;this._partialDbObjectTypes.length>0;){let e=this._partialDbObjectTypes.pop(),t="%ROWTYPE",s=e.name;s.endsWith(t)?s=s.substring(0,s.length-t.length):t="";let r;e.packageName?r=`"${e.schema}"."${e.packageName}"."${s}"${t}`:r=`"${e.schema}"."${s}"${t}`,await this._populateDbObjectTypeInfo(r)}}async commit(){let e=new at.CommitMessage(this);await this._protocol._processMessage(e)}async breakExecution(){await this._protocol.breakMessage()}isHealthy(){try{return this.nscon.recvInbandNotif()===0}catch{return!1}}isPooled(){return!!this._pool}async connect(e){e.connectString||Ke.throwErr(Ke.ERR_EMPTY_CONNECT_STRING),dn.checkCredentials(e),this.sessionID=0,this.serialNum=0,this.autoCommit=!1,this.serverVersion="",this.statementCache=null,this.currentSchema="",this.invokeSessionCallback=!0,this.statementCacheSize=e.stmtCacheSize,this._currentSchemaModified=!1,this._tempLobsToClose=[],this._tempLobsTotalSize=0,this._drcpEstablishSession=!1,this._cclass=null,this._clientIdentifier="",this._clientIdentifierModified=!1,this._action="",this._actionModified=!1,this._dbOp="",this._dbOpModified=!1,this._clientInfo="",this._clientInfoModified=!1,this._module="",this._moduleModified=!1,this._drcpEnabled=!1,this.serviceName="",this.remoteAddress="",this.comboKey=null,this.tpcContext=null,this.nscon=new GC,KC.register(this,this.nscon),await this.nscon.connect(e);let t;this.isPooled()?(t=e._connInfo[0],this.serviceName=e._connInfo[2],this.purity=e._connInfo[3]|X.PURITY_DEFAULT,this.sid=e._connInfo[4]):(t=this.nscon.getOption(Ir.SERVERTYPE),this.serviceName=this.nscon.getOption(Ir.SVCNAME),this.sid=this.nscon.getOption(Ir.SID),this.purity=this.nscon.getOption(Ir.PURITY)|X.PURITY_DEFAULT),t&&(this._drcpEnabled=t.toLowerCase()==="pooled"),this.remoteAddress=this.nscon.getOption(Ir.REMOTEADDR),this.connectionClass=e.connectionClass,this.purity===X.PURITY_DEFAULT&&this._drcpEnabled&&(this.isPooled()?this.purity=X.PURITY_SELF:this.purity=X.PURITY_NEW),this._protocol=new kC(this),this._protocol.caps.protocolVersion<X.TNS_VERSION_MIN_ACCEPTED&&Ke.throwErr(Ke.ERR_SERVER_VERSION_NOT_SUPPORTED);try{let s=new at.ProtocolMessage(this),r=new at.DataTypeMessage(this),n=new at.AuthMessage(this,e);if(this.nscon.supportsFastAuth){let a=new at.FastAuthMessage(this);a.protocolMessage=s,a.dataTypeMessage=r,a.authMessage=n,await this._protocol._processMessage(a),a.reNegotiate&&(await this._protocol._processMessage(r),await this._protocol._processMessage(n))}else await this._protocol._processMessage(s),await this._protocol._processMessage(r),await this._protocol._processMessage(n);e.token||await this._protocol._processMessage(n)}catch(s){throw this.nscon.disconnect(),s}this.statementCache=new vC(this.statementCacheSize),this._partialDbObjectTypes=[],e.debugJDWP?this.jdwpData=Vd.from(e.debugJDWP):Fd.env.ORA_DEBUG_JDWP&&(this.jdwpData=Vd.from(Fd.env.ORA_DEBUG_JDWP)),this._protocol.connInProgress=!1}_returnStatement(e){this.statementCache.returnStatement(e)}_prepare(e,t){let s=this._getStatement(e,t.keepInStmtCache);return s.bufferRowIndex=0,s.bufferRowCount=0,s.lastRowIndex=0,s.moreRowsToFetch=!0,s}async _bind(e,t,s=0){let r=e.bindInfoDict,n=e.bindInfoList;if(e.isPlSql&&t.maxSize>32767){t.type===se.DB_TYPE_RAW||t.type===se.DB_TYPE_LONG_RAW?t.type=se.DB_TYPE_BLOB:t.type._csfrm===X.CSFRM_NCHAR?t.type=se.DB_TYPE_NCLOB:t.type=se.DB_TYPE_CLOB;let a=t.maxSize;delete t.maxSize,t.outConverter=async function(_){if(_===null)return null;let T=await _.getData(),l=_._length;return T&&l>a&&Ke.throwErr(Ke.ERR_INSUFFICIENT_BUFFER_FOR_BINDS),T}}if(t.type===se.DB_TYPE_CLOB||t.type===se.DB_TYPE_NCLOB||t.type===se.DB_TYPE_BLOB){for(let[a,_]of t.values.entries())if(!(_ instanceof gT))if(_&&_.length>0){let T=new gT;await T.create(this,t.type),await T.write(1,_),t.values[a]=T}else t.values[a]=null}if(t.name){let a;t.name.startsWith('"')&&t.name.endsWith('"')?a=t.name.substring(1,t.name.length-1):a=t.name.toUpperCase(),a.startsWith(":")&&(a=t.name.substring(1)),r.has(a)||Ke.throwErr(Ke.ERR_INVALID_BIND_NAME,a),r.get(a).forEach(_=>{e._setVariable(_,t)})}else{let a=n[s-1];e._setVariable(a,t)}}_createResultSet(e,t){let s=new bC;if(t||(t=new HC),s._resultSetNew(this,t,e),t.queryVars.length>0){let r=dn.getMetadataMany(t.queryVars);s._setup(e,r)}return s}async getDbObjectClass(e){let t=await this._populateDbObjectTypeInfo(e);return await this._populatePartialDbObjectTypes(),t}async getStatementInfo(e){let t={},s={},r=this._prepare(e,t);t.connection=this;try{if(!r.isDdl){let n=new at.ExecuteMessage(this,r,t);n.parseOnly=!0,await this._protocol._processMessage(n)}return r.numQueryVars>0&&(s.metaData=dn.getMetadataMany(r.queryVars)),s.bindNames=Array.from(r.bindInfoDict.keys()),s.statementType=r.statementType,s}finally{this._returnStatement(r)}}async execute(e,t,s,r,n){let a=this._prepare(e,r);try{return await this._execute(a,t,s,r,n)}catch(_){throw this._returnStatement(a),_}}_getStatement(e,t=!1){return this.statementCache.getStatement(e,t,this._drcpEstablishSession)}async ping(){let e=new at.PingMessage(this);await this._protocol._processMessage(e)}async rollback(){let e=new at.RollbackMessage(this);await this._protocol._processMessage(e)}getOracleServerVersion(){return this.serverVersion}getOracleServerVersionString(){return this.serverVersionString}setCurrentSchema(e){this._currentSchemaModified=!0,this.currentSchema=e}getCurrentSchema(){return this.currentSchema}setClientId(e){this._clientIdentifierModified=!0,this._clientIdentifier=e}setDbOp(e){this._dbOpModified=!0,this._dbOp=e}setExternalName(e){this.externalName=e}setInternalName(e){this.internalName=e}setClientInfo(e){this._clientInfoModified=!0,this._clientInfo=e}setModule(e){this._moduleModified=!0,this._module=e,this._actionModified=!0}setAction(e){this._actionModified=!0,this._action=e}async changePassword(e,t,s){let r={user:e,newPassword:s,password:t,changePassword:!0},n=new at.AuthMessage(this,r);await this._protocol._processMessage(n)}async createLob(e){let t=new gT;return await t.create(this,e),t}checkTpcCommitState(e,t){(t&&e!==X.TNS_TPC_TXN_STATE_READ_ONLY&&e!==X.TNS_TPC_TXN_STATE_COMMITTED||!t&&e!==X.TNS_TPC_TXN_STATE_FORGOTTEN)&&Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,e)}createTpcCommitMessage(e,t){let s=new at.TransactionChangeStateMessage(this);return s.operation=X.TNS_TPC_TXN_COMMIT,s.state=t==0?X.TNS_TPC_TXN_STATE_COMMITTED:X.TNS_TPC_TXN_STATE_READ_ONLY,s.xid=e,s.context=this.tpcContext,s}createTpcRollbackMessage(e=null){let t=new at.TransactionChangeStateMessage(this);return t.operation=X.TNS_TPC_TXN_ABORT,t.state=X.TNS_TPC_TXN_STATE_ABORTED,t.xid=e,t.context=this.tpcContext,t}async tpcBegin(e,t,s){let r=new at.TransactionSwitchMessage(this);r.operation=X.TNS_TPC_TXN_START,r.xid=e,r.flags=t,r.timeout=s,await this._protocol._processMessage(r),this.tpcContext=r.context}async tpcCommit(e,t){let s=this.createTpcCommitMessage(e,t);await this._protocol._processMessage(s),this.checkTpcCommitState(s.state,t)}async tpcEnd(e,t){let s=new at.TransactionSwitchMessage(this);s.operation=X.TNS_TPC_TXN_DETACH,s.xid=e,s.context=this.tpcContext,s.flags=t,await this._protocol._processMessage(s),this.tpcContext=null}async tpcPrepare(e){let t=new at.TransactionChangeStateMessage(this);if(t.operation=X.TNS_TPC_TXN_PREPARE,t.xid=e,t.context=this.tpcContext,await this._protocol._processMessage(t),t.state===X.TNS_TPC_TXN_STATE_REQUIRES_COMMIT)return!0;if(t.state===X.TNS_TPC_TXN_STATE_READ_ONLY)return!1;Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,t.state)}async tpcRollback(e){let t=this.createTpcRollbackMessage(e);await this._protocol._processMessage(t),t.state!==X.TNS_TPC_TXN_STATE_ABORTED&&Ke.throwErr(Ke.ERR_UNKNOWN_TRANSACTION_STATE,t.state)}getStmtCacheSize(){return this.statementCache._maxSize}setCallTimeout(e){this._protocol.callTimeout=e}getCallTimeout(){return this._protocol.callTimeout}getTag(){return""}getExternalName(){return this.externalName}getInstanceName(){return this.instanceName}getInternalName(){return this.internalName}getDbDomain(){return this.dbDomain}getDbName(){return this.dbName}getMaxOpenCursors(){return this.maxOpenCursors}getServiceName(){return this.serviceName}getTransactionInProgress(){return this._protocol.txnInProgress}getWarning(){return this.warning}};c(wT,"ThinConnectionImpl");var LT=wT;xd.exports=LT});var kd=P((tU,bd)=>{"use strict";var WC=ea(),XC=UT(),mt=kr(),Bs=W(),zC=Vt(),YT=et(),$C=Wr(),{getConnectionInfo:jC}=Kc(),JC=require("crypto"),QC=require("events"),ZC=require("timers"),VT=class VT extends WC{_init(e){if(e.homogeneous||Bs.throwErr(Bs.ERR_NOT_IMPLEMENTED,"Heterogeneous Pooling"),$C.checkCredentials(e),this._availableObjects=[],this._name="node-thin",this._poolMin=e.poolMin,this._poolMax=e.poolMax,this._poolIncrement=e.poolIncrement,this._poolTimeout=e.poolTimeout,this._poolPingInterval=e.poolPingInterval,this._poolPingTimeout=e.poolPingTimeout,this._stmtCacheSize=e.stmtCacheSize,this._userConfig=e,this._freeConnectionList=[],this._usedConnectionList=new Set,this._password=e.password,this._walletPassword=e.walletPassword,this._walletContent=e.walletContent,this._obfuscatedPassword=[],this._obfuscatedWalletPassword=[],this._token=e.token,this._obfuscatedToken=[],this._privateKey=e.privateKey,this._obfuscatedPrivateKey=[],this._schedulerJob=null,this._poolCloseWaiter=null,this._pendingRequests=[],this._password!==void 0){let t=mt.setObfuscatedValue(this._password);this._password=t.value,this._obfuscatedPassword=t.obfuscatedValue,this._userConfig.password=null}if(this._walletPassword!==void 0){let t=mt.setObfuscatedValue(this._walletPassword);this._walletPassword=t.value,this._obfuscatedWalletPassword=t.obfuscatedValue,this._userConfig.walletPassword=null}if(this._walletContent!==void 0){let t=mt.setObfuscatedValue(this._walletContent);this._walletContent=t.value,this._obfuscatedWalletContent=t.obfuscatedValue,this._userConfig.walletConent=null}if(this._token!==void 0){let t=mt.setObfuscatedValue(this._token);this._token=t.value,this._obfuscatedToken=t.obfuscatedValue,this._userConfig.token=null}if(this._privateKey!==void 0){let t=mt.setObfuscatedValue(this._privateKey);this._privateKey=t.value,this._obfuscatedPrivateKey=t.obfuscatedValue,this._userConfig.privateKey=null}this._accessTokenFn=e.accessTokenFn,this._accessTokenConfig=e.accessTokenConfig,this._isDRCPEnabled=!1,this._implicitPool=null,this.eventEmitter=new QC,this.eventEmitter.on("_removePoolConnection",async t=>{await this._destroy(t)})}async create(e){this._init(e),this._userConfig._connInfo=await jC(e),this._isDRCPEnabled=String(this._userConfig._connInfo[0]).toLowerCase()==="pooled",this._isDRCPEnabled&&zC.connectionClass===""&&this._generateConnectionClass(),this.bgThreadFunc()}setAccessToken(e){if(e.token){this._token=e.token;let t=mt.setObfuscatedValue(this._token);this._token=t.value,this._obfuscatedToken=t.obfuscatedValue}if(e.privateKey){this._privateKey=e.privateKey;let t=mt.setObfuscatedValue(this._privateKey);this._privateKey=t.value,this._obfuscatedPrivateKey=t.obfuscatedValue}}async _getConnAttrs(){let e,t=Object.assign({},this._userConfig);if(t.password===null&&(t.password=mt.getDeobfuscatedValue(this._password,this._obfuscatedPassword)),t.walletPassword===null&&(t.walletPassword=mt.getDeobfuscatedValue(this._walletPassword,this._obfuscatedWalletPassword)),t.walletContent===null&&(t.walletContent=mt.getDeobfuscatedValue(this._walletContent,this._obfuscatedWalletContent)),t.token===null&&(t.token=mt.getDeobfuscatedValue(this._token,this._obfuscatedToken),YT.isTokenExpired(t.token)))if(typeof this._accessTokenFn=="function"){if(e=await this._accessTokenFn(!0,this._accessTokenConfig),typeof e=="string")if(t.token=e,YT.isTokenExpired(t.token))Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);else{let s=mt.setObfuscatedValue(t.token);this._token=s.value,this._obfuscatedToken=s.obfuscatedValue}else if(typeof e=="object")if(t.token=e.token,t.privateKey=e.privateKey,YT.isTokenExpired(t.token))Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);else{let s=mt.setObfuscatedValue(t.token);this._token=s.value,this._obfuscatedToken=s.obfuscatedValue;let r=mt.setObfuscatedValue(t.privateKey);this._privateKey=r.value,this._obfuscatedPrivateKey=r.obfuscatedValue}}else Bs.throwErr(Bs.ERR_TOKEN_HAS_EXPIRED);return t.privateKey===null&&(t.privateKey=mt.getDeobfuscatedValue(this._privateKey,this._obfuscatedPrivateKey)),t}async getConnection(){return await this.acquire()}async _destroy(e){e.nscon.ntAdapter.connected&&(e._dropSess=!0,await e.close())}async close(){await new Promise(e=>{this._poolCloseWaiter=e,this.bgWaiter&&this.bgWaiter()}),this._schedulerJob&&(clearTimeout(this._schedulerJob),this._schedulerJob=null);for(let e of this._freeConnectionList)await this._destroy(e);for(let e of this._usedConnectionList)await this._destroy(e);this.eventEmitter.removeAllListeners()}getPoolMax(){return this._poolMax}getPoolMin(){return this._poolMin}getConnectionsInUse(){return this._usedConnectionList.size}getConnectionsOpen(){return this._freeConnectionList.length+this._usedConnectionList.size}getPoolIncrement(){return this._poolIncrement}getPoolMaxPerShard(){}getPoolPingInterval(){return this._poolPingInterval}getPoolPingTimeout(){return this._poolPingTimeout}getPoolTimeout(){return this._poolTimeout}getSodaMetaDataCache(){}getStmtCacheSize(){return this._stmtCacheSize}_setScheduler(){!this._schedulerJob&&this._poolTimeout>0&&this._freeConnectionList.length>0&&this._freeConnectionList.length+this._usedConnectionList.size>this._poolMin&&(this._schedulerJob=setTimeout(()=>{this._scanIdleConnection()},this._poolTimeout*1e3))}_scanIdleConnection(){for(;this._usedConnectionList.size+this._freeConnectionList.length>this._poolMin&&this._freeConnectionList.length>0;){let e=this._freeConnectionList[0];if(Date.now()-e._lastTimeUsed<this._poolTimeout*1e3)break;this.eventEmitter.emit("_removePoolConnection",e),this._freeConnectionList.shift()}this._schedulerJob=null,this._setScheduler()}_getNumConnsToCreate(){let e=this._freeConnectionList.length+this._usedConnectionList.size;return e<this._poolMin?this._poolMin-e:this._pendingRequests.length>0?Math.min(this._poolIncrement,this._poolMax-e):0}async bgThreadFunc(){for(;!this._poolCloseWaiter;){let e=this._poolMax-this.getConnectionsOpen();for(;e>0&&this._freeConnectionList.length>0;){let s=this._freeConnectionList.shift();this.eventEmitter.emit("_removePoolConnection",s),e--}let t=this._getNumConnsToCreate();for(let s=0;s<t;s++){try{let r=await this._getConnAttrs(),n=new XC;n._pool=this,await n.connect(r),n._newSession=!0,n._dropSess=!1,n._lastTimeUsed=Date.now(),this._freeConnectionList.push(n)}catch(r){this._bgErr=r}if(this._poolIncrement>1&&this._poolMax-this._usedConnectionList.size-this._freeConnectionList.length>1&&this._setScheduler(),this._pendingRequests.length>0&&this._pendingRequests.shift().resolve(),await new Promise(r=>ZC.setImmediate(r)),this._poolCloseWaiter)break}if(this._poolCloseWaiter)break;(this._pendingRequests.length==0||this._bgErr)&&(await new Promise(s=>{this.bgWaiter=s}),this.bgWaiter=null)}this._poolCloseWaiter()}async acquire(){for(;this._freeConnectionList.length>0;){let t=this._freeConnectionList.pop();if(!t.isHealthy()){this.eventEmitter.emit("_removePoolConnection",t);continue}let s=!1;if((this._poolPingInterval===0||this._poolPingInterval>0&&Date.now()-t._lastTimeUsed>this._poolPingInterval*1e3)&&(s=!0),s){let r;try{this._poolPingTimeout&&(r=setTimeout(()=>{t.nscon.forceDisconnect()},this._poolPingTimeout)),await t.ping()}catch{t.nscon.forceDisconnect();continue}finally{clearTimeout(r)}}return this._usedConnectionList.add(t),t}if(await new Promise(t=>{this._pendingRequests.push({resolve:t}),this.bgWaiter&&this.bgWaiter()}),this._bgErr){let t=this._bgErr;throw this._bgErr=null,this._pendingRequests.length>0&&this.bgWaiter&&this.bgWaiter(),t}let e=this._freeConnectionList.pop();return this._usedConnectionList.add(e),e}release(e){e.warning=void 0,this._usedConnectionList.delete(e),e.nscon.connected&&(e._lastTimeUsed=Date.now(),e._newSession=!1,this._freeConnectionList.length+this._usedConnectionList.size<this._poolMax?this._freeConnectionList.push(e):this.eventEmitter.emit("_removePoolConnection",e)),this._setScheduler()}_generateConnectionClass(){this._userConfig.connectionClass=JC.randomBytes(16).toString("base64"),this._userConfig.connectionClass="NJS:"+this._userConfig.connectionClass}reconfigure(e){e.poolIncrement!==void 0&&(this._poolIncrement=e.poolIncrement),e.poolTimeout!==void 0&&this._poolTimeout!==e.poolTimeout&&(this._poolTimeout=e.poolTimeout,this._schedulerJob&&(clearTimeout(this._schedulerJob),this._schedulerJob=null)),e.poolPingInterval!==void 0&&(this._poolPingInterval=e.poolPingInterval),e.stmtCacheSize!==void 0&&(this._stmtCacheSize=e.stmtCacheSize),e.poolMax!==void 0&&(this._poolMax=e.poolMax),e.poolMin!==void 0&&(this._poolMin=e.poolMin),this.bgWaiter&&this.bgWaiter()}};c(VT,"ThinPoolImpl");var MT=VT;bd.exports=MT});var qd=P(()=>{"use strict";var eO=UT(),tO=q_(),sO=kd(),rO=Gr(),{ThinDbObjectImpl:iO}=y_(),Zr=lr();Zr.ConnectionImpl=eO;Zr.ResultSetImpl=tO;Zr.PoolImpl=sO;Zr.LobImpl=rO;Zr.DbObjectImpl=iO});var zd=P((nU,Xd)=>{"use strict";Vo();var w=nt(),Pe=et(),y=W(),oe=lt(),Gd=lr(),oO=require("process"),aO=require("util"),FT=oO.version.substring(1).split(".").map(Number);y.assert(FT[0]>14||FT[0]===14&&FT[1]>=6,y.ERR_NODE_TOO_OLD,Pe.PACKAGE_JSON_VERSION,"14.6");var _O=Ba(),cO=Ma(),TO=xa(),lO=ja(),EO=ra(),uO=Er(),Hd=l_(),hO=xs(),vd=kS(),NO=h_(),SO=bi(),H=Vt(),AO=a_(),dO=i_(),pO=Za(),fO=hr(),mO=s_(),Dr={},pn={},ei="default",Ks;function PO(i){let e=typeof __non_webpack_require__=="function"?__non_webpack_require__:require,t=["../"+Pe.RELEASE_DIR+"/"+Pe.BINARY_FILE,"../"+Pe.RELEASE_DIR+"/"+Pe.BUILD_FILE,"../build/Debug/"+Pe.BUILD_FILE,"./node_modules/oracledb/"+Pe.RELEASE_DIR+"/"+Pe.BINARY_FILE,"./node_modules/oracledb/"+Pe.RELEASE_DIR+"/"+Pe.BUILD_FILE];i.binaryDir!==void 0&&t.splice(0,0,i.binaryDir+"/"+Pe.BINARY_FILE,i.binaryDir+"/"+Pe.BUILD_FILE);let s;for(let r=0;r<t.length;r++)try{s=e(t[r]);break}catch(n){if(n.code!=="MODULE_NOT_FOUND"||r==t.length-1){let a;n.code==="MODULE_NOT_FOUND"?a=`
  Looked for ${t.map(_=>require("path").resolve(__dirname,_)).join(", ")}
  ${Pe.getInstallURL()}
`:a=`
  Node.js require('oracledb') error was:
  ${n.message}
  ${Pe.getInstallHelp()}
`,y.throwErr(y.ERR_CANNOT_LOAD_BINARY,a)}}return s}c(PO,"_initCLib");function Kd(){qd()}c(Kd,"_initializeThinDriver");async function Wd(i,e){let t={};if(i=await gO(i),i.user!==void 0&&(y.assertParamPropValue(typeof i.user=="string",1,"user"),t.user=i.user),i.username!==void 0&&(y.assert(t.user===void 0,y.ERR_DBL_USER),y.assertParamPropValue(typeof i.username=="string",1,"username"),t.user=i.username),i.password!==void 0&&(y.assertParamPropValue(typeof i.password=="string",1,"password"),t.password=i.password),i.connectString!==void 0&&(y.assertParamPropValue(typeof i.connectString=="string",1,"connectString"),t.connectString=i.connectString),i.connectionString!==void 0&&(y.assert(t.connectString===void 0,y.ERR_DBL_CONNECT_STRING),y.assertParamPropValue(typeof i.connectionString=="string",1,"connectionString"),t.connectString=i.connectionString),i.walletPassword!==void 0&&(y.assertParamPropValue(typeof i.walletPassword=="string",1,"walletPassword"),t.walletPassword=i.walletPassword),i.walletLocation!==void 0&&(y.assertParamPropValue(typeof i.walletLocation=="string",1,"walletLocation"),t.walletLocation=i.walletLocation),i.walletContent!==void 0&&(y.assertParamPropValue(typeof i.walletContent=="string",1,"walletContent"),t.walletContent=i.walletContent),i.edition!==void 0&&(y.assertParamPropValue(typeof i.edition=="string",1,"edition"),t.edition=i.edition),i.stmtCacheSize!==void 0&&(y.assertParamPropValue(Number.isInteger(i.stmtCacheSize)&&i.stmtCacheSize>=0,1,"stmtCacheSize"),t.stmtCacheSize=i.stmtCacheSize),t.externalAuth=H.externalAuth,i.externalAuth!==void 0&&(y.assertParamPropValue(typeof i.externalAuth=="boolean",1,"externalAuth"),t.externalAuth=i.externalAuth),i.events!==void 0&&(y.assertParamPropValue(typeof i.events=="boolean",1,"events"),t.events=i.events),i.poolAlias!==void 0&&(y.assertParamPropValue(typeof i.poolAlias=="string"&&i.poolAlias.length>0,1,"poolAlias"),t.poolAlias=i.poolAlias),i.configDir!==void 0&&(y.assertParamPropValue(typeof i.configDir=="string",1,"configDir"),t.configDir=i.configDir),i.sslServerCertDN!==void 0&&(y.assertParamPropValue(typeof i.sslServerCertDN=="string",1,"sslServerCertDN"),t.sslServerCertDN=i.sslServerCertDN),i.sslServerDNMatch!==void 0&&(y.assertParamPropValue(typeof i.sslServerDNMatch=="boolean",1,"sslServerDNMatch"),t.sslServerDNMatch=i.sslServerDNMatch),i.sslAllowWeakDNMatch!==void 0&&(y.assertParamPropValue(typeof i.sslAllowWeakDNMatch=="boolean",1,"sslAllowWeakDNMatch"),t.sslAllowWeakDNMatch=i.sslAllowWeakDNMatch),i.httpsProxy!==void 0&&(y.assertParamPropValue(typeof i.httpsProxy=="string",1,"httpsProxy"),t.httpsProxy=i.httpsProxy),i.httpsProxyPort!==void 0&&(y.assertParamPropValue(Number.isInteger(i.httpsProxyPort)&&i.httpsProxyPort>=0,1,"httpsProxyPort"),t.httpsProxyPort=i.httpsProxyPort),i.retryCount!==void 0&&(y.assertParamPropValue(Number.isInteger(i.retryCount)&&i.retryCount>=0,1,"retryCount"),t.retryCount=i.retryCount),i.retryDelay!==void 0&&(y.assertParamPropValue(Number.isInteger(i.retryDelay)&&i.retryDelay>=0,1,"retryDelay"),t.retryDelay=i.retryDelay),i.connectTimeout!==void 0&&(y.assertParamPropValue(Number.isInteger(i.connectTimeout)&&i.connectTimeout>=0,1,"connectTimeout"),t.connectTimeout=i.connectTimeout),i.transportConnectTimeout!==void 0&&(y.assertParamPropValue(Number.isInteger(i.transportConnectTimeout)&&i.transportConnectTimeout>=0,1,"transportConnectTimeout"),t.transportConnectTimeout=i.transportConnectTimeout),i.expireTime!==void 0&&(y.assertParamPropValue(Number.isInteger(i.expireTime)&&i.expireTime>=0,1,"expireTime"),t.expireTime=i.expireTime),i.sdu!==void 0&&(y.assertParamPropValue(Number.isInteger(i.sdu)&&i.sdu>0,1,"sdu"),t.sdu=i.sdu),i.connectionIdPrefix!==void 0&&(y.assertParamPropValue(typeof i.connectionIdPrefix=="string",1,"connectionIdPrefix"),t.connectionIdPrefix=i.connectionIdPrefix),i.privilege!==void 0&&(y.assertParamPropValue(Pe.isPrivilege(i.privilege),1,"privilege"),t.privilege=i.privilege),e)i.poolMax!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolMax)&&i.poolMax>0,1,"poolMax"),t.poolMax=i.poolMax),i.poolMaxPerShard!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolMaxPerShard)&&i.poolMaxPerShard>=0,1,"poolMaxPerShard"),t.poolMaxPerShard=i.poolMaxPerShard),i.poolMin!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolMin)&&i.poolMin>=0,1,"poolMin"),t.poolMin=i.poolMin),i.poolIncrement!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolIncrement)&&i.poolIncrement>=0,1,"poolIncrement"),t.poolIncrement=i.poolIncrement),i.poolTimeout!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolTimeout)&&i.poolTimeout>=0,1,"poolTimeout"),t.poolTimeout=i.poolTimeout),i.poolPingInterval!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolPingInterval)&&i.poolPingInterval>=-2147483648&&i.poolPingInterval<=2147483647,1,"poolPingInterval"),t.poolPingInterval=i.poolPingInterval),i.poolPingTimeout!==void 0&&(y.assertParamPropValue(Number.isInteger(i.poolPingTimeout)&&i.poolPingTimeout>=0,1,"poolPingTimeout"),t.poolPingTimeout=i.poolPingTimeout),t.homogeneous=!0,i.homogeneous!==void 0&&(y.assertParamPropValue(typeof i.homogeneous=="boolean",1,"homogeneous"),t.homogeneous=i.homogeneous),i.queueTimeout!==void 0&&(y.assertParamPropValue(Number.isInteger(i.queueTimeout)&&i.queueTimeout>=0,1,"queueTimeout"),t.queueTimeout=i.queueTimeout),i.queueMax!==void 0&&(y.assertParamPropValue(Number.isInteger(i.queueMax),1,"queueMax"),t.queueMax=i.queueMax),t.sodaMetaDataCache=!1,i.sodaMetaDataCache!==void 0&&(y.assertParamPropValue(typeof i.sodaMetaDataCache=="boolean",1,"sodaMetaDataCache"),t.sodaMetaDataCache=i.sodaMetaDataCache),i.sessionCallback!==void 0&&(y.assertParamPropValue(typeof i.sessionCallback=="string"||typeof i.sessionCallback=="function",1,"sessionCallback"),t.sessionCallback=i.sessionCallback),t.enableStatistics=!1,i.enableStatistics!==void 0&&(y.assertParamPropValue(typeof i.enableStatistics=="boolean",1,"enableStatistics"),t.enableStatistics=i.enableStatistics),!t.enableStatistics&&i._enableStats!==void 0&&(y.assertParamPropValue(typeof i._enableStats=="boolean",1,"_enableStats"),t.enableStatistics=i._enableStats);else{if(i.newPassword!==void 0&&(y.assertParamPropValue(typeof i.newPassword=="string",1,"newPassword"),t.newPassword=i.newPassword),i.shardingKey!==void 0){let s=i.shardingKey;y.assertParamPropValue(Pe.isShardingKey(s),1,"shardingKey"),t.shardingKey=i.shardingKey}if(i.superShardingKey!==void 0){let s=i.superShardingKey;y.assertParamPropValue(Pe.isShardingKey(s),1,"superShardingKey"),t.superShardingKey=i.superShardingKey}}if(i.accessToken!==void 0){y.assert(t.user===void 0&&t.password===void 0,y.ERR_TOKEN_BASED_AUTH),e?y.assert(t.homogeneous&&t.externalAuth,y.ERR_POOL_TOKEN_BASED_AUTH):y.assert(t.externalAuth,y.ERR_CONN_TOKEN_BASED_AUTH);let s;typeof i.accessToken=="function"?(t.accessTokenFn=i.accessToken,t.accessTokenConfig=i.accessTokenConfig,s=await i.accessToken(!1,i.accessTokenConfig),Pe.isTokenValid(s)||(s=await i.accessToken(!0,i.accessTokenConfig))):s=i.accessToken,y.assert(Pe.isTokenValid(s),y.ERR_TOKEN_HAS_EXPIRED),s.privateKey!==void 0&&(y.assert(typeof s.privateKey=="string",y.ERR_TOKEN_BASED_AUTH),s.privateKey=Pe.denormalizePrivateKey(s.privateKey)),typeof s=="string"?t.token=s:(t.token=s.token,t.privateKey=s.privateKey)}return t.token===void 0&&t.externalAuth&&(t.password&&y.throwErr(y.ERR_WRONG_CRED_FOR_EXTAUTH),t.user&&(e?y.throwErr(y.ERR_WRONG_CRED_FOR_EXTAUTH):(t.user[0]!=="["||t.user.slice(-1)!=="]")&&y.throwErr(y.ERR_WRONG_USER_FORMAT_EXTAUTH_PROXY))),t}c(Wd,"_verifyOptions");async function RO(i){let e;y.assertArgCount(arguments,1,1),y.assertParamValue(Pe.isObject(i),1),i=await Wd(i,!0);let t=i.sessionCallback;typeof t=="function"&&delete i.sessionCallback,i.poolAlias!==void 0?e=i.poolAlias:i.poolAlias===void 0&&!Dr[ei]&&!pn[ei]&&(e=ei),(Dr[e]||pn[e])&&y.throwErr(y.ERR_POOL_WITH_ALIAS_ALREADY_EXISTS,e),H.addToOptions(i,"connectionClass","edition","events","externalAuth","stmtCacheSize","poolMax","poolMaxPerShard","poolMin","poolIncrement","poolTimeout","poolPingInterval","poolPingTimeout","queueMax","queueTimeout"),i.poolMin>i.poolMax&&y.throwErr(y.ERR_INVALID_NUMBER_OF_CONNECTIONS,i.poolMax,i.poolMin),Ks===void 0&&!H.thinDriverInitialized&&Kd(),e&&(pn[e]=!0);let s=new vd;try{await s._impl.create(i)}finally{e&&delete pn[e]}return e&&(Dr[e]=s),s._setup(i,e),s._sessionCallback=t,s.on("_afterPoolClose",()=>{s.poolAlias&&delete Dr[s.poolAlias]}),Ks===void 0&&(H.thinDriverInitialized=!0),s}c(RO,"createPool");async function IO(i){let e={},t;if(y.assertArgCount(arguments,0,1),arguments.length==0?t=ei:typeof i=="string"?t=i:(e=i,y.assertParamValue(Pe.isObject(e),1),t=e.poolAlias),t){let r=Dr[t];return y.assert(r,y.ERR_POOL_WITH_ALIAS_NOT_FOUND,t),await r.getConnection(e)}e=await Wd(e,!1),H.addToOptions(e,"connectionClass","edition","events","externalAuth","stmtCacheSize"),Ks===void 0&&!H.thinDriverInitialized&&Kd();let s=new Hd;return s._impl=new Gd.ConnectionImpl,await s._impl.connect(e),Ks===void 0&&(H.thinDriverInitialized=!0),s}c(IO,"getConnection");function DO(i){y.assertArgCount(arguments,0,1),i&&y.assertParamValue(typeof i=="string"||typeof i=="number",1),i=i||ei;let e=Dr[i];return e||y.throwErr(y.ERR_POOL_WITH_ALIAS_NOT_FOUND,i),e}c(DO,"getPool");function CO(i){let e={};if(y.assertArgCount(arguments,0,1),i!==void 0&&(y.assertParamValue(Pe.isObject(i),1),e={...i},y.assertParamPropString(e,1,"libDir"),y.assertParamPropString(e,1,"configDir"),y.assertParamPropString(e,1,"errorUrl"),y.assertParamPropString(e,1,"driverName"),y.assertParamPropString(e,1,"binaryDir")),H.thinDriverInitialized&&y.throwErr(y.ERR_THIN_CONNECTION_ALREADY_CREATED),Ks===void 0){let t=PO(e);e.driverName===void 0&&(e.driverName=w.DEFAULT_DRIVER_NAME+" thk"),e.errorUrl===void 0&&(e.errorUrl=w.DEFAULT_ERROR_URL);try{t.initOracleClient(e,Gd,H)}catch(s){let r=y.transformErr(s);throw r.code==="DPI-1047"&&(r.message+=`
`+Pe.getInstallHelp()),r}Ks=i||{}}else aO.isDeepStrictEqual(Ks,e)||y.throwErr(y.ERR_INIT_ORACLE_CLIENT_ARGS);H.thin=!1}c(CO,"initOracleClient");async function OO(i,e){let t={},s=w.SHUTDOWN_MODE_DEFAULT;y.assertArgCount(arguments,0,2),arguments.length==2?(y.assertParamValue(typeof i=="object",1),y.assertParamValue(typeof e=="number",2),t=i,s=e):arguments.length==1&&(y.assertParamValue(typeof i=="object",1),t=i);let r={user:t.user,password:t.password,connectString:t.connectString,connectionString:t.connectionString,externalAuth:t.externalAuth,privilege:w.SYSOPER},n=await this.getConnection(r);await n.shutdown(s),s!=this.SHUTDOWN_MODE_ABORT&&(await n.execute("ALTER DATABASE CLOSE"),await n.execute("ALTER DATABASE DISMOUNT"),await n.shutdown(this.SHUTDOWN_MODE_FINAL)),await n.close()}c(OO,"shutdown");async function gO(i){let e=i.connectString||i.connectionString;if(!e)return i;let t=e,s,r=new RegExp("^config-(?<provider>[A-Za-z0-9]+)(://)(?<provider_arg>[^?]+)");e.indexOf("?")!=-1&&(t=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?"),e.length));let n=t.match(r);if(n){let a=n.groups.provider,_=n.groups.provider_arg,T;try{T=nO("./configProviders/"+a)}catch{y.throwErr(y.ERR_CONFIG_PROVIDER_NOT_SUPPORTED,a)}let l=new T(_,s);try{l.init()}catch(h){y.throwErr(y.ERR_CONFIG_PROVIDER_LOAD_FAILED,h.message)}let E;try{E=await l.returnConfig()}catch(h){y.throwErr(y.ERR_CONFIG_PROVIDER_FAILED_TO_RETRIEVE_CONFIG,h.message)}i=l.modifyOptionsPrecedence(E,i)}return i}c(gO,"_checkConfigProvider");async function yO(i,e){let t={},s={};y.assertArgCount(arguments,0,2),arguments.length==2?(y.assertParamValue(typeof i=="object",1),y.assertParamValue(typeof e=="object",2),t=i,s=e):arguments.length==1&&(y.assertParamValue(typeof i=="object",1),t=i);let r={user:t.user,password:t.password,connectString:t.connectString,connectionString:t.connectionString,externalAuth:t.externalAuth,privilege:this.SYSOPER|this.SYSPRELIM},n=await this.getConnection(r);await n.startup(s),await n.close(),r.privilege=this.SYSOPER,n=await this.getConnection(r),await n.execute("ALTER DATABASE MOUNT"),await n.execute("ALTER DATABASE OPEN"),await n.close()}c(yO,"startup");Xd.exports={AqDeqOptions:_O,AqEnqOptions:cO,AqMessage:TO,AqQueue:lO,BaseDbObject:uO,Connection:Hd,JsonId:oe.JsonId,Lob:hO,Pool:vd,PoolStatistics:NO,ResultSet:SO,SodaDatabase:AO,SodaCollection:dO,SodaDocCursor:pO,SodaDocument:fO,SodaOperation:mO,getConnection:Pe.callbackify(IO),createPool:Pe.callbackify(RO),getPool:DO,initOracleClient:CO,shutdown:Pe.callbackify(OO),startup:Pe.callbackify(yO),CQN_OPCODE_ALL_OPS:w.CQN_OPCODE_ALL_OPS,CQN_OPCODE_ALL_ROWS:w.CQN_OPCODE_ALL_ROWS,CQN_OPCODE_ALTER:w.CQN_OPCODE_ALTER,CQN_OPCODE_DELETE:w.CQN_OPCODE_DELETE,CQN_OPCODE_DROP:w.CQN_OPCODE_DROP,CQN_OPCODE_INSERT:w.CQN_OPCODE_INSERT,CQN_OPCODE_UPDATE:w.CQN_OPCODE_UPDATE,DB_TYPE_BFILE:oe.DB_TYPE_BFILE,DB_TYPE_BINARY_DOUBLE:oe.DB_TYPE_BINARY_DOUBLE,DB_TYPE_BINARY_FLOAT:oe.DB_TYPE_BINARY_FLOAT,DB_TYPE_BINARY_INTEGER:oe.DB_TYPE_BINARY_INTEGER,DB_TYPE_BLOB:oe.DB_TYPE_BLOB,DB_TYPE_BOOLEAN:oe.DB_TYPE_BOOLEAN,DB_TYPE_CHAR:oe.DB_TYPE_CHAR,DB_TYPE_CLOB:oe.DB_TYPE_CLOB,DB_TYPE_CURSOR:oe.DB_TYPE_CURSOR,DB_TYPE_DATE:oe.DB_TYPE_DATE,DB_TYPE_INTERVAL_DS:oe.DB_TYPE_INTERVAL_DS,DB_TYPE_INTERVAL_YM:oe.DB_TYPE_INTERVAL_YM,DB_TYPE_JSON:oe.DB_TYPE_JSON,DB_TYPE_LONG:oe.DB_TYPE_LONG,DB_TYPE_LONG_NVARCHAR:oe.DB_TYPE_LONG_NVARCHAR,DB_TYPE_LONG_RAW:oe.DB_TYPE_LONG_RAW,DB_TYPE_NCHAR:oe.DB_TYPE_NCHAR,DB_TYPE_NCLOB:oe.DB_TYPE_NCLOB,DB_TYPE_NUMBER:oe.DB_TYPE_NUMBER,DB_TYPE_NVARCHAR:oe.DB_TYPE_NVARCHAR,DB_TYPE_OBJECT:oe.DB_TYPE_OBJECT,DB_TYPE_RAW:oe.DB_TYPE_RAW,DB_TYPE_ROWID:oe.DB_TYPE_ROWID,DB_TYPE_TIMESTAMP:oe.DB_TYPE_TIMESTAMP,DB_TYPE_TIMESTAMP_LTZ:oe.DB_TYPE_TIMESTAMP_LTZ,DB_TYPE_TIMESTAMP_TZ:oe.DB_TYPE_TIMESTAMP_TZ,DB_TYPE_VARCHAR:oe.DB_TYPE_VARCHAR,DB_TYPE_XMLTYPE:oe.DB_TYPE_XMLTYPE,DB_TYPE_VECTOR:oe.DB_TYPE_VECTOR,DEFAULT:w.DEFAULT,STMT_TYPE_UNKNOWN:w.STMT_TYPE_UNKNOWN,STMT_TYPE_SELECT:w.STMT_TYPE_SELECT,STMT_TYPE_UPDATE:w.STMT_TYPE_UPDATE,STMT_TYPE_DELETE:w.STMT_TYPE_DELETE,STMT_TYPE_INSERT:w.STMT_TYPE_INSERT,STMT_TYPE_CREATE:w.STMT_TYPE_CREATE,STMT_TYPE_DROP:w.STMT_TYPE_DROP,STMT_TYPE_ALTER:w.STMT_TYPE_ALTER,STMT_TYPE_BEGIN:w.STMT_TYPE_BEGIN,STMT_TYPE_DECLARE:w.STMT_TYPE_DECLARE,STMT_TYPE_CALL:w.STMT_TYPE_CALL,STMT_TYPE_EXPLAIN_PLAN:w.STMT_TYPE_EXPLAIN_PLAN,STMT_TYPE_MERGE:w.STMT_TYPE_MERGE,STMT_TYPE_ROLLBACK:w.STMT_TYPE_ROLLBACK,STMT_TYPE_COMMIT:w.STMT_TYPE_COMMIT,SHUTDOWN_MODE_DEFAULT:w.SHUTDOWN_MODE_DEFAULT,SHUTDOWN_MODE_TRANSACTIONAL:w.SHUTDOWN_MODE_TRANSACTIONAL,SHUTDOWN_MODE_TRANSACTIONAL_LOCAL:w.SHUTDOWN_MODE_TRANSACTIONAL_LOCAL,SHUTDOWN_MODE_IMMEDIATE:w.SHUTDOWN_MODE_IMMEDIATE,SHUTDOWN_MODE_ABORT:w.SHUTDOWN_MODE_ABORT,SHUTDOWN_MODE_FINAL:w.SHUTDOWN_MODE_FINAL,STARTUP_MODE_DEFAULT:w.STARTUP_MODE_DEFAULT,STARTUP_MODE_FORCE:w.STARTUP_MODE_FORCE,STARTUP_MODE_RESTRICT:w.STARTUP_MODE_RESTRICT,SUBSCR_EVENT_TYPE_SHUTDOWN:w.SUBSCR_EVENT_TYPE_SHUTDOWN,SUBSCR_EVENT_TYPE_SHUTDOWN_ANY:w.SUBSCR_EVENT_TYPE_SHUTDOWN_ANY,SUBSCR_EVENT_TYPE_STARTUP:w.SUBSCR_EVENT_TYPE_STARTUP,SUBSCR_EVENT_TYPE_DEREG:w.SUBSCR_EVENT_TYPE_DEREG,SUBSCR_EVENT_TYPE_OBJ_CHANGE:w.SUBSCR_EVENT_TYPE_OBJ_CHANGE,SUBSCR_EVENT_TYPE_QUERY_CHANGE:w.SUBSCR_EVENT_TYPE_QUERY_CHANGE,SUBSCR_EVENT_TYPE_AQ:w.SUBSCR_EVENT_TYPE_AQ,SUBSCR_GROUPING_CLASS_TIME:w.SUBSCR_GROUPING_CLASS_TIME,SUBSCR_GROUPING_TYPE_SUMMARY:w.SUBSCR_GROUPING_TYPE_SUMMARY,SUBSCR_GROUPING_TYPE_LAST:w.SUBSCR_GROUPING_TYPE_LAST,SUBSCR_NAMESPACE_AQ:w.SUBSCR_NAMESPACE_AQ,SUBSCR_NAMESPACE_DBCHANGE:w.SUBSCR_NAMESPACE_DBCHANGE,SUBSCR_QOS_BEST_EFFORT:w.SUBSCR_QOS_BEST_EFFORT,SUBSCR_QOS_DEREG_NFY:w.SUBSCR_QOS_DEREG_NFY,SUBSCR_QOS_QUERY:w.SUBSCR_QOS_QUERY,SUBSCR_QOS_RELIABLE:w.SUBSCR_QOS_RELIABLE,SUBSCR_QOS_ROWIDS:w.SUBSCR_QOS_ROWIDS,SYSASM:w.SYSASM,SYSBACKUP:w.SYSBACKUP,SYSDBA:w.SYSDBA,SYSDG:w.SYSDG,SYSKM:w.SYSKM,SYSOPER:w.SYSOPER,SYSPRELIM:w.SYSPRELIM,SYSRAC:w.SYSRAC,BIND_IN:w.BIND_IN,BIND_INOUT:w.BIND_INOUT,BIND_OUT:w.BIND_OUT,OUT_FORMAT_ARRAY:w.OUT_FORMAT_ARRAY,OUT_FORMAT_OBJECT:w.OUT_FORMAT_OBJECT,SODA_COLL_MAP_MODE:w.SODA_COLL_MAP_MODE,POOL_STATUS_OPEN:w.POOL_STATUS_OPEN,POOL_STATUS_DRAINING:w.POOL_STATUS_DRAINING,POOL_STATUS_CLOSED:w.POOL_STATUS_CLOSED,POOL_STATUS_RECONFIGURING:w.POOL_STATUS_RECONFIGURING,AQ_DEQ_NO_WAIT:w.AQ_DEQ_NO_WAIT,AQ_DEQ_WAIT_FOREVER:w.AQ_DEQ_WAIT_FOREVER,AQ_DEQ_MODE_BROWSE:w.AQ_DEQ_MODE_BROWSE,AQ_DEQ_MODE_LOCKED:w.AQ_DEQ_MODE_LOCKED,AQ_DEQ_MODE_REMOVE:w.AQ_DEQ_MODE_REMOVE,AQ_DEQ_MODE_REMOVE_NO_DATA:w.AQ_DEQ_MODE_REMOVE_NO_DATA,AQ_DEQ_NAV_FIRST_MSG:w.AQ_DEQ_NAV_FIRST_MSG,AQ_DEQ_NAV_NEXT_TRANSACTION:w.AQ_DEQ_NAV_NEXT_TRANSACTION,AQ_DEQ_NAV_NEXT_MSG:w.AQ_DEQ_NAV_NEXT_MSG,AQ_MSG_DELIV_MODE_PERSISTENT:w.AQ_MSG_DELIV_MODE_PERSISTENT,AQ_MSG_DELIV_MODE_BUFFERED:w.AQ_MSG_DELIV_MODE_BUFFERED,AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED:w.AQ_MSG_DELIV_MODE_PERSISTENT_OR_BUFFERED,AQ_MSG_STATE_READY:w.AQ_MSG_STATE_READY,AQ_MSG_STATE_WAITING:w.AQ_MSG_STATE_WAITING,AQ_MSG_STATE_PROCESSED:w.AQ_MSG_STATE_PROCESSED,AQ_MSG_STATE_EXPIRED:w.AQ_MSG_STATE_EXPIRED,AQ_VISIBILITY_IMMEDIATE:w.AQ_VISIBILITY_IMMEDIATE,AQ_VISIBILITY_ON_COMMIT:w.AQ_VISIBILITY_ON_COMMIT,TPC_BEGIN_JOIN:w.TPC_BEGIN_JOIN,TPC_BEGIN_NEW:w.TPC_BEGIN_NEW,TPC_BEGIN_PROMOTE:w.TPC_BEGIN_PROMOTE,TPC_BEGIN_RESUME:w.TPC_BEGIN_RESUME,TPC_END_NORMAL:w.TPC_END_NORMAL,TPC_END_SUSPEND:w.TPC_END_SUSPEND,VECTOR_FORMAT_FLOAT32:w.VECTOR_FORMAT_FLOAT32,VECTOR_FORMAT_FLOAT64:w.VECTOR_FORMAT_FLOAT64,VECTOR_FORMAT_INT8:w.VECTOR_FORMAT_INT8,VECTOR_FORMAT_BINARY:w.VECTOR_FORMAT_BINARY,BLOB:oe.DB_TYPE_BLOB,BUFFER:oe.DB_TYPE_RAW,CLOB:oe.DB_TYPE_CLOB,CURSOR:oe.DB_TYPE_CURSOR,DATE:oe.DB_TYPE_TIMESTAMP,NCLOB:oe.DB_TYPE_NCLOB,NUMBER:oe.DB_TYPE_NUMBER,STRING:oe.DB_TYPE_VARCHAR,ARRAY:w.OUT_FORMAT_ARRAY,OBJECT:w.OUT_FORMAT_OBJECT,future:EO,get autoCommit(){return H.autoCommit},get connectionClass(){return H.connectionClass},get dbObjectAsPojo(){return H.dbObjectAsPojo},get edition(){return H.edition},get errorOnConcurrentExecute(){return H.errorOnConcurrentExecute},get events(){return H.events},get externalAuth(){return H.externalAuth},get fetchArraySize(){return H.fetchArraySize},get fetchAsBuffer(){return H.fetchAsBuffer},get fetchAsString(){return H.fetchAsString},get fetchTypeHandler(){return H.fetchTypeHandler},get lobPrefetchSize(){return H.lobPrefetchSize},get maxRows(){return H.maxRows},get oracleClientVersion(){return H.oracleClientVersion},get oracleClientVersionString(){return H.oracleClientVersionString},get outFormat(){return H.outFormat},get poolIncrement(){return H.poolIncrement},get poolMax(){return H.poolMax},get poolMaxPerShard(){return H.poolMaxPerShard},get poolMin(){return H.poolMin},get poolPingInterval(){return H.poolPingInterval},get poolPingTimeout(){return H.poolPingTimeout},get poolTimeout(){return H.poolTimeout},get prefetchRows(){return H.prefetchRows},get stmtCacheSize(){return H.stmtCacheSize},get thin(){return H.thin},get version(){return w.VERSION_MAJOR*1e4+w.VERSION_MINOR*100+w.VERSION_PATCH},get versionString(){return w.VERSION_STRING},get versionSuffix(){return w.VERSION_SUFFIX},set autoCommit(i){y.assertPropValue(typeof i=="boolean","autoCommit"),H.autoCommit=i},set connectionClass(i){y.assertPropValue(typeof i=="string","connectionClass"),H.connectionClass=i},set dbObjectAsPojo(i){y.assertPropValue(typeof i=="boolean","dbObjectAsPojo"),H.dbObjectAsPojo=i},set edition(i){y.assertPropValue(typeof i=="string","edition"),H.edition=i},set errorOnConcurrentExecute(i){y.assertPropValue(typeof i=="boolean","errorOnConcurrentExecute"),H.errorOnConcurrentExecute=i},set events(i){y.assertPropValue(typeof i=="boolean","events"),H.events=i},set externalAuth(i){y.assertPropValue(typeof i=="boolean","externalAuth"),H.externalAuth=i},set fetchArraySize(i){y.assertPropValue(Number.isInteger(i)&&i>0,"fetchArraySize"),H.fetchArraySize=i},set fetchAsBuffer(i){y.assertPropValue(Array.isArray(i),"fetchAsBuffer"),H.createFetchTypeMap(H.fetchAsString,i),H.fetchAsBuffer=i},set fetchAsString(i){y.assertPropValue(Array.isArray(i),"fetchAsString"),H.createFetchTypeMap(i,H.fetchAsBuffer),H.fetchAsString=i},set fetchTypeHandler(i){i!==void 0&&y.assertPropValue(typeof i=="function","fetchTypeHandler"),H.fetchTypeHandler=i},set lobPrefetchSize(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"lobPrefetchSize"),H.lobPrefetchSize=i},set maxRows(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"maxRows"),H.maxRows=i},set outFormat(i){i!==w.OUT_FORMAT_ARRAY&&i!==w.OUT_FORMAT_OBJECT&&y.throwErr(y.ERR_INVALID_PROPERTY_VALUE,"outFormat"),H.outFormat=i},set poolIncrement(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolIncrement"),H.poolIncrement=i},set poolMax(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolMax"),H.poolMax=i},set poolMaxPerShard(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolMaxPerShard"),H.poolMaxPerShard=i},set poolMin(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolMin"),H.poolMin=i},set poolPingInterval(i){y.assertPropValue(Number.isInteger(i)&&i<2**31&&i>=(-2)**31,"poolPingInterval"),H.poolPingInterval=i},set poolPingTimeout(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolPingTimeout"),H.poolPingTimeout=i},set poolTimeout(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"poolTimeout"),H.poolTimeout=i},set prefetchRows(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"prefetchRows"),H.prefetchRows=i},set stmtCacheSize(i){y.assertPropValue(Number.isInteger(i)&&i>=0,"stmtCacheSize"),H.stmtCacheSize=i}}});var jd=P((_U,$d)=>{$d.exports=zd()});var xT=P(Jd=>{Jd.require=function(){if(typeof process=="object"&&process.versions&&process.versions.electron)try{let i=require("original-fs");if(Object.keys(i).length>0)return i}catch{}return require("fs")}});var bT=P((TU,Qd)=>{Qd.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var sp=P((lU,tp)=>{var LO=xT().require(),Pt=require("path"),Zd=bT(),BO=typeof process=="object"&&process.platform==="win32",ep=c(i=>i&&typeof i=="object","is_Obj"),kT=new Uint32Array(256).map((i,e)=>{for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e>>>=1;return e>>>0});function _t(i){this.sep=Pt.sep,this.fs=LO,ep(i)&&ep(i.fs)&&typeof i.fs.statSync=="function"&&(this.fs=i.fs)}c(_t,"Utils");tp.exports=_t;_t.prototype.makeDir=function(i){let e=this;function t(s){let r=s.split(e.sep)[0];s.split(e.sep).forEach(function(n){if(!(!n||n.substr(-1,1)===":")){r+=e.sep+n;var a;try{a=e.fs.statSync(r)}catch{e.fs.mkdirSync(r)}if(a&&a.isFile())throw Errors.FILE_IN_THE_WAY.replace("%s",r)}})}c(t,"mkdirSync"),t(i)};_t.prototype.writeFileTo=function(i,e,t,s){let r=this;if(r.fs.existsSync(i)){if(!t)return!1;var n=r.fs.statSync(i);if(n.isDirectory())return!1}var a=Pt.dirname(i);r.fs.existsSync(a)||r.makeDir(a);var _;try{_=r.fs.openSync(i,"w",438)}catch{r.fs.chmodSync(i,438),_=r.fs.openSync(i,"w",438)}if(_)try{r.fs.writeSync(_,e,0,e.length,0)}finally{r.fs.closeSync(_)}return r.fs.chmodSync(i,s||438),!0};_t.prototype.writeFileToAsync=function(i,e,t,s,r){typeof s=="function"&&(r=s,s=void 0);let n=this;n.fs.exists(i,function(a){if(a&&!t)return r(!1);n.fs.stat(i,function(_,T){if(a&&T.isDirectory())return r(!1);var l=Pt.dirname(i);n.fs.exists(l,function(E){E||n.makeDir(l),n.fs.open(i,"w",438,function(h,p){h?n.fs.chmod(i,438,function(){n.fs.open(i,"w",438,function(A,u){n.fs.write(u,e,0,e.length,0,function(){n.fs.close(u,function(){n.fs.chmod(i,s||438,function(){r(!0)})})})})}):p?n.fs.write(p,e,0,e.length,0,function(){n.fs.close(p,function(){n.fs.chmod(i,s||438,function(){r(!0)})})}):n.fs.chmod(i,s||438,function(){r(!0)})})})})})};_t.prototype.findFiles=function(i){let e=this;function t(s,r,n){typeof r=="boolean"&&(n=r,r=void 0);let a=[];return e.fs.readdirSync(s).forEach(function(_){var T=Pt.join(s,_);e.fs.statSync(T).isDirectory()&&n&&(a=a.concat(t(T,r,n))),(!r||r.test(T))&&a.push(Pt.normalize(T)+(e.fs.statSync(T).isDirectory()?e.sep:""))}),a}return c(t,"findSync"),t(i,void 0,!0)};_t.prototype.getAttributes=function(){};_t.prototype.setAttributes=function(){};_t.crc32update=function(i,e){return kT[(i^e)&255]^i>>>8};_t.crc32=function(i){typeof i=="string"&&(i=Buffer.from(i,"utf8")),kT.length||genCRCTable();let e=i.length,t=-1;for(let s=0;s<e;)t=_t.crc32update(t,i[s++]);return~t>>>0};_t.methodToString=function(i){switch(i){case Zd.STORED:return"STORED ("+i+")";case Zd.DEFLATED:return"DEFLATED ("+i+")";default:return"UNSUPPORTED ("+i+")"}};_t.canonical=function(i){if(!i)return"";var e=Pt.posix.normalize("/"+i.split("\\").join("/"));return Pt.join(".",e)};_t.sanitize=function(i,e){i=Pt.resolve(Pt.normalize(i));for(var t=e.split("/"),s=0,r=t.length;s<r;s++){var n=Pt.normalize(Pt.join(i,t.slice(s,r).join(Pt.sep)));if(n.indexOf(i)===0)return n}return Pt.normalize(Pt.join(i,Pt.basename(e)))};_t.toBuffer=c(function(e){return Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e):typeof e=="string"?Buffer.from(e,"utf8"):Buffer.alloc(0)},"toBuffer");_t.readBigUInt64LE=function(i,e){var t=Buffer.from(i.slice(e,e+8));return t.swap64(),parseInt(`0x${t.toString("hex")}`)};_t.isWin=BO;_t.crcTable=kT});var ip=P((uU,rp)=>{rp.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}});var ap=P((hU,op)=>{var fn=xT().require(),np=require("path");fn.existsSync=fn.existsSync||np.existsSync;op.exports=function(i){var e=i||"",t=r(),s=null;function r(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return c(r,"newAttr"),e&&fn.existsSync(e)?(s=fn.statSync(e),t.directory=s.isDirectory(),t.mtime=s.mtime,t.atime=s.atime,t.executable=(73&s.mode)!==0,t.readonly=(128&s.mode)===0,t.hidden=np.basename(e)[0]==="."):console.warn("Invalid path: "+e),{get directory(){return t.directory},get readOnly(){return t.readonly},get hidden(){return t.hidden},get mtime(){return t.mtime},get atime(){return t.atime},get executable(){return t.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:e,isDirectory:t.directory,isReadOnly:t.readonly,isHidden:t.hidden,isExecutable:t.executable,mTime:t.mtime,aTime:t.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var Cr=P((SU,ti)=>{ti.exports=sp();ti.exports.Constants=bT();ti.exports.Errors=ip();ti.exports.FileAttr=ap()});var cp=P((AU,_p)=>{var si=Cr(),v=si.Constants;_p.exports=function(){var i=20,e=10,t=0,s=0,r=0,n=0,a=0,_=0,T=0,l=0,E=0,h=0,p=0,A=0,u=0;i|=si.isWin?2560:768,t|=v.FLG_EFS;var N={};function d(S){S=new Date(S),r=(S.getFullYear()-1980&127)<<25|S.getMonth()+1<<21|S.getDate()<<16|S.getHours()<<11|S.getMinutes()<<5|S.getSeconds()>>1}return c(d,"setTime"),d(+new Date),{get made(){return i},set made(S){i=S},get version(){return e},set version(S){e=S},get flags(){return t},set flags(S){t=S},get method(){return s},set method(S){switch(S){case v.STORED:this.version=10;case v.DEFLATED:default:this.version=20}s=S},get time(){return new Date((r>>25&127)+1980,(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(r&31)<<1)},set time(S){d(S)},get crc(){return n},set crc(S){n=Math.max(0,S)>>>0},get compressedSize(){return a},set compressedSize(S){a=Math.max(0,S)>>>0},get size(){return _},set size(S){_=Math.max(0,S)>>>0},get fileNameLength(){return T},set fileNameLength(S){T=S},get extraLength(){return l},set extraLength(S){l=S},get commentLength(){return E},set commentLength(S){E=S},get diskNumStart(){return h},set diskNumStart(S){h=Math.max(0,S)>>>0},get inAttr(){return p},set inAttr(S){p=Math.max(0,S)>>>0},get attr(){return A},set attr(S){A=Math.max(0,S)>>>0},get fileAttr(){return A?(A>>>0|0)>>16&4095:0},get offset(){return u},set offset(S){u=Math.max(0,S)>>>0},get encripted(){return(t&1)===1},get entryHeaderSize(){return v.CENHDR+T+l+E},get realDataOffset(){return u+v.LOCHDR+N.fnameLen+N.extraLen},get dataHeader(){return N},loadDataHeaderFromBinary:function(S){var D=S.slice(u,u+v.LOCHDR);if(D.readUInt32LE(0)!==v.LOCSIG)throw new Error(si.Errors.INVALID_LOC);N={version:D.readUInt16LE(v.LOCVER),flags:D.readUInt16LE(v.LOCFLG),method:D.readUInt16LE(v.LOCHOW),time:D.readUInt32LE(v.LOCTIM),crc:D.readUInt32LE(v.LOCCRC),compressedSize:D.readUInt32LE(v.LOCSIZ),size:D.readUInt32LE(v.LOCLEN),fnameLen:D.readUInt16LE(v.LOCNAM),extraLen:D.readUInt16LE(v.LOCEXT)}},loadFromBinary:function(S){if(S.length!==v.CENHDR||S.readUInt32LE(0)!==v.CENSIG)throw new Error(si.Errors.INVALID_CEN);i=S.readUInt16LE(v.CENVEM),e=S.readUInt16LE(v.CENVER),t=S.readUInt16LE(v.CENFLG),s=S.readUInt16LE(v.CENHOW),r=S.readUInt32LE(v.CENTIM),n=S.readUInt32LE(v.CENCRC),a=S.readUInt32LE(v.CENSIZ),_=S.readUInt32LE(v.CENLEN),T=S.readUInt16LE(v.CENNAM),l=S.readUInt16LE(v.CENEXT),E=S.readUInt16LE(v.CENCOM),h=S.readUInt16LE(v.CENDSK),p=S.readUInt16LE(v.CENATT),A=S.readUInt32LE(v.CENATX),u=S.readUInt32LE(v.CENOFF)},dataHeaderToBinary:function(){var S=Buffer.alloc(v.LOCHDR);return S.writeUInt32LE(v.LOCSIG,0),S.writeUInt16LE(e,v.LOCVER),S.writeUInt16LE(t,v.LOCFLG),S.writeUInt16LE(s,v.LOCHOW),S.writeUInt32LE(r,v.LOCTIM),S.writeUInt32LE(n,v.LOCCRC),S.writeUInt32LE(a,v.LOCSIZ),S.writeUInt32LE(_,v.LOCLEN),S.writeUInt16LE(T,v.LOCNAM),S.writeUInt16LE(l,v.LOCEXT),S},entryHeaderToBinary:function(){var S=Buffer.alloc(v.CENHDR+T+l+E);return S.writeUInt32LE(v.CENSIG,0),S.writeUInt16LE(i,v.CENVEM),S.writeUInt16LE(e,v.CENVER),S.writeUInt16LE(t,v.CENFLG),S.writeUInt16LE(s,v.CENHOW),S.writeUInt32LE(r,v.CENTIM),S.writeUInt32LE(n,v.CENCRC),S.writeUInt32LE(a,v.CENSIZ),S.writeUInt32LE(_,v.CENLEN),S.writeUInt16LE(T,v.CENNAM),S.writeUInt16LE(l,v.CENEXT),S.writeUInt16LE(E,v.CENCOM),S.writeUInt16LE(h,v.CENDSK),S.writeUInt16LE(p,v.CENATT),S.writeUInt32LE(A,v.CENATX),S.writeUInt32LE(u,v.CENOFF),S.fill(0,v.CENHDR),S},toJSON:function(){let S=c(function(D){return D+" bytes"},"bytes");return{made:i,version:e,flags:t,method:si.methodToString(s),time:this.time,crc:"0x"+n.toString(16).toUpperCase(),compressedSize:S(a),size:S(_),fileNameLength:S(T),extraLength:S(l),commentLength:S(E),diskNumStart:h,inAttr:p,attr:A,offset:u,entryHeaderSize:S(v.CENHDR+T+l+E)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var lp=P((pU,Tp)=>{var Or=Cr(),be=Or.Constants;Tp.exports=function(){var i=0,e=0,t=0,s=0,r=0;return{get diskEntries(){return i},set diskEntries(n){i=e=n},get totalEntries(){return e},set totalEntries(n){e=i=n},get size(){return t},set size(n){t=n},get offset(){return s},set offset(n){s=n},get commentLength(){return r},set commentLength(n){r=n},get mainHeaderSize(){return be.ENDHDR+r},loadFromBinary:function(n){if((n.length!==be.ENDHDR||n.readUInt32LE(0)!==be.ENDSIG)&&(n.length<be.ZIP64HDR||n.readUInt32LE(0)!==be.ZIP64SIG))throw new Error(Or.Errors.INVALID_END);n.readUInt32LE(0)===be.ENDSIG?(i=n.readUInt16LE(be.ENDSUB),e=n.readUInt16LE(be.ENDTOT),t=n.readUInt32LE(be.ENDSIZ),s=n.readUInt32LE(be.ENDOFF),r=n.readUInt16LE(be.ENDCOM)):(i=Or.readBigUInt64LE(n,be.ZIP64SUB),e=Or.readBigUInt64LE(n,be.ZIP64TOT),t=Or.readBigUInt64LE(n,be.ZIP64SIZ),s=Or.readBigUInt64LE(n,be.ZIP64OFF),r=0)},toBinary:function(){var n=Buffer.alloc(be.ENDHDR+r);return n.writeUInt32LE(be.ENDSIG,0),n.writeUInt32LE(0,4),n.writeUInt16LE(i,be.ENDSUB),n.writeUInt16LE(e,be.ENDTOT),n.writeUInt32LE(t,be.ENDSIZ),n.writeUInt32LE(s,be.ENDOFF),n.writeUInt16LE(r,be.ENDCOM),n.fill(" ",be.ENDHDR),n},toJSON:function(){let n=c(function(a,_){let T=a.toString(16).toUpperCase();for(;T.length<_;)T="0"+T;return"0x"+T},"offset");return{diskEntries:i,totalEntries:e,size:t+" bytes",offset:n(s,4),commentLength:r}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var GT=P(qT=>{qT.EntryHeader=cp();qT.MainHeader=lp()});var up=P((PU,Ep)=>{Ep.exports=function(i){var e=require("zlib"),t={chunkSize:(parseInt(i.length/1024)+1)*1024};return{deflate:function(){return e.deflateRawSync(i,t)},deflateAsync:function(s){var r=e.createDeflateRaw(t),n=[],a=0;r.on("data",function(_){n.push(_),a+=_.length}),r.on("end",function(){var _=Buffer.alloc(a),T=0;_.fill(0);for(var l=0;l<n.length;l++){var E=n[l];E.copy(_,T),T+=E.length}s&&s(_)}),r.end(i)}}}});var Np=P((RU,hp)=>{hp.exports=function(i){var e=require("zlib");return{inflate:function(){return e.inflateRawSync(i)},inflateAsync:function(t){var s=e.createInflateRaw(),r=[],n=0;s.on("data",function(a){r.push(a),n+=a.length}),s.on("end",function(){var a=Buffer.alloc(n),_=0;a.fill(0);for(var T=0;T<r.length;T++){var l=r[T];l.copy(a,_),_+=l.length}t&&t(a)}),s.end(i)}}}});var fp=P((IU,pp)=>{"use strict";var{randomFillSync:Sp}=require("crypto"),wO=new Uint32Array(256).map((i,e)=>{for(let t=0;t<8;t++)e&1?e=e>>>1^3988292384:e>>>=1;return e>>>0}),dp=c((i,e)=>Math.imul(i,e)>>>0,"uMul"),Ap=c((i,e)=>wO[(i^e)&255]^i>>>8,"crc32update"),ri=c(()=>typeof Sp=="function"?Sp(Buffer.alloc(12)):ri.node(),"genSalt");ri.node=()=>{let i=Buffer.alloc(12),e=i.length;for(let t=0;t<e;t++)i[t]=Math.random()*256&255;return i};var mn={genSalt:ri};function Pn(i){let e=Buffer.isBuffer(i)?i:Buffer.from(i);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let t=0;t<e.length;t++)this.updateKeys(e[t])}c(Pn,"Initkeys");Pn.prototype.updateKeys=function(i){let e=this.keys;return e[0]=Ap(e[0],i),e[1]+=e[0]&255,e[1]=dp(e[1],134775813)+1,e[2]=Ap(e[2],e[1]>>>24),i};Pn.prototype.next=function(){let i=(this.keys[2]|2)>>>0;return dp(i,i^1)>>8&255};function UO(i){let e=new Pn(i);return function(t){let s=Buffer.alloc(t.length),r=0;for(let n of t)s[r++]=e.updateKeys(n^e.next());return s}}c(UO,"make_decrypter");function YO(i){let e=new Pn(i);return function(t,s,r=0){s||(s=Buffer.alloc(t.length));for(let n of t){let a=e.next();s[r++]=n^a,e.updateKeys(n)}return s}}c(YO,"make_encrypter");function MO(i,e,t){if(!i||!Buffer.isBuffer(i)||i.length<12)return Buffer.alloc(0);let s=UO(t);if(s(i.slice(0,12))[11]!==e.crc>>>24)throw"ADM-ZIP: Wrong Password";return s(i.slice(12))}c(MO,"decrypt");function VO(i){Buffer.isBuffer(i)&&i.length>=12?mn.genSalt=function(){return i.slice(0,12)}:i==="node"?mn.genSalt=ri.node:mn.genSalt=ri}c(VO,"_salter");function FO(i,e,t,s=!1){i==null&&(i=Buffer.alloc(0)),Buffer.isBuffer(i)||(i=Buffer.from(i.toString()));let r=YO(t),n=mn.genSalt();n[11]=e.crc>>>24&255,s&&(n[10]=e.crc>>>16&255);let a=Buffer.alloc(i.length+12);return r(n,a),r(i,a,12)}c(FO,"encrypt");pp.exports={decrypt:MO,encrypt:FO,_salter:VO}});var mp=P(Rn=>{Rn.Deflater=up();Rn.Inflater=Np();Rn.ZipCrypto=fp()});var vT=P((OU,Pp)=>{var je=Cr(),xO=GT(),Bt=je.Constants,HT=mp();Pp.exports=function(i){var e=new xO.EntryHeader,t=Buffer.alloc(0),s=Buffer.alloc(0),r=!1,n=null,a=Buffer.alloc(0);function _(){return!i||!Buffer.isBuffer(i)?Buffer.alloc(0):(e.loadDataHeaderFromBinary(i),i.slice(e.realDataOffset,e.realDataOffset+e.compressedSize))}c(_,"getCompressedDataFromZip");function T(u){return!((e.flags&8)!==8&&je.crc32(u)!==e.dataHeader.crc)}c(T,"crc32OK");function l(u,N,d){if(typeof N>"u"&&typeof u=="string"&&(d=u,u=void 0),r)return u&&N&&N(Buffer.alloc(0),je.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var S=_();if(S.length===0)return u&&N&&N(S),S;if(e.encripted){if(typeof d!="string"&&!Buffer.isBuffer(d))throw new Error("ADM-ZIP: Incompatible password parameter");S=HT.ZipCrypto.decrypt(S,e,d)}var D=Buffer.alloc(e.size);switch(e.method){case je.Constants.STORED:if(S.copy(D),T(D))return u&&N&&N(D),D;throw u&&N&&N(D,je.Errors.BAD_CRC),new Error(je.Errors.BAD_CRC);case je.Constants.DEFLATED:var m=new HT.Inflater(S);if(u)m.inflateAsync(function(O){O.copy(O,0),N&&(T(O)?N(O):N(O,je.Errors.BAD_CRC))});else{if(m.inflate(D).copy(D,0),!T(D))throw new Error(je.Errors.BAD_CRC+" "+t.toString());return D}break;default:throw u&&N&&N(Buffer.alloc(0),je.Errors.UNKNOWN_METHOD),new Error(je.Errors.UNKNOWN_METHOD)}}c(l,"decompress");function E(u,N){if((!n||!n.length)&&Buffer.isBuffer(i))return u&&N&&N(_()),_();if(n.length&&!r){var d;switch(e.method){case je.Constants.STORED:return e.compressedSize=e.size,d=Buffer.alloc(n.length),n.copy(d),u&&N&&N(d),d;default:case je.Constants.DEFLATED:var S=new HT.Deflater(n);if(u)S.deflateAsync(function(m){d=Buffer.alloc(m.length),e.compressedSize=m.length,m.copy(d),N&&N(d)});else{var D=S.deflate();return e.compressedSize=D.length,D}S=null;break}}else if(u&&N)N(Buffer.alloc(0));else return Buffer.alloc(0)}c(E,"compress");function h(u,N){return(u.readUInt32LE(N+4)<<4)+u.readUInt32LE(N)}c(h,"readUInt64LE");function p(u){for(var N=0,d,S,D;N<u.length;)d=u.readUInt16LE(N),N+=2,S=u.readUInt16LE(N),N+=2,D=u.slice(N,N+S),N+=S,Bt.ID_ZIP64===d&&A(D)}c(p,"parseExtra");function A(u){var N,d,S,D;u.length>=Bt.EF_ZIP64_SCOMP&&(N=h(u,Bt.EF_ZIP64_SUNCOMP),e.size===Bt.EF_ZIP64_OR_32&&(e.size=N)),u.length>=Bt.EF_ZIP64_RHO&&(d=h(u,Bt.EF_ZIP64_SCOMP),e.compressedSize===Bt.EF_ZIP64_OR_32&&(e.compressedSize=d)),u.length>=Bt.EF_ZIP64_DSN&&(S=h(u,Bt.EF_ZIP64_RHO),e.offset===Bt.EF_ZIP64_OR_32&&(e.offset=S)),u.length>=Bt.EF_ZIP64_DSN+4&&(D=u.readUInt32LE(Bt.EF_ZIP64_DSN),e.diskNumStart===Bt.EF_ZIP64_OR_16&&(e.diskNumStart=D))}return c(A,"parseZip64ExtendedInformation"),{get entryName(){return t.toString()},get rawEntryName(){return t},set entryName(u){t=je.toBuffer(u);var N=t[t.length-1];r=N===47||N===92,e.fileNameLength=t.length},get extra(){return a},set extra(u){a=u,e.extraLength=u.length,p(u)},get comment(){return s.toString()},set comment(u){s=je.toBuffer(u),e.commentLength=s.length},get name(){var u=t.toString();return r?u.substr(u.length-1).split("/").pop():u.split("/").pop()},get isDirectory(){return r},getCompressedData:function(){return E(!1,null)},getCompressedDataAsync:function(u){E(!0,u)},setData:function(u){n=je.toBuffer(u),!r&&n.length?(e.size=n.length,e.method=je.Constants.DEFLATED,e.crc=je.crc32(u),e.changed=!0):e.method=je.Constants.STORED},getData:function(u){return e.changed?n:l(!1,null,u)},getDataAsync:function(u,N){e.changed?u(n):l(!0,u,N)},set attr(u){e.attr=u},get attr(){return e.attr},set header(u){e.loadFromBinary(u)},get header(){return e},packHeader:function(){var u=e.entryHeaderToBinary(),N=je.Constants.CENHDR;return t.copy(u,N),N+=t.length,e.extraLength&&(a.copy(u,N),N+=e.extraLength),e.commentLength&&s.copy(u,N),u},toJSON:function(){let u=c(function(N){return"<"+(N&&N.length+" bytes buffer"||"null")+">"},"bytes");return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:e.toJSON(),compressedData:u(i),data:u(n)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var Dp=P((yU,Ip)=>{var Rp=vT(),bO=GT(),Nt=Cr();Ip.exports=function(i,e){var t=[],s={},r=Buffer.alloc(0),n=new bO.MainHeader,a=!1;let _=Object.assign(Object.create(null),e),{noSort:T}=_;i?h(_.readEntries):a=!0;function l(A){let u=n.diskEntries,N=n.offset;for(let d=0;d<u;d++){let S=N,D=new Rp(i);D.header=i.slice(S,S+=Nt.Constants.CENHDR),D.entryName=i.slice(S,S+=D.header.fileNameLength),N+=D.header.entryHeaderSize,A(D)}}c(l,"iterateEntries");function E(){a=!0,s={},t=new Array(n.diskEntries);for(var A=n.offset,u=0;u<t.length;u++){var N=A,d=new Rp(i);d.header=i.slice(N,N+=Nt.Constants.CENHDR),d.entryName=i.slice(N,N+=d.header.fileNameLength),d.header.extraLength&&(d.extra=i.slice(N,N+=d.header.extraLength)),d.header.commentLength&&(d.comment=i.slice(N,N+d.header.commentLength)),A+=d.header.entryHeaderSize,t[u]=d,s[d.entryName]=d}}c(E,"readEntries");function h(A){var u=i.length-Nt.Constants.ENDHDR,N=Math.max(0,u-65535),d=N,S=i.length,D=-1,m=0;for(u;u>=d;u--)if(i[u]===80){if(i.readUInt32LE(u)===Nt.Constants.ENDSIG){D=u,m=u,S=u+Nt.Constants.ENDHDR,d=u-Nt.Constants.END64HDR;continue}if(i.readUInt32LE(u)===Nt.Constants.END64SIG){d=N;continue}if(i.readUInt32LE(u)===Nt.Constants.ZIP64SIG){D=u,S=u+Nt.readBigUInt64LE(i,u+Nt.Constants.ZIP64SIZE)+Nt.Constants.ZIP64LEAD;break}}if(!~D)throw new Error(Nt.Errors.INVALID_FORMAT);n.loadFromBinary(i.slice(D,S)),n.commentLength&&(r=i.slice(m+Nt.Constants.ENDHDR)),A&&E()}c(h,"readMainHeader");function p(){t.length>1&&!T&&t.sort((A,u)=>A.entryName.toLowerCase().localeCompare(u.entryName.toLowerCase()))}return c(p,"sortEntries"),{get entries(){return a||E(),t},get comment(){return r.toString()},set comment(A){r=Nt.toBuffer(A),n.commentLength=r.length},getEntryCount:function(){return a?t.length:n.diskEntries},forEach:function(A){if(!a){l(A);return}t.forEach(A)},getEntry:function(A){return a||E(),s[A]||null},setEntry:function(A){a||E(),t.push(A),s[A.entryName]=A,n.totalEntries=t.length},deleteEntry:function(A){a||E();var u=s[A];if(u&&u.isDirectory){var N=this;this.getEntryChildren(u).forEach(function(d){d.entryName!==A&&N.deleteEntry(d.entryName)})}t.splice(t.indexOf(u),1),delete s[A],n.totalEntries=t.length},getEntryChildren:function(A){if(a||E(),A&&A.isDirectory){let u=[],N=A.entryName,d=N.length;return t.forEach(function(S){S.entryName.substr(0,d)===N&&u.push(S)}),u}return[]},compressToBuffer:function(){a||E(),p();let A=[],u=[],N=0,d=0;n.size=0,n.offset=0;for(let m of t){let O=m.getCompressedData();m.header.offset=d;let U=m.header.dataHeaderToBinary(),V=m.rawEntryName.length,G=Buffer.alloc(V+m.extra.length);m.rawEntryName.copy(G,0),G.copy(m.extra,V);let z=U.length+G.length+O.length;d+=z,A.push(U),A.push(G),A.push(O);let C=m.packHeader();u.push(C),n.size+=C.length,N+=z+C.length}N+=n.mainHeaderSize,n.offset=d,d=0;let S=Buffer.alloc(N);for(let m of A)m.copy(S,d),d+=m.length;for(let m of u)m.copy(S,d),d+=m.length;let D=n.toBinary();return r&&r.copy(D,Nt.Constants.ENDHDR),D.copy(S,d),S},toAsyncBuffer:function(A,u,N,d){try{a||E(),p();let S=[],D=[],m=0,O=0;n.size=0,n.offset=0;let U=c(function(V){if(V.length){let G=V.pop(),z=G.entryName+G.extra.toString();N&&N(z),G.getCompressedDataAsync(function(C){d&&d(z),G.header.offset=O;let q=G.header.dataHeaderToBinary(),R=Buffer.alloc(z.length,z),B=q.length+R.length+C.length;O+=B,S.push(q),S.push(R),S.push(C);let x=G.packHeader();D.push(x),n.size+=x.length,m+=B+x.length,U(V)})}else{m+=n.mainHeaderSize,n.offset=O,O=0;let G=Buffer.alloc(m);S.forEach(function(C){C.copy(G,O),O+=C.length}),D.forEach(function(C){C.copy(G,O),O+=C.length});let z=n.toBinary();r&&r.copy(z,Nt.Constants.ENDHDR),z.copy(G,O),A(G)}},"compress2Buffer");U(t)}catch(S){u(S)}}}}});var Op=P((BU,Cp)=>{var Ze=Cr(),ts=require("path"),kO=vT(),qO=Dp(),Ws=c((i,e)=>typeof i=="boolean"?i:e,"get_Bool"),KT=c((i,e)=>typeof i=="string"?i:e,"get_Str"),GO={noSort:!1,readEntries:!1,method:Ze.Constants.NONE,fs:null};Cp.exports=function(i,e){let t=null,s=Object.assign(Object.create(null),GO);i&&typeof i=="object"&&(i instanceof Uint8Array||(Object.assign(s,i),i=s.input?s.input:void 0,s.input&&delete s.input),Buffer.isBuffer(i)&&(t=i,s.method=Ze.Constants.BUFFER,i=void 0)),Object.assign(s,e);let r=new Ze(s);if(i&&typeof i=="string")if(r.fs.existsSync(i))s.method=Ze.Constants.FILE,s.filename=i,t=r.fs.readFileSync(i);else throw new Error(Ze.Errors.INVALID_FILENAME);let n=new qO(t,s),{canonical:a,sanitize:_}=Ze;function T(E){if(E&&n){var h;if(typeof E=="string"&&(h=n.getEntry(E)),typeof E=="object"&&typeof E.entryName<"u"&&typeof E.header<"u"&&(h=n.getEntry(E.entryName)),h)return h}return null}c(T,"getEntry");function l(E){let{join:h,normalize:p,sep:A}=ts.posix;return h(".",p(A+E.split("\\").join(A)+A))}return c(l,"fixPath"),{readFile:function(E,h){var p=T(E);return p&&p.getData(h)||null},readFileAsync:function(E,h){var p=T(E);p?p.getDataAsync(h):h(null,"getEntry failed for:"+E)},readAsText:function(E,h){var p=T(E);if(p){var A=p.getData();if(A&&A.length)return A.toString(h||"utf8")}return""},readAsTextAsync:function(E,h,p){var A=T(E);A?A.getDataAsync(function(u,N){if(N){h(u,N);return}u&&u.length?h(u.toString(p||"utf8")):h("")}):h("")},deleteFile:function(E){var h=T(E);h&&n.deleteEntry(h.entryName)},addZipComment:function(E){n.comment=E},getZipComment:function(){return n.comment||""},addZipEntryComment:function(E,h){var p=T(E);p&&(p.comment=h)},getZipEntryComment:function(E){var h=T(E);return h&&h.comment||""},updateFile:function(E,h){var p=T(E);p&&p.setData(h)},addLocalFile:function(E,h,p,A){if(r.fs.existsSync(E)){h=h?l(h):"";var u=E.split("\\").join("/").split("/").pop();h+=p||u;let N=r.fs.statSync(E);this.addFile(h,r.fs.readFileSync(E),A,N)}else throw new Error(Ze.Errors.FILE_NOT_FOUND.replace("%s",E))},addLocalFolder:function(E,h,p){if(p instanceof RegExp?p=function(A){return function(u){return A.test(u)}}(p):typeof p!="function"&&(p=c(function(){return!0},"filter")),h=h?l(h):"",E=ts.normalize(E),r.fs.existsSync(E)){let A=r.findFiles(E),u=this;A.length&&A.forEach(function(N){var d=ts.relative(E,N).split("\\").join("/");if(p(d)){var S=r.fs.statSync(N);S.isFile()?u.addFile(h+d,r.fs.readFileSync(N),"",S):u.addFile(h+d+"/",Buffer.alloc(0),"",S)}})}else throw new Error(Ze.Errors.FILE_NOT_FOUND.replace("%s",E))},addLocalFolderAsync:function(E,h,p,A){A instanceof RegExp?A=function(N){return function(d){return N.test(d)}}(A):typeof A!="function"&&(A=c(function(){return!0},"filter")),p=p?l(p):"",E=ts.normalize(E);var u=this;r.fs.open(E,"r",function(N){if(N&&N.code==="ENOENT")h(void 0,Ze.Errors.FILE_NOT_FOUND.replace("%s",E));else if(N)h(void 0,N);else{var d=r.findFiles(E),S=-1,D=c(function(){if(S+=1,S<d.length){var m=d[S],O=ts.relative(E,m).split("\\").join("/");O=O.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),A(O)?r.fs.stat(m,function(U,V){U&&h(void 0,U),V.isFile()?r.fs.readFile(m,function(G,z){G?h(void 0,G):(u.addFile(p+O,z,"",V),D())}):(u.addFile(p+O+"/",Buffer.alloc(0),"",V),D())}):D()}else h(!0,void 0)},"next");D()}})},addLocalFolderPromise:function(E,h){return new Promise((p,A)=>{let{filter:u,zipPath:N}=Object.assign({},h);this.addLocalFolderAsync(E,(d,S)=>{S&&A(S),d&&p(this)},N,u)})},addFile:function(E,h,p,A){let u=T(E),N=u!=null;N||(u=new kO,u.entryName=E),u.comment=p||"";let d=typeof A=="object"&&A instanceof r.fs.Stats;d&&(u.header.time=A.mtime);var S=u.isDirectory?16:0;if(!Ze.isWin){let D=u.isDirectory?16384:32768;d?D|=4095&A.mode:typeof A=="number"?D|=4095&A:D|=u.isDirectory?493:420,S=(S|D<<16)>>>0}u.attr=S,u.setData(h),N||n.setEntry(u)},getEntries:function(){return n?n.entries:[]},getEntry:function(E){return T(E)},getEntryCount:function(){return n.getEntryCount()},forEach:function(E){return n.forEach(E)},extractEntryTo:function(E,h,p,A,u,N){A=Ws(A,!1),u=Ws(u,!1),p=Ws(p,!0),N=KT(N,KT(u,void 0));var d=T(E);if(!d)throw new Error(Ze.Errors.NO_ENTRY);var S=a(d.entryName),D=_(h,N&&!d.isDirectory?N:p?S:ts.basename(S));if(d.isDirectory){var m=n.getEntryChildren(d);return m.forEach(function(V){if(V.isDirectory)return;var G=V.getData();if(!G)throw new Error(Ze.Errors.CANT_EXTRACT_FILE);var z=a(V.entryName),C=_(h,p?z:ts.basename(z));let q=u?V.header.fileAttr:void 0;r.writeFileTo(C,G,A,q)}),!0}var O=d.getData();if(!O)throw new Error(Ze.Errors.CANT_EXTRACT_FILE);if(r.fs.existsSync(D)&&!A)throw new Error(Ze.Errors.CANT_OVERRIDE);let U=u?E.header.fileAttr:void 0;return r.writeFileTo(D,O,A,U),!0},test:function(E){if(!n)return!1;for(var h in n.entries)try{if(h.isDirectory)continue;var p=n.entries[h].getData(E);if(!p)return!1}catch{return!1}return!0},extractAllTo:function(E,h,p,A){if(h=Ws(h,!1),A=KT(p,A),p=Ws(p,!1),!n)throw new Error(Ze.Errors.NO_ZIP);n.entries.forEach(function(u){var N=_(E,a(u.entryName.toString()));if(u.isDirectory){r.makeDir(N);return}var d=u.getData(A);if(!d)throw new Error(Ze.Errors.CANT_EXTRACT_FILE);let S=p?u.header.fileAttr:void 0;r.writeFileTo(N,d,h,S);try{r.fs.utimesSync(N,u.header.time,u.header.time)}catch{throw new Error(Ze.Errors.CANT_EXTRACT_FILE)}})},extractAllToAsync:function(E,h,p,A){if(A||(A=c(function(){},"callback")),h=Ws(h,!1),typeof p=="function"&&!A&&(A=p),p=Ws(p,!1),!n){A(new Error(Ze.Errors.NO_ZIP));return}E=ts.resolve(E);let u=c(m=>_(E,ts.normalize(a(m.entryName.toString()))),"getPath"),N=c((m,O)=>new Error(m+': "'+O+'"'),"getError"),d=[],S=new Set;n.entries.forEach(m=>{m.isDirectory?d.push(m):S.add(m)});for(let m of d){let O=u(m),U=p?m.header.fileAttr:void 0;try{r.makeDir(O),U&&r.fs.chmodSync(O,U),r.fs.utimesSync(O,m.header.time,m.header.time)}catch{A(N("Unable to create folder",O))}}let D=c(()=>{S.size===0&&A()},"done");for(let m of S.values()){let O=ts.normalize(a(m.entryName.toString())),U=_(E,O);m.getDataAsync(function(V,G){if(G){A(new Error(G));return}if(!V)A(new Error(Ze.Errors.CANT_EXTRACT_FILE));else{let z=p?m.header.fileAttr:void 0;r.writeFileToAsync(U,V,h,z,function(C){if(!C){A(N("Unable to write file",U));return}r.fs.utimes(U,m.header.time,m.header.time,function(q){if(q){A(N("Unable to set times",U));return}S.delete(m),D()})})}})}D()},writeZip:function(E,h){if(arguments.length===1&&typeof E=="function"&&(h=E,E=""),!E&&s.filename&&(E=s.filename),!!E){var p=n.compressToBuffer();if(p){var A=r.writeFileTo(E,p,!0);typeof h=="function"&&h(A?null:new Error("failed"),"")}}},writeZipPromise:function(E,h){let{overwrite:p,perm:A}=Object.assign({overwrite:!0},h);return new Promise((u,N)=>{!E&&s.filename&&(E=s.filename),E||N("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(d=>{let S=c(D=>D?u(D):N("ADM-ZIP: Wasn't able to write zip file"),"ret");r.writeFileToAsync(E,d,p,A,S)},N)})},toBufferPromise:function(){return new Promise((E,h)=>{n.toAsyncBuffer(E,h)})},toBuffer:function(E,h,p,A){return this.valueOf=2,typeof E=="function"?(n.toAsyncBuffer(E,h,p,A),null):n.compressToBuffer()}}}});var Lp=P((UU,yp)=>{"use strict";var HO=require("crypto"),gr=require("fs"),gp=require("path"),vO=Op(),KO=c((i,e)=>new Promise((t,s)=>{try{let r=new vO(i);if(!r)return s(new Error("Link to zip file is broken or system has no permissions to "+i+" folder"));let n=r.getEntries();return Object.keys(n).length===0?s(new Error("Zip file is empty")):(r.extractAllTo(e,!0),t(e))}catch(r){s(r)}}),"extractZip"),WO=c((i,e)=>{if(!gr.existsSync(i))return;let t=/DIRECTORY\=\".+?\"/i,s=gr.readFileSync(i).toString();t.test(s)&&(s=s.replace(t,`DIRECTORY="${e}"`),gr.writeFileSync(i,s))},"replaceSqlNetOraDirectoryPath"),XO=c(i=>new Promise((e,t)=>{let s=c(a=>HO.createHash("md5").update(a,"utf-8").digest("hex"),"getHash"),r=gr.createReadStream(i),n="";r.on("data",a=>{n+=a}),r.on("error",a=>{t(a)}),r.on("end",function(){e(s(n))})}),"getHashByFile"),zO=c(async({walletFile:i,tempFolder:e,name:t})=>{if(!gr.existsSync(i))return;let s=await XO(i),r=gp.join(e,t+"_"+s);if(gr.existsSync(r))return r;await KO(i,r);let n=gp.join(r,"sqlnet.ora");return WO(n,r),r},"extractWallet");yp.exports=zO});var Bp=P(WT=>{"use strict";Object.defineProperty(WT,"__esModule",{value:!0});var $O=function(){function i(e,t){t===void 0&&(t=0),this.source=e,this.position=t}return c(i,"LexerState"),i.prototype.copy=function(){return new i(this.source,this.position)},i}();WT.default=$O});var Yp=P(Xs=>{"use strict";var jO=Xs&&Xs.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){i(e,t);function s(){this.constructor=e}c(s,"__"),e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}}();Object.defineProperty(Xs,"__esModule",{value:!0});var wp=function(){function i(e,t,s,r,n,a){this.type=e,this.match=t,this.groups=s,this.start=r,this.end=n,this.lexer=a}return c(i,"Token"),i.prototype.strpos=function(){var e=this.lexer.strpos(this.start),t=this.lexer.strpos(this.end);return{start:e,end:t}},i.prototype.isEof=function(){return!1},i}();Xs.default=wp;var Up=function(i){jO(e,i);function e(t){var s=this,r=t.source.length;return s=i.call(this,null,"(eof)",[],r,r,t)||this,s}return c(e,"EOFToken"),e.prototype.isEof=function(){return!0},e}(wp);Xs.EOFToken=Up;Xs.EOF=function(i){return new Up(i)}});var Mp=P(XT=>{"use strict";Object.defineProperty(XT,"__esModule",{value:!0});function JO(i){return new RegExp(i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"))}c(JO,"toRegExp");function QO(i){return typeof i=="string"&&(i=JO(i)),i.source.startsWith("^")?i:new RegExp("^"+i.source,i.flags)}c(QO,"normalize");function ZO(i,e){for(var t=0,s=0,r=i;s<r.length;s++){var n=r[s],a=e(n,t++);if(a)return{item:n,result:a}}}c(ZO,"first");var eg=function(){function i(){this.tokenTypes=[]}return c(i,"TokenTypes"),i.prototype.disable=function(e){return this.enable(e,!1)},i.prototype.enable=function(e,t){return t===void 0&&(t=!0),this.tokenTypes.filter(function(s){return s.type==e}).forEach(function(s){return s.enabled=t}),this},i.prototype.isEnabled=function(e){var t=this.tokenTypes.filter(function(s){return s.type==e});if(t.length==0)throw new Error("Token of type "+e+" does not exists");return t[0].enabled},i.prototype.peek=function(e,t){var s=e.substr(t);return ZO(this.tokenTypes.filter(function(r){return r.enabled}),function(r){return r.regex.lastIndex=0,r.regex.exec(s)})},i.prototype.token=function(e,t,s){return s===void 0&&(s=!1),this.tokenTypes.push({type:e,regex:QO(t),enabled:!0,skip:s}),this},i}();XT.default=eg});var Fp=P(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});var zT=Bp();zs.LexerState=zT.default;var In=Yp();zs.Token=In.default;zs.EOF=In.EOF;var Vp=Mp();zs.TokenTypes=Vp.default;var tg=function(){function i(e){e===void 0&&(e=""),this._state=new zT.default(e),this._tokenTypes=new Vp.default}return c(i,"Lexer"),Object.defineProperty(i.prototype,"position",{get:function(){return this._state.position},set:function(e){this._state.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"source",{get:function(){return this._state.source},set:function(e){this._state=new zT.default(e)},enumerable:!0,configurable:!0}),i.prototype.attachTo=function(e){this._state=e._state},i.prototype.disable=function(e){return this._tokenTypes.disable(e),this},i.prototype.enable=function(e,t){return this._tokenTypes.enable(e,t),this},i.prototype.expect=function(e){var t=this.next();if(t.type!=e){var s=t.strpos();throw new Error("Expected "+e+(t?", got "+t.type:"")+" at "+s.start.line+":"+s.start.column)}return t},i.prototype.isEnabled=function(e){return this._tokenTypes.isEnabled(e)},i.prototype.next=function(){try{var e=this.peek();return this._state.position=e.end,e}catch(t){throw this._state.position=t.end,t}},i.prototype.peek=function(e){var t=this;e===void 0&&(e=this._state.position);var s=c(function(E){if(E===void 0&&(E=e),E>=t._state.source.length)return In.EOF(t);var h=t._tokenTypes.peek(t._state.source,E);return h?h.item.skip?s(E+h.result[0].length):new In.default(h.item.type,h.result[0],h.result.map(function(p){return p}),E,E+h.result[0].length,t):null},"read"),r=s();if(r)return r;var n=this._state.source.substring(e,e+1);try{this.peek(e+1)}catch(E){n+=E.unexpected}var a=this.strpos(e),_=a.line,T=a.column,l=new Error("Unexpected input: "+n+" at ("+_+":"+T+")");throw l.unexpected=n,l.end=e+n.length,l},i.prototype.strpos=function(e){var t=this._state.source.substring(0,e).split(/\r?\n/);Array.isArray(t)||(t=[t]);var s=t.length,r=t[t.length-1].length+1;return{line:s,column:r}},i.prototype.toArray=function(){var e=this._state.copy();this._state.position=0;for(var t=[],s;!(s=this.next()).isEof();)t.push(s);return this._state=e,t},i.prototype.token=function(e,t,s){return this._tokenTypes.token(e,t,s),this},i.prototype.keyword=function(e){return this.token(e,new RegExp(e+"(?=\\W|$)"))},i.prototype.operator=function(e){var t=new String(e).valueOf();return this.token(e,t)},i}();zs.default=tg});var bp=P((HU,xp)=>{xp.exports=Fp()});var Gp=P((vU,qp)=>{"use strict";var sg=bp().default;function kp(i,e={}){i.expect("(");let t=i.expect("WORD").match;i.expect("=");let s;if(i.peek().type==="("){s={};do Object.assign(s,kp(i,e));while(i.peek().type==="(")}else s=i.expect("WORD").match;return i.expect(")"),{...e,[t]:s}}c(kp,"parseObject");var rg=c(i=>{let e=i.expect("WORD").match;return i.expect("="),{name:e,data:kp(i)}},"parseConnection"),ig=c(i=>{let e=new sg(i).token("$SKIP_COMMENT",/#[^\n]*/,!0).token("$SKIP_WS",/\s+/,!0).token("WORD",/([a-z0-9._-]+|["'][\s\S]*?["'])/i).token("(",/\(/).token(")",/\)/).token("=",/=/),t={};for(;e.peek().type!==null;){let s=rg(e);t[s.name]=s}return t},"parseTns");qp.exports=ig});var Dn=P((WU,Hp)=>{"use strict";var JT=class JT{cache;cacheValue;cycle;ifNotExist;increment;maxValue;minValue;sequenceName;start;sharing;order;keep;scale;scaleExtend;shard;shardExtend;type};c(JT,"Sequence");var $T=JT,QT=class QT{sharing;ddlScript;sequenceName;minValue;maxValue;increment;cycle;order;cacheValue;scale;extend;shard;type;keep};c(QT,"SequenceDto");var jT=QT;Hp.exports={Sequence:$T,SequenceDto:jT}});var Wp=P((jU,Kp)=>{"use strict";var{Sequence:zU,SequenceDto:$U}=Dn(),ng=/(?<=START WITH)(\s+)([\w]+)(?=\s+)?/,og=/\s+LINK$/,St={true:"Y",false:"N"},Oe={cache:"cache",cycle:"cycle",extend:"extend",global:"global",keep:"keep",noCache:"nocache",noCycle:"nocycle",noExtend:"noextend",noKeep:"nokeep",noOrder:"noorder",noScale:"noscale",noShard:"noshard",order:"order",scale:"scale",scaleExtend:"scaleExtend",session:"session",shard:"shard",sharing:"sharing",type:"type"},vp={[Oe.cycle]:{[St.true]:Oe.cycle,[St.false]:Oe.noCycle},[Oe.order]:{[St.true]:Oe.order,[St.false]:Oe.noOrder},[Oe.shard]:{[St.true]:Oe.shard,[St.false]:""},[Oe.scale]:{[St.true]:Oe.scale,[St.false]:Oe.noScale},[Oe.type]:{[St.true]:Oe.session,[St.false]:Oe.global},[Oe.keep]:{[St.true]:Oe.keep,[St.false]:Oe.noKeep},[Oe.extend]:{[St.true]:Oe.extend,[St.false]:Oe.noExtend}},ag=c(async({schema:i,execute:e,logger:t})=>{try{let s=await e(`
      SELECT JSON_OBJECT(
          'sharing'      VALUE SHARING,
          'sequenceName' VALUE SEQUENCE_NAME,
          'minValue'     VALUE MIN_VALUE,
          'maxValue'     VALUE MAX_VALUE,
          'increment'    VALUE INCREMENT_BY,
          'cycle'        VALUE CYCLE_FLAG,
          'order'        VALUE ORDER_FLAG,
          'cacheValue'   VALUE CACHE_SIZE,
          'scale'        VALUE SCALE_FLAG,
          'extend'       VALUE EXTEND_FLAG,
          'shard'        VALUE SHARDED_FLAG,
          'type'         VALUE SESSION_FLAG,
          'keep'         VALUE KEEP_VALUE
      )
      FROM ALL_OBJECTS
      LEFT JOIN ALL_SEQUENCES
                ON ALL_SEQUENCES.SEQUENCE_OWNER = ALL_OBJECTS.OWNER
                AND ALL_SEQUENCES.SEQUENCE_NAME = ALL_OBJECTS.OBJECT_NAME
      WHERE OBJECT_TYPE = 'SEQUENCE'
      AND OWNER = '${i}'
      `);if(!(s!=null&&s.length))return[];let r=await _g({schema:i,execute:e,logger:t});return s.map(([n])=>{let a=JSON.parse(n),_=r[a.sequenceName]||"";return{...a,ddlScript:_}})}catch(s){let{message:r,stack:n,...a}=s;return t.log("error",{message:"Cannot get sequences",error:{message:r,stack:n,err:a}},"Getting sequences"),[]}},"getSchemaSequenceDtos"),_g=c(async({schema:i,execute:e,logger:t})=>{try{let s=await e(`
      SELECT JSON_OBJECT(
          'sequenceName' VALUE OBJECT_NAME,
          'ddlScript'    VALUE DBMS_METADATA.GET_DDL(OBJECT_TYPE, OBJECT_NAME, OWNER)
      )
      FROM ALL_OBJECTS
      WHERE OBJECT_TYPE = 'SEQUENCE'
      AND OWNER = '${i}'
      `);return s!=null&&s.length?s.reduce((r,[n])=>{let{sequenceName:a,ddlScript:_}=JSON.parse(n);return{...r,[a]:_}},{}):{}}catch(s){let{message:r,stack:n,...a}=s;return t.log("error",{message:"Cannot get sequences DDL",error:{message:r,stack:n,err:a}},"Getting sequences"),{}}},"getSchemaSequenceDdl"),cg=c(({execute:i})=>async({schema:e,logger:t})=>(await ag({schema:e,execute:i,logger:t})).map(r=>{let n=Tg({sequenceDto:r}),a=Eg({sequenceDto:r}),_=ug({sequenceDto:r}),T=lg({sequenceDto:r}),l=r.cacheValue?Oe.cache:Oe.noCache;return{sequenceName:r.sequenceName,minValue:r.minValue,maxValue:r.maxValue,increment:r.increment,cacheValue:r.cacheValue,cache:l,sharing:n,...a,..._,...T}}),"getSchemaSequences"),Tg=c(({sequenceDto:i})=>{var e,t;return(t=(e=i.sharing)==null?void 0:e.replace(og,""))==null?void 0:t.toLowerCase()},"getSequenceSharing"),lg=c(({sequenceDto:i})=>{let e=i[Oe.scale],t=i[Oe.shard],s=i[Oe.extend],r=vp[Oe.extend][s],n=e===St.true?r:"",a=t===St.true?r:"";return{scaleExtend:n,shardExtend:a}},"getExtendOptions"),Eg=c(({sequenceDto:i})=>Object.entries(vp).reduce((e,[t,s])=>({...e,[t]:s[i[t]]}),{}),"getBooleanOptions"),ug=c(({sequenceDto:i})=>({start:hg({sequenceDto:i})}),"getOptionsFromDdl"),hg=c(({sequenceDto:i})=>{var s;let e=i.ddlScript;if(!e.includes("START WITH"))return i.minValue<i.maxValue?i.minValue:i.maxValue;let t=(s=e.match(ng))==null?void 0:s[2];return isNaN(Number(t))?t:Number(t)},"getStartOptionFromDdl");Kp.exports={getSchemaSequences:cg}});var sl=P((QU,Qp)=>{"use strict";var ii=jd(),Ng=Lp(),On=require("path"),gn=require("fs"),Sg=Gp(),{getSchemaSequences:Ag}=Wp(),Re=require("lodash"),zp={message:"Connection error"},Ns,ZT,dg=c((i="")=>{let e=i.match(/http:\/\/(?:.*?:.*?@)?(.*?):(\d+)/i);return e?{httpsProxy:e[1],httpsProxyPort:e[2]}:{}},"parseProxyOptions"),$p=c(i=>[i,process.env.TNS_ADMIN,On.join(process.env.ORACLE_HOME||"","network","admin"),On.join(process.env.LD_LIBRARY_PATH||"","network","admin")].reduce((t,s)=>{if(t)return t;let r=On.join(s,"tnsnames.ora");return gn.existsSync(r)?r:t},""),"getTnsNamesOraFile"),jp=c(i=>{let e=gn.readFileSync(i).toString();return Sg(e)},"parseTnsNamesOra"),pg=c((i,e,t,s)=>{var p,A,u,N,d,S,D,m;let r=$p(i);if(!gn.existsSync(r))return e;s({message:"Found tnsnames.ora file: "+r});let n=jp(r);s({message:"tnsnames.ora successfully parsed"});let a=Object.keys(n);if(!n[e]&&a.length===0)return s({message:`Cannot find '${e}' in tnsnames.ora and no fallback found`}),e;let[_]=a,T=n[e]||n[_];n[e]||s({message:`Connect using first TNS service ${_}' from ${On.join(i,"tnsnames.ora")}.`});let l=(A=(p=T==null?void 0:T.data)==null?void 0:p.description)==null?void 0:A.address,E=(d=(N=(u=T==null?void 0:T.data)==null?void 0:u.description)==null?void 0:N.connect_data)==null?void 0:d.service_name,h=(m=(D=(S=T==null?void 0:T.data)==null?void 0:S.description)==null?void 0:D.connect_data)==null?void 0:m.sid;return s({message:"tnsnames.ora",address:l,service:E}),el(Re.omitBy({...l,...t,protocol:(l==null?void 0:l.protocol)||"tcps",service:E||e,sid:h},Re.isUndefined),s)},"getConnectionStringByTnsNames"),Cn=c((i,e)=>i?e:"","combine"),el=c(({protocol:i,host:e,port:t,sid:s,service:r,httpsProxy:n,httpsProxyPort:a},_)=>{let T=`(DESCRIPTION=
		(ADDRESS=
			(PROTOCOL=${i||"tcp"})
			(HOST=${e})
			(PORT=${t}))
			${Cn(n,`(HTTPS_PROXY=${n})`)}
			${Cn(a,`(HTTPS_PROXY_PORT=${a})`)}
		(CONNECT_DATA=
					${Cn(s,`(SID=${s})`)}
					${Cn(r,`(SERVICE_NAME=${r})`)}
		)
	)`;return _({message:"connectionString",connectionString:T}),T},"getConnectionDescription"),fg=c(async(i,e,t)=>{var n,a,_,T,l,E,h,p,A,u,N;let s={protocol:"",host:"",port:"",service:""};if(["Wallet","TNS"].includes(i.connectionMethod)){let d=$p(i.configDir);if(!gn.existsSync(d))throw new Error("Cannot find tnsnames.ora file. Please, specify tnsnames folder or use Base connection method.");t({message:"Found tnsnames.ora file: "+d});let S=jp(d);if(!S[i.serviceName])throw new Error('Cannot find "'+i.serviceName+'" in tnsnames.ora');let D=(_=(a=(n=S[i.serviceName])==null?void 0:n.data)==null?void 0:a.description)==null?void 0:_.address,m=(h=(E=(l=(T=S[i.serviceName])==null?void 0:T.data)==null?void 0:l.description)==null?void 0:E.connect_data)==null?void 0:h.service_name,O=(N=(u=(A=(p=S[i.serviceName])==null?void 0:p.data)==null?void 0:A.description)==null?void 0:u.connect_data)==null?void 0:N.sid;t({message:"tnsnames.ora",address:D,service:m}),s.protocol=D==null?void 0:D.protocol,s.host=D==null?void 0:D.host,s.port=D==null?void 0:D.port,s.service=m||i.serviceName,s.sid=O}else s.host=i.host,s.port=i.port,s.service=i.serviceName,s.sid=i.sid;let{options:r}=await e.openTunnel({sshAuthMethod:i.sshConfig.ssh_method==="privateKey"?"IDENTITY_FILE":"USER_PASSWORD",sshTunnelHostname:i.sshConfig.ssh_host,sshTunnelPort:i.sshConfig.ssh_port,sshTunnelUsername:i.sshConfig.ssh_user,sshTunnelPassword:i.sshConfig.ssh_password,sshTunnelIdentityFile:i.sshConfig.ssh_key_file,sshTunnelPassphrase:i.sshConfig.ssh_key_passphrase,host:s.host,port:s.port});return el({...s,host:r.host,port:r.port.toString()},t)},"getSshConnectionString"),mg=c(async({walletFile:i,walletPassword:e,tempFolder:t,name:s,connectionMethod:r,TNSpath:n,host:a,port:_,userName:T,userPassword:l,serviceName:E,clientPath:h,clientType:p,queryRequestTimeout:A,authMethod:u,options:N,sid:d,ssh:S,ssh_user:D,ssh_host:m,ssh_port:O,ssh_method:U,ssh_key_file:V,ssh_key_passphrase:G,ssh_password:z,authRole:C,mode:q},R,B)=>{if(Ns)return Ns;let x={thin:"thin",thick:"thick"},J,re,k={},Ee="";r==="Wallet"&&(J=await Ng({walletFile:i,tempFolder:t,name:s}),process.env.TNS_ADMIN=J),r==="TNS"&&(J=n),p==="InstantClient"&&(re=h),N!=null&&N.proxy&&(Ee=dg(N==null?void 0:N.proxy)),q!==x.thin&&ii.initOracleClient({libDir:re,configDir:J});let M="";return["Wallet","TNS"].includes(r)?M=pg(J,E,Ee,B):M=el({host:a,port:_,sid:d,service:E},B),S&&(ZT=!0,M=await fg({host:a,port:_,configDir:J,serviceName:E,sid:d,connectionMethod:r,sshConfig:{ssh_user:D,ssh_host:m,ssh_port:O,ssh_method:U,ssh_key_file:V,ssh_password:z,ssh_key_passphrase:G}},R,B)),u==="OS"?k.externalAuth=!0:u==="Kerberos"?(k.username=T,k.password=l,k.externalAuth=!0):(k.username=T,k.password=l),Rg({connectString:M,username:T,password:l,queryRequestTimeout:A,authRole:C,walletLocation:J,walletPassword:e})},"connect"),Pg=c(async i=>Ns?(ZT&&(ZT=!1,await i.closeConsumer()),new Promise((e,t)=>{Ns.close(s=>{if(Ns=null,s)return t(s);e()})})):Promise.reject(zp),"disconnect"),Rg=c(({connectString:i,username:e,password:t,queryRequestTimeout:s,authRole:r,walletPassword:n,walletLocation:a})=>new Promise((_,T)=>{let l={username:e,password:t,connectString:i,privilege:r==="default"?void 0:ii[r],walletLocation:a,walletPassword:n};ii.getConnection(l,(E,h)=>{if(E)return Ns=null,T(E);try{h.callTimeout=Number(s||0),Ns=h,_()}catch(p){T(p)}})}),"authByCredentials"),Ig=c(async({includeSystemCollection:i,schemaName:e},t)=>{let s="SELECT USERNAME FROM ALL_USERS",r,n="";return e&&(n=`USERNAME = '${e}'`),i?r=`${s}${n?` WHERE ${n}`:""}`:r=`${s} WHERE ORACLE_MAINTAINED = 'N'${n?` AND ${n}`:""}`,await At(r).catch(a=>(t.info({message:"Cannot retrieve schema names"}),t.error(a),[]))},"getSchemaNames"),Dg=c(i=>Re.reduce(i,(e,t)=>({...e,[t[0]]:[...e[t[0]]||[],t[1]]}),{}),"pairToObj"),yn=c((i,e,t)=>{let s="";return t&&(s=`T.OWNER = '${t}'`),At(e?`${i}${s?` WHERE ${s}`:""}`:`${i} INNER JOIN ALL_USERS U ON T.OWNER = U.USERNAME WHERE U.ORACLE_MAINTAINED = 'N'${s?` AND ${s}`:""}`)},"selectEntities"),Cg=c(({includeSystemCollection:i,schemaName:e})=>yn("SELECT T.OWNER, T.TABLE_NAME FROM ALL_TABLES T",i,e),"tableNamesByUser"),Og=c(({includeSystemCollection:i,schemaName:e})=>yn("SELECT T.OWNER, T.TABLE_NAME FROM ALL_EXTERNAL_TABLES T",i,e),"externalTableNamesByUser"),gg=c(({includeSystemCollection:i,schemaName:e})=>yn("SELECT T.OWNER, T.VIEW_NAME || ' (v)' FROM ALL_VIEWS T",i,e),"viewNamesByUser"),yg=c(({includeSystemCollection:i,schemaName:e})=>yn("SELECT T.OWNER, T.MVIEW_NAME || ' (v)' FROM ALL_MVIEWS T",i,e),"materializedViewNamesByUser"),Lg=c(async(i,e)=>{let t=await yg(i).catch(T=>(e.info({message:"Cannot retrieve materialized views"}),e.error(T),[]));e.info({materializedViews:t});let s=t.map(T=>Re.join(T,".").slice(0,-4)),r=await Cg(i).then(T=>Re.reject(T,l=>s.includes(Re.join(l,".")))).catch(T=>(e.info({message:"Cannot retrieve tables"}),e.error(T),[]));e.info({tables:r});let n=await Og(i).catch(T=>(e.info({message:"Cannot retrieve external tables"}),e.error(T),[]));e.info({externalTables:n});let a=await gg(i).catch(T=>(e.info({message:"Cannot retrieve views"}),e.error(T),[]));e.info({views:a});let _=Dg([...r,...n,...a,...t]);return Object.keys(_).reduce((T,l)=>[...T,{dbName:l,dbCollections:_[l],isEmpty:!_[l].length}],[])},"getEntitiesNames"),At=c((i,e={},t=[])=>Ns?new Promise((s,r)=>{Ns.execute(i,t,e,(n,a)=>{if(n)return r(n);s(a.rows)})}):Promise.reject(zp),"execute"),Bg=c(async i=>{var s,r;let e=["12c","18c","19c","21c","23ai"],t="21c";try{let n=await At("SELECT VERSION FROM PRODUCT_COMPONENT_VERSION WHERE product LIKE 'Oracle Database%'");i.log("info",n,"DB Version");let a=(r=(s=n==null?void 0:n[0])==null?void 0:s[0])==null?void 0:r.split(".").shift();return a&&e.find(T=>T.startsWith(a))||t}catch(n){return i.log("error",{message:n.message,stack:n.stack},"Error of getting DB Version"),t}},"getDbVersion"),wg=c(i=>i.slice(-4)===" (v)","isView"),Ug=c(i=>{let e=Re.partition(i,wg);return{views:e[0].map(t=>t.slice(0,-4)),tables:e[1]}},"splitEntityNames"),tl=c(()=>At(`BEGIN
		DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM,'SQLTERMINATOR', TRUE);
	END;`),"setSQLTerminator"),Yg=c(async(i,e,t)=>{var s;try{await tl();let r=await At(`
			SELECT JSON_OBJECT(
			'tableDDL' VALUE DBMS_METADATA.GET_DDL('TABLE', T.TABLE_NAME, T.OWNER),
			'countOfRecords' VALUE (SELECT COUNT(*) FROM ALL_TABLES WHERE TABLE_NAME='${i}'),
			'indexDDLs' VALUE (
				SELECT JSON_ARRAYAGG(DBMS_METADATA.GET_DDL('INDEX', INDEX_NAME, OWNER) RETURNING CLOB)
				FROM ALL_INDEXES
				WHERE TABLE_OWNER=T.OWNER
					AND TABLE_NAME=T.TABLE_NAME
					AND INDEX_NAME NOT IN (
						SELECT CONSTRAINT_NAME
						FROM ALL_CONSTRAINTS
						WHERE CONSTRAINT_TYPE='P'
						AND OWNER=T.OWNER
						AND TABLE_NAME=T.TABLE_NAME
					)
				),
			'jsonColumns' VALUE (
				SELECT JSON_ARRAYAGG(JSON_OBJECT('name' VALUE COLUMN_NAME, 'datatype' VALUE DATA_TYPE) RETURNING CLOB)
				FROM ALL_TAB_COLUMNS
				WHERE TABLE_NAME=T.TABLE_NAME
				AND OWNER=T.OWNER
				AND DATA_TYPE IN ('CLOB', 'BLOB', 'NVARCHAR2', 'JSON')
			),
			'tableComment' VALUE (
				SELECT COMMENTS
				FROM ALL_TAB_COMMENTS
				WHERE OWNER = T.OWNER AND TABLE_NAME = T.TABLE_NAME AND COMMENTS IS NOT NULL
			),
			'columnComments' VALUE (
				SELECT JSON_ARRAYAGG(JSON_OBJECT('name' VALUE COLUMN_NAME, 'comment' VALUE COMMENTS) RETURNING CLOB)
				FROM ALL_COL_COMMENTS
				WHERE OWNER = T.OWNER AND TABLE_NAME = T.TABLE_NAME  AND COMMENTS IS NOT NULL
			) RETURNING CLOB
			)
			FROM ALL_TABLES T
			WHERE T.OWNER='${e}' AND T.TABLE_NAME='${i}'
		`),n=await((s=Re.first(Re.first(r)))==null?void 0:s.getData());try{let a=JSON.parse(n);t.log("info",a,`Getting DDL from "${e}"."${i}"`);let _=a.tableComment?`COMMENT ON TABLE ${ws(e)}.${ws(i)} IS ${Xp(a.tableComment)};`:"",T=Re.map(a.columnComments,E=>`COMMENT ON COLUMN ${ws(e)}.${ws(i)}.${ws(E.name)}  IS ${Xp(E.comment)};`);return{ddl:`${a.tableDDL}
				${Re.join(a.indexDDLs,`
`)}
				${_}

				${Re.join(T,`
`)}`,jsonColumns:a.jsonColumns,countOfRecords:a.countOfRecords}}catch(a){return t.log("error",{message:`Cannot parse query result: 

`+n,error:{message:a.message,stack:a.stack,err:Re.omit(a,["message","stack"])}},`Getting DDL from "${e}"."${i}"`),{ddl:"",jsonColumns:[],countOfRecords:0}}}catch(r){if((r==null?void 0:r.errorNum)===31603&&!await Jp(t))throw r;return t.log("error",{message:"Cannot get DDL for table: "+i,error:{message:r.message,stack:r.stack,err:Re.omit(r,["message","stack"])}},`Getting DDL from "${e}"."${i}"`),{ddl:"",jsonColumns:[],countOfRecords:0}}},"getDDL"),Mg=c(i=>Object.keys(i).reduce(async(e,t)=>{let s=await e,r=i[t];return r instanceof ii.Lob&&(r=await r.getData()),r instanceof Buffer&&(r=r.toString()),s[t]=r,s},Promise.resolve({})),"readLobs"),Vg=c(async i=>await i.reduce(async(e,t)=>{let s=await e,r=await Mg(t);return s.concat(r)},Promise.resolve([])),"readRecordsValues"),ws=c(i=>/[\s\da-z]/.test(i)?`"${i}"`:i,"escapeName"),Xp=c(i=>`'${i.replaceAll("'","''")}'`,"escapeComment"),Fg=c((i,e)=>e.map(t=>i.reduce((s,r)=>(s[r]=t[r],s),{})),"replaceNames"),xg=c(async({tableName:i,limit:e,jsonColumns:t,schema:s})=>{let r=Re.map(t,_=>_.name),n=await At(`SELECT ${r.map(_=>ws(_)).join(", ")} FROM ${ws(s)}.${ws(i)} FETCH NEXT ${e} ROWS ONLY`,{outFormat:ii.OBJECT});return await Vg(Fg(r,n))},"selectRecords"),bg=c((i,e)=>{let t={number:"number",boolean:"boolean",string:"string"};return i.reduce((s,r)=>{if(s)return s;let n=r[e];return Array.isArray(n)?"array":typeof n=="object"?n?"object":"null":t[typeof n]??s},"")},"getJsonType"),kg=c(i=>`json${i.charAt(0).toUpperCase()}${i.slice(1)}`,"getJsonTypeName"),qg=c(async(i,e)=>{let t={CLOB:{type:"lobs",mode:"clob"},BLOB:{type:"lobs",mode:"blob"},NVARCHAR2:{type:"char",mode:"nvarchar2"},JSON:{type:"json"}};return{properties:i.reduce((r,n)=>{let a=n.name,_=n.datatype,T=t[_];if(!T)return r;let l=bg(e,a);if(!l)return r;let E=kg(l);return{...r,[a]:{...T,subtype:l,childType:"json",type:E}}},{})}},"getJsonSchema"),Gg=c(async(i,e,t)=>{try{let s=await Hg(i);if(await tl(),s){t.log("info",{viewName:i,schema:e},'Is materialized view"');let a=await At(`SELECT JSON_OBJECT(
					'viewDDL' VALUE DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW', MV.MVIEW_NAME, MV.OWNER),
					'indexDDLs' VALUE (
						SELECT JSON_ARRAYAGG(DBMS_METADATA.GET_DDL('INDEX', INDEX_NAME, OWNER) RETURNING CLOB)
						FROM ALL_INDEXES
						WHERE TABLE_OWNER=MV.OWNER
							AND TABLE_NAME=MV.MVIEW_NAME
							AND INDEX_NAME NOT IN (
								SELECT CONSTRAINT_NAME
								FROM ALL_CONSTRAINTS
								WHERE CONSTRAINT_TYPE='P'
								AND OWNER=MV.OWNER
								AND TABLE_NAME=MV.MVIEW_NAME
							)
						)
					)
					FROM ALL_MVIEWS MV
					WHERE MV.OWNER='${e}' AND MV.MVIEW_NAME='${i}'`),_=Re.first(Re.first(a)),T=JSON.parse(_);return t.log("info",{viewName:i,schema:e},`Getting DDL from "${e}"."${i}"`),`${T.viewDDL}
${Re.join(T.indexDDLs,`
`)}`}let r=await At(`SELECT DBMS_METADATA.GET_DDL('VIEW', VIEW_NAME, OWNER) FROM ALL_VIEWS WHERE VIEW_NAME='${i}'`);return await Re.first(Re.first(r)).getData()}catch(s){if((s==null?void 0:s.errorNum)===31603&&!await Jp(t))throw s;return t.log("error",{message:"Cannot get DDL for view: "+i,error:{message:s.message,stack:s.stack,err:Re.omit(s,["message","stack"])}},"Getting DDL"),""}},"getViewDDL"),Hg=c(async i=>{await tl();let e=await At(`SELECT * FROM ALL_MVIEWS WHERE MVIEW_NAME = '${i}'`);return!Re.isEmpty(e)},"checkEntityMaterializedView"),Jp=c(async i=>{var e;try{let t=await At("SELECT sys_context('USERENV', 'CURRENT_USER') FROM dual"),s=Re.first(Re.first(t));return((e=await At(`SELECT GRANTED_ROLE FROM USER_ROLE_PRIVS WHERE USERNAME = '${s}'`))==null?void 0:e.map(([n])=>n)).includes("SELECT_CATALOG_ROLE")}catch(t){return i.log("error",{message:"Checking user privileges error",error:{message:t.message,stack:t.stack,err:Re.omit(t,["message","stack"])}},"Getting DDL"),!1}},"checkUserHaveRequiredRole"),vg=c(i=>{i.log("info",{TNS_ADMIN:process.env.TNS_ADMIN??"",ORACLE_HOME:process.env.ORACLE_HOME??"",LD_LIBRARY_PATH:process.env.LD_LIBRARY_PATH??"",ORACLE_BASE:process.env.ORACLE_BASE??""},"Environment variables")},"logEnvironment"),Kg=c(async i=>{try{let e=await At("SELECT OWNER, SYNONYM_NAME, TABLE_OWNER, TABLE_NAME, DB_LINK FROM ALL_SYNONYMS WHERE ORIGIN_CON_ID > 1");if(Re.isEmpty(e))return[];let t=e.map(([a,_,T,l])=>({synonymSchemaName:T,synonymPublic:a==="PUBLIC",synonymName:_,synonymEntityId:l}));i.log("info",t,"Getting synonyms");let s=await Wg(),r=t.map(a=>{var l;let _=s.find(({name:E})=>E===a.synonymName),T=!((l=_==null?void 0:_.ddl)!=null&&l.toUpperCase().includes("NONEDITIONABLE"));return{...a,synonymEditionable:T?"EDITIONABLE":"NONEDITIONABLE"}});return Re.groupBy(r,"synonymSchemaName")}catch(e){i.log("error",{message:"Cannot get synonyms",error:{message:e.message,stack:e.stack,err:Re.omit(e,["message","stack"])}},"Getting synonyms")}},"getDbSynonyms"),Wg=c(async()=>{let i=await At("SELECT SYNONYM_NAME, DBMS_METADATA.GET_DDL('SYNONYM', SYNONYM_NAME, OWNER) FROM ALL_SYNONYMS WHERE ORIGIN_CON_ID > 1");return await Promise.all(i.map(async([t,s])=>{let r=await s.getData();return{name:t,ddl:r}}))},"getSynonymsDDL");Qp.exports={connect:mg,disconnect:Pg,getEntitiesNames:Lg,getSchemaNames:Ig,splitEntityNames:Ug,getDDL:Yg,getJsonSchema:qg,getViewDDL:Gg,getDbVersion:Bg,selectRecords:xg,logEnvironment:vg,execute:At,getDbSynonyms:Kg,getSchemaSequences:Ag({execute:At})}});var sf=P((eY,tf)=>{"use strict";var Ln=require("lodash"),Zp=UE(),wt=sl();tf.exports={async connect(i,e,t,s){let r=s.require("@hackolade/ssh-service");Zp("Connect to instance",i,e),wt.logEnvironment(e);try{await wt.connect(i,r,n=>{e.log("info",n,"Connection")}),t()}catch(n){throw ef(e,n,t),n}},async disconnect(i,e,t,s){try{let r=s.require("@hackolade/ssh-service");await wt.disconnect(r),t(null)}catch(r){ef(e,r,t)}},async testConnection(i,e,t,s){try{await this.connect(i,e,()=>{},s),t(null)}catch(r){e.log("error",{message:r.message,stack:r.stack,error:r},"Test connection"),t({message:r.message,stack:r.stack})}},async getSchemaNames(i,e,t,s){try{Zp("Get schemas",i,e),await this.connect(i,e,()=>{},s);let r=await wt.getSchemaNames();return e.log("info",r,"All schemas list",i.hiddenKeys),t(null,r)}catch(r){return e.log("error",{message:r.message,stack:r.stack,error:r},"Get schemas"),t({message:r.message,stack:r.stack})}},async getDbCollectionsNames(i,e,t,s){try{await this.connect(i,e,()=>{},s);let r=await wt.getEntitiesNames(i,{info:n=>{e.log("info",n,"Retrieving table and view names")},error:n=>{e.log("error",{message:n.message,stack:n.stack,error:n},"Retrieving databases and tables information")}});t(null,r)}catch(r){e.log("error",{message:r.message,stack:r.stack,error:r},"Retrieving databases and tables information"),t({message:r.message,stack:r.stack})}},async getDbCollectionsData(i,e,t,s){try{let r=c(({message:h,containerName:p="",entityName:A=""})=>{e.log("info",{message:h,schema:p,table:A},"Retrieving schema"),e.progress({message:h,containerName:p,entityName:A})},"progress");e.log("info",i,"Retrieving schema",i.hiddenKeys),r({message:"Start reverse-engineering process",containerName:"",entityName:""});let n=i.collectionData,a=n.collections,_=n.dataBaseNames,T=await wt.getDbVersion(e),l=await wt.getDbSynonyms(e),E=await _.reduce(async(h,p)=>{let A=await h,u=wt.splitEntityNames(a[p]),N=await wt.getSchemaSequences({schema:p,logger:e}),d=await u.tables.reduce(async(m,O)=>{let U=await m;r({message:"Start getting data from table",containerName:p,entityName:O});let{ddl:V,countOfRecords:G,jsonColumns:z}=await wt.getDDL(O,p,e),C=[],q={};if(!Ln.isEmpty(z)){let R=Xg(G,i.recordSamplingSettings);r({message:`Fetching columns for JSON schema inference: ${JSON.stringify(z)}`,containerName:p,entityName:O}),C=await wt.selectRecords({tableName:O,limit:R,jsonColumns:z,schema:p}),q=await wt.getJsonSchema(z,C)}return r({message:"Data retrieved successfully",containerName:p,entityName:O}),U.concat({dbName:p,collectionName:O,entityLevel:{},documents:C,views:[],ddl:{script:V,type:"oracle",takeAllDdlProperties:!0},emptyBucket:!1,validation:{jsonSchema:q},bucketInfo:{database:p,synonyms:(l==null?void 0:l[p])||[],sequences:N}})},Promise.resolve([])),S=await u.views.reduce(async(m,O)=>{let U=await m;r({message:"Start getting data from view",containerName:p,entityName:O});let V=await wt.getViewDDL(O,p,e);return r({message:"Data retrieved successfully",containerName:p,entityName:O}),U.concat({name:O,data:{},ddl:{script:V,type:"oracle",takeAllDdlProperties:!0}})},Promise.resolve([]));if(Ln.isEmpty(S))return[...A,...d];let D={dbName:p,entityLevel:{},views:S,emptyBucket:!1,bucketInfo:{indexes:[],database:p,synonyms:(l==null?void 0:l[p])||[],sequences:N}};return[...A,...d,D]},Promise.resolve([]));r({message:"Start processing the retrieved data in the application ..."}),t(null,E.filter(Boolean),{version:T})}catch(r){if((r==null?void 0:r.errorNum)===31603)return e.log("error",{message:"Missing required role \u201CSELECT_CATALOG_ROLE\u201D to perform this operation",stack:r.stack,error:r},"Reverse-engineering process failed"),t({message:"Missing required role \u201CSELECT_CATALOG_ROLE\u201D to perform this operation",type:"simpleError"});e.log("error",{message:r.message,stack:r.stack,error:r},"Reverse-engineering process failed"),t({message:r.message,stack:r.stack})}}};var ef=c((i,e,t)=>{let s=Ln.isString(e)?e:Ln.get(e,"message","Reverse Engineering error");i.log("error",{error:e},"Reverse Engineering error"),t(s)},"handleError"),Xg=c((i,e)=>{if(e.active==="absolute")return Number(e.absolute.value);let t=Math.ceil(i*e.relative.value/100);return Math.min(t,e.maxValue)},"getSampleDocSize")});var nf=P((sY,rf)=>{"use strict";var rl=sl(),il=require("lodash"),zg=c(async(i,e,t)=>{let s=t.require("async"),r=t.require("@hackolade/ssh-service");rl.logEnvironment(e),await rl.connect(i,r,_=>{e.log("info",_,"Connection")});let n=i.script.split(`

`).filter(Boolean).map(_=>il.trim(il.trim(il.trim(_),"/"),";")),a;if(await s.mapSeries(n,async _=>{try{_.endsWith("END")&&(_+=";");let T="Query: "+_.split(`
`).shift().substr(0,150);e.progress({message:T}),e.log("info",{message:T},"Apply to instance"),await rl.execute(_)}catch(T){let l=T.errorNum===955,E=T.errorNum===1920;if(l||E)return;a=T,e.progress({message:"[color:red]Not executed..."}),e.log("error",{message:T.message,stack:T.stack,query:_},"Error applying to instance")}}),a)throw new Error(`Not all statements executed successfully.
Please, see HackoladeFE.log for more details.`)},"applyToInstance");rf.exports={applyToInstance:zg}});var Ft=P((iY,of)=>{"use strict";var al=class al{script;isDropScript};c(al,"ModificationScript");var nl=al,_l=class _l{isActivated;scripts;static getInstances(e,t,s){return(e||[]).filter(Boolean).map(r=>({isActivated:t,scripts:[{isDropScript:s,script:r}]}))}static getInstance(e,t,s){var r;if((r=e==null?void 0:e.filter(Boolean))!=null&&r.length)return{isActivated:t,scripts:e.filter(Boolean).map(n=>({isDropScript:s,script:n}))}}static getDropAndRecreateInstance(e,t,s){let r=[];if(e&&r.push({isDropScript:!0,script:e}),t&&r.push({isDropScript:!1,script:t}),!!(r!=null&&r.length))return{isActivated:s,scripts:r}}};c(_l,"AlterScriptDto");var ol=_l;of.exports={ModificationScript:nl,AlterScriptDto:ol}});var le=P((aY,af)=>{"use strict";var oY=require("lodash");af.exports=i=>{let e=c(R=>i.get(R,"[0].code")||i.get(R,"[0].name",""),"getDbName"),t=c(R=>R&&(R.code||R.collectionName)||"","getEntityName"),s=c(R=>R&&(R.code||R.name)||"","getViewName"),r=c(R=>R&&(R.code||R.name)||"","getBucketName"),n=c(R=>({...i.get(R,"[0]",{}),name:e(R)}),"getDbData"),a=c(R=>i.get(R,"[0].viewOn"),"getViewOn"),_=c(R=>B=>B.primaryTableId===R&&B.primaryTableId!==B.foreignTableId,"isRecursiveRelationship"),T=c(R=>Object.keys(R).reduce((B,x)=>{let J=R[x].filter(re=>{let k=R[re.primaryTableId];return Array.isArray(k)?!k.some(_(x)):!0});return i.isEmpty(J)?B:{...B,[x]:J}},{}),"rejectRecursiveRelationships"),l=c(R=>Object.keys(R).reduce((B,x)=>{let J=R[x].filter(re=>{let k=R[re.primaryTableId];return Array.isArray(k)?k.some(_(x)):!1});return B.concat(J)},[]),"filterRecursiveRelationships"),E=c((R,B="	")=>R.split(`
`).map(x=>B+x).join(`
`),"tab"),h=c((R,B)=>Object.keys(R).map(i.toLower).includes(i.toLower(B)),"hasType"),p=c(R=>Object.entries(R).filter(([B,x])=>!i.isNil(x)).reduce((B,[x,J])=>({...B,[x]:J}),{}),"clean"),A=c(R=>R.every(B=>i.get(B,"isActivated",!0)),"checkAllKeysActivated"),u=c(R=>R.length?R.every(B=>!i.get(B,"isActivated",!0)):!1,"checkAllKeysDeactivated"),N=c((R,B)=>{let x=R.filter(re=>i.get(re,"isActivated",!0)).map(B),J=R.filter(re=>!i.get(re,"isActivated",!0)).map(B);return{activatedItems:x,deactivatedItems:J}},"divideIntoActivatedAndDeactivated"),d=c((R,{isActivated:B,isPartOfLine:x,inlineComment:J="--"})=>B!==!1?R:x?"/* "+R+" */":R.includes(`
`)?`/*
`+R+` */
`:J+" "+R,"commentIfDeactivated"),S=c((R,B="'",x="'")=>{let J=R[0];return R[R.length-1]===B&&J===x?R:`${B}${R}${x}`},"wrap"),D=c(R=>`"${R}"`,"wrapInQuotes"),m=c(R=>B=>R==="nonquotedIdentifier"?B:D(B),"prepareNameForScriptFormat"),O=c(R=>`'${R}'`,"wrapComment"),U=c(R=>(B,x)=>x?`${m(R)(x)}.${m(R)(B)}`:m(R)(B),"getNamePrefixedWithSchemaNameForScriptFormat"),V=c((R,B)=>B.some(x=>(R==null?void 0:R.oldField[x])!==(R==null?void 0:R.newField[x])),"checkFieldPropertiesChanged"),G=c(({name:R})=>D(R),"columnMapToString");return{getDbName:e,getBucketName:r,getDbData:n,getEntityName:t,getViewName:s,getViewOn:a,rejectRecursiveRelationships:T,filterRecursiveRelationships:l,tab:E,hasType:h,clean:p,checkAllKeysActivated:A,checkAllKeysDeactivated:u,divideIntoActivatedAndDeactivated:N,commentIfDeactivated:d,wrap:S,wrapComment:O,wrapInQuotes:D,getNamePrefixedWithSchemaNameForScriptFormat:U,checkFieldPropertiesChanged:V,getColumnsList:c((R,B,x,J=G)=>{var Ee;let re=N(R,J),k=(Ee=re==null?void 0:re.deactivatedItems)!=null&&Ee.length?d(re.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!B&&x?" ("+re.activatedItems.join(", ")+k+")":" ("+R.map(J).join(", ")+")"},"getColumnsList"),escapeSingleQuote:c(R=>R.replaceAll("'","''"),"escapeSingleQuote"),getGroupItemsByCompMode:c(({newItems:R=[],oldItems:B=[]})=>{let x=R.filter(k=>!B.some(Ee=>Ee.id===k.id)),J=[],re=[];return B.forEach(k=>{let Ee=R.find(M=>M.id===k.id);Ee?i.isEqual(Ee,k)||re.push(Ee):J.push(k)}),{added:x,removed:J,modified:re}},"getGroupItemsByCompMode"),prepareNameForScriptFormat:m}}});var lf=P((cY,Tf)=>{"use strict";var{AlterScriptDto:_f}=Ft(),cf=require("lodash"),$g=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(cf),n=`CREATE USER ${s(e)(t)} NO AUTHENTICATION;`;return _f.getInstance([n],!0,!1)},"getAddContainerScriptDto"),jg=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(cf),n=`DROP USER ${s(e)(t)};`;return _f.getInstance([n],!0,!0)},"getDeleteContainerScriptDto");Tf.exports={getAddContainerScriptDto:$g,getDeleteContainerScriptDto:jg}});var uf=P((lY,Ef)=>{"use strict";var{AlterScriptDto:Jg}=Ft(),Qg=c((i,e,t)=>s=>{var p;let{checkFieldPropertiesChanged:r,prepareNameForScriptFormat:n,getNamePrefixedWithSchemaNameForScriptFormat:a,getEntityName:_}=le()(i),T={...s,...i.omit(s==null?void 0:s.role,"properties")||{}},l=_(T),E=(p=T.compMod)==null?void 0:p.keyspaceName,h=a(t)(l,E);return i.toPairs(s.properties).filter(([A,u])=>r(u.compMod,["type","mode"])).map(([A,u])=>`ALTER TABLE ${h} MODIFY (${n(t)(A)} ${i.toUpper(u.compMod.newField.mode||u.compMod.newField.type)});`).map(A=>Jg.getInstance([A],!0,!1))},"getUpdateTypesScriptDtos");Ef.exports={getUpdateTypesScriptDtos:Qg}});var Nf=P((uY,hf)=>{"use strict";var{AlterScriptDto:Zg}=Ft(),ey=c((i,e,t)=>s=>{var p;let{checkFieldPropertiesChanged:r,getEntityName:n,getNamePrefixedWithSchemaNameForScriptFormat:a,prepareNameForScriptFormat:_}=le()(i),T={...s,...i.omit(s==null?void 0:s.role,"properties")||{}},l=n(T),E=(p=T.compMod)==null?void 0:p.keyspaceName,h=a(t)(l,E);return i.values(s.properties).filter(A=>r(A.compMod,["name"])).map(A=>{let u=_(t)(A.compMod.oldField.name),N=_(t)(A.compMod.newField.name);return e.renameColumn(h,u,N)}).map(A=>Zg.getInstance([A],!0,!1))},"getRenameColumnScriptDtos");hf.exports={getRenameColumnScriptDtos:ey}});var Bn=P((NY,Sf)=>{"use strict";var ll=class ll{type;keyId};c(ll,"AlterIndexKeyDto");var cl=ll,El=class El{id;indxName;isActivated;ifNotExist;indxType;indxKey;column_expression;tablespace;index_properties;index_attributes;index_compression;logging_clause;indxComments};c(El,"AlterIndexDto");var Tl=El;Sf.exports={AlterIndexDto:Tl,AlterIndexKeyDto:cl}});var df=P((dY,Af)=>{"use strict";var{AlterIndexDto:AY}=Bn(),pl=class pl{id;constraintName;indexStorageParameters;indexTablespace;indexInclude};c(pl,"AlterCollectionColumnPrimaryKeyOptionDto");var ul=pl,fl=class fl{type;isActivated;primaryKey;unique;mode;length;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;primaryKeyOptions;triggerUpdateColumns;compMod;GUID};c(fl,"AlterCollectionColumnDto");var hl=fl,ml=class ml extends ul{compositePrimaryKey};c(ml,"AlterCollectionRoleCompModPKDto");var Nl=ml,Pl=class Pl{new;old};c(Pl,"AlterCollectionRoleCompModPrimaryKey");var Sl=Pl,Rl=class Rl{id;type;collectionName;properties;definitions;isActivated;additionalProperties;memory_optimized;collectionUsers;ifNotExist;on_commit;table_tablespace_name;bucketId;compMod;name;roleType;patternProperties};c(Rl,"AlterCollectionRoleDto");var Al=Rl,Il=class Il{type;isActivated;unique;subtype;properties;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};c(Il,"AlterCollectionDto");var dl=Il;Af.exports={AlterCollectionDto:dl,AlterCollectionRoleDto:Al,AlterCollectionColumnDto:hl,AlterCollectionRoleCompModPrimaryKey:Sl,AlterCollectionRoleCompModPKDto:Nl}});var Pf=P((PY,mf)=>{"use strict";var{AlterScriptDto:yr}=Ft(),{AlterCollectionDto:fY}=df(),{AlterIndexDto:mY}=Bn(),{prepareNameForScriptFormat:Dl}=le()(),ty=["index_compression","tablespace","logging_clause"],sy=["indxType","indxKey","column_expression","index_properties","index_attributes"],ry=c(({_:i})=>({oldIndex:e,newIndex:t})=>sy.some(s=>!i.isEqual(e[s],t[s])),"shouldDropAndRecreateIndex"),iy=c(({oldIndex:i,newIndex:e})=>ty.some(t=>i[t]!==e[t]),"shouldAlterIndexRebuild"),Cl=c(({oldIndex:i,newIndex:e})=>i.id===e.id||i.indxName===e.indxName,"areOldIndexDtoAndNewIndexDtoDescribingSameDatabaseIndex"),pf=c(({index:i,collection:e})=>{var t;return(t=i==null?void 0:i.indxKey)!=null&&t.length?{...i,indxKey:i.indxKey.map(s=>{var T,l,E,h,p,A;if(!(s!=null&&s.keyId))return s;let r=Object.entries(((T=e==null?void 0:e.role)==null?void 0:T.properties)||(e==null?void 0:e.properties)||{}).map(([u,N])=>({...N,name:u})),n=(((E=(l=e==null?void 0:e.role)==null?void 0:l.compMod)==null?void 0:E.oldProperties)||[]).map(u=>({...u,GUID:u.id})),_=(r.length>0?r:n).find(u=>(u==null?void 0:u.GUID)===(s==null?void 0:s.keyId));return _?(h=_==null?void 0:_.compMod)!=null&&h.newField?{...s,name:((A=(p=_==null?void 0:_.compMod)==null?void 0:p.newField)==null?void 0:A.name)||null}:{...s,name:_.name}:s})}:i},"addNameToIndexKey"),ny=c(({_:i,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{var _,T,l,E,h,p;let r=((l=(T=(_=s==null?void 0:s.role)==null?void 0:_.compMod)==null?void 0:T.Indxs)==null?void 0:l.new)||[];return(((p=(h=(E=s==null?void 0:s.role)==null?void 0:E.compMod)==null?void 0:h.Indxs)==null?void 0:p.old)||[]).filter(A=>!r.find(N=>Cl({oldIndex:A,newIndex:N}))).map(A=>oy({ddlProvider:e,scriptFormat:t})({index:A,collection:s}))},"getDeletedIndexesScriptDtos"),oy=c(({ddlProvider:i,scriptFormat:e})=>({index:t})=>{let s=Dl(e)(t.indxName),r=i.dropIndex({name:s});return yr.getInstance([r],t.isActivated,!0)},"getDeleteIndexScriptDto"),ff=c(({_:i,ddlProvider:e})=>({collection:t})=>{var a,_,T,l;let s=((a=t==null?void 0:t.role)==null?void 0:a.Indxs)||[],r=((l=(T=(_=t==null?void 0:t.role)==null?void 0:_.compMod)==null?void 0:T.Indxs)==null?void 0:l.old)||[];return s.filter(E=>!r.find(p=>Cl({oldIndex:p,newIndex:E}))).map(E=>ay({ddlProvider:e})({index:E,collection:t}))},"getAddedIndexesScriptDtos"),ay=c(({ddlProvider:i})=>({index:e,collection:t})=>{var a,_,T,l,E,h,p;let s=pf({index:e,collection:t}),r=((T=(_=(a=t==null?void 0:t.role)==null?void 0:a.compMod)==null?void 0:_.collectionName)==null?void 0:T.new)||((l=t==null?void 0:t.role)==null?void 0:l.name),n=i.createIndex(r,{...s,schemaName:(p=(h=(E=t==null?void 0:t.role)==null?void 0:E.compMod)==null?void 0:h.bucketProperties)==null?void 0:p.name});return yr.getInstance([n],e.isActivated,!1)},"getAddIndexScriptDto"),_y=c(({_:i,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{var _,T,l,E,h,p;let r=((l=(T=(_=s==null?void 0:s.role)==null?void 0:_.compMod)==null?void 0:T.Indxs)==null?void 0:l.new)||[],n=((p=(h=(E=s==null?void 0:s.role)==null?void 0:E.compMod)==null?void 0:h.Indxs)==null?void 0:p.old)||[];return r.map(A=>{let u=n.find(N=>Cl({oldIndex:N,newIndex:A}));if(u)return{newIndex:A,oldIndex:u}}).filter(Boolean).flatMap(A=>cy({_:i,ddlProvider:e,scriptFormat:t})({modifiedIndex:A,collection:s}))},"getModifiedIndexesScriptDtos"),cy=c(({_:i,ddlProvider:e,scriptFormat:t})=>({modifiedIndex:{oldIndex:s,newIndex:r},collection:n})=>{var E,h,p,A,u,N;let a=Dl(t)(s.indxName),_=Dl(t)(r.indxName),T=[];if(ry({_:i})({oldIndex:s,newIndex:r})){let d=yr.getInstance([e.dropIndex({name:a})],r.isActivated,!0),S=pf({index:r,collection:n}),D=yr.getInstance([e.createIndex((p=(h=(E=n==null?void 0:n.role)==null?void 0:E.compMod)==null?void 0:h.collectionName)==null?void 0:p.new,{...S,schemaName:(N=(u=(A=n==null?void 0:n.role)==null?void 0:A.compMod)==null?void 0:u.bucketProperties)==null?void 0:N.name})],r.isActivated,!1);return T.push(d,D),T}if(s.indxName!==r.indxName){let d=yr.getInstance([e.alterIndexRename({oldName:a,newName:_})],r.isActivated,!1);T.push(d)}if(iy({oldIndex:s,newIndex:r})){let d=yr.getInstance([e.alterIndexRebuild({name:_,indexData:r})],r.isActivated,!1);T.push(d)}return T},"getModifyIndexScriptDto"),Ty=c(({_:i,ddlProvider:e,scriptFormat:t})=>({collection:s})=>{let r=ny({_:i,ddlProvider:e,scriptFormat:t})({collection:s}),n=ff({_:i,ddlProvider:e})({collection:s}),a=_y({_:i,ddlProvider:e,scriptFormat:t})({collection:s});return[...r,...n,...a].filter(Boolean)},"getModifyIndexesScriptDtos");mf.exports={getModifyIndexesScriptDtos:Ty,getAddedIndexesScriptDtos:ff}});var ni=P((IY,Rf)=>{"use strict";Rf.exports=i=>{let e=require("lodash"),{createColumnDefinition:t}=i.require("@hackolade/ddl-fe-utils"),s=c(n=>n.$ref?n.$ref.split("/").pop():e.toUpper(n.mode||n.childType||n.type),"getType");return{createColumnDefinitionBySchema:c(({name:n,jsonSchema:a,parentJsonSchema:_,ddlProvider:T,schemaData:l,definitionJsonSchema:E})=>t({name:n,jsonSchema:a,parentJsonSchema:_,ddlProvider:T,schemaData:l,definitionJsonSchema:E,getType:s}),"createColumnDefinitionBySchema")}}});var Df=P((CY,If)=>{"use strict";If.exports={number:"numeric",string:"nvarchar2",date:"date",timestamp:"timestamp",binary:"raw",boolean:"numeric",document:"bfile",array:"json",objectId:"char",default:"nvarchar2"}});var Of=P((OY,Cf)=>{"use strict";Cf.exports={character:{type:"char"},"character varying":{type:"varchar"},"char varying":{type:"varchar"},"national char":{type:"nchar"},"national character":{type:"nchar"},"national char varying":{type:"nvarchar2"},"national character varying":{type:"nvarchar2"},"nchar varying":{type:"nvarchar2"},tinyint:{type:"number",precision:5},"small int":{type:"number",precision:5},shortinteger:{type:"number",precision:5},shortint:{type:"number",precision:5},smallint:{type:"number",precision:5},int:{type:"number",precision:10},integer:{type:"number",precision:10},shortdecimal:{type:"number",precision:5,scale:0},decimal:{type:"number",precision:5,scale:0},longinteger:{type:"number",precision:20},bigint:{type:"number",precision:20},int8:{type:"number",precision:20},bit:{type:"number",precision:1},real:{type:"float",length:23},"double precision":{type:"number"},"small money":{type:"float",precision:16,scale:2},money:{type:"float",precision:16,scale:2},"long varchar":{type:"long"},text:{type:"long"},ntext:{type:"long"},uniqueidentifier:{type:"char",length:36},uuid:{type:"char",length:36},datetime:{type:"date"},"small datetime":{type:"date"},image:{type:"long raw"},binary:{type:"raw"},varbinary:{type:"raw"},string:{type:"nvarchar2"}}});var Ol=P((gY,gf)=>{"use strict";gf.exports={createSchema:"CREATE USER${ifNotExists} ${schemaName} NO AUTHENTICATION",comment:"\nCOMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${tableType} TABLE${ifNotExists} ${name}${tableProps}\n${options}",createTableProps:"${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}",columnDefinition:"${name}${type}${default}${encrypt}${constraints}",createKeyConstraint:"${constraintName}${keyType}${columns}${options}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete}",checkConstraint:"${name}CHECK (${expression})",createForeignKey:"ALTER TABLE ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${onDelete};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",createIndex:"CREATE${indexType} INDEX${ifNotExists}${name} ON ${tableName}${keys}${options};\n",dropIndex:"DROP INDEX ${name};",alterIndexRename:"ALTER INDEX ${oldName} RENAME TO ${newName};",alterIndexRebuild:"ALTER INDEX ${name} REBUILD ${options};",createView:"CREATE${orReplace}${force}${viewType}${materialized} VIEW${ifNotExists} ${name} ${sharing}${viewProperties}\n	AS ${selectStatement}",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createObjectType:`CREATE OR REPLACE TYPE \${name} AS OBJECT 
(
	\${properties}
);
`,objectTypeColumnDefinition:"${name} ${type}",createCollectionType:"CREATE OR REPLACE TYPE ${name} IS ${collectionType}${size} OF (${datatype})${notPersistable};\n",ifNotExists:`DECLARE
BEGIN
	EXECUTE IMMEDIATE '\${statement}';
	EXCEPTION WHEN OTHERS THEN
		IF SQLCODE = -\${errorCode} THEN NULL; ELSE RAISE; END IF;
END;
/
`,createSynonym:"CREATE${orReplace}${editionable}${public} SYNONYM ${name}\n	FOR ${objectName};\n",renameColumn:"ALTER TABLE ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",createSequence:"CREATE SEQUENCE${ifNotExists} ${name}${sharing}${options}",dropSequence:"DROP SEQUENCE${ifExists} ${name};\n",renameSequence:"RENAME ${name} TO ${newName};\n",alterSequence:"ALTER SEQUENCE${ifExists} ${name}${options};\n",dualityView:{createJsonRelationalDualityViewHeading:"CREATE${orReplaceStatement}${forceStatement}${editionableStatement} JSON RELATIONAL DUALITY VIEW ${viewName} AS",sql:{tableTagsStatement:"WITH${checkStatement}${etagStatement}${insertStatement}${updateStatement}${deleteStatement}",columnTagsStatement:"WITH${checkStatement}${etagStatement}${updateStatement}",fromTableStatement:"FROM ${tableName}${tableAlias}${tableTagsStatement}${whereClauseStatement}"}},alterSession:"ALTER SESSION SET CURRENT_SCHEMA=${schemaName};\n"}});var gl=P((yY,yf)=>{"use strict";var ly=Object.freeze({SQL:"SQL",GRAPHQL:"GRAPHQL"});yf.exports={DualityViewSyntaxType:ly}});var yl=P((LY,Lf)=>{"use strict";var Ey=Object.freeze({JOIN_SUBQUERY_TYPE:"joinSubquery",COLLECTION_REFERENCE:"collectionReference"});Lf.exports={DualityViewPropertiesType:Ey}});var Uf=P((BY,wf)=>{"use strict";var{DualityViewPropertiesType:Bf}=yl(),Kt=class Kt{constructor(e,t,s,r,n){if(this.constructor===Kt)throw new Error("Abstract classes can't be instantiated.");this._ddlTemplates=e,this._assignTemplates=t,this._lodash=s,this._prepareName=r,this._getNamePrefixedWithSchemaName=n}static padInFront(e){return` ${e}`}static padInFrontAndUppercaseIfExists(e){return e?Kt.padInFront(e).toUpperCase():""}static isDualityView(e={}){return e.viewOn&&e.duality}static isJoinSubquery(e={}){return(e==null?void 0:e.type)===Bf.JOIN_SUBQUERY_TYPE}static isFlexColumn(e={}){return e.flexColumn}static isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e={}){let{ref:t,refIdPath:s,refType:r}=e;return t&&(s||[]).length===2&&r===Bf.COLLECTION_REFERENCE}static isRegularDualityViewFieldInArraySubquery(e={}){let{ref:t,refId:s}=e;return t&&s}static isRegularDualityViewField(e={}){return Kt.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)||Kt.isRegularDualityViewFieldInArraySubquery(e)}static getPathToReferencedColumn(e,t){let s=[];return Kt.isRegularDualityViewFieldOnRootLevelOrInObjectSubquery(e)?s=e.refIdPath:Kt.isRegularDualityViewFieldInArraySubquery(e)&&(s=[...t.joinedCollectionRefIdPath||[],e.ref]),s}static getRegularFieldNameFromCollection(e,t){if(e.length<2)throw new Error("Cannot extract referenced column name");let s=e[0],r=e[1],n=t[s],a=(n==null?void 0:n.properties)||{};for(let _ of Object.keys(a))if(a[_].GUID===r)return _;return""}static getKeyValueFrontPadding(e){return"	".repeat(e)}_getForceStatement(e){return Kt.padInFrontAndUppercaseIfExists(e.force)}_getOrReplaceStatement(e){return e.orReplace?" OR REPLACE":""}_getEditionableStatement(e){return Kt.padInFrontAndUppercaseIfExists(e.editionable)}static getRegularFieldName(e,t){return t.code||e||t.referencedColumnName}getCreateJsonRelationalDualityViewHeadingDdl(e){var p,A;let{jsonSchema:t,view:s}=e,{getViewName:r}=le()(this._lodash),n=((A=(p=this._ddlTemplates)==null?void 0:p.dualityView)==null?void 0:A.createJsonRelationalDualityViewHeading)||"",a=this._getOrReplaceStatement(s),_=this._getForceStatement(t),T=this._getEditionableStatement(t),l=r(s),E=this._getNamePrefixedWithSchemaName(l,s.schemaName),h={orReplaceStatement:a,forceStatement:_,editionableStatement:T,viewName:E};return this._assignTemplates(n,h)}getDualityViewBodyDdl(e){throw new Error("Not implemented")}convertDualityViewToDdl(e){let t=this.getCreateJsonRelationalDualityViewHeadingDdl(e),s=this.getDualityViewBodyDdl(e);return t+`
`+s+`
`}};c(Kt,"AbstractDualityViewFeDdlCreator");var Ll=Kt;wf.exports={AbstractDualityViewFeDdlCreator:Ll}});var Mf=P((UY,Yf)=>{"use strict";var{AbstractDualityViewFeDdlCreator:ge}=Uf(),wl=class wl extends ge{_getFromRootTableAliasStatement(e){if(e.rootTableAlias){let t=this._prepareName(e.rootTableAlias);return ge.padInFront(t)}return""}_getFromChildTableAliasStatement(e){if(e.childTableAlias){let t=this._prepareName(e.childTableAlias);return ge.padInFront(t)}return""}_getCheckStatement(e){return ge.padInFrontAndUppercaseIfExists(e.check)}_getEtagStatement(e){let t=e.etag?"etag":"";return ge.padInFrontAndUppercaseIfExists(t)}_getDeleteStatement(e){return ge.padInFrontAndUppercaseIfExists(e.delete)}_getInsertStatement(e){return ge.padInFrontAndUppercaseIfExists(e.insert)}_getUpdateStatement(e){return ge.padInFrontAndUppercaseIfExists(e.update)}_getTableTagsStatement(e){let t=e.tableTagsClause||{},s=this._getCheckStatement(t),r="";s&&(r=this._getEtagStatement(t));let n=this._getInsertStatement(t),a=this._getUpdateStatement(t),_=this._getDeleteStatement(t),T={checkStatement:s,etagStatement:r,insertStatement:n,updateStatement:a,deleteStatement:_};if(Object.values(T).some(E=>E==null?void 0:E.length)){let E=this._ddlTemplates.dualityView.sql.tableTagsStatement,h=this._assignTemplates(E,T);return ge.padInFront(h)}return""}_getColumnTagsStatement(e){let t=e.columnTagsClause||{},s=this._getCheckStatement(t),r="";s&&(r=this._getEtagStatement(t));let n=this._getUpdateStatement(t),a={checkStatement:s,etagStatement:r,updateStatement:n};if(Object.values(a).some(T=>T==null?void 0:T.length)){let T=this._ddlTemplates.dualityView.sql.columnTagsStatement,l=this._assignTemplates(T,a);return ge.padInFront(l)}return""}_getFromRootTableStatement(e){var T;let t=this._getNamePrefixedWithSchemaName(e.tableName,e.schemaName),s=this._getFromRootTableAliasStatement(e),r=this._getTableTagsStatement(e),n=(T=e.whereClause)==null?void 0:T.trim(),a=n?`
WHERE ${n} WITH CHECK OPTION`:"",_=this._ddlTemplates.dualityView.sql.fromTableStatement;return this._assignTemplates(_,{tableName:t,tableAlias:s,tableTagsStatement:r,whereClauseStatement:a})}_getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:t,bodyPadding:s}){let r=this._lodash.first(e.joinedCollectionRefIdPath);if(!r)throw new Error("Specify child table for all join subqueries");let n=t[r],{getEntityName:a}=le()(this._lodash),_=a(n),T=n.bucketName,l=this._getNamePrefixedWithSchemaName(_,T),E=this._getFromChildTableAliasStatement(e),h=this._getTableTagsStatement(e),p=this._ddlTemplates.dualityView.sql.fromTableStatement,u=[this._assignTemplates(p,{tableName:l,tableAlias:E,tableTagsStatement:h})];return e.whereClause&&u.push(`WHERE ${e.whereClause}`),u.map(N=>`${s}${N}`).join(`
`)}_getNameOfReferencedColumnForDdl(e,t,s){let{getEntityName:r}=le()(this._lodash);if(ge.isDualityView(e)){let n=e.rootTableAlias||e.tableName;return this._getNamePrefixedWithSchemaName(t,n)}if(ge.isJoinSubquery(e)){if(e.childTableAlias){let a=e.childTableAlias;return this._getNamePrefixedWithSchemaName(t,a)}let n=this._lodash.first(e.joinedCollectionRefIdPath);if(n){let a=s[n],_=r(a);return this._getNamePrefixedWithSchemaName(t,_)}}return""}_getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:r,relatedSchemas:n}){let{wrap:a}=le()(this._lodash),_=ge.getKeyValueFrontPadding(r),T=ge.getRegularFieldName(e,t),l=a(T,"'","'"),E=ge.getPathToReferencedColumn(t,s),h=ge.getRegularFieldNameFromCollection(E,n),p=this._getNameOfReferencedColumnForDdl(s,h,n),A=this._getColumnTagsStatement(t);return`${_}${l}: ${p}${A}`}_getJoinSubqueryValueStatement({propertyJsonSchema:e,paddingFactor:t,relatedSchemas:s}){let r=t+1,n=t+2,a=this._getObjectGenStatement({paddingFactor:n,relatedSchemas:s,jsonSchema:e}),_=ge.getKeyValueFrontPadding(r),l=[`${_}SELECT${a}`],E=this._getFromChildTableStatement({joinSubqueryJsonSchema:e,relatedSchemas:s,bodyPadding:_});return l.push(E),l.join(`
`)}_shouldUnnestJoinSubquery(e){let t=this._lodash.toUpper(e.sqlJsonFunction),s=this._lodash.toLower(e.subtype);return t==="JSON_OBJECT"||s==="object"?!!e.unnestSubquery:!1}_getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:s,relatedSchemas:r}){let{wrap:n}=le()(this._lodash),a=this._getJoinSubqueryValueStatement({relatedSchemas:r,paddingFactor:s,propertyJsonSchema:t}),_=ge.getKeyValueFrontPadding(s),T=this._getObjectGenStatementJsonKeywordConfig(t),l=T.surroundingBrackets[0],E=T.surroundingBrackets[1];if(this._shouldUnnestJoinSubquery(t))return`${_}UNNEST ${l}
${a}
${_}${E}`;let p=this._getJoinSubqueryName(e,t),A=n(p,"'","'");return`${_}${A} : ${l}
${a}
${_}${E}`}_getJoinSubqueryName(e,t){return t.name||e}_buildKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:r,relatedSchemas:n}){return ge.isFlexColumn(t)?this._getFlexColumnStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:r}):ge.isRegularDualityViewField(t)?this._getRegularFieldKeyValueStatement({propertyName:e,propertyJsonSchema:t,parent:s,paddingFactor:r,relatedSchemas:n}):ge.isJoinSubquery(t)?this._getJoinSubqueryKeyValueStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:r,relatedSchemas:n}):""}_getKeyValueStatement({jsonSchema:e,relatedSchemas:t,paddingFactor:s}){var T;let r=[],n=e.properties||((T=e.items)==null?void 0:T.properties)||{},a=this._lodash.toPairs(n);for(let[l,E]of a){let h=this._buildKeyValueStatement({propertyName:l,propertyJsonSchema:E,parent:e,paddingFactor:s,relatedSchemas:t});r.push(h)}return`
${r.join(`,
`)}
`}_getObjectGenStatementJsonKeywordConfig(e){if(!ge.isJoinSubquery(e))return{jsonKeyword:"JSON",surroundingBrackets:["",""],jsonKeywordBrackets:["{","}"]};let t=this._lodash.toUpper(e.sqlJsonFunction);return t==="JSON_OBJECT"?{jsonKeyword:t,surroundingBrackets:["(",")"],jsonKeywordBrackets:["(",")"]}:t==="JSON_ARRAYAGG"?{jsonKeyword:t,surroundingBrackets:["(",")"],jsonKeywordBrackets:["( JSON {","})"]}:this._lodash.toLower(e.subtype)==="array"?{jsonKeyword:"JSON",surroundingBrackets:["[","]"],jsonKeywordBrackets:["{","}"]}:{jsonKeyword:"JSON",surroundingBrackets:["(",")"],jsonKeywordBrackets:["{","}"]}}_getObjectGenStatement({relatedSchemas:e,paddingFactor:t,jsonSchema:s}){let r=this._getKeyValueStatement({relatedSchemas:e,paddingFactor:t,jsonSchema:s}),n=ge.getKeyValueFrontPadding(t-1),a=this._getObjectGenStatementJsonKeywordConfig(s),_=a.jsonKeywordBrackets[0],T=a.jsonKeywordBrackets[1],l=`${a.jsonKeyword} ${_}\${keyValueStatement}${n}${T}`,E=this._assignTemplates(l,{keyValueStatement:r});return ge.padInFront(E)}getDualityViewBodyDdl(e){let{view:t,jsonSchema:s,relatedSchemas:r}=e,_=[`SELECT${this._getObjectGenStatement({jsonSchema:s,paddingFactor:1,relatedSchemas:r})}`],T=this._getFromRootTableStatement(t);return _.push(T+";"),_.join(`
`)}_getFlexColumnStatement({propertyName:e,propertyJsonSchema:t,paddingFactor:s}){let{wrap:r}=le()(this._lodash),n=ge.getKeyValueFrontPadding(s),a=ge.getRegularFieldName(e,t),_=r(a,'"','"');return`${n}${_} AS FLEX COLUMN`}};c(wl,"SqlDualityViewDdlCreator");var Bl=wl;Yf.exports={SqlDualityViewDdlCreator:Bl}});var Ff=P((MY,Vf)=>{"use strict";var{DualityViewSyntaxType:uy}=gl(),{SqlDualityViewDdlCreator:hy}=Mf(),Yl=class Yl{static getCreatorInstance(e,{ddlTemplates:t,assignTemplates:s,lodash:r,prepareName:n,getNamePrefixedWithSchemaName:a}){switch(e==null?void 0:e.toUpperCase()){case uy.SQL:return new hy(t,s,r,n,a);default:throw new Error(`Unknown syntax config: ${e}`)}}};c(Yl,"DualityViewDdlCreatorFactory");var Ul=Yl;Vf.exports={DualityViewDdlCreatorFactory:Ul}});var Ml=P((FY,xf)=>{"use strict";var Ny=Object.freeze({IF_NOT_EXISTS_SINCE:23,JSON_TYPE_SINCE:21});xf.exports={DbVersion:Ny}});var qf=P((xY,kf)=>{"use strict";var bf=c((i="")=>new RegExp("\\$\\{(.*?)\\}",i),"template"),Sy=c(i=>i.match(bf("gi"))||[],"getAllTemplates"),Ay=c(i=>(i.match(bf("i"))||[])[1],"parseTemplate");kf.exports=({_:i})=>({assignTemplates:c((t,s)=>Sy(t).reduce((r,n)=>{let a=Ay(n);return r.replace(n,()=>s[a]||s[a]===0?s[a]:"")},t),"assignTemplates")})});var Hf=P((qY,Gf)=>{"use strict";var kY=require("lodash");Gf.exports=(i,e)=>{let t=c((N,d)=>Object.entries(N.properties).map(d),"mapProperties"),s=c(N=>N.compositeUniqueKey?!1:!!N.unique,"isUniqueKey"),r=c(N=>{var d;return s(N)&&!((d=N.uniqueKeyOptions)!=null&&d.constraintName)},"isInlineUnique"),n=c(N=>N.compositeUniqueKey||N.compositePrimaryKey?!1:!!N.primaryKey,"isPrimaryKey"),a=c(N=>{var d;return n(N)&&!((d=N.primaryKeyOptions)!=null&&d.constraintName)},"isInlinePrimaryKey"),_=c((N,d,S)=>e({keyType:"UNIQUE",columns:[{name:d,isActivated:S}],...N}),"hydrateUniqueOptions"),T=c((N,d,S)=>e({keyType:"PRIMARY KEY",columns:[{name:d,isActivated:S}],...N}),"hydratePrimaryKeyOptions"),l=c((N,d)=>Object.keys(d).find(S=>d[S].GUID===N),"findName"),E=c((N,d)=>i.get(Object.values(d).find(S=>S.GUID===N),"isActivated",!0),"checkIfActivated"),h=c((N,d)=>i.map(N,S=>({name:l(S.keyId,d.properties),isActivated:E(S.keyId,d.properties)})),"getKeys"),p=c(N=>Array.isArray(N.primaryKey)?N.primaryKey.filter(d=>!i.isEmpty(d.compositePrimaryKey)).map(d=>({...T(d,null,null),columns:h(d.compositePrimaryKey,N)})):[],"getCompositePrimaryKeys"),A=c(N=>Array.isArray(N.uniqueKey)?N.uniqueKey.filter(d=>!i.isEmpty(d.compositeUniqueKey)).map(d=>({..._(d,null,null),columns:h(d.compositeUniqueKey,N)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:c(N=>{if(!N.properties)return[];let d=t(N,([D,m])=>{if(!(!s(m)||r(m)))return _(m.uniqueKeyOptions,D,m.isActivated)}).filter(Boolean);return[...t(N,([D,m])=>{if(!(!n(m)||a(m)))return T(m.primaryKeyOptions,D,m.isActivated)}).filter(Boolean),...p(N),...d,...A(N)]},"getTableKeyConstraints"),isInlineUnique:r,isInlinePrimaryKey:a,getKeys:h}}});var Vl=P((vY,vf)=>{"use strict";var HY=require("lodash");vf.exports=({prepareName:i,_:e})=>({getOptionsString:c(({constraintName:s,deferClause:r,rely:n,validate:a,indexClause:_,exceptionClause:T})=>{let l=s?` CONSTRAINT ${i(e.trim(s))}`:"",E=[r,n,_,a,T].filter(Boolean).join(" ");return{constraintString:l,statement:E&&` ${E}`}},"getOptionsString")})});var Wf=P((XY,Kf)=>{"use strict";var WY=require("lodash"),{DbVersion:dy}=Ml(),py=c(i=>Number.parseInt(i,10)<dy.JSON_TYPE_SINCE,"shouldUseClobForJsonColumns");Kf.exports=({_:i,wrap:e,assignTemplates:t,templates:s,commentIfDeactivated:r,wrapComment:n,prepareName:a})=>{let{getOptionsString:_}=Vl()({_:i,prepareName:a}),T=c((M,ee)=>i.chain(ee).filter("comment").map(ae=>{let Ye=t(s.comment,{object:"COLUMN",objectName:`${M}.${a(ae.name)}`,comment:n(ae.comment)});return r(Ye,ae)}).join(`
`).value(),"getColumnComments"),l=c(({nullable:M,unique:ee,primaryKey:ae,primaryKeyOptions:Ye,uniqueKeyOptions:Je})=>{let{constraintString:it,statement:xt}=_(E({primaryKey:ae,unique:ee,primaryKeyOptions:Ye,uniqueKeyOptions:Je}));return`${M?"":" NOT NULL"}${it}${ae?" PRIMARY KEY":""}${ee?" UNIQUE":""}${xt}`},"getColumnConstraints"),E=c(({primaryKey:M,unique:ee,primaryKeyOptions:ae,uniqueKeyOptions:Ye})=>M?ae||{}:ee?Ye||{}:{},"getOptions"),h=c((M,ee)=>M==="JSON"&&py(ee)?"CLOB":M,"replaceTypeByVersion"),p=c(({default:M,identity:ee})=>{if(!i.isEmpty(ee)&&ee.generated){let ae=c(({generated:Je,generatedOnNull:it})=>Je==="BY DEFAULT"?` ${Je} ${it?" ON NULL":""}`:" ALWAYS","getGenerated"),Ye=c(({identityStart:Je,identityIncrement:it,numberToCache:xt})=>{let Xt=Je?` START WITH ${Je}`:"",Ss=it?` INCREMENT BY ${it}`:"",Js=xt?` CACHE ${xt}`:" NOCACHE";return`${Xt}${Ss}${Js}`},"getOptions");return` GENERATED${ae(ee)} AS IDENTITY (${i.trim(Ye(ee))})`}else if(M)return` DEFAULT ${M}`;return""},"getColumnDefault"),A=c(({encryption:M})=>{if(i.isPlainObject(M)&&!i.isEmpty(i.omit(M,"id"))){let{ENCRYPTION_ALGORITHM:ee,INTEGRITY_ALGORITHM:ae,noSalt:Ye}=M,Je=ee?` USING '${ee}'`:"",it=ae?` '${ae}'`:"";return` ENCRYPT${Je}${it}${Ye?" NO SALT":""}`}return""},"getColumnEncrypt"),u=c((M,ee,ae)=>` ${M}(${ee} ${i.toUpper(ae)})`,"addByteLength"),N=c((M,ee)=>` ${M}(${ee})`,"addLength"),d=c((M,ee,ae)=>i.isNumber(ae)?` ${M}(${ee||"*"},${ae})`:i.isNumber(ee)?` ${M}(${ee})`:` ${M}`,"addScalePrecision"),S=c((M,ee)=>i.isNumber(ee)?` ${M}(${ee})`:` ${M}`,"addPrecision"),D=c((M,ee,ae)=>` TIMESTAMP${i.isNumber(M)?`(${M})`:""}${ee?` WITH${ae?" LOCAL":""} TIME ZONE`:""}`,"timestamp"),m=c(M=>` INTERVAL YEAR${i.isNumber(M)?`(${M})`:""} TO MONTH`,"intervalYear"),O=c((M,ee)=>{let ae=i.isNumber(M)?`(${M})`:"",Ye=i.isNumber(ee)?`(${ee})`:"";return` INTERVAL DAY${ae} TO SECOND${Ye}`},"intervalDay"),U=c((M,ee,ae)=>{let Ye={"vector<int8>":"int8","vector<float32>":"float32","vector<float64>":"float64"}[ae],Je=ee||"*",it=i.toUpper(Ye||"*");return` ${M}(${Je}, ${it})`},"decorateVector"),V=c((M,ee)=>["object","array"].includes(ee)?" "+M+"("+i.toUpper(ee)+")":" "+M,"decorateJson"),G=c(M=>["CHAR","VARCHAR2"].includes(M),"canHaveByte"),z=c(M=>["CHAR","VARCHAR2","NCHAR","NVARCHAR2","RAW","UROWID"].includes(M),"canHaveLength"),C=c(M=>["NUMBER","FLOAT"].includes(M),"canHavePrecision"),q=c(M=>M==="NUMBER","canHaveScale"),R=c(M=>M==="INTERVAL YEAR","isIntervalYear"),B=c(M=>M==="INTERVAL DAY","isIntervalDay"),x=c(M=>M==="TIMESTAMP","isTimezone"),J=c((M,ee,ae)=>M==="VECTOR"&&(ee||ae),"canDecorateVector"),re=c(M=>M==="JSON","isJson");return{getColumnComments:T,getColumnConstraints:l,replaceTypeByVersion:h,getColumnDefault:p,getColumnEncrypt:A,decorateType:c((M,ee)=>{let{lengthSemantics:ae,length:Ye,precision:Je,scale:it,fractSecPrecision:xt,withTimeZone:Xt,localTimeZone:Ss,yearPrecision:Js,dayPrecision:Fn,isUDTRef:xn,schemaName:ai,dimension:Lr,subtype:Qs}=ee;return ae&&G(M)&&z(M)&&i.isNumber(Ye)?u(M,Ye,ae):z(M)&&i.isNumber(Ye)?N(M,Ye):C(M)&&q(M)?d(M,Je,it):C(M)&&i.isNumber(Je)?S(M,Je):x(M)?D(xt,Xt,Ss):R(M)?m(Js):B(M)?O(Fn,xt):xn&&ai?` "${ai}"."${M}"`:J(M,Lr,Qs)?U(M,Lr,Qs):re(M)?V(M,Qs):` ${M}`},"decorateType"),canHaveIdentity:c(M=>["number"].includes(M),"canHaveIdentity")}}});var zf=P((jY,Xf)=>{"use strict";var $Y=require("lodash");Xf.exports=({_:i,getColumnsList:e,checkAllKeysDeactivated:t,commentIfDeactivated:s,prepareName:r,assignTemplates:n})=>{let{getOptionsString:a}=Vl()({_:i,prepareName:r}),_=c(({duplicated:C,external:q,immutable:R,sharded:B,temporary:x,temporaryType:J,blockchain_table_clauses:re})=>{let k=!i.isEmpty(re);switch(!0){case x:return` ${i.toUpper(J)} TEMPORARY`;case B:return" SHARDED";case C:return" DUPLICATED";case R:return" IMMUTABLE";case k:return`${re.immutable?" IMMUTABLE":""} BLOCKCHAIN`;default:return""}},"getTableType"),T=c(C=>{let q=c(B=>B?`${B}
`:"","wrap"),R=[{key:"blockchain_table_clauses",getValue:l(C==null?void 0:C.tableProperties)},{key:"storage",getValue:E(C==null?void 0:C.tableProperties)},{key:"external_table_clause",getValue:h},{key:"partitioning",getValue:p},{key:"selectStatement",getValue:m("AS")},{key:"tableProperties",getValue:B=>B}].map(B=>C[B.key]?q(B.getValue(C[B.key],C)):"").filter(Boolean).join("");return i.trim(R)?` ${i.trim(R)}`:""},"getTableOptions"),l=c(C=>({blockchain_table_retention_clause:q,blockchain_row_retention_clause:R,blockchain_hash_and_data_format_clause:B})=>i.includes(C,q)||i.includes(C,R)||i.includes(C,B)?"":i.trim(` ${q||""} ${R||""} ${B||""}`),"getBlockChainClause"),E=c(C=>({organization:q,tablespace:R,logging:B})=>i.includes(C,"TABLESPACE")?"":q==="external"?"ORGANIZATION EXTERNAL":`ORGANIZATION ${i.toUpper(q)||"HEAP"}${R?` TABLESPACE ${r(R)}`:""} ${B?"LOGGING":"NOLOGGING"}`,"getStorage"),h=c(C=>{if(!(C!=null&&C.access_driver_type))return"";let{access_driver_type:q,default_directory:R,access_parameter_type:B,opaque_format_spec:x,clob_subquery:J,reject_limit:re,location:k}=C,Ee=`(${i.map(k,({location_directory:ae,location_specifier:Ye})=>`${ae?`${ae}:`:""}'${Ye}'`).join(", ")})`,M=B==="NONE"?"":`ACCESS PARAMETERS ${J?`USING CLOB ${J}`:x}`,ee=`${R&&!i.isEmpty(R)?` DEFAULT DIRECTORY ${R}`:""}`+M+`${k&&!i.isEmpty(k)?` LOCATION ${Ee}`:""}`;return` (TYPE ${i.toUpper(q)} ${ee}) REJECT LIMIT ${re||"UNLIMITED"} `},"getExternalTableClause"),p=c((C,{isActivated:q})=>{if(C!=null&&C.partitionBy){let R=A(C,q),B=u(C,q);return`PARTITION BY ${i.toUpper(i.startsWith(C.partitionBy,"composite")?i.last(C.partitionBy.split(" ")):C.partitionBy)} ${R}${B}`}return""},"getPartitioning"),A=c((C,q)=>{let R=t(C.partitionKey);return i.isEmpty(C.partitionKey)?"":e(C.partitionKey,R,q,({name:B})=>r(B))},"getPartitionKeys"),u=c((C,q)=>{switch(C.partitionBy){case"range":return`${C.interval?`
INTERVAL (${C.interval})`:""}`+S(C.store_in_tablespaces)+N(C.range_partitions,"range_partition_clause");case"list":return`${C.automatic?" AUTOMATIC":""}`+S(C.store_in_tablespaces)+N(C.list_partitions,"list_partition_clause");case"hash":return D(C);case"reference":return`${C.constraint?` (${C.constraint})`:""}`+N(C.reference_partition_descs,"reference_partition_desc");case"system":return C.system_partitioning_quantity?` PARTITIONS ${C.system_partitioning_quantity}`:N(C.system_partition_descs,"system_partition_desc");case"composite range":{let R=d(C,q);return`${C.interval?` INTERVAL (${C.interval})`:""}`+S(C.store_in_tablespaces)+R+N(C.range_subpartition_descs,"range_subpartition_desc")}case"composite list":{let R=d(C,q);return S(C.store_in_tablespaces,"AUTOMATIC")+R+N(C.list_subpartition_descs,"list_subpartition_description")}case"composite hash":{let R=d(C,q),B=D(C);return`${R}${B}`}default:return""}},"getPartitionClause"),N=c((C,q)=>C&&i.isArray(C)&&!i.isEmpty(C)?`
(
	${(q?i.map(C,R=>R[q]):C).join(`,
	`)}
)
`:"","partitionsToString"),d=c(({subpartitionType:C,subpartitionDescription:q,compositePartitionKey:R},B)=>{if(C){let x=t(R),J=q?`
${q}`:"";return` SUBPARTITION BY ${i.toUpper(C)} ${e(R,x,B,({name:re})=>r(re))} ${J}`}return""},"getSubpartition"),S=c((C,q,R="store_in_tablespace")=>i.isEmpty(C)?"":`${q?` ${q}`:""} STORE IN (${i.map(C,B=>B[R]).join(", ")})`,"getTablespaceList"),D=c(({hash_partition_quantity:C,store_in_tablespaces:q,overflow_store_in_tablespaces:R,individual_hash_partitions:B})=>C?` PARTITIONS ${C}`+S(q)+S(R,"OVERFLOW","overflow_store_in_tablespace"):N(B,"individual_hash_partition"),"getHashPartition"),m=c(C=>q=>{if(q)return`${C} ${q}`},"getBasicValue");return{getTableOptions:T,getTableType:_,generateConstraintsString:c((C,q)=>{var J,re;let R=s(((C==null?void 0:C.deactivatedItems)||[]).join(`,
	`),{isActivated:!q,isPartOfLine:!0}),B=(J=C==null?void 0:C.activatedItems)!=null&&J.length?`,
	`+C.activatedItems.join(`,
	`):"",x=(re=C==null?void 0:C.deactivatedItems)!=null&&re.length?`
	`+R:"";return B+x},"generateConstraintsString"),foreignKeysToString:c(C=>{if(Array.isArray(C)){let q=C.filter(x=>i.get(x,"isActivated",!0)).map(x=>r(i.trim(x.name))),R=C.filter(x=>!i.get(x,"isActivated",!0)).map(x=>r(i.trim(x.name))),B=R.length?s(R,{isActivated:!1,isPartOfLine:!0}):"";return q.join(", ")+B}return C},"foreignKeysToString"),foreignActiveKeysToString:c(C=>C.map(q=>i.trim(q.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:c((C,q)=>R=>{let B=t(R.columns),x=e(R.columns,B,q,({name:re})=>r(re)),J=a(R).statement;return{statement:n(C.createKeyConstraint,{constraintName:R.constraintName?`CONSTRAINT ${r(R.constraintName)} `:"",keyType:R.keyType,columns:x,options:J}),isActivated:!B}},"createKeyConstraint"),customPropertiesForForeignKey:c(C=>({foreignOnDelete:i.get(C,"relationshipOnDelete","")}),"customPropertiesForForeignKey")}}});var jf=P((ZY,$f)=>{"use strict";var QY=require("lodash");$f.exports=({_:i,assignTemplates:e,templates:t,getNamePrefixedWithSchemaName:s})=>{let r=["OBJECT_UDT","VARRAY","TABLE","COLLECTION_UDT"],n=c((T,l)=>{let E=s(T.name,T.schemaName);switch(T.type){case"OBJECT_UDT":return e(t.createObjectType,{name:E,properties:i.map(T.properties,h=>l(h,t.objectTypeColumnDefinition)).join(`,
	`)});case"VARRAY":case"TABLE":{let h=T.type==="VARRAY"?"(64)":"";return e(t.createCollectionType,{name:E,collectionType:T.type,size:i.isNumber(T.size)?`(${T.size})`:h,datatype:`${T.ofType}${T.nullable?"":" NOT NULL"}`,notPersistable:`${T.notPersistable?" NOT PERSISTABLE":""}`})}default:return""}},"getPlainUdt");return{getUserDefinedType:c((T,l)=>n(T,l),"getUserDefinedType"),isNotPlainType:c(T=>{let l=i.toUpper(T.mode||T.type);return r.includes(l)},"isNotPlainType")}}});var Qf=P((tM,Jf)=>{"use strict";Jf.exports=({_:i,prepareName:e})=>{let t=c(({editioning:n,editionable:a})=>`${a?" EDITIONABLE":""}${n?" EDITIONING":""}`,"getViewType"),s=c(n=>n?n.alias?`${e(n.name)} as ${e(n.alias)}`:e(n.name):"","getKeyWithAlias");return{getViewType:t,getViewData:c(n=>Array.isArray(n)?n.reduce((a,_)=>{if(!_.tableName)return a.columns.push(s(_)),a;let T=`${e(_.dbName)}.${e(_.tableName)}`;return a.tables.includes(T)||a.tables.push(T),a.columns.push({statement:`${T}.${s(_)}`,isActivated:_.isActivated}),a},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData")}}});var em=P((iM,Zf)=>{"use strict";var rM=require("lodash");Zf.exports=({_:i,prepareName:e})=>({getIndexType:c(a=>a?` ${i.toUpper(a)}`:"","getIndexType"),getIndexKeys:c(({indxKey:a,column_expression:_})=>{let{escapeSingleQuote:T}=le()();return _?`
(
	${T(_)}
)
	`:i.isArray(a)&&!i.isEmpty(a)?`
(
	${i.map(a,({name:E,type:h})=>`${e(E)} ${i.toUpper(h)}`).join(`,
	`)}
)
	`:""},"getIndexKeys"),getIndexOptions:c(({indxDescription:a,comments:_,tablespace:T,index_properties:l,index_attributes:E,index_compression:h,logging_clause:p,indxKey:A,column_expression:u})=>{let N=p?` ${i.toUpper(p)}`:"",d=T?` TABLESPACE ${T}`:"",S=h?` ${h}`:"",D=`${N}${d}${S}`;return l?D=` ${l}`:E&&(D=` ${E}`),i.isEmpty(A)&&i.isEmpty(u)?D:i.trim(D)},"getIndexOptions"),getIndexName:c(a=>a?` ${e(a)}`:"","getIndexName")})});var sm=P((oM,tm)=>{"use strict";tm.exports=({prepareName:i,templates:e,assignTemplates:t,getNamePrefixedWithSchemaName:s})=>{let r=c(a=>{let _=s(a.synonymName,a.schemaName);return t(e.createSynonym,{name:a.synonymPublic?i(a.synonymName):_,orReplace:a.synonymOrReplace?" OR REPLACE":"",editionable:a.synonymEditionable?" "+a.synonymEditionable:"",public:a.synonymPublic?" PUBLIC":"",objectName:a.synonymEntityName})},"generateSynonymCreateStatement");return{generateSynonymStatements:c((a,_,T)=>a!=null&&a.length?`
`+a.map(l=>r({...l,synonymEntityName:_,schemaName:T})).join(`
`):"","generateSynonymStatements")}}});var im=P((TM,rm)=>{"use strict";var _M=require("lodash"),{Sequence:cM}=Dn();rm.exports=({_:i,templates:e,assignTemplates:t,getNamePrefixedWithSchemaName:s,wrapIfNotExists:r})=>{let n=c(({schemaName:m,sequences:O,usingTryCatchWrapper:U})=>i.map(O,V=>a({schemaName:m,sequence:V,usingTryCatchWrapper:U})).join(`

`),"getSequencesScript"),a=c(({schemaName:m,sequence:O,usingTryCatchWrapper:U})=>{let V=D({schemaName:m,sequence:O}),G=s(O.sequenceName,V),z=U?"":u({sequence:O}),C=l({sequence:O,schemaName:m}),q=d({sequence:O}),R=t(e.createSequence,{name:G,ifNotExists:z,sharing:q,options:C});return U?r(R,O.ifNotExist):R+";"},"createSequenceScript"),_=c(({schemaName:m,sequence:O,oldSequence:U,usingTryCatchWrapper:V})=>{let G=U.sequenceName||O.sequenceName,z=D({schemaName:m,sequence:O}),C=s(G),q=s(G,z),R=S({sequence:O,oldSequence:U}),B=l({schemaName:m,sequence:R}),x=R.sequenceName?s(R.sequenceName):"",J=N({usingTryCatchWrapper:V});if(R.hasOwnProperty("sharing")){let Ee=T({schemaName:m,sequence:U,usingTryCatchWrapper:V}),M=a({schemaName:m,sequence:O,usingTryCatchWrapper:V});return Ee+`
`+M+`
`}return[{key:"options",value:B,name:q,template:e.alterSequence},{key:"newName",value:x,name:C,template:e.renameSequence}].filter(Ee=>Ee.value).map(Ee=>t(Ee.template,{[Ee.key]:Ee.value,name:Ee.name,ifExists:J})).join(`
`)},"alterSequenceScript"),T=c(({schemaName:m,sequence:O,usingTryCatchWrapper:U})=>{let V=D({schemaName:m,sequence:O}),G=s(O.sequenceName,V),z=N({usingTryCatchWrapper:U});return t(e.dropSequence,{name:G,ifExists:z})},"dropSequenceScript"),l=c(({schemaName:m,sequence:O})=>{let V=[{getOption:E,key:"increment",clause:"INCREMENT BY"},{getOption:E,key:"start",clause:"START WITH"},{getOption:E,key:"restart",clause:"RESTART WITH"},{getOption:E,key:"minValue",clause:"MINVALUE"},{getOption:E,key:"maxValue",clause:"MAXVALUE"},{getOption:h,key:"cache",extendedKey:"cacheValue"},{getOption:h,key:"cycle",extendedKey:""},{getOption:h,key:"order",extendedKey:""},{getOption:h,key:"keep",extendedKey:""},{getOption:h,key:"scale",extendedKey:"scaleExtend"},{getOption:h,key:"shard",extendedKey:"shardExtend"},{getOption:h,key:"type",extendedKey:""}].map(G=>{let z=G.getOption({sequence:O,schemaName:m,config:G});return p({option:z})}).filter(Boolean).join("");return V&&A({options:V})},"getSequenceOptions"),E=c(({sequence:m,config:O})=>{let U=Number(m[O.key]);return isNaN(U)?"":`${O.clause} ${U}`},"getNumberOption"),h=c(({sequence:m,config:O})=>{let U=i.toUpper(m[O.key]);return U?U.startsWith("NO")||!m[O.extendedKey]?U:U+" "+h({sequence:m,config:{key:O.extendedKey}}):""},"getLiteralOption"),p=c(({option:m})=>m?`	${m}
`:"","wrapOption"),A=c(({options:m})=>`
`+m.replace(/\n$/,""),"wrapOptionsBlock"),u=c(({sequence:m})=>m.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),N=c(({usingTryCatchWrapper:m})=>m?"":" IF EXISTS","getIfExists"),d=c(({sequence:m})=>m.sharing?" SHARING="+i.toUpper(m.sharing):"","getSharing"),S=c(({sequence:m,oldSequence:O})=>{let U=i.omitBy(m,(V,G)=>i.isEqual(V,O[G]));return m.minValue>O.minValue?{...U,restart:m.start}:U},"getModifiedSequence"),D=c(({schemaName:m,sequence:O})=>O.type==="session"?"":m,"getSequenceSchemaName");return{getSequencesScript:n,createSequenceScript:a,alterSequenceScript:_,dropSequenceScript:T}}});var Wt=P((hM,om)=>{"use strict";var he=require("lodash"),fy=Df(),nm=Of(),ye=Ol(),{DualityViewDdlCreatorFactory:my}=Ff(),{DualityViewSyntaxType:Py}=gl(),{DbVersion:Ry}=Ml(),{AlterIndexDto:EM}=Bn(),{Sequence:uM}=Dn(),$s=c(i=>Number.parseInt(i,10)<Ry.IF_NOT_EXISTS_SINCE,"shouldUseTryCatchIfNotExistsWrapper");om.exports=(i,e,t)=>{var Lr,Qs;let s=c(g=>he.isArray(g)?g:[g],"toArray"),{tab:r,commentIfDeactivated:n,checkAllKeysDeactivated:a,divideIntoActivatedAndDeactivated:_,hasType:T,wrap:l,clean:E,getNamePrefixedWithSchemaNameForScriptFormat:h,wrapComment:p,getColumnsList:A,prepareNameForScriptFormat:u}=le()(he),N=u((Lr=e==null?void 0:e.targetScriptOptions)==null?void 0:Lr.keyword),d=h((Qs=e==null?void 0:e.targetScriptOptions)==null?void 0:Qs.keyword),{assignTemplates:S}=qf()({_:he}),D=Hf()(he,E),{getColumnComments:m,getColumnConstraints:O,replaceTypeByVersion:U,getColumnDefault:V,getColumnEncrypt:G,decorateType:z,canHaveIdentity:C}=Wf()({_:he,wrap:l,assignTemplates:S,templates:ye,commentIfDeactivated:n,wrapComment:p,prepareName:N}),{getTableType:q,getTableOptions:R,generateConstraintsString:B,foreignKeysToString:x,foreignActiveKeysToString:J,createKeyConstraint:re,customPropertiesForForeignKey:k}=zf()({_:he,checkAllKeysDeactivated:a,getColumnsList:A,commentIfDeactivated:n,prepareName:N,assignTemplates:S}),{getUserDefinedType:Ee,isNotPlainType:M}=jf()({_:he,commentIfDeactivated:n,assignTemplates:S,templates:ye,getNamePrefixedWithSchemaName:d}),{getViewType:ee,getViewData:ae}=Qf()({_:he,prepareName:N}),{getIndexType:Ye,getIndexKeys:Je,getIndexOptions:it,getIndexName:xt}=em()({_:he,prepareName:N}),Xt=c((g,Y,Q=955)=>{if(Y){let te=r(r(g)),xe=he.trim(te).replace(/;$/,"");return S(ye.ifNotExists,{statement:xe,errorCode:Q})}return g+";"},"wrapIfNotExists"),{generateSynonymStatements:Ss}=sm()({prepareName:N,templates:ye,assignTemplates:S,getNamePrefixedWithSchemaName:d}),{getSequencesScript:Js,createSequenceScript:Fn,dropSequenceScript:xn,alterSequenceScript:ai}=im()({_:he,templates:ye,assignTemplates:S,getNamePrefixedWithSchemaName:d,wrapIfNotExists:Xt});return{getDefaultType(g){return fy[g]},getTypesDescriptors(){return nm},hasType(g){return T(nm,g)},hydrateSchema(g,Y){let Q=he.get(Y,"modelData.0.dbVersion");return{schemaName:g.name,ifNotExist:g.ifNotExist,dbVersion:Q,synonyms:Y.synonyms,sequences:Y.sequences}},createSchema({schemaName:g,ifNotExist:Y,dbVersion:Q,sequences:te}){let Me=`

`,xe=";",ze=N(g),We=$s(Q),ct=S(ye.createSchema,{schemaName:ze,ifNotExists:!We&&Y?" IF NOT EXISTS":""}),gt=Js({schemaName:g,sequences:te,usingTryCatchWrapper:We}),bt=gt?Me+gt:"",Tt=S(ye.alterSession,{schemaName:ze});return We?Xt(ct,Y,1920)+bt:ct+xe+Me+Tt+bt},hydrateColumn({columnDefinition:g,jsonSchema:Y,schemaData:Q,definitionJsonSchema:te={}}){var We;let Me=Q.dbVersion,xe=!!Y.$ref,ze=xe?g.type:he.toUpper(Y.mode||Y.type);return{name:g.name,type:ze,ofType:Y.ofType,notPersistable:Y.notPersistable,size:Y.size,primaryKey:D.isInlinePrimaryKey(Y),primaryKeyOptions:Y.primaryKeyOptions,unique:D.isInlineUnique(Y),uniqueKeyOptions:Y.uniqueKeyOptions,nullable:g.nullable,default:g.default,comment:Y.refDescription||Y.description||te.description,isActivated:g.isActivated,scale:g.scale,precision:g.precision,length:g.length,schemaName:Q.schemaName,checkConstraints:Y.checkConstraints,dbVersion:Me,fractSecPrecision:Y.fractSecPrecision,withTimeZone:Y.withTimeZone,localTimeZone:Y.localTimeZone,yearPrecision:Y.yearPrecision,dayPrecision:Y.dayPrecision,lengthSemantics:Y.lengthSemantics,encryption:Y.encryption,synonyms:((We=Q==null?void 0:Q.synonyms)==null?void 0:We.filter(ct=>ct.synonymEntityId===Y.GUID))||[],isUDTRef:xe,dimension:Y.dimension,subtype:Y.subtype,...C(Y.mode)&&{identity:Y.identity}}},hydrateJsonSchemaColumn(g,Y){return!g.$ref||he.isEmpty(Y)||M(Y)?g:(g=he.omit(g,"$ref"),{...Y,...g})},convertColumnDefinition(g,Y=ye.columnDefinition){let Q=U(g.type,g.dbVersion);return n(S(Y,{name:N(g.name),type:z(Q,g),default:V(g),encrypt:G(g),constraints:O(g)}),{isActivated:g.isActivated})},hydrateCheckConstraint(g){return{name:g.chkConstrName,expression:g.constrExpression,comments:g.constrComments,description:g.constrDescription}},createCheckConstraint({name:g,expression:Y,comments:Q,description:te}){return S(ye.checkConstraint,{name:g?`CONSTRAINT ${N(g)} `:"",expression:he.trim(Y).replace(/^\(([\s\S]*)\)$/,"$1")})},createForeignKeyConstraint({name:g,foreignKey:Y,primaryTable:Q,primaryKey:te,primaryTableActivated:Me,foreignTableActivated:xe,foreignSchemaName:ze,primarySchemaName:We,customProperties:ct},gt,bt){let Tt=a(te),yt=a(Y),rs=!Tt&&!yt&&Me&&xe,As=s(Y),Ys=s(te),{foreignOnDelete:Ms}=k(ct),Zs=S(ye.createForeignKeyConstraint,{primaryTable:d(Q,We||bt.schemaName),name:g?`CONSTRAINT ${N(g)}`:"",foreignKey:rs?x(As):J(As),primaryKey:rs?x(Ys):J(Ys),onDelete:Ms?` ON DELETE ${Ms}`:""});return{statement:he.trim(Zs),isActivated:rs}},createForeignKey({name:g,foreignTable:Y,foreignKey:Q,primaryTable:te,primaryKey:Me,primaryTableActivated:xe,foreignTableActivated:ze,foreignSchemaName:We,primarySchemaName:ct,customProperties:gt},bt,Tt){let yt=a(Me),rs=a(Q),As=!yt&&!rs&&xe&&ze,Ys=s(Q),Ms=s(Me),{foreignOnDelete:Zs}=k(gt),_i=S(ye.createForeignKey,{primaryTable:d(te,ct||Tt.schemaName),foreignTable:d(Y,We||Tt.schemaName),name:g?N(g):"",foreignKey:As?x(Ys):J(Ys),primaryKey:As?x(Ms):J(Ms),onDelete:Zs?` ON DELETE ${Zs}`:""});return{statement:he.trim(_i)+`
`,isActivated:As}},dropForeignKey(g,Y){let Q={tableName:g,fkConstraintName:Y};return S(ye.dropForeignKey,Q)},hydrateTable({tableData:g,entityData:Y,jsonSchema:Q}){var ze,We;let te=Y[0],Me=he.first(te.partitioning)||{},xe=D.getKeys(Me.compositePartitionKey,Q);return{...g,keyConstraints:D.getTableKeyConstraints(Q),selectStatement:he.trim(te.selectStatement),partitioning:he.assign({},Me,{compositePartitionKey:xe}),...he.pick(te,"blockchain_table_clauses","duplicated","external","external_table_clause","immutable","sharded","storage","temporary","temporaryType","description","ifNotExist","tableProperties"),synonyms:((We=(ze=g==null?void 0:g.schemaData)==null?void 0:ze.synonyms)==null?void 0:We.filter(ct=>ct.synonymEntityId===Q.GUID))||[]}},createTable({blockchain_table_clauses:g,checkConstraints:Y,columnDefinitions:Q,columns:te,duplicated:Me,external:xe,external_table_clause:ze,foreignKeyConstraints:We,keyConstraints:ct,immutable:gt,name:bt,partitioning:Tt,schemaData:yt,selectStatement:rs,sharded:As,storage:Ys,temporary:Ms,temporaryType:Zs,description:_i,ifNotExist:DE,tableProperties:qm,synonyms:Gm},ci){let Ti=d(bt,yt.schemaName),CE=_i?S(ye.comment,{object:"TABLE",objectName:Ti,comment:p(_i)}):"",Hm=_(ct.map(re(ye,ci)),bn=>bn.statement),vm=B(Hm,ci),Km=_(We,bn=>bn.statement),Wm=B(Km,ci),OE=m(Ti,Q),gE=S(ye.createTableProps,{columnDefinitions:he.join(te,`,
	`),foreignKeyConstraints:Wm,keyConstraints:vm,checkConstraints:he.isEmpty(Y)?"":`,
	`+he.join(Y,`,
	`)}),Xm=Ss(Gm,Ti,yt.schemaName),zm=CE||OE?`
`+CE+OE:"",$m=yt.dbVersion||"",yE=$s($m),li=S(ye.createTable,{name:Ti,ifNotExists:!yE&&DE?" IF NOT EXISTS":"",tableProps:gE?`
(
	${gE}
)`:"",tableType:q({duplicated:Me,external:xe,immutable:gt,sharded:As,temporary:Ms,temporaryType:Zs,blockchain_table_clauses:g}),options:R({blockchain_table_clauses:g,external_table_clause:ze,storage:Ys,partitioning:Tt,selectStatement:rs,tableProperties:qm})});return yE?li=Xt(li,DE):li+=";",n(li+`${zm}
`+Xm,{isActivated:ci})},hydrateIndex(g,Y,Q){return{...g,schemaName:Q.schemaName}},createIndex(g,Y,Q,te=!0){let Me=xt(Y.indxName),xe=Ye(Y.indxType),ze=Je(Y),We=it(Y),ct=e.dbVersion||"",gt=$s(ct),bt=Y.ifNotExist&&!gt,Tt=S(ye.createIndex,{indexType:xe,ifNotExists:bt?" IF NOT EXISTS":"",name:Me,keys:ze,options:We,tableName:d(g,Y.schemaName)});return Y.ifNotExist&&gt&&(Tt=Xt(Tt,!0)),gt?n(Tt,{isActivated:Y.isActivated}):n(Tt,{isActivated:Y.isActivated})},dropIndex({name:g}){return S(ye.dropIndex,{name:g})},alterIndexRename({oldName:g,newName:Y}){return S(ye.alterIndexRename,{oldName:g,newName:Y})},alterIndexRebuild({name:g,indexData:Y}){let Q=it(Y);return S(ye.alterIndexRebuild,{name:g,options:Q})},hydrateViewColumn(g){return{name:g.name,tableName:g.entityName,alias:g.alias,isActivated:g.isActivated,dbName:g.dbName}},hydrateView({viewData:g,entityData:Y,jsonSchema:Q}){var Me,xe;let te=Y[0];return{name:g.name,keys:g.keys,orReplace:te.or_replace,editionable:te.editionable,editioning:te.editioning,force:te.force,selectStatement:te.selectStatement,tableName:g.tableName,schemaName:g.schemaData.schemaName,description:te.description,ifNotExist:te.ifNotExist,materialized:te.materialized,sharing:te.sharing,duality:te.duality,rootTableAlias:te.rootTableAlias,tableTagsClause:te.tableTagsClause,viewProperties:te.materialized?te.mviewProperties:te.viewProperties,synonyms:((xe=(Me=g.schemaData)==null?void 0:Me.synonyms)==null?void 0:xe.filter(ze=>ze.synonymEntityId===Q.GUID))||[],modelInfo:{dbVersion:he.get(g,"schemaData.dbVersion")},whereClause:te.whereClause}},hydrateViewIndex(g,Y,Q){var te;return{...g,schemaName:Y.schemaName,materialized:(te=he.first(Q))==null?void 0:te.materialized}},createViewIndex(g,Y,Q,te){let Me=xt(Y.indxName),xe=Ye(Y.indxType),ze=Je(Y),We=it(Y,te);if(Y.materialized)return n(S(ye.createIndex,{indexType:xe,name:Me,keys:ze,options:We,tableName:d(g,Y.schemaName)}),{isActivated:Y.isActivated})},createView(g,Y,Q){let te=d(g.name,g.schemaName),{columns:Me,tables:xe}=ae(g.keys),ze=Me.map(rs=>rs.statement).join(`,
		`),We=g.description?`
`+S(ye.comment,{object:"TABLE",objectName:te,comment:p(g.description)})+`
`:`
`,ct=he.trim(g.selectStatement)?he.trim(r(g.selectStatement)):S(ye.viewSelectStatement,{tableName:xe.join(", "),keys:ze}),gt=Ss(g.synonyms,te,g.schemaName),bt=he.get(g,"modelInfo.dbVersion",""),Tt=$s(bt),yt=S(ye.createView,{name:te,ifNotExists:!Tt&&g.ifNotExist?" IF NOT EXISTS":"",orReplace:g.orReplace&&!g.materialized?" OR REPLACE":"",force:g.force&&!g.materialized?" FORCE":"",materialized:g.materialized?" MATERIALIZED":"",viewType:g.materialized?"":ee(g),viewProperties:g.viewProperties?` 
`+r(g.viewProperties):"",sharing:g.sharing&&!g.materialized?` SHARING=${g.sharing}`:"",selectStatement:ct});return Tt?yt=Xt(yt,g.ifNotExist):yt+=";",n(yt+We+gt,{isActivated:Q})},createDualityView({jsonSchema:g,view:Y,relatedSchemas:Q}){return my.getCreatorInstance(Py.SQL,{ddlTemplates:ye,assignTemplates:S,lodash:he,prepareName:N,getNamePrefixedWithSchemaName:d}).convertDualityViewToDdl({view:Y,jsonSchema:g,relatedSchemas:Q})},createUdt(g){let Y=Ss(g.synonyms,d(g.name,g.schemaName),g.schemaName);return n(Ee(g,this.convertColumnDefinition)+Y,{isActivated:g.isActivated})},commentIfDeactivated(g,Y,Q){return g},renameColumn(g,Y,Q){return S(ye.renameColumn,{tableName:g,oldColumnName:Y,newColumnName:Q})},createSchemaSequence({schemaName:g,sequence:Y}){let Q=$s(e==null?void 0:e.dbVersion);return Fn({schemaName:g,sequence:Y,usingTryCatchWrapper:Q})},dropSchemaSequence({schemaName:g,sequence:Y}){let Q=$s(e==null?void 0:e.dbVersion);return xn({schemaName:g,sequence:Y,usingTryCatchWrapper:Q})},alterSchemaSequence({schemaName:g,sequence:Y,oldSequence:Q}){let te=$s(e==null?void 0:e.dbVersion);return ai({schemaName:g,sequence:Y,oldSequence:Q,usingTryCatchWrapper:te})}}}});var cm=P((SM,_m)=>{"use strict";var{AlterScriptDto:wn}=Ft(),{getUpdateTypesScriptDtos:Iy}=uf(),{getRenameColumnScriptDtos:Dy}=Nf(),{getModifyIndexesScriptDtos:Cy,getAddedIndexesScriptDtos:Oy}=Pf(),dt=require("lodash"),gy=c(({app:i,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r,scriptFormat:n})=>a=>{let{getEntityName:_}=le()(dt),{createColumnDefinitionBySchema:T}=ni()(i),l=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:n}},i),{getDefinitionByReference:E}=i.require("@hackolade/ddl-fe-utils"),p={schemaName:a.compMod.keyspaceName,dbVersion:e},A={...a,...dt.omit(a==null?void 0:a.role,"properties")||{}},u=dt.toPairs(A.properties).map(([O,U])=>{let V=E({propertySchema:U,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r});return T({name:O,jsonSchema:U,parentJsonSchema:A,ddlProvider:l,schemaData:p,definitionJsonSchema:V})}),N=(A.chkConstr||[]).map(O=>l.createCheckConstraint(l.hydrateCheckConstraint(O))),d={name:_(A),columns:u.map(O=>l.convertColumnDefinition(O)),checkConstraints:N,foreignKeyConstraints:[],schemaData:p,columnDefinitions:u},S=l.hydrateTable({tableData:d,entityData:[A],jsonSchema:A}),D=am({_:dt,ddlProvider:l,collection:a,dbVersion:e}).flatMap(({scripts:O})=>O.map(({script:U})=>U)),m=l.createTable(S,A.isActivated);return wn.getInstance([m,...D],!0,!1)},"getAddCollectionScriptDto"),yy=c((i,e)=>t=>{let{getEntityName:s,getNamePrefixedWithSchemaNameForScriptFormat:r}=le()(dt),n={...t,...dt.omit(t==null?void 0:t.role,"properties")||{}},a=s(n),_=t.compMod.keyspaceName,l=`DROP TABLE ${r(e)(a,_)};`;return wn.getInstance([l],!0,!0)},"getDeleteCollectionScriptDto"),Ly=c(({app:i,dbVersion:e,scriptFormat:t})=>s=>{let r=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:t}},i);return[...Cy({_:dt,ddlProvider:r,scriptFormat:t})({collection:s})].filter(Boolean)},"getModifyCollectionScriptDtos"),By=c(({app:i,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r,scriptFormat:n})=>a=>{var m;let{getEntityName:_,getNamePrefixedWithSchemaNameForScriptFormat:T}=le()(dt),{createColumnDefinitionBySchema:l}=ni()(i),E=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:n}},i),{getDefinitionByReference:h}=i.require("@hackolade/ddl-fe-utils"),p={...a,...dt.omit(a==null?void 0:a.role,"properties")||{}},A=_(p),u=(m=p.compMod)==null?void 0:m.keyspaceName,N=T(n)(A,u),d={schemaName:u,dbVersion:e},S=dt.toPairs(a.properties).filter(([O,U])=>!U.compMod).map(([O,U])=>{let V=h({propertySchema:U,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r});return l({name:O,jsonSchema:U,parentJsonSchema:p,ddlProvider:E,schemaData:d,definitionJsonSchema:V})}).map(O=>E.convertColumnDefinition(O)).map(O=>`ALTER TABLE ${N} ADD (${O});`).map(O=>wn.getInstance([O],!0,!1)).filter(Boolean),D=am({_:dt,ddlProvider:E,collection:a});return S.concat(D).filter(Boolean)},"getAddColumnScriptDtos"),am=c(({_:i,ddlProvider:e,collection:t})=>{var _,T;let s=((_=t==null?void 0:t.role)==null?void 0:_.Indxs)||[],r={...t==null?void 0:t.properties,...(T=t==null?void 0:t.role)==null?void 0:T.properties},n=Object.values(r).map(({GUID:l})=>l);return s.length===0||n.length===0?[]:s.some(({indxKey:l})=>l.find(({keyId:E})=>n.includes(E)))?Oy({_:i,ddlProvider:e})({collection:t}):[]},"getNewlyCreatedIndexesScripts"),wy=c((i,e)=>t=>{var E;let{getEntityName:s,getNamePrefixedWithSchemaNameForScriptFormat:r,prepareNameForScriptFormat:n}=le()(dt),a={...t,...dt.omit(t==null?void 0:t.role,"properties")||{}},_=s(a),T=(E=a.compMod)==null?void 0:E.keyspaceName,l=r(e)(_,T);return dt.toPairs(t.properties).filter(([h,p])=>!p.compMod).map(([h])=>`ALTER TABLE ${l} DROP COLUMN ${n(e)(h)};`).map(h=>wn.getInstance([h],!0,!0)).filter(Boolean)},"getDeleteColumnScriptDtos"),Uy=c((i,e,t)=>s=>{let r=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:t}},i),n=Dy(dt,r,t)(s),a=Iy(dt,r,t)(s);return[...n,...a].filter(Boolean)},"getModifyColumnScriptDtos");_m.exports={getAddCollectionScriptDto:gy,getDeleteCollectionScriptDto:yy,getModifyCollectionScriptDtos:Ly,getAddColumnScriptDtos:By,getDeleteColumnScriptDtos:wy,getModifyColumnScriptDtos:Uy}});var Em=P((dM,lm)=>{"use strict";var{checkFieldPropertiesChanged:Tm}=le()(),Yy=Ol(),{AlterScriptDto:js}=Ft(),ss=require("lodash"),My=c(({app:i,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r,scriptFormat:n})=>a=>{let{createColumnDefinitionBySchema:_}=ni()(i),T=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:n}},i),{getDefinitionByReference:l}=i.require("@hackolade/ddl-fe-utils"),E={dbVersion:e},h=ss.toPairs(a.properties||{}).map(([N,d])=>{let S=l({propertySchema:d,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r});return _({name:N,jsonSchema:d,parentJsonSchema:a,ddlProvider:T,schemaData:E,definitionJsonSchema:S})}),A={..._({name:a.code||a.name,jsonSchema:a,parentJsonSchema:{required:[]},definitionJsonSchema:{},ddlProvider:T,schemaData:E}),properties:h},u=T.createUdt(A);return js.getInstance([u],!0,!1)},"getCreateUdtScriptDto"),Vy=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),n=`DROP TYPE ${s(e)(t.code||t.name)};`;return js.getInstance([n],!0,!0)},"getDeleteUdtScriptDto"),Fy=c(({app:i,dbVersion:e,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r,scriptFormat:n})=>a=>{let{createColumnDefinitionBySchema:_}=ni()(i),{prepareNameForScriptFormat:T}=le()(ss),l=Wt()(null,{dbVersion:e,targetScriptOptions:{keyword:n}},i),{getDefinitionByReference:E}=i.require("@hackolade/ddl-fe-utils"),h=T(n)(a.code||a.name),p={dbVersion:e};return ss.toPairs(a.properties).filter(([A,u])=>!u.compMod).map(([A,u])=>{let N=E({propertySchema:u,modelDefinitions:t,internalDefinitions:s,externalDefinitions:r});return _({name:A,jsonSchema:u,parentJsonSchema:{required:[]},ddlProvider:l,schemaData:p,definitionJsonSchema:N})}).map(A=>l.convertColumnDefinition(A,Yy.objectTypeColumnDefinition)).map(A=>`ALTER TYPE ${h} ADD ATTRIBUTE ${A};`).map(A=>js.getInstance([A],!0,!1))},"getAddColumnToTypeScriptDtos"),xy=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),r=s(e)(t.code||t.name);return ss.toPairs(t.properties).filter(([n,a])=>!a.compMod).map(([n])=>`ALTER TYPE ${r} DROP ATTRIBUTE ${s(e)(n)};`).map(n=>js.getInstance([n],!0,!0))},"getDeleteColumnFromTypeScriptDtos"),by=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(ss),r=s(e)(t.code||t.name),n=ss.values(t.properties).filter(_=>Tm(_.compMod,["name"])).flatMap(_=>{let T=s(e)(_.compMod.oldField.name),l=`ALTER TYPE ${r} DROP ATTRIBUTE ${T};`,E=s(e)(_.compMod.newField.name),h=`ALTER TYPE ${r} ADD ATTRIBUTE ${E};`;return[js.getInstance([l],!0,!0),js.getInstance([h],!0,!1)]}),a=ss.toPairs(t.properties).filter(([_,T])=>Tm(T.compMod,["type","mode"])).map(([_,T])=>{let l=s(e)(_),E=ss.toUpper(T.compMod.newField.mode||T.compMod.newField.type),h=`ALTER TYPE ${r} MODIFY ATTRIBUTE ${l} ${E};`;return js.getInstance([h],!0,!1)});return[...n,...a]},"getModifyColumnOfTypeScriptDtos");lm.exports={getCreateUdtScriptDto:My,getDeleteUdtScriptDto:Vy,getAddColumnToTypeScriptDtos:Fy,getDeleteColumnFromTypeScriptDtos:xy,getModifyColumnOfTypeScriptDtos:by}});var Nm=P((fM,hm)=>{"use strict";var{DualityViewPropertiesType:um}=yl(),ky=c(i=>e=>{let{getEntityName:t,getBucketName:s}=le()(i),r=i.get(e,"role",{}),n=i.get(r,"compMod.bucketProperties",{}),a=i.get(r,"compMod.collectionData.entityData[0]",{}),_=t(a),T=s(n);return{code:r.code,tableName:_,name:r.name,tableTagsClause:r.tableTagsClause,schemaName:T,rootTableAlias:r.rootTableAlias,orReplace:r.or_replace}},"mapToFeView"),qy=c(i=>(e,t,s)=>{let r=s==null?void 0:s[t.refId],n=(r==null?void 0:r.definition)||{},a=n.code||n.name||"";return{code:e,ref:t.ref,refId:t.refId,refIdPath:[t.refId,t.ref],refType:um.COLLECTION_REFERENCE,columnTagsClause:t.columnTagsClause,referencedColumnName:a}},"mapRegularField"),Gy=c((i,e,t)=>{if(!t[e.GUID]){let s=i||e.title;throw s?s=`<u>${s}</u>`:s="a",new Error(`Could not find referenced collection for ${s} subquery. Check if all the subqueries have the "child table" property set`)}},"assertSubqueryIsValid"),Hy=c(i=>(e,t,s)=>{Gy(e,t,s);let r={code:e,type:t.type,name:t.title,subtype:t.subtype,sqlJsonFunction:t.sqlJsonFunction,whereClause:t.whereClause,joinedCollectionRefIdPath:[t.GUID],childTableAlias:t.childTableAlias,tableTagsClause:t.tableTagsClause,items:void 0,properties:void 0,unnestSubquery:void 0};if(t.subtype==="array"){let n=i.get(t,"items.properties",{});r.items={properties:Fl(i)(n,s)}}else if(t.subtype==="object"){r.unnestSubquery=t.unnestSubquery;let n=i.get(t,"properties",{});r.properties=Fl(i)(n,s)}return r},"mapSubquery"),Fl=c(i=>(e,t)=>{let r=i.toPairs(e).map(([n,a])=>{if(a.type===um.JOIN_SUBQUERY_TYPE){let T=Hy(i)(n,a,t);return[n,T]}let _=qy(i)(n,a,t);return[n,_]});return i.fromPairs(r)},"recursivelyParseProperties"),vy=c(i=>e=>{let t=i.get(e,"role.properties",{}),s=i.get(e,"role.compMod.collectionData.collectionRefsDefinitionsMap",{});return Fl(i)(t,s)},"parseProperties"),Ky=c(i=>e=>{let{getEntityName:t}=le()(i),s=i.get(e,"role",{}),r=i.get(s,"compMod.collectionData.entityData[0]",{}),n=t(r),a=vy(i)(e);return{rootTableAlias:s.rootTableAlias,tableName:n,properties:a,duality:s.duality,editionable:s.editionable,force:s.force,viewOn:s.viewOn}},"mapToFeJsonSchema"),Wy=c(i=>e=>{let t=i.get(e,"role.compMod.collectionData.collectionRefsDefinitionsMap",{}),r=i.toPairs(t).map(([n,a])=>{let _=i.get(a,"bucket[0].name",""),T=i.get(a,"collection[0]",""),l=a.definition||{},h={properties:{[l.code||l.name]:{GUID:a.definitionId}},bucketName:_,code:T.code,collectionName:T.collectionName};return[n,h]});return i.fromPairs(r)},"mapToFeRelatedSchemas"),Xy=c(i=>e=>{let t=ky(i)(e),s=Ky(i)(e),r=Wy(i)(e);return{view:t,jsonSchema:s,relatedSchemas:r}},"mapDeltaDualityViewToFeDualityView");hm.exports={mapDeltaDualityViewToFeDualityView:Xy}});var dm=P((PM,Am)=>{"use strict";var{AlterScriptDto:xl}=Ft(),{mapDeltaDualityViewToFeDualityView:zy}=Nm(),Sm=require("lodash"),$y=c((i,e)=>t=>{let s=Wt()(null,{targetScriptOptions:{keyword:e}},i),r={name:t.code||t.name,keys:[],schemaData:{schemaName:""}},n=s.hydrateView({viewData:r,entityData:[t]}),a=s.createView(n,{},t.isActivated);return xl.getInstance([a],!0,!1)},"getAddRegularViewScriptDto"),jy=c((i,e)=>t=>{let s=Wt()(null,{targetScriptOptions:{keyword:e}},i),r=zy(Sm)(t),n=s.createDualityView(r);return xl.getInstance([n],!0,!1)},"getDualityViewScriptDto"),Jy=c((i,e)=>t=>{if(t.duality)return jy(i,e)(t);if(t.selectStatement)return $y(i,e)(t)},"getAddViewScriptDto"),Qy=c((i,e)=>t=>{let{prepareNameForScriptFormat:s}=le()(Sm),n=`DROP VIEW ${s(e)(t.code||t.name)};`;return xl.getInstance([n],!0,!0)},"getDeleteViewScriptDto");Am.exports={getAddViewScriptDto:Jy,getDeleteViewScriptDto:Qy}});var fm=P((IM,pm)=>{"use strict";var Wl=class Wl{isActivated;name};c(Wl,"AlterRelationshipFKField");var bl=Wl,Xl=class Xl{bucket;collection};c(Xl,"AlterRelationshipParentDto");var kl=Xl,zl=class zl{bucket;collection};c(zl,"AlterRelationshipChildDto");var ql=zl,$l=class $l{relationshipOnDelete;relationshipOnUpdate;relationshipMatch};c($l,"AlterRelationshipCustomProperties");var Gl=$l,jl=class jl{created;deleted;modified;parent;child;name;description;customProperties;isActivated};c(jl,"AlterRelationshipRoleCompModDto");var Hl=jl,Jl=class Jl{id;name;relationshipType;parentField;parentCardinality;childField;isActivated;childCardinality;parentCollection;childCollection;hackoladeStyles;compMod;roleType};c(Jl,"AlterRelationshipRoleDto");var vl=Jl,Ql=class Ql{type;isActivated;unique;subtype;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};c(Ql,"AlterRelationshipDto");var Kl=Ql;pm.exports={AlterRelationshipRoleCompModDto:Hl,AlterRelationshipRoleDto:vl,AlterRelationshipDto:Kl,AlterRelationshipFKField:bl,AlterRelationshipParentDto:kl,AlterRelationshipChildDto:ql,AlterRelationshipCustomProperties:Gl}});var Cm=P((OM,Dm)=>{"use strict";var{AlterScriptDto:Zl}=Ft(),{AlterRelationshipDto:CM}=fm(),Un=c(i=>i.role.name,"getRelationshipName"),Zy=c((i,e)=>t=>{let{getNamePrefixedWithSchemaNameForScriptFormat:s}=le()(i),r=t.role.compMod,n=r.child.bucket.name,a=r.child.collection.name;return s(e)(a,n)},"getFullChildTableName"),mm=c((i,e)=>t=>{var n,a;let s=t.role.compMod,r=((n=s.name)==null?void 0:n.new)||Un(t)||"";return i.createForeignKey({name:r,foreignKey:s.child.collection.fkFields,primaryKey:s.parent.collection.fkFields,customProperties:(a=s.customProperties)==null?void 0:a.new,foreignTable:s.child.collection.name,foreignSchemaName:s.child.bucket.name,foreignTableActivated:s.child.collection.isActivated,primaryTable:s.parent.collection.name,primarySchemaName:s.parent.bucket.name,primaryTableActivated:s.parent.collection.isActivated})},"getAddSingleForeignKeyStatementDto"),Pm=c(i=>{var t,s,r,n,a,_,T,l,E,h,p;let e=i.role.compMod;return e?[((t=e.name)==null?void 0:t.new)||Un(i),(s=e.parent)==null?void 0:s.bucket,(r=e.parent)==null?void 0:r.collection,(_=(a=(n=e.parent)==null?void 0:n.collection)==null?void 0:a.fkFields)==null?void 0:_.length,(T=e.child)==null?void 0:T.bucket,(l=e.child)==null?void 0:l.collection,(p=(h=(E=e.child)==null?void 0:E.collection)==null?void 0:h.fkFields)==null?void 0:p.length].every(A=>!!A):!1},"canRelationshipBeAdded"),eL=c((i,e)=>t=>t.filter(s=>Pm(s)).map(s=>{let r=mm(i,e)(s);return Zl.getInstance([r.statement],r.isActivated,!1)}).filter(Boolean).filter(s=>s.scripts.some(r=>!!r.script)),"getAddForeignKeyScriptDtos"),Rm=c((i,e,t)=>s=>{var p,A,u,N;let{prepareNameForScriptFormat:r}=le()(e),n=s.role.compMod,a=Zy(e,t)(s),_=((p=n.name)==null?void 0:p.old)||Un(s)||"",T=r(t)(_),l=i.dropForeignKey(a,T),E=!!((N=(u=(A=s.role)==null?void 0:A.compMod)==null?void 0:u.isActivated)!=null&&N.new),h=n.child.collection.isActivated;return{statement:l,isActivated:E&&h}},"getDeleteSingleForeignKeyStatementDto"),Im=c(i=>{var t,s,r;let e=i.role.compMod;return e?[((t=e.name)==null?void 0:t.old)||Un(i),(s=e.child)==null?void 0:s.bucket,(r=e.child)==null?void 0:r.collection].every(n=>!!n):!1},"canRelationshipBeDeleted"),tL=c((i,e,t)=>s=>s.filter(r=>Im(r)).map(r=>{let n=Rm(i,e,t)(r);return Zl.getInstance([n.statement],n.isActivated,!0)}).filter(Boolean).filter(r=>r.scripts.some(n=>!!n.script)),"getDeleteForeignKeyScriptDtos"),sL=c((i,e,t)=>s=>s.filter(r=>Pm(r)&&Im(r)).map(r=>{let n=Rm(i,e,t)(r),a=mm(i,e)(r),_=a.isActivated&&n.isActivated;return Zl.getDropAndRecreateInstance(n.statement,a.statement,_)}).filter(Boolean).filter(r=>r.scripts.some(n=>!!n.script)),"getModifyForeignKeyScriptDtos");Dm.exports={getDeleteForeignKeyScriptDtos:tL,getModifyForeignKeyScriptDtos:sL,getAddForeignKeyScriptDtos:eL}});var _E=P((yM,Om)=>{"use strict";var iE=class iE{message;stack};c(iE,"PluginError");var eE=iE,nE=class nE{require};c(nE,"App");var tE=nE,oE=class oE{log;clear};c(oE,"Logger");var sE=oE,aE=class aE{jsonSchema;modelDefinitions;internalDefinitions;externalDefinitions;containerData;entityData;entities;views;viewData;relationships;collectionRefsDefinitionsMap;isUpdateScript;level;host;clusterId;accessToken;applyToInstanceQueryRequestTimeout;script;hiddenKeys;options;modelData};c(aE,"CoreData");var rE=aE;Om.exports={App:tE,CoreData:rE,Logger:sE,PluginError:eE}});var ym=P((BM,gm)=>{"use strict";var AE=class AE{name;isActivated};c(AE,"ContainerJsonSchema");var cE=AE,dE=class dE{backgroundColor};c(dE,"ContainerStyles");var TE=dE,pE=class pE{collectionName;isActivated;bucketId;additionalProperties;tableIfNotExists};c(pE,"EntityData");var lE=pE,fE=class fE{$schema;type;GUID};c(fE,"InternalDefinitions");var EE=fE,mE=class mE{$schema;type;GUID};c(mE,"ModelDefinitions");var uE=mE,PE=class PE{$schema;type;GUID};c(PE,"ExternalDefinitions");var hE=PE,RE=class RE{type;isActivated;mode;subtype;compositeKey;compositePartitionKey;compositeClusteringKey;compositePrimaryKey;compositeUniqueKey;GUID};c(RE,"FieldJsonSchema");var NE=RE,IE=class IE{$schema;type;title;properties;isActivated;additionalProperties;tableIfNotExists;GUID};c(IE,"EntityJsonSchema");var SE=IE;gm.exports={ContainerJsonSchema:cE,ContainerStyles:TE,EntityData:lE,InternalDefinitions:EE,ModelDefinitions:uE,ExternalDefinitions:hE,FieldJsonSchema:NE,EntityJsonSchema:SE}});var Yn=P((UM,Lm)=>{"use strict";Lm.exports=Wt()});var wm=P((MM,Bm)=>{"use strict";var{AlterScriptDto:oi}=Ft(),{App:YM}=_E(),rL="sequences",Mn=require("lodash"),iL=c(({app:i})=>({container:e,dbVersion:t})=>{var a;let s=Yn()(null,{dbVersion:t},i),{getDbName:r}=le()(Mn),n=r([e.role]);return(((a=e.role)==null?void 0:a.sequences)||[]).map(_=>{let T=s.createSchemaSequence({schemaName:n,sequence:_});return oi.getInstance([T],!0,!1)}).filter(Boolean)},"getAddContainerSequencesScriptDtos"),nL=c(({app:i})=>({container:e,dbVersion:t})=>{var d,S;let s=Yn()(null,{dbVersion:t},i),{getDbName:r,getGroupItemsByCompMode:n}=le()(Mn),a=r([e.role]),_=((S=(d=e.role)==null?void 0:d.compMod)==null?void 0:S[rL])||{},{new:T=[],old:l=[]}=_,{removed:E,added:h,modified:p}=n({newItems:T,oldItems:l}),A=E.map(D=>{let m=s.dropSchemaSequence({schemaName:a,sequence:D});return oi.getInstance([m],!0,!0)}),u=h.map(D=>{let m=s.createSchemaSequence({schemaName:a,sequence:D});return oi.getInstance([m],!0,!1)});return[...p.map(D=>{let m=Mn.find(l,{id:D.id})||{},O=s.alterSchemaSequence({schemaName:a,sequence:D,oldSequence:m}),U=O.startsWith("DROP");return oi.getInstance([O],!0,U)}),...A,...u].filter(Boolean)},"getModifyContainerSequencesScriptDtos"),oL=c(({app:i})=>({container:e,dbVersion:t})=>{var a;let s=Yn()(null,{dbVersion:t},i),{getDbName:r}=le()(Mn),n=r([e.role]);return(((a=e.role)==null?void 0:a.sequences)||[]).map(_=>{let T=s.dropSchemaSequence({schemaName:n,sequence:_});return oi.getInstance([T],!0,!0)}).filter(Boolean)},"getDeleteContainerSequencesScriptDtos");Bm.exports={getAddContainerSequencesScriptDtos:iL,getModifyContainerSequencesScriptDtos:nL,getDeleteContainerSequencesScriptDtos:oL}});var Ym=P((vM,Um)=>{"use strict";var{getAddContainerScriptDto:aL,getDeleteContainerScriptDto:_L}=lf(),{getAddCollectionScriptDto:cL,getDeleteCollectionScriptDto:TL,getModifyCollectionScriptDtos:lL,getAddColumnScriptDtos:EL,getDeleteColumnScriptDtos:uL,getModifyColumnScriptDtos:hL}=cm(),{getDeleteUdtScriptDto:NL,getCreateUdtScriptDto:SL,getAddColumnToTypeScriptDtos:AL,getDeleteColumnFromTypeScriptDtos:dL,getModifyColumnOfTypeScriptDtos:pL}=Em(),{getAddViewScriptDto:fL,getDeleteViewScriptDto:mL}=dm(),{getModifyForeignKeyScriptDtos:PL,getDeleteForeignKeyScriptDtos:RL,getAddForeignKeyScriptDtos:IL}=Cm(),{AlterScriptDto:FM,ModificationScript:xM}=Ft(),{App:bM,CoreData:kM}=_E(),{InternalDefinitions:qM,ModelDefinitions:GM,ExternalDefinitions:HM}=ym(),{getModifyContainerSequencesScriptDtos:DL,getDeleteContainerSequencesScriptDtos:CL,getAddContainerSequencesScriptDtos:OL}=wm(),Us=require("lodash"),gL=c(({collection:i,app:e,scriptFormat:t})=>{var _,T,l,E,h,p,A,u;let s=(E=(l=(T=(_=i.properties)==null?void 0:_.containers)==null?void 0:T.properties)==null?void 0:l.added)==null?void 0:E.items,r=(u=(A=(p=(h=i.properties)==null?void 0:h.containers)==null?void 0:p.properties)==null?void 0:A.deleted)==null?void 0:u.items,n=[].concat(s).filter(Boolean).map(N=>aL(e,t)(Object.keys(N.properties)[0])),a=[].concat(r).filter(Boolean).map(N=>_L(e,t)(Object.keys(N.properties)[0]));return[...n,...a].filter(Boolean)},"getAlterContainersScriptDtos"),yL=c(({collection:i,app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})=>{var d,S,D,m,O,U,V,G,z,C,q,R;let _=[].concat((m=(D=(S=(d=i.properties)==null?void 0:d.entities)==null?void 0:S.properties)==null?void 0:D.added)==null?void 0:m.items).filter(Boolean).map(B=>Object.values(B.properties)[0]),T=[].concat((G=(V=(U=(O=i.properties)==null?void 0:O.entities)==null?void 0:U.properties)==null?void 0:V.deleted)==null?void 0:G.items).filter(Boolean).map(B=>Object.values(B.properties)[0]),l=[].concat((R=(q=(C=(z=i.properties)==null?void 0:z.entities)==null?void 0:C.properties)==null?void 0:q.modified)==null?void 0:R.items).filter(Boolean).map(B=>Object.values(B.properties)[0]),E=_.filter(B=>{var x;return(x=B.compMod)==null?void 0:x.created}).map(cL({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})),h=T.filter(B=>{var x;return(x=B.compMod)==null?void 0:x.deleted}).map(TL(e,a)),p=l.filter(B=>{var x;return(x=B.compMod)==null?void 0:x.modified}).flatMap(lL({app:e,dbVersion:t,scriptFormat:a})),A=_.filter(B=>{var x;return!((x=B==null?void 0:B.compMod)!=null&&x.created)}).flatMap(EL({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})),u=T.filter(B=>{var x;return!((x=B==null?void 0:B.compMod)!=null&&x.deleted)}).flatMap(uL(e,a)),N=l.flatMap(hL(e,t,a));return[...E,...h,...p,...A,...u,...N].filter(Boolean)},"getAlterCollectionsScriptDtos"),LL=c((i,e,t,s)=>{var a,_,T,l,E,h,p,A;let r=[].concat((l=(T=(_=(a=i.properties)==null?void 0:a.views)==null?void 0:_.properties)==null?void 0:T.added)==null?void 0:l.items).filter(Boolean).map(u=>Object.values(u.properties)[0]).map(u=>({...u,...u.role||{}})).filter(u=>{var N;return(N=u.compMod)==null?void 0:N.created}).map(fL(e,s));return[...[].concat((A=(p=(h=(E=i.properties)==null?void 0:E.views)==null?void 0:h.properties)==null?void 0:p.deleted)==null?void 0:A.items).filter(Boolean).map(u=>Object.values(u.properties)[0]).map(u=>({...u,...u.role||{}})).map(mL(e,s)),...r].filter(Boolean)},"getAlterViewScriptDtos"),BL=c(({collection:i,app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})=>{var p,A,u,N,d,S,D,m,O,U,V,G,z,C,q,R,B,x,J,re;let _=[].concat((N=(u=(A=(p=i.properties)==null?void 0:p.modelDefinitions)==null?void 0:A.properties)==null?void 0:u.added)==null?void 0:N.items).filter(Boolean).map(k=>Object.values(k.properties)[0]).map(k=>({...k,...Us.omit(k.role,"properties")||{}})).filter(k=>{var Ee;return(Ee=k.compMod)==null?void 0:Ee.created}).map(SL({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})),T=[].concat((m=(D=(S=(d=i.properties)==null?void 0:d.modelDefinitions)==null?void 0:S.properties)==null?void 0:D.deleted)==null?void 0:m.items).filter(Boolean).map(k=>Object.values(k.properties)[0]).map(k=>({...k,...Us.omit(k.role,"properties")||{}})).filter(k=>{var Ee;return(Ee=k.compMod)==null?void 0:Ee.deleted}).map(NL(e,a)),l=[].concat((G=(V=(U=(O=i.properties)==null?void 0:O.modelDefinitions)==null?void 0:U.properties)==null?void 0:V.added)==null?void 0:G.items).filter(Boolean).map(k=>Object.values(k.properties)[0]).filter(k=>!k.compMod).map(k=>({...k,...Us.omit(k.role,"properties")||{}})).filter(k=>k.childType==="object_udt").flatMap(AL({app:e,dbVersion:t,modelDefinitions:s,internalDefinitions:r,externalDefinitions:n,scriptFormat:a})),E=[].concat((R=(q=(C=(z=i.properties)==null?void 0:z.modelDefinitions)==null?void 0:C.properties)==null?void 0:q.deleted)==null?void 0:R.items).filter(Boolean).map(k=>Object.values(k.properties)[0]).filter(k=>!k.compMod).map(k=>({...k,...Us.omit(k.role,"properties")||{}})).filter(k=>k.childType==="object_udt").flatMap(dL(e,a)),h=[].concat((re=(J=(x=(B=i.properties)==null?void 0:B.modelDefinitions)==null?void 0:x.properties)==null?void 0:J.modified)==null?void 0:re.items).filter(Boolean).map(k=>Object.values(k.properties)[0]).filter(k=>!k.compMod).map(k=>({...k,...Us.omit(k.role,"properties")||{}})).filter(k=>k.childType==="object_udt").flatMap(pL(e,a));return[...T,..._,...l,...E,...h].filter(Boolean)},"getAlterModelDefinitionsScriptDtos"),wL=c(({collection:i,app:e,scriptFormat:t})=>{var E,h,p,A,u,N,d,S,D,m,O,U;let s=Wt()(null,{targetScriptOptions:{keyword:t}},e),r=[].concat((A=(p=(h=(E=i.properties)==null?void 0:E.relationships)==null?void 0:h.properties)==null?void 0:p.added)==null?void 0:A.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var G,z;return(z=(G=V==null?void 0:V.role)==null?void 0:G.compMod)==null?void 0:z.created}),n=[].concat((S=(d=(N=(u=i.properties)==null?void 0:u.relationships)==null?void 0:N.properties)==null?void 0:d.deleted)==null?void 0:S.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var G,z;return(z=(G=V==null?void 0:V.role)==null?void 0:G.compMod)==null?void 0:z.deleted}),a=[].concat((U=(O=(m=(D=i.properties)==null?void 0:D.relationships)==null?void 0:m.properties)==null?void 0:O.modified)==null?void 0:U.items).filter(Boolean).map(V=>Object.values(V.properties)[0]).filter(V=>{var G,z;return(z=(G=V==null?void 0:V.role)==null?void 0:G.compMod)==null?void 0:z.modified}),_=RL(s,Us,t)(n),T=IL(s,Us)(r),l=PL(s,Us,t)(a);return[..._,...T,...l].filter(Boolean)},"getAlterRelationshipsScriptDtos"),UL=c(i=>{if(!i)return;let e=i.scripts.map(t=>({...t,script:(t.script||"").trim()})).filter(t=>!!t.script);if(e.length)return{...i,scripts:e}},"prettifyAlterScriptDto"),YL=c(({collection:i,app:e,dbVersion:t})=>{var l,E,h,p,A,u,N,d,S,D,m,O;let s=(p=(h=(E=(l=i.properties)==null?void 0:l.containers)==null?void 0:E.properties)==null?void 0:h.added)==null?void 0:p.items,r=(d=(N=(u=(A=i.properties)==null?void 0:A.containers)==null?void 0:u.properties)==null?void 0:N.deleted)==null?void 0:d.items,n=(O=(m=(D=(S=i.properties)==null?void 0:S.containers)==null?void 0:D.properties)==null?void 0:m.modified)==null?void 0:O.items,a=[].concat(s).filter(Boolean).map(U=>Object.values(U.properties)[0]).flatMap(U=>OL({app:e})({container:U,dbVersion:t})),_=[].concat(r).filter(Boolean).map(U=>Object.values(U.properties)[0]).flatMap(U=>CL({app:e})({container:U,dbVersion:t})),T=[].concat(n).filter(Boolean).map(U=>Object.values(U.properties)[0]).flatMap(U=>DL({app:e})({container:U,dbVersion:t}));return[...a,..._,...T].filter(Boolean)},"getAlterContainersSequencesScriptDtos"),ML=c((i,e)=>{var u,N,d;let t=JSON.parse(i.jsonSchema);if(!t)throw new Error('"comparisonModelCollection" is not found. Alter script can be generated only from Delta model');let s=(N=(u=i.options)==null?void 0:u.targetScriptOptions)==null?void 0:N.keyword,r=JSON.parse(i.modelDefinitions),n=JSON.parse(i.internalDefinitions),a=JSON.parse(i.externalDefinitions),_=(d=i.modelData[0])==null?void 0:d.dbVersion,T=gL({collection:t,app:e,scriptFormat:s}),l=yL({collection:t,app:e,dbVersion:_,modelDefinitions:r,internalDefinitions:n,externalDefinitions:a,scriptFormat:s}),E=LL(t,e,_,s),h=BL({collection:t,app:e,dbVersion:_,modelDefinitions:r,internalDefinitions:n,externalDefinitions:a,scriptFormat:s}),p=wL({collection:t,app:e,scriptFormat:s}),A=YL({collection:t,app:e,dbVersion:_});return[...T,...A,...h,...l,...E,...p].filter(Boolean).map(S=>UL(S)).filter(Boolean)},"getAlterScriptDtos");Um.exports={getAlterScriptDtos:ML}});var bm=P((XM,xm)=>{"use strict";var{getAlterScriptDtos:Vn}=Ym(),{AlterScriptDto:WM}=Ft(),Mm=require("lodash"),Vm=c(i=>(e,t)=>{let{commentIfDeactivated:s}=le()(i);return e.map(r=>r.isActivated===!1?r.scripts.map(n=>s(n.script,{isActivated:!1,isPartOfLine:!1})):t?r.scripts.map(n=>n.script):r.scripts.map(n=>s(n.script,{isActivated:!n.isDropScript,isPartOfLine:!1}))).flat().filter(Boolean).map(r=>r.trim()).filter(Boolean).join(`

`)},"joinAlterScriptDtosIntoScript"),VL=c((i,e)=>{var r,n;let t=Vn(i,e),s=(n=(r=i.options)==null?void 0:r.additionalOptions)==null?void 0:n.some(a=>a.id==="applyDropStatements"&&a.value);return Vm(Mm)(t,s)},"buildEntityLevelAlterScript"),FL=c((i,e)=>Vn(i,e).some(s=>s.isActivated&&s.scripts.some(r=>r.isDropScript)),"doesEntityLevelAlterScriptContainDropStatements"),Fm=c(i=>({...i,jsonSchema:i.collections[0],internalDefinitions:Object.values(i.internalDefinitions)[0]}),"mapCoreDataForContainerLevelScripts"),xL=c((i,e)=>{var n,a;let t=Fm(i),s=Vn(t,e),r=(a=(n=t.options)==null?void 0:n.additionalOptions)==null?void 0:a.some(_=>_.id==="applyDropStatements"&&_.value);return Vm(Mm)(s,r)},"buildContainerLevelAlterScript"),bL=c((i,e)=>{let t=Fm(i);return Vn(t,e).some(r=>r.isActivated&&r.scripts.some(n=>n.isDropScript))},"doesContainerLevelAlterScriptContainDropStatements");xm.exports={buildEntityLevelAlterScript:VL,doesEntityLevelAlterScriptContainDropStatements:FL,buildContainerLevelAlterScript:xL,doesContainerLevelAlterScriptContainDropStatements:bL}});var km=sf(),kL=nf(),{doesContainerLevelAlterScriptContainDropStatements:qL,doesEntityLevelAlterScriptContainDropStatements:GL,buildContainerLevelAlterScript:HL,buildEntityLevelAlterScript:vL}=bm();module.exports={generateScript(i,e,t,s){try{let r=vL(i,s);t(null,r)}catch(r){e.log("error",{message:r.message,stack:r.stack},"Oracle Forward-Engineering Error"),t({message:r.message,stack:r.stack})}},generateViewScript(i,e,t,s){t(new Error("Forward-Engineering of delta model on view level is not supported"))},generateContainerScript(i,e,t,s){try{let r=HL(i,s);t(null,r)}catch(r){e.log("error",{message:r.message,stack:r.stack},"Oracle Forward-Engineering Error"),t({message:r.message,stack:r.stack})}},getDatabases(i,e,t,s){e.progress({message:"Find all schemas"}),km.getSchemaNames(i,e,t,s)},applyToInstance(i,e,t,s){e.clear(),e.log("info",i,"connectionInfo",i.hiddenKeys),kL.applyToInstance(i,e,s).then(r=>{t(null,r)}).catch(r=>{let n={message:r.message,stack:r.stack};e.log("error",n,"Error when applying to instance"),t(n)})},testConnection(i,e,t,s){km.testConnection(i,e,t,s)},isDropInStatements(i,e,t,s){try{if(i.level==="container"){let r=qL(i,s);t(null,r)}else{let r=GL(i,s);t(null,r)}}catch(r){t({message:r.message,stack:r.stack})}}};
